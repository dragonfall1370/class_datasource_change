SELECT
	TBL_CONTACT.CONTACTID AS 'CONTACTID',
	TBL_CONTACT.LATITUDE AS 'ACT_LATITUDE',
	TBL_CONTACT.LONGITUDE AS 'ACT_LONGITUDE',
	TBL_ADDRESS0.LINE1 AS 'ADDRESS_1',
	TBL_ADDRESS0.LINE2 AS 'ADDRESS_2',
	TBL_ADDRESS0.LINE3 AS 'ADDRESS_3',
	TBL_CONTACT.AEM_BOUNCEBACK AS 'AEM Bounce Back',
	TBL_CONTACT.AEM_OPTOUT AS 'AEM Opt Out',
	TBL_PHONE1.SUFFIX AS 'ALTERNATE_EXTENSION',
	TBL_PHONE1.NUMBERDISPLAY AS 'ALTERNATE_PHONE',
	TBL_CONTACT.BIRTHDATE AS 'BIRTH_DATE',
	TBL_ADDRESS0.CITY AS 'CITY',
	TBL_CONTACT.COMPANYNAME AS 'COMPANY',
	TBL_CONTACT.COMPANYID AS 'COMPANYID',
	TBL_CONTACT.FULLNAME AS 'CONTACT',
	TBL_ADDRESS0.COUNTRYNAME AS 'COUNTRY',
	TBL_CONTACT.CREATEDATE AS 'CREATE_DATE',
	TBL_CONTACT.CUST_CurrentlyWorking_032120935 AS 'Currently Working ',
	TBL_CONTACT.CUST_DBSIssuingBody_024624251 AS 'DBS Issuing Body',
	TBL_CONTACT.DEPARTMENT AS 'DEPARTMENT',
	TBL_CONTACT.CUST_DrivingLicense_030155761 AS 'Driving License  ',
	TBL_CONTACT.EDITDATE AS 'EDIT_DATE',
	TBL_EMAIL2.ADDRESS AS 'E-MAIL',
	TBL_PHONE3.SUFFIX AS 'EXTENSION',
	TBL_PHONE4.SUFFIX AS 'FAX_EXTENSION',
	TBL_PHONE4.NUMBERDISPLAY AS 'FAX_PHONE',
	TBL_CONTACT.FIRSTNAME AS 'FIRST_NAME',
	TBL_CONTACT.CUST_HCPCExpiry_025843939 AS 'HCPC Expiry ',
	TBL_CONTACT.CUST_HCPCNumber_025518815 AS 'HCPC Number',
	TBL_ADDRESS5.LINE1 AS 'HOME_ADDRESS_1',
	TBL_ADDRESS5.LINE2 AS 'HOME_ADDRESS_2',
	TBL_ADDRESS5.LINE3 AS 'HOME_ADDRESS_3',
	TBL_ADDRESS5.CITY AS 'HOME_CITY',
	TBL_ADDRESS5.COUNTRYNAME AS 'HOME_COUNTRY',
	TBL_PHONE6.SUFFIX AS 'HOME_EXTENSION',
	TBL_PHONE6.NUMBERDISPLAY AS 'HOME_PHONE',
	TBL_ADDRESS5.STATE AS 'HOME_STATE',
	TBL_ADDRESS5.POSTALCODE AS 'HOME_ZIP_CODE',
--	TBL_CONTACT.CATEGORY AS 'ID/STATUS',
	TBL_CONTACT.CATEGORY AS 'CATEGORY',
	TBL_CONTACT.IMPORTDATE AS 'IMPORT_DATE',
	TBL_CONTACT.ISFAVORITE AS 'IS_FAVORITE',
	TBL_CONTACT.ISIMPORTED AS 'IS_IMPORTED',
	TBL_CONTACT.ISUSER AS 'IS_USER',
	TBL_CONTACT.LASTATTEMPTDATE AS 'LAST_ATTEMPT',
	TBL_ACCESSOR7.NAME AS 'LAST_EDITED_BY',
	TBL_CONTACT.LASTEMAILDATE AS 'LAST_E-MAIL',
	TBL_CONTACT.LASTMEETDATE AS 'LAST_MEETING',
	TBL_CONTACT.LASTNAME AS 'LAST_NAME',
	TBL_CONTACT.LASTREACHDATE AS 'LAST_REACH',
	TBL_CONTACT.LASTRESULTS AS 'LAST_RESULTS',
	TBL_CONTACT.LASTLETTERDATE AS 'LETTER_DATE',
	TBL_CONTACT.INSTANTMSGID AS 'MESSENGER_ID',
	TBL_CONTACT.MIDDLENAME AS 'MIDDLE_NAME',
	TBL_PHONE8.SUFFIX AS 'MOBILE_EXTENSION',
	TBL_PHONE8.NUMBERDISPLAY AS 'MOBILE_PHONE',
	TBL_CONTACT.CUST_MOTCertificateNumber_032237940 AS 'MOT Certificate Number',
	TBL_CONTACT.CUST_MOTExpiryDate_032317633 AS 'MOT Expiry Date',
	TBL_CONTACT.NAMEPREFIX AS 'NAME_PREFIX',
	TBL_CONTACT.NAMESUFFIX AS 'NAME_SUFFIX',
	TBL_CONTACT.CUST_NewField1_025859215 AS 'New Field 1',
	TBL_CONTACT.CUST_NINumber_023716178 AS 'NI Number',
	TBL_PHONE9.SUFFIX AS 'PAGER_EXTENSION',
	TBL_PHONE9.NUMBERDISPLAY AS 'PAGER_PHONE',
	TBL_CONTACT.CUST_PayRate_024946843 AS 'Pay Rate',
	TBL_CONTACT.CUST_PAYEorLTD_025431109 AS 'PAYE or LTD',
	TBL_EMAIL10.ADDRESS AS 'PERSONAL_E-MAIL',
	TBL_PHONE3.NUMBERDISPLAY AS 'PHONE',
	TBL_CONTACT.ISPRIVATE AS 'IS_PRIVATE',
	TBL_ACCESSOR11.NAME AS 'RECORD_CREATOR',
	TBL_ACCESSOR12.NAME AS 'RECORD_MANAGER',
	TBL_CONTACT.REFERREDBY AS 'REFERRED_BY',
	TBL_CONTACT.SALUTATION AS 'SALUTATION',
	TBL_CONTACT.SPOUSENAME AS 'SPOUSE',
	TBL_ADDRESS0.STATE AS 'STATE',
	TBL_CONTACT.JOBTITLE AS 'TITLE',
	TBL_CONTACT.CUST_Useofcarforwork_032203944 AS 'Use of car for work ',
	TBL_CONTACT.USER1 AS 'USER1',
	TBL_CONTACT.USER2 AS 'USER2',
	TBL_CONTACT.USER3 AS 'USER3',
	TBL_CONTACT.USER4 AS 'USER4',
	TBL_CONTACT.USER5 AS 'USER5',
	TBL_CONTACT.USER6 AS 'USER6',
	TBL_CONTACT.USER7 AS 'USER7',
	TBL_CONTACT.USER8 AS 'USER8',
	TBL_CONTACT.USER9 AS 'USER9',
	TBL_CONTACT.CONTACTWEBADDRESS AS 'WEB_SITE',
	TBL_PHONE13.SUFFIX AS 'Work_EXTENSION',
	TBL_PHONE13.NUMBERDISPLAY AS 'Work_PHONE',
	TBL_ADDRESS0.POSTALCODE AS 'ZIP_CODE'
FROM 	dbo.TBL_CONTACT
		LEFT OUTER JOIN dbo.TBL_ADDRESS TBL_ADDRESS0 ON (TBL_CONTACT.CONTACTID = TBL_ADDRESS0.CONTACTID AND TBL_ADDRESS0.TYPEID = '31BD07D5-4CB7-4038-9505-D2347AA530A1')
		LEFT OUTER JOIN dbo.TBL_PHONE TBL_PHONE1 ON (TBL_CONTACT.CONTACTID = TBL_PHONE1.CONTACTID AND TBL_PHONE1.TYPEID = 'C7953F28-8CD8-4184-A4AD-D2CCBCDB855B')
		LEFT OUTER JOIN dbo.TBL_EMAIL TBL_EMAIL2 ON (TBL_CONTACT.CONTACTID = TBL_EMAIL2.CONTACTID AND TBL_EMAIL2.TYPEID = '9CE4FF61-F0B5-439F-81CC-857138422EC7')
		LEFT OUTER JOIN dbo.TBL_PHONE TBL_PHONE3 ON (TBL_CONTACT.CONTACTID = TBL_PHONE3.CONTACTID AND TBL_PHONE3.TYPEID = 'C3AE9586-6158-4D0D-9FAF-253CB0152F18')
		LEFT OUTER JOIN dbo.TBL_PHONE TBL_PHONE4 ON (TBL_CONTACT.CONTACTID = TBL_PHONE4.CONTACTID AND TBL_PHONE4.TYPEID = '2870C5A5-7B3B-49DE-AD57-763EA3BF41D0')
		LEFT OUTER JOIN dbo.TBL_ADDRESS TBL_ADDRESS5 ON (TBL_CONTACT.CONTACTID = TBL_ADDRESS5.CONTACTID AND TBL_ADDRESS5.TYPEID = '47E09CBD-4218-411B-8B59-E838B13E2CCF')
		LEFT OUTER JOIN dbo.TBL_PHONE TBL_PHONE6 ON (TBL_CONTACT.CONTACTID = TBL_PHONE6.CONTACTID AND TBL_PHONE6.TYPEID = '2B7C5F46-A48A-4C6F-BB9D-C672DAB0DC4C')
		LEFT OUTER JOIN dbo.TBL_ACCESSOR TBL_ACCESSOR7 ON (TBL_CONTACT.EDITUSERID = TBL_ACCESSOR7.ACCESSORID)
		LEFT OUTER JOIN dbo.TBL_PHONE TBL_PHONE8 ON (TBL_CONTACT.CONTACTID = TBL_PHONE8.CONTACTID AND TBL_PHONE8.TYPEID = '511DF006-2CDB-40B5-8D1A-B313C873DD1C')
		LEFT OUTER JOIN dbo.TBL_PHONE TBL_PHONE9 ON (TBL_CONTACT.CONTACTID = TBL_PHONE9.CONTACTID AND TBL_PHONE9.TYPEID = '00320990-7438-4B5A-BA53-D4E5C6E2A135')
		LEFT OUTER JOIN dbo.TBL_EMAIL TBL_EMAIL10 ON (TBL_CONTACT.CONTACTID = TBL_EMAIL10.CONTACTID AND TBL_EMAIL10.TYPEID = '8809A43E-C9DA-4902-B8A6-10CD9D255D9C')
		INNER JOIN dbo.TBL_ACCESSOR TBL_ACCESSOR11 ON (TBL_CONTACT.CREATEUSERID = TBL_ACCESSOR11.ACCESSORID)
		INNER JOIN dbo.TBL_ACCESSOR TBL_ACCESSOR12 ON (TBL_CONTACT.MANAGEUSERID = TBL_ACCESSOR12.ACCESSORID)
		LEFT OUTER JOIN dbo.TBL_PHONE TBL_PHONE13 ON (TBL_CONTACT.CONTACTID = TBL_PHONE13.CONTACTID AND TBL_PHONE13.TYPEID = '55637A5D-5381-44D4-9664-E7D6AEBEA382')
		where COMPANYID is null or (COMPANYID is not null and CATEGORY!='Client') or (COMPANYID is not null and CATEGORY is null);
		order by TBL_CONTACT.CONTACTID
-- WHERE (	1 = 1
-- AND	EXISTS (SELECT 1 FROM dbo.VWX_CONTACT_USER_ENUM UAE WHERE UAE.USERID = (SELECT USERID FROM dbo.FNR_SECURED_MY_RECORD()) AND TBL_CONTACT.CONTACTID = UAE.CONTACTID)) OR (APP_NAME()='C80B8645-3232-4552-907E-960A9C528D04')) ;
