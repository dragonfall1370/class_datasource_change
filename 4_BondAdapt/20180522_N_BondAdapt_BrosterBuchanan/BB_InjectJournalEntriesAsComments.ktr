<?xml version="1.0" encoding="UTF-8"?>
<transformation>
  <info>
    <name>BB_InjectJournalEntriesAsComments</name>
    <description/>
    <extended_description/>
    <trans_version/>
    <trans_type>Normal</trans_type>
    <trans_status>0</trans_status>
    <directory>&#x2f;</directory>
    <parameters>
    </parameters>
    <log>
      <trans-log-table>
        <connection/>
        <schema/>
        <table/>
        <size_limit_lines/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
          <subject/>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
          <subject/>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
          <subject/>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
          <subject/>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </trans-log-table>
      <perf-log-table>
        <connection/>
        <schema/>
        <table/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>SEQ_NR</id>
          <enabled>Y</enabled>
          <name>SEQ_NR</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>INPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>INPUT_BUFFER_ROWS</name>
        </field>
        <field>
          <id>OUTPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>OUTPUT_BUFFER_ROWS</name>
        </field>
      </perf-log-table>
      <channel-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
      <step-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
      </step-log-table>
      <metrics-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>METRICS_DATE</id>
          <enabled>Y</enabled>
          <name>METRICS_DATE</name>
        </field>
        <field>
          <id>METRICS_CODE</id>
          <enabled>Y</enabled>
          <name>METRICS_CODE</name>
        </field>
        <field>
          <id>METRICS_DESCRIPTION</id>
          <enabled>Y</enabled>
          <name>METRICS_DESCRIPTION</name>
        </field>
        <field>
          <id>METRICS_SUBJECT</id>
          <enabled>Y</enabled>
          <name>METRICS_SUBJECT</name>
        </field>
        <field>
          <id>METRICS_TYPE</id>
          <enabled>Y</enabled>
          <name>METRICS_TYPE</name>
        </field>
        <field>
          <id>METRICS_VALUE</id>
          <enabled>Y</enabled>
          <name>METRICS_VALUE</name>
        </field>
      </metrics-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file/>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
    <created_user>-</created_user>
    <created_date>2017&#x2f;12&#x2f;27 10&#x3a;03&#x3a;14.499</created_date>
    <modified_user>-</modified_user>
    <modified_date>2017&#x2f;12&#x2f;27 10&#x3a;03&#x3a;14.499</modified_date>
    <key_for_session_key>H4sIAAAAAAAAAAMAAAAAAAAAAAA&#x3d;</key_for_session_key>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
  </notepads>
  <connection>
    <name>BB local</name>
    <server>localhost</server>
    <type>MSSQL</type>
    <access>Native</access>
    <database>BrosterBuchanan</database>
    <port>1433</port>
    <username>sa</username>
    <password>Encrypted 2be98afc86aa7f2d5f94aea35e083b8df</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1433</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>Y</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>BB review</name>
    <server>10.0.9.228</server>
    <type>POSTGRESQL</type>
    <access>Native</access>
    <database>brosterbuchanan-review.vincere.io</database>
    <port>5432</port>
    <username>dbapplication_user</username>
    <password>Encrypted 2be98afc819e8b9aebe11bd63cb8b9ae3</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>5432</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>Y</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <order>
    <hop>
      <from>company_input</from>
      <to>Table output_usethis</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Database lookup</from>
      <to>Insert &#x2f; Update</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Company_inputlocalComment</from>
      <to>Database lookup</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Contact_Event_As_Comment 2</from>
      <to>Database lookup 2 2 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Database lookup 2 2 2 2</from>
      <to>Table output 2 2 2 2 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Contact Comment 2 2 2 2</from>
      <to>Table output 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Contact_Event_As_Comment 2 2</from>
      <to>Database lookup 2 2 2 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Database lookup 2 2 2 2 2</from>
      <to>Insert &#x2f; Update 2_use this</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Input_Job_Event 2</from>
      <to>Database lookup 2 2 2 2 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>job comment</from>
      <to>Table output 3 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Database lookup 2 2 2 2 3</from>
      <to>Insert &#x2f; Update 2_use this 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Input_Candidate_Event 4</from>
      <to>Database lookup 2 2 2 4</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate Comment 2 2 2 2</from>
      <to>Table output 3 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Database lookup 2 2 2 4</from>
      <to>Insert &#x2f; Update 2_use this 2 2</to>
      <enabled>N</enabled>
    </hop>
  </order>
  <step>
    <name>company_input</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>BB review</connection>
    <sql>select &#x2a; from activity&#xa;where category &#x3d; &#x27;comment&#x27;  and type &#x3d; &#x27;company&#x27; --and id &#x3e; 42</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>96</xloc>
      <yloc>96</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Database lookup</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>BB review</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>company</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>CompanyExternalId</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>id</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>256</xloc>
      <yloc>16</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Company_inputlocalComment</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>BB local</connection>
    <sql>&#x2f;&#x2a;	SELECT OWNER_ID, STUFF&#x28;&#x28;SELECT DISTINCT &#x27;,&#x27; &#x2b; cast&#x28;DOC_ID as varchar&#x28;max&#x29;&#x29; &#x2b; &#x27;_&#x27; &#xd;&#xa;						&#x2b; replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;DOC_NAME,&#x27;&#x3f;&#x27;,&#x27;&#x27;&#x29;,&#x27; &#x27;,&#x27;_&#x27;&#x29;,&#x27;&#x2f;&#x27;,&#x27;.&#x27;&#x29;,&#x27;&#x27;&#x27;&#x27;,&#x27;&#x27;&#x29;,&#x27;,&#x27;,&#x27;_&#x27;&#x29;,&#x27;&#x2a;&#x27;,&#x27;&#x7e;&#x27;&#x29;,&#x27;&#x22;&#x27;,&#x27;&#x5e;&#x27;&#x29;,&#x27;&#x5c;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x7c;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3a;&#x27;,&#x27;&#x27;&#x29;,char&#x28;10&#x29;,&#x27;&#x27;&#x29;,char&#x28;13&#x29;,&#x27;&#x27;&#x29;&#xd;&#xa;						&#x2b; &#x27;.&#x27; &#x2b; replace&#x28;coalesce&#x28;nullif&#x28;FILE_EXTENSION,&#x27;&#x27;&#x29;,PREVIEW_TYPE&#x29;,&#x27;txt&#x27;,&#x27;rtf&#x27;&#x29;&#xd;&#xa;						from DOCUMENTS &#xd;&#xa;						WHERE OWNER_ID &#x3d; a.OWNER_ID FOR XML PATH &#x28;&#x27;&#x27;&#x29;, TYPE&#x29;.value&#x28;&#x27;.&#x27;, &#x27;nvarchar&#x28;MAX&#x29;&#x27;&#x29;, 1, 1, &#x27;&#x27;&#x29;  AS docs&#xd;&#xa;FROM DOCUMENTS as a&#xd;&#xa;WHERE a.OWNER_ID &#x3d; 116662820196 or a.OWNER_ID &#x3d; 116662888140 or a.OWNER_ID &#x3d; 116667442875 or a.OWNER_ID &#x3d; 116664504104                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          &#xd;&#xa;GROUP BY a.OWNER_ID&#xd;&#xa;&#xd;&#xa;select je.&#x2a;, r1.CONFIG_ROLE_NAME role1, r2.CONFIG_ROLE_NAME role2, r3.CONFIG_ROLE_NAME role3&#xd;&#xa;	, r4.CONFIG_ROLE_NAME role4,r5.CONFIG_ROLE_NAME role5, r6.CONFIG_ROLE_NAME role6, mn.DESCRIPTION&#xd;&#xa;from  JOURNAL_ENTRIES je left join MD_ROLES r1 on je.ROLE_ID_1 &#x3d; r1.ROLE_ID&#xd;&#xa;						 left join MD_ROLES r2 on je.ROLE_ID_2 &#x3d; r2.ROLE_ID&#xd;&#xa;						 left join MD_ROLES r3 on je.ROLE_ID_3 &#x3d; r3.ROLE_ID&#xd;&#xa;						 left join MD_ROLES r4 on je.ROLE_ID_4 &#x3d; r4.ROLE_ID&#xd;&#xa;						 left join MD_ROLES r5 on je.ROLE_ID_5 &#x3d; r5.ROLE_ID&#xd;&#xa;						 left join MD_ROLES r6 on je.ROLE_ID_6 &#x3d; r6.ROLE_ID&#xd;&#xa;						 left join MD_MULTI_NAMES mn on je.BO_ID &#x3d; mn.ID&#xd;&#xa;where je.ID &#x3d; 4310146276 and--je.ROLE_ID_4 is not null and je.ROLE_ID_4 &#x3c;&#x3e; 0 and &#xd;&#xa;mn.LANGUAGE&#x3d;1 and mn.type &#x3d; &#x27;BO&#x27;-- and ENTITY_ID_5 &#x3c;&#x3e; 0&#xd;&#xa;--mn.LANGUAGE&#x3d;1 and &#x28;ENTITY_ID_1 &#x3d; 116669809495 or ENTITY_ID_2 &#x3d; 116669809495 or ENTITY_ID_3 &#x3d; 116669809495 or ENTITY_ID_4 &#x3d; 116669809495&#x29;&#xd;&#xa;&#xd;&#xa;select &#x2a; from LK_ENTITIES_JOURNAL where JOURNAL_ID &#x3d; 4316494027&#xd;&#xa;select &#x2a; from ENTITY_TABLE&#xd;&#xa;select &#x2a; from LK_ENTITY_ROLE&#xd;&#xa;select &#x2a; from JOURNAL_ENTRIES where id &#x3d; 4310146276--bo_id is null&#xd;&#xa;select distinct JOURNAL_ID from LK_ENTITIES_JOURNAL&#xd;&#xa;&#xd;&#xa;select &#x2a; from MD_ROLES where role_id &#x3d; 6990593&#xd;&#xa;&#xd;&#xa;select &#x2a; from PROP_EMPLOYEE_GEN where user_ref &#x3d; 600083253&#xd;&#xa;&#xd;&#xa;select &#x2a; from PROP_EMPLOYEE_GEN where USER_REF &#x3d; 600032024&#xd;&#xa;select &#x2a; from PROP_X_CLIENT_JOB&#x2a;&#x2f;&#xd;&#xa;&#xd;&#xa;with&#xd;&#xa;  contact0 &#x28;CLIENT,CONTACT,rn&#x29; as &#x28;SELECT CLIENT,CONTACT,ROW_NUMBER&#x28;&#x29; OVER&#x28;PARTITION BY cg.CONTACT ORDER BY cg.BISUNIQUEID DESC&#x29; AS rn FROM PROP_X_CLIENT_CON cg&#x29;&#xd;&#xa;&#xd;&#xa;, contact1 as &#x28;select CLIENT,CONTACT from contact0 where rn &#x3d; 1&#x29;&#xd;&#xa;&#xd;&#xa;, contact as&#x28;&#xd;&#xa;select&#xd;&#xa;	ccc.CONTACT,ccc.CLIENT, pg.FIRST_NAME, pg.LAST_NAME, pg.MIDDLE_NAME&#xd;&#xa;	, Stuff&#x28;&#xd;&#xa;			  Coalesce&#x28;&#x27; &#x27; &#x2b; NULLIF&#x28;pg.FIRST_NAME, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;			&#x2b; Coalesce&#x28;&#x27; &#x27; &#x2b; NULLIF&#x28;pg.MIDDLE_NAME, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;			&#x2b; Coalesce&#x28;&#x27; &#x27; &#x2b; NULLIF&#x28;pg.LAST_NAME, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;			, 1, 1, &#x27;&#x27;&#x29; as contactFullName&#xd;&#xa;from PROP_X_CLIENT_CON cc&#xd;&#xa;left join contact1 ccc on cc.CONTACT &#x3d; ccc.CONTACT&#xd;&#xa;left join &#x28;select REFERENCE,FIRST_NAME,LAST_NAME, MIDDLE_NAME, JOB_TITLE, LINKEDIN, SALUTATION from PROP_PERSON_GEN&#x29; pg on ccc.CONTACT &#x3d; pg.REFERENCE&#xd;&#xa;&#x29;&#xd;&#xa;--select &#x2a; from contact&#xd;&#xa;&#xd;&#xa;, tempJournal as &#x28;&#xd;&#xa; select ej.JOURNAL_ID,ej.ENTITY_ID,ej.ENTITY_TYPE&#xd;&#xa;		,je.CREATION_DATE,je.CREATOR_ID,je.J_NOTES,je.J_DOCUMENT&#xd;&#xa;		,mn.DESCRIPTION workflow&#xd;&#xa;		,r.CONFIG_ROLE_NAME as role&#xd;&#xa;		,comp.REFERENCE companyID&#xd;&#xa;		,comp.name companyName&#xd;&#xa;		,con.contact contactID&#xd;&#xa;		,con.contactFullName&#xd;&#xa;		, cj.JOB jobID&#xd;&#xa;		, jg.JOB_TITLE&#xd;&#xa;		, cp.REFERENCE candID&#xd;&#xa;		, Stuff&#x28;&#xd;&#xa;			  Coalesce&#x28;&#x27; &#x27; &#x2b; NULLIF&#x28;pg.FIRST_NAME, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;			&#x2b; Coalesce&#x28;&#x27; &#x27; &#x2b; NULLIF&#x28;pg.MIDDLE_NAME, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;			&#x2b; Coalesce&#x28;&#x27; &#x27; &#x2b; NULLIF&#x28;pg.LAST_NAME, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;			, 1, 1, &#x27;&#x27;&#x29; as candFullName&#xd;&#xa;from LK_ENTITIES_JOURNAL ej left join JOURNAL_ENTRIES je on ej.JOURNAL_ID &#x3d; je.ID&#xd;&#xa;							left join MD_MULTI_NAMES mn on je.BO_ID &#x3d; mn.ID&#xd;&#xa;							left join LK_ENTITY_ROLE AS er ON ej.ENTITY_ID &#x3d; er.ENTITY_ID&#xd;&#xa;							left join MD_ROLES AS r ON er.ROLE_ID &#x3d; r.ROLE_ID&#xd;&#xa;							left join PROP_CLIENT_GEN comp on ej.ENTITY_ID &#x3d; comp.REFERENCE&#xd;&#xa;							left join contact con on ej.ENTITY_ID &#x3d; con.CONTACT&#xd;&#xa;							left join PROP_X_CLIENT_JOB cj on ej.ENTITY_ID &#x3d; cj.JOB--3095 rows&#xd;&#xa;							left join PROP_JOB_GEN jg on cj.JOB &#x3d; jg.REFERENCE&#xd;&#xa;							left join PROP_CAND_PREF cp on ej.ENTITY_ID &#x3d; cp.REFERENCE&#xd;&#xa;							left join PROP_PERSON_GEN pg on cp.REFERENCE &#x3d; pg.REFERENCE&#xd;&#xa;where mn.LANGUAGE&#x3d;1 and mn.type &#x3d; &#x27;BO&#x27; and r.CONFIG_ROLE_NAME is not null&#xd;&#xa;--order by JOURNAL_ID&#xd;&#xa;&#x29;--trong bang LK_ENTITIES_JOURNAL, journal cung link vs user, nhung lai link vs user_ref, trong khi trong bang JOURNAL_ENTRIES, joural do&#x27; link vs reference cua user&#xd;&#xa;--select &#x2a; from tempJournal where JOURNAL_ID &#x3d; 4325187318--4323922531&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;, tempJournal1 as &#x28;select t.&#x2a;, t1.companyID,t1.companyName,t2.contactID,t2.contactFullName,t3.jobID,t3.JOB_TITLE,t4.candID,t4.candFullName&#xd;&#xa;from &#x28;select distinct journal_id, workflow,ENTITY_TYPE from tempJournal&#x29; t&#xd;&#xa;							 left join &#x28;select &#x2a; from tempJournal where companyId is not null&#x29; t1 on t1.JOURNAL_ID &#x3d; t.JOURNAL_ID&#xd;&#xa;							 left join &#x28;select &#x2a; from tempJournal where contactID is not null&#x29; t2 on t2.JOURNAL_ID &#x3d; t.JOURNAL_ID&#xd;&#xa;							 left join &#x28;select &#x2a; from tempJournal where jobID is not null&#x29; t3 on t3.JOURNAL_ID &#x3d; t.JOURNAL_ID&#xd;&#xa;							 left join &#x28;select &#x2a; from tempJournal where candID is not null&#x29; t4 on t4.JOURNAL_ID &#x3d; t.JOURNAL_ID&#xd;&#xa; where t.entity_type &#x3c;&#x3e; &#x27;U&#x27;&#x29;&#xd;&#xa;&#xd;&#xa; , tempJournal2 as &#x28;select j1.&#x2a;, je.CREATION_DATE,eg.NAME createdUser, je.J_NOTES,je.J_DOCUMENT, jn.J_DOCUMENT as document2&#xd;&#xa; from tempJournal1 j1 left join JOURNAL_ENTRIES je on j1.JOURNAL_ID &#x3d; je.ID&#xd;&#xa;						left join JOURNAL_NOTES jn on j1.JOURNAL_ID &#x3d; jn.JOURNAL_ID&#xd;&#xa;						left join PROP_EMPLOYEE_GEN eg on je.CREATOR_ID &#x3d; eg.USER_REF&#x29;&#xd;&#xa;--where jn.J_DOCUMENT is not null&#xd;&#xa;&#xd;&#xa;select concat&#x28;&#x27;BB&#x27;,companyID&#x29; as CompanyExternalId, -10 as userId&#xd;&#xa;		, CREATION_DATE as InsertTimeStamp, -10 as AssignedUserId, &#x27;comment&#x27; as category, &#x27;company&#x27; as type&#xd;&#xa;		, J_DOCUMENT&#xd;&#xa;		, concat&#x28;&#xd;&#xa;				&#x27;-----MIGRATED FROM JOURNAL ENTRIES-----&#x27;,&#xd;&#xa;				iif&#x28;workflow &#x3d; &#x27;&#x27; or workflow is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Work Flow&#x3a; &#x27;,workflow&#x29;&#x29;,&#xd;&#xa;				iif&#x28;companyName &#x3d; &#x27;&#x27; or companyName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Company&#x3a; &#x27;,companyName&#x29;&#x29;,&#xd;&#xa;				iif&#x28;contactFullName &#x3d; &#x27;&#x27; or contactFullName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Contact&#x3a; &#x27;,contactFullName&#x29;&#x29;,&#xd;&#xa;				iif&#x28;JOB_TITLE &#x3d; &#x27;&#x27; or JOB_TITLE is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Job&#x3a; &#x27;,JOB_TITLE&#x29;&#x29;,&#xd;&#xa;				iif&#x28;candFullName &#x3d; &#x27;&#x27; or candFullName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Candidate&#x3a; &#x27;,candFullName&#x29;&#x29;,&#xd;&#xa;				iif&#x28;J_NOTES like &#x27;&#x27; or candFullName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Notes&#x3a; &#x27;,replace&#x28;replace&#x28;J_NOTES,&#x27;&#x3c;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3c;&#x2f;p&#x3e;&#x27;,&#x27;&#x27;&#x29;&#x29;&#x29;,&#xd;&#xa;				iif&#x28;J_DOCUMENT like &#x27;&#x27; or J_DOCUMENT is null,iif&#x28;document2 like &#x27;&#x27; or document2 is null,&#x27;&#x27;,concat&#x28;char&#x28;10&#x29;,&#x27;Documents&#x3a; &#x27;,replace&#x28;replace&#x28;document2,&#x27;&#x3c;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3c;&#x2f;p&#x3e;&#x27;,&#x27;&#x27;&#x29;&#x29;&#x29;,concat&#x28;char&#x28;10&#x29;,&#x27;Documents&#x3a; &#x27;,replace&#x28;replace&#x28;replace&#x28;replace&#x28;convert&#x28;nvarchar&#x28;max&#x29;,j_DOCUMENT&#x29;,&#x27;&#x3c;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3c;&#x2f;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x26;nbsp&#x3b;&#x27;,&#x27; &#x27;&#x29;,&#x27;  &#x27;,&#x27; &#x27;&#x29;&#x29;&#x29;,&#xd;&#xa;				iif&#x28;CREATION_DATE is null, &#x27;&#x27;, concat&#x28;CHAR&#x28;10&#x29;,&#x27;Created Date&#x3a; &#x27;,convert&#x28;varchar&#x28;20&#x29;,CREATION_DATE,120&#x29;&#x29;&#x29;,&#xd;&#xa;				iif&#x28;createdUser &#x3d; &#x27;&#x27; or createdUser is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Created By&#x3a; &#x27;,createdUser&#x29;&#x29;,&#xd;&#xa;				concat&#x28;char&#x28;10&#x29;,&#x27;JE ID&#x3a; &#x27;, JOURNAL_ID&#x29;&#xd;&#xa;				&#x29; as commentContent&#xd;&#xa;from tempJournal2&#xd;&#xa;where companyID is not null --and j_DOCUMENT is not null and j_DOCUMENT not like &#x27;&#x27;&#xd;&#xa;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>96</xloc>
      <yloc>16</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Insert &#x2f; Update</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>BB review</connection>
    <commit>100</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>activity</table>
      <key>
        <name>id</name>
        <field>company_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>commentContent</name>
        <field>content</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>InsertTimeStamp</name>
        <field>insert_timestamp</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>company_id</name>
        <rename>id</rename>
        <update>Y</update>
      </value>
      <value>
        <name>user_account_id</name>
        <rename>userId</rename>
        <update>Y</update>
      </value>
      <value>
        <name>insert_timestamp</name>
        <rename>InsertTimeStamp</rename>
        <update>Y</update>
      </value>
      <value>
        <name>content</name>
        <rename>commentContent</rename>
        <update>Y</update>
      </value>
      <value>
        <name>type</name>
        <rename>type</rename>
        <update>Y</update>
      </value>
      <value>
        <name>category</name>
        <rename>category</rename>
        <update>Y</update>
      </value>
      <value>
        <name>assigned_user_id</name>
        <rename>AssignedUserId</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>416</xloc>
      <yloc>16</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Table output_usethis</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>BB review</connection>
    <schema>public</schema>
    <table>activity_company</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>activity_id</column_name>
          <stream_name>id</stream_name>
        </field>
        <field>
          <column_name>company_id</column_name>
          <stream_name>company_id</stream_name>
        </field>
        <field>
          <column_name>insert_timestamp</column_name>
          <stream_name>insert_timestamp</stream_name>
        </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>256</xloc>
      <yloc>96</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Contact_Event_As_Comment 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>BB local</connection>
    <sql>&#x2f;&#x2a;	SELECT OWNER_ID, STUFF&#x28;&#x28;SELECT DISTINCT &#x27;,&#x27; &#x2b; cast&#x28;DOC_ID as varchar&#x28;max&#x29;&#x29; &#x2b; &#x27;_&#x27; &#xd;&#xa;						&#x2b; replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;DOC_NAME,&#x27;&#x3f;&#x27;,&#x27;&#x27;&#x29;,&#x27; &#x27;,&#x27;_&#x27;&#x29;,&#x27;&#x2f;&#x27;,&#x27;.&#x27;&#x29;,&#x27;&#x27;&#x27;&#x27;,&#x27;&#x27;&#x29;,&#x27;,&#x27;,&#x27;_&#x27;&#x29;,&#x27;&#x2a;&#x27;,&#x27;&#x7e;&#x27;&#x29;,&#x27;&#x22;&#x27;,&#x27;&#x5e;&#x27;&#x29;,&#x27;&#x5c;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x7c;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3a;&#x27;,&#x27;&#x27;&#x29;,char&#x28;10&#x29;,&#x27;&#x27;&#x29;,char&#x28;13&#x29;,&#x27;&#x27;&#x29;&#xd;&#xa;						&#x2b; &#x27;.&#x27; &#x2b; replace&#x28;coalesce&#x28;nullif&#x28;FILE_EXTENSION,&#x27;&#x27;&#x29;,PREVIEW_TYPE&#x29;,&#x27;txt&#x27;,&#x27;rtf&#x27;&#x29;&#xd;&#xa;						from DOCUMENTS &#xd;&#xa;						WHERE OWNER_ID &#x3d; a.OWNER_ID FOR XML PATH &#x28;&#x27;&#x27;&#x29;, TYPE&#x29;.value&#x28;&#x27;.&#x27;, &#x27;nvarchar&#x28;MAX&#x29;&#x27;&#x29;, 1, 1, &#x27;&#x27;&#x29;  AS docs&#xd;&#xa;FROM DOCUMENTS as a&#xd;&#xa;WHERE a.OWNER_ID &#x3d; 116662820196 or a.OWNER_ID &#x3d; 116662888140 or a.OWNER_ID &#x3d; 116667442875 or a.OWNER_ID &#x3d; 116664504104                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          &#xd;&#xa;GROUP BY a.OWNER_ID&#xd;&#xa;&#xd;&#xa;select je.&#x2a;, r1.CONFIG_ROLE_NAME role1, r2.CONFIG_ROLE_NAME role2, r3.CONFIG_ROLE_NAME role3&#xd;&#xa;	, r4.CONFIG_ROLE_NAME role4,r5.CONFIG_ROLE_NAME role5, r6.CONFIG_ROLE_NAME role6, mn.DESCRIPTION&#xd;&#xa;from  JOURNAL_ENTRIES je left join MD_ROLES r1 on je.ROLE_ID_1 &#x3d; r1.ROLE_ID&#xd;&#xa;						 left join MD_ROLES r2 on je.ROLE_ID_2 &#x3d; r2.ROLE_ID&#xd;&#xa;						 left join MD_ROLES r3 on je.ROLE_ID_3 &#x3d; r3.ROLE_ID&#xd;&#xa;						 left join MD_ROLES r4 on je.ROLE_ID_4 &#x3d; r4.ROLE_ID&#xd;&#xa;						 left join MD_ROLES r5 on je.ROLE_ID_5 &#x3d; r5.ROLE_ID&#xd;&#xa;						 left join MD_ROLES r6 on je.ROLE_ID_6 &#x3d; r6.ROLE_ID&#xd;&#xa;						 left join MD_MULTI_NAMES mn on je.BO_ID &#x3d; mn.ID&#xd;&#xa;where je.ID &#x3d; 4310146276 and--je.ROLE_ID_4 is not null and je.ROLE_ID_4 &#x3c;&#x3e; 0 and &#xd;&#xa;mn.LANGUAGE&#x3d;1 and mn.type &#x3d; &#x27;BO&#x27;-- and ENTITY_ID_5 &#x3c;&#x3e; 0&#xd;&#xa;--mn.LANGUAGE&#x3d;1 and &#x28;ENTITY_ID_1 &#x3d; 116669809495 or ENTITY_ID_2 &#x3d; 116669809495 or ENTITY_ID_3 &#x3d; 116669809495 or ENTITY_ID_4 &#x3d; 116669809495&#x29;&#xd;&#xa;&#xd;&#xa;select &#x2a; from LK_ENTITIES_JOURNAL where JOURNAL_ID &#x3d; 4316494027&#xd;&#xa;select &#x2a; from ENTITY_TABLE&#xd;&#xa;select &#x2a; from LK_ENTITY_ROLE&#xd;&#xa;select &#x2a; from JOURNAL_ENTRIES where id &#x3d; 4310146276--bo_id is null&#xd;&#xa;select distinct JOURNAL_ID from LK_ENTITIES_JOURNAL&#xd;&#xa;&#xd;&#xa;select &#x2a; from MD_ROLES where role_id &#x3d; 6990593&#xd;&#xa;&#xd;&#xa;select &#x2a; from PROP_EMPLOYEE_GEN where user_ref &#x3d; 600083253&#xd;&#xa;&#xd;&#xa;select &#x2a; from PROP_EMPLOYEE_GEN where USER_REF &#x3d; 600032024&#xd;&#xa;select &#x2a; from PROP_X_CLIENT_JOB&#x2a;&#x2f;&#xd;&#xa;&#xd;&#xa;with&#xd;&#xa;  contact0 &#x28;CLIENT,CONTACT,rn&#x29; as &#x28;SELECT CLIENT,CONTACT,ROW_NUMBER&#x28;&#x29; OVER&#x28;PARTITION BY cg.CONTACT ORDER BY cg.BISUNIQUEID DESC&#x29; AS rn FROM PROP_X_CLIENT_CON cg&#x29;&#xd;&#xa;&#xd;&#xa;, contact1 as &#x28;select CLIENT,CONTACT from contact0 where rn &#x3d; 1&#x29;&#xd;&#xa;&#xd;&#xa;, contact as&#x28;&#xd;&#xa;select&#xd;&#xa;	ccc.CONTACT,ccc.CLIENT, pg.FIRST_NAME, pg.LAST_NAME, pg.MIDDLE_NAME&#xd;&#xa;	, Stuff&#x28;&#xd;&#xa;			  Coalesce&#x28;&#x27; &#x27; &#x2b; NULLIF&#x28;pg.FIRST_NAME, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;			&#x2b; Coalesce&#x28;&#x27; &#x27; &#x2b; NULLIF&#x28;pg.MIDDLE_NAME, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;			&#x2b; Coalesce&#x28;&#x27; &#x27; &#x2b; NULLIF&#x28;pg.LAST_NAME, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;			, 1, 1, &#x27;&#x27;&#x29; as contactFullName&#xd;&#xa;from PROP_X_CLIENT_CON cc&#xd;&#xa;left join contact1 ccc on cc.CONTACT &#x3d; ccc.CONTACT&#xd;&#xa;left join &#x28;select REFERENCE,FIRST_NAME,LAST_NAME, MIDDLE_NAME, JOB_TITLE, LINKEDIN, SALUTATION from PROP_PERSON_GEN&#x29; pg on ccc.CONTACT &#x3d; pg.REFERENCE&#xd;&#xa;&#x29;&#xd;&#xa;--select &#x2a; from contact&#xd;&#xa;&#xd;&#xa;, tempJournal as &#x28;&#xd;&#xa; select ej.JOURNAL_ID,ej.ENTITY_ID,ej.ENTITY_TYPE&#xd;&#xa;		,je.CREATION_DATE,je.CREATOR_ID,je.J_NOTES,je.J_DOCUMENT&#xd;&#xa;		,mn.DESCRIPTION workflow&#xd;&#xa;		,r.CONFIG_ROLE_NAME as role&#xd;&#xa;		,comp.REFERENCE companyID&#xd;&#xa;		,comp.name companyName&#xd;&#xa;		,con.contact contactID&#xd;&#xa;		,con.contactFullName&#xd;&#xa;		, cj.JOB jobID&#xd;&#xa;		, jg.JOB_TITLE&#xd;&#xa;		, cp.REFERENCE candID&#xd;&#xa;		, Stuff&#x28;&#xd;&#xa;			  Coalesce&#x28;&#x27; &#x27; &#x2b; NULLIF&#x28;pg.FIRST_NAME, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;			&#x2b; Coalesce&#x28;&#x27; &#x27; &#x2b; NULLIF&#x28;pg.MIDDLE_NAME, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;			&#x2b; Coalesce&#x28;&#x27; &#x27; &#x2b; NULLIF&#x28;pg.LAST_NAME, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;			, 1, 1, &#x27;&#x27;&#x29; as candFullName&#xd;&#xa;from LK_ENTITIES_JOURNAL ej left join JOURNAL_ENTRIES je on ej.JOURNAL_ID &#x3d; je.ID&#xd;&#xa;							left join MD_MULTI_NAMES mn on je.BO_ID &#x3d; mn.ID&#xd;&#xa;							left join LK_ENTITY_ROLE AS er ON ej.ENTITY_ID &#x3d; er.ENTITY_ID&#xd;&#xa;							left join MD_ROLES AS r ON er.ROLE_ID &#x3d; r.ROLE_ID&#xd;&#xa;							left join PROP_CLIENT_GEN comp on ej.ENTITY_ID &#x3d; comp.REFERENCE&#xd;&#xa;							left join contact con on ej.ENTITY_ID &#x3d; con.CONTACT&#xd;&#xa;							left join PROP_X_CLIENT_JOB cj on ej.ENTITY_ID &#x3d; cj.JOB--3095 rows&#xd;&#xa;							left join PROP_JOB_GEN jg on cj.JOB &#x3d; jg.REFERENCE&#xd;&#xa;							left join PROP_CAND_PREF cp on ej.ENTITY_ID &#x3d; cp.REFERENCE&#xd;&#xa;							left join PROP_PERSON_GEN pg on cp.REFERENCE &#x3d; pg.REFERENCE&#xd;&#xa;where mn.LANGUAGE&#x3d;1 and mn.type &#x3d; &#x27;BO&#x27; and r.CONFIG_ROLE_NAME is not null&#xd;&#xa;--order by JOURNAL_ID&#xd;&#xa;&#x29;--trong bang LK_ENTITIES_JOURNAL, journal cung link vs user, nhung lai link vs user_ref, trong khi trong bang JOURNAL_ENTRIES, joural do&#x27; link vs reference cua user&#xd;&#xa;--select &#x2a; from tempJournal where JOURNAL_ID &#x3d; 4325187318--4323922531&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;, tempJournal1 as &#x28;select t.&#x2a;, t1.companyID,t1.companyName,t2.contactID,t2.contactFullName,t3.jobID,t3.JOB_TITLE,t4.candID,t4.candFullName&#xd;&#xa;from &#x28;select distinct journal_id, workflow,ENTITY_TYPE from tempJournal&#x29; t&#xd;&#xa;							 left join &#x28;select &#x2a; from tempJournal where companyId is not null&#x29; t1 on t1.JOURNAL_ID &#x3d; t.JOURNAL_ID&#xd;&#xa;							 left join &#x28;select &#x2a; from tempJournal where contactID is not null&#x29; t2 on t2.JOURNAL_ID &#x3d; t.JOURNAL_ID&#xd;&#xa;							 left join &#x28;select &#x2a; from tempJournal where jobID is not null&#x29; t3 on t3.JOURNAL_ID &#x3d; t.JOURNAL_ID&#xd;&#xa;							 left join &#x28;select &#x2a; from tempJournal where candID is not null&#x29; t4 on t4.JOURNAL_ID &#x3d; t.JOURNAL_ID&#xd;&#xa; where t.entity_type &#x3c;&#x3e; &#x27;U&#x27;&#x29;&#xd;&#xa;&#xd;&#xa; , tempJournal2 as &#x28;select j1.&#x2a;, je.CREATION_DATE,eg.NAME createdUser, je.J_NOTES,je.J_DOCUMENT, jn.J_DOCUMENT as document2&#xd;&#xa; from tempJournal1 j1 left join JOURNAL_ENTRIES je on j1.JOURNAL_ID &#x3d; je.ID&#xd;&#xa;						left join JOURNAL_NOTES jn on j1.JOURNAL_ID &#x3d; jn.JOURNAL_ID&#xd;&#xa;						left join PROP_EMPLOYEE_GEN eg on je.CREATOR_ID &#x3d; eg.USER_REF&#x29;&#xd;&#xa;--where jn.J_DOCUMENT is not null&#xd;&#xa;&#xd;&#xa;, companyComments as &#x28;select concat&#x28;&#x27;BB&#x27;,companyID&#x29; as CompanyExternalId, -10 as userId&#xd;&#xa;		, CREATION_DATE as InsertTimeStamp, -10 as AssignedUserId, &#x27;comment&#x27; as category, &#x27;company&#x27; as type&#xd;&#xa;		, J_DOCUMENT&#xd;&#xa;		, concat&#x28;&#xd;&#xa;				&#x27;-----MIGRATED FROM JOURNAL ENTRIES-----&#x27;,&#xd;&#xa;				iif&#x28;workflow &#x3d; &#x27;&#x27; or workflow is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Work Flow&#x3a; &#x27;,workflow&#x29;&#x29;,&#xd;&#xa;				iif&#x28;companyName &#x3d; &#x27;&#x27; or companyName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Company&#x3a; &#x27;,companyName&#x29;&#x29;,&#xd;&#xa;				iif&#x28;contactFullName &#x3d; &#x27;&#x27; or contactFullName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Contact&#x3a; &#x27;,contactFullName&#x29;&#x29;,&#xd;&#xa;				iif&#x28;JOB_TITLE &#x3d; &#x27;&#x27; or JOB_TITLE is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Job&#x3a; &#x27;,JOB_TITLE&#x29;&#x29;,&#xd;&#xa;				iif&#x28;candFullName &#x3d; &#x27;&#x27; or candFullName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Candidate&#x3a; &#x27;,candFullName&#x29;&#x29;,&#xd;&#xa;				iif&#x28;J_NOTES like &#x27;&#x27; or candFullName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Notes&#x3a; &#x27;,replace&#x28;replace&#x28;J_NOTES,&#x27;&#x3c;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3c;&#x2f;p&#x3e;&#x27;,&#x27;&#x27;&#x29;&#x29;&#x29;,&#xd;&#xa;				iif&#x28;J_DOCUMENT like &#x27;&#x27; or J_DOCUMENT is null,iif&#x28;document2 like &#x27;&#x27; or document2 is null,&#x27;&#x27;,concat&#x28;char&#x28;10&#x29;,&#x27;Documents&#x3a; &#x27;,replace&#x28;replace&#x28;document2,&#x27;&#x3c;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3c;&#x2f;p&#x3e;&#x27;,&#x27;&#x27;&#x29;&#x29;&#x29;,concat&#x28;char&#x28;10&#x29;,&#x27;Documents&#x3a; &#x27;,replace&#x28;replace&#x28;replace&#x28;replace&#x28;convert&#x28;nvarchar&#x28;max&#x29;,j_DOCUMENT&#x29;,&#x27;&#x3c;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3c;&#x2f;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x26;nbsp&#x3b;&#x27;,&#x27; &#x27;&#x29;,&#x27;  &#x27;,&#x27; &#x27;&#x29;&#x29;&#x29;,&#xd;&#xa;				iif&#x28;CREATION_DATE is null, &#x27;&#x27;, concat&#x28;CHAR&#x28;10&#x29;,&#x27;Created Date&#x3a; &#x27;,convert&#x28;varchar&#x28;20&#x29;,CREATION_DATE,120&#x29;&#x29;&#x29;,&#xd;&#xa;				iif&#x28;createdUser &#x3d; &#x27;&#x27; or createdUser is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Created By&#x3a; &#x27;,createdUser&#x29;&#x29;,&#xd;&#xa;				concat&#x28;char&#x28;10&#x29;,&#x27;JE ID&#x3a; &#x27;, JOURNAL_ID&#x29;&#xd;&#xa;				&#x29; as commentContent&#xd;&#xa;from tempJournal2&#xd;&#xa;where companyID is not null&#x29; --and j_DOCUMENT is not null and j_DOCUMENT not like &#x27;&#x27;&#x29;&#xd;&#xa;&#xd;&#xa;select concat&#x28;&#x27;BB&#x27;,contactID&#x29; as ContactExternalId, -10 as userId&#xd;&#xa;		, CREATION_DATE as InsertTimeStamp, -10 as AssignedUserId, &#x27;comment&#x27; as category, &#x27;contact&#x27; as type&#xd;&#xa;		, J_DOCUMENT&#xd;&#xa;		, concat&#x28;&#xd;&#xa;				&#x27;-----MIGRATED FROM JOURNAL ENTRIES-----&#x27;,&#xd;&#xa;				iif&#x28;workflow &#x3d; &#x27;&#x27; or workflow is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Work Flow&#x3a; &#x27;,workflow&#x29;&#x29;,&#xd;&#xa;				iif&#x28;companyName &#x3d; &#x27;&#x27; or companyName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Company&#x3a; &#x27;,companyName&#x29;&#x29;,&#xd;&#xa;				iif&#x28;contactFullName &#x3d; &#x27;&#x27; or contactFullName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Contact&#x3a; &#x27;,contactFullName&#x29;&#x29;,&#xd;&#xa;				iif&#x28;JOB_TITLE &#x3d; &#x27;&#x27; or JOB_TITLE is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Job&#x3a; &#x27;,JOB_TITLE&#x29;&#x29;,&#xd;&#xa;				iif&#x28;candFullName &#x3d; &#x27;&#x27; or candFullName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Candidate&#x3a; &#x27;,candFullName&#x29;&#x29;,&#xd;&#xa;				iif&#x28;J_NOTES like &#x27;&#x27; or candFullName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Notes&#x3a; &#x27;,replace&#x28;replace&#x28;J_NOTES,&#x27;&#x3c;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3c;&#x2f;p&#x3e;&#x27;,&#x27;&#x27;&#x29;&#x29;&#x29;,&#xd;&#xa;				iif&#x28;J_DOCUMENT like &#x27;&#x27; or J_DOCUMENT is null,iif&#x28;document2 like &#x27;&#x27; or document2 is null,&#x27;&#x27;,concat&#x28;char&#x28;10&#x29;,&#x27;Documents&#x3a; &#x27;,replace&#x28;replace&#x28;document2,&#x27;&#x3c;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3c;&#x2f;p&#x3e;&#x27;,&#x27;&#x27;&#x29;&#x29;&#x29;,concat&#x28;char&#x28;10&#x29;,&#x27;Documents&#x3a; &#x27;,replace&#x28;replace&#x28;replace&#x28;replace&#x28;convert&#x28;nvarchar&#x28;max&#x29;,j_DOCUMENT&#x29;,&#x27;&#x3c;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3c;&#x2f;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x26;nbsp&#x3b;&#x27;,&#x27; &#x27;&#x29;,&#x27;  &#x27;,&#x27; &#x27;&#x29;&#x29;&#x29;,&#xd;&#xa;				iif&#x28;CREATION_DATE is null, &#x27;&#x27;, concat&#x28;CHAR&#x28;10&#x29;,&#x27;Created Date&#x3a; &#x27;,convert&#x28;varchar&#x28;20&#x29;,CREATION_DATE,120&#x29;&#x29;&#x29;,&#xd;&#xa;				iif&#x28;createdUser &#x3d; &#x27;&#x27; or createdUser is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Created By&#x3a; &#x27;,createdUser&#x29;&#x29;,&#xd;&#xa;				concat&#x28;char&#x28;10&#x29;,&#x27;JE ID&#x3a; &#x27;, JOURNAL_ID&#x29;&#xd;&#xa;				&#x29; as commentContent&#xd;&#xa;from tempJournal2&#xd;&#xa;where contactID is not null&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>96</xloc>
      <yloc>176</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Database lookup 2 2 2 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>BB review</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>contact</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>ContactExternalId</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>id</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>256</xloc>
      <yloc>176</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Table output 2 2 2 2 2 2</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>BB review</connection>
    <schema>public</schema>
    <table>activity</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>assigned_user_id</column_name>
          <stream_name>AssignedUserId</stream_name>
        </field>
        <field>
          <column_name>insert_timestamp</column_name>
          <stream_name>InsertTimeStamp</stream_name>
        </field>
        <field>
          <column_name>category</column_name>
          <stream_name>category</stream_name>
        </field>
        <field>
          <column_name>content</column_name>
          <stream_name>commentContent</stream_name>
        </field>
        <field>
          <column_name>contact_id</column_name>
          <stream_name>id</stream_name>
        </field>
        <field>
          <column_name>type</column_name>
          <stream_name>type</stream_name>
        </field>
        <field>
          <column_name>user_account_id</column_name>
          <stream_name>userId</stream_name>
        </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>416</xloc>
      <yloc>176</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Contact Comment 2 2 2 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>BB review</connection>
    <sql>select &#x2a; from activity&#xa;where category &#x3d; &#x27;comment&#x27;  and type &#x3d; &#x27;contact&#x27; and id not in &#x28;23,24,25,1141316&#x29;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>96</xloc>
      <yloc>336</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Table output 3</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>BB review</connection>
    <schema>public</schema>
    <table>activity_contact</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>activity_id</column_name>
          <stream_name>id</stream_name>
        </field>
        <field>
          <column_name>contact_id</column_name>
          <stream_name>contact_id</stream_name>
        </field>
        <field>
          <column_name>insert_timestamp</column_name>
          <stream_name>insert_timestamp</stream_name>
        </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>256</xloc>
      <yloc>336</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Contact_Event_As_Comment 2 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>BB local</connection>
    <sql>&#x2f;&#x2a;	SELECT OWNER_ID, STUFF&#x28;&#x28;SELECT DISTINCT &#x27;,&#x27; &#x2b; cast&#x28;DOC_ID as varchar&#x28;max&#x29;&#x29; &#x2b; &#x27;_&#x27; &#xd;&#xa;						&#x2b; replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;DOC_NAME,&#x27;&#x3f;&#x27;,&#x27;&#x27;&#x29;,&#x27; &#x27;,&#x27;_&#x27;&#x29;,&#x27;&#x2f;&#x27;,&#x27;.&#x27;&#x29;,&#x27;&#x27;&#x27;&#x27;,&#x27;&#x27;&#x29;,&#x27;,&#x27;,&#x27;_&#x27;&#x29;,&#x27;&#x2a;&#x27;,&#x27;&#x7e;&#x27;&#x29;,&#x27;&#x22;&#x27;,&#x27;&#x5e;&#x27;&#x29;,&#x27;&#x5c;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x7c;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3a;&#x27;,&#x27;&#x27;&#x29;,char&#x28;10&#x29;,&#x27;&#x27;&#x29;,char&#x28;13&#x29;,&#x27;&#x27;&#x29;&#xd;&#xa;						&#x2b; &#x27;.&#x27; &#x2b; replace&#x28;coalesce&#x28;nullif&#x28;FILE_EXTENSION,&#x27;&#x27;&#x29;,PREVIEW_TYPE&#x29;,&#x27;txt&#x27;,&#x27;rtf&#x27;&#x29;&#xd;&#xa;						from DOCUMENTS &#xd;&#xa;						WHERE OWNER_ID &#x3d; a.OWNER_ID FOR XML PATH &#x28;&#x27;&#x27;&#x29;, TYPE&#x29;.value&#x28;&#x27;.&#x27;, &#x27;nvarchar&#x28;MAX&#x29;&#x27;&#x29;, 1, 1, &#x27;&#x27;&#x29;  AS docs&#xd;&#xa;FROM DOCUMENTS as a&#xd;&#xa;WHERE a.OWNER_ID &#x3d; 116662820196 or a.OWNER_ID &#x3d; 116662888140 or a.OWNER_ID &#x3d; 116667442875 or a.OWNER_ID &#x3d; 116664504104                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          &#xd;&#xa;GROUP BY a.OWNER_ID&#xd;&#xa;&#xd;&#xa;select je.&#x2a;, r1.CONFIG_ROLE_NAME role1, r2.CONFIG_ROLE_NAME role2, r3.CONFIG_ROLE_NAME role3&#xd;&#xa;	, r4.CONFIG_ROLE_NAME role4,r5.CONFIG_ROLE_NAME role5, r6.CONFIG_ROLE_NAME role6, mn.DESCRIPTION&#xd;&#xa;from  JOURNAL_ENTRIES je left join MD_ROLES r1 on je.ROLE_ID_1 &#x3d; r1.ROLE_ID&#xd;&#xa;						 left join MD_ROLES r2 on je.ROLE_ID_2 &#x3d; r2.ROLE_ID&#xd;&#xa;						 left join MD_ROLES r3 on je.ROLE_ID_3 &#x3d; r3.ROLE_ID&#xd;&#xa;						 left join MD_ROLES r4 on je.ROLE_ID_4 &#x3d; r4.ROLE_ID&#xd;&#xa;						 left join MD_ROLES r5 on je.ROLE_ID_5 &#x3d; r5.ROLE_ID&#xd;&#xa;						 left join MD_ROLES r6 on je.ROLE_ID_6 &#x3d; r6.ROLE_ID&#xd;&#xa;						 left join MD_MULTI_NAMES mn on je.BO_ID &#x3d; mn.ID&#xd;&#xa;where je.ID &#x3d; 4310146276 and--je.ROLE_ID_4 is not null and je.ROLE_ID_4 &#x3c;&#x3e; 0 and &#xd;&#xa;mn.LANGUAGE&#x3d;1 and mn.type &#x3d; &#x27;BO&#x27;-- and ENTITY_ID_5 &#x3c;&#x3e; 0&#xd;&#xa;--mn.LANGUAGE&#x3d;1 and &#x28;ENTITY_ID_1 &#x3d; 116669809495 or ENTITY_ID_2 &#x3d; 116669809495 or ENTITY_ID_3 &#x3d; 116669809495 or ENTITY_ID_4 &#x3d; 116669809495&#x29;&#xd;&#xa;&#xd;&#xa;select &#x2a; from LK_ENTITIES_JOURNAL where JOURNAL_ID &#x3d; 4316494027&#xd;&#xa;select &#x2a; from ENTITY_TABLE&#xd;&#xa;select &#x2a; from LK_ENTITY_ROLE&#xd;&#xa;select &#x2a; from JOURNAL_ENTRIES where id &#x3d; 4310146276--bo_id is null&#xd;&#xa;select distinct JOURNAL_ID from LK_ENTITIES_JOURNAL&#xd;&#xa;&#xd;&#xa;select &#x2a; from MD_ROLES where role_id &#x3d; 6990593&#xd;&#xa;&#xd;&#xa;select &#x2a; from PROP_EMPLOYEE_GEN where user_ref &#x3d; 600083253&#xd;&#xa;&#xd;&#xa;select &#x2a; from PROP_EMPLOYEE_GEN where USER_REF &#x3d; 600032024&#xd;&#xa;select &#x2a; from PROP_X_CLIENT_JOB&#x2a;&#x2f;&#xd;&#xa;&#xd;&#xa;with&#xd;&#xa;  contact0 &#x28;CLIENT,CONTACT,rn&#x29; as &#x28;SELECT CLIENT,CONTACT,ROW_NUMBER&#x28;&#x29; OVER&#x28;PARTITION BY cg.CONTACT ORDER BY cg.BISUNIQUEID DESC&#x29; AS rn FROM PROP_X_CLIENT_CON cg&#x29;&#xd;&#xa;&#xd;&#xa;, contact1 as &#x28;select CLIENT,CONTACT from contact0 where rn &#x3d; 1&#x29;&#xd;&#xa;&#xd;&#xa;, contact as&#x28;&#xd;&#xa;select&#xd;&#xa;	ccc.CONTACT,ccc.CLIENT, pg.FIRST_NAME, pg.LAST_NAME, pg.MIDDLE_NAME&#xd;&#xa;	, Stuff&#x28;&#xd;&#xa;			  Coalesce&#x28;&#x27; &#x27; &#x2b; NULLIF&#x28;pg.FIRST_NAME, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;			&#x2b; Coalesce&#x28;&#x27; &#x27; &#x2b; NULLIF&#x28;pg.MIDDLE_NAME, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;			&#x2b; Coalesce&#x28;&#x27; &#x27; &#x2b; NULLIF&#x28;pg.LAST_NAME, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;			, 1, 1, &#x27;&#x27;&#x29; as contactFullName&#xd;&#xa;from PROP_X_CLIENT_CON cc&#xd;&#xa;left join contact1 ccc on cc.CONTACT &#x3d; ccc.CONTACT&#xd;&#xa;left join &#x28;select REFERENCE,FIRST_NAME,LAST_NAME, MIDDLE_NAME, JOB_TITLE, LINKEDIN, SALUTATION from PROP_PERSON_GEN&#x29; pg on ccc.CONTACT &#x3d; pg.REFERENCE&#xd;&#xa;&#x29;&#xd;&#xa;--select &#x2a; from contact&#xd;&#xa;&#xd;&#xa;, tempJournal as &#x28;&#xd;&#xa; select ej.JOURNAL_ID,ej.ENTITY_ID,ej.ENTITY_TYPE&#xd;&#xa;		,je.CREATION_DATE,je.CREATOR_ID,je.J_NOTES,je.J_DOCUMENT&#xd;&#xa;		,mn.DESCRIPTION workflow&#xd;&#xa;		,r.CONFIG_ROLE_NAME as role&#xd;&#xa;		,comp.REFERENCE companyID&#xd;&#xa;		,comp.name companyName&#xd;&#xa;		,con.contact contactID&#xd;&#xa;		,con.contactFullName&#xd;&#xa;		, cj.JOB jobID&#xd;&#xa;		, jg.JOB_TITLE&#xd;&#xa;		, cp.REFERENCE candID&#xd;&#xa;		, Stuff&#x28;&#xd;&#xa;			  Coalesce&#x28;&#x27; &#x27; &#x2b; NULLIF&#x28;pg.FIRST_NAME, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;			&#x2b; Coalesce&#x28;&#x27; &#x27; &#x2b; NULLIF&#x28;pg.MIDDLE_NAME, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;			&#x2b; Coalesce&#x28;&#x27; &#x27; &#x2b; NULLIF&#x28;pg.LAST_NAME, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;			, 1, 1, &#x27;&#x27;&#x29; as candFullName&#xd;&#xa;from LK_ENTITIES_JOURNAL ej left join JOURNAL_ENTRIES je on ej.JOURNAL_ID &#x3d; je.ID&#xd;&#xa;							left join MD_MULTI_NAMES mn on je.BO_ID &#x3d; mn.ID&#xd;&#xa;							left join LK_ENTITY_ROLE AS er ON ej.ENTITY_ID &#x3d; er.ENTITY_ID&#xd;&#xa;							left join MD_ROLES AS r ON er.ROLE_ID &#x3d; r.ROLE_ID&#xd;&#xa;							left join PROP_CLIENT_GEN comp on ej.ENTITY_ID &#x3d; comp.REFERENCE&#xd;&#xa;							left join contact con on ej.ENTITY_ID &#x3d; con.CONTACT&#xd;&#xa;							left join PROP_X_CLIENT_JOB cj on ej.ENTITY_ID &#x3d; cj.JOB--3095 rows&#xd;&#xa;							left join PROP_JOB_GEN jg on cj.JOB &#x3d; jg.REFERENCE&#xd;&#xa;							left join PROP_CAND_PREF cp on ej.ENTITY_ID &#x3d; cp.REFERENCE&#xd;&#xa;							left join PROP_PERSON_GEN pg on cp.REFERENCE &#x3d; pg.REFERENCE&#xd;&#xa;where mn.LANGUAGE&#x3d;1 and mn.type &#x3d; &#x27;BO&#x27; and r.CONFIG_ROLE_NAME is not null&#xd;&#xa;--order by JOURNAL_ID&#xd;&#xa;&#x29;--trong bang LK_ENTITIES_JOURNAL, journal cung link vs user, nhung lai link vs user_ref, trong khi trong bang JOURNAL_ENTRIES, joural do&#x27; link vs reference cua user&#xd;&#xa;--select &#x2a; from tempJournal where JOURNAL_ID &#x3d; 4325187318--4323922531&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;, tempJournal1 as &#x28;select t.&#x2a;, t1.companyID,t1.companyName,t2.contactID,t2.contactFullName,t3.jobID,t3.JOB_TITLE,t4.candID,t4.candFullName&#xd;&#xa;from &#x28;select distinct journal_id, workflow,ENTITY_TYPE from tempJournal&#x29; t&#xd;&#xa;							 left join &#x28;select &#x2a; from tempJournal where companyId is not null&#x29; t1 on t1.JOURNAL_ID &#x3d; t.JOURNAL_ID&#xd;&#xa;							 left join &#x28;select &#x2a; from tempJournal where contactID is not null&#x29; t2 on t2.JOURNAL_ID &#x3d; t.JOURNAL_ID&#xd;&#xa;							 left join &#x28;select &#x2a; from tempJournal where jobID is not null&#x29; t3 on t3.JOURNAL_ID &#x3d; t.JOURNAL_ID&#xd;&#xa;							 left join &#x28;select &#x2a; from tempJournal where candID is not null&#x29; t4 on t4.JOURNAL_ID &#x3d; t.JOURNAL_ID&#xd;&#xa; where t.entity_type &#x3c;&#x3e; &#x27;U&#x27;&#x29;&#xd;&#xa;&#xd;&#xa; , tempJournal2 as &#x28;select j1.&#x2a;, je.CREATION_DATE,eg.NAME createdUser, je.J_NOTES,je.J_DOCUMENT, jn.J_DOCUMENT as document2&#xd;&#xa; from tempJournal1 j1 left join JOURNAL_ENTRIES je on j1.JOURNAL_ID &#x3d; je.ID&#xd;&#xa;						left join JOURNAL_NOTES jn on j1.JOURNAL_ID &#x3d; jn.JOURNAL_ID&#xd;&#xa;						left join PROP_EMPLOYEE_GEN eg on je.CREATOR_ID &#x3d; eg.USER_REF&#x29;&#xd;&#xa;--where jn.J_DOCUMENT is not null&#xd;&#xa;&#xd;&#xa;, companyComments as &#x28;select concat&#x28;&#x27;BB&#x27;,companyID&#x29; as CompanyExternalId, -10 as userId&#xd;&#xa;		, CREATION_DATE as InsertTimeStamp, -10 as AssignedUserId, &#x27;comment&#x27; as category, &#x27;company&#x27; as type&#xd;&#xa;		, J_DOCUMENT&#xd;&#xa;		, concat&#x28;&#xd;&#xa;				&#x27;-----MIGRATED FROM JOURNAL ENTRIES-----&#x27;,&#xd;&#xa;				iif&#x28;workflow &#x3d; &#x27;&#x27; or workflow is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Work Flow&#x3a; &#x27;,workflow&#x29;&#x29;,&#xd;&#xa;				iif&#x28;companyName &#x3d; &#x27;&#x27; or companyName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Company&#x3a; &#x27;,companyName&#x29;&#x29;,&#xd;&#xa;				iif&#x28;contactFullName &#x3d; &#x27;&#x27; or contactFullName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Contact&#x3a; &#x27;,contactFullName&#x29;&#x29;,&#xd;&#xa;				iif&#x28;JOB_TITLE &#x3d; &#x27;&#x27; or JOB_TITLE is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Job&#x3a; &#x27;,JOB_TITLE&#x29;&#x29;,&#xd;&#xa;				iif&#x28;candFullName &#x3d; &#x27;&#x27; or candFullName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Candidate&#x3a; &#x27;,candFullName&#x29;&#x29;,&#xd;&#xa;				iif&#x28;J_NOTES like &#x27;&#x27; or candFullName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Notes&#x3a; &#x27;,replace&#x28;replace&#x28;J_NOTES,&#x27;&#x3c;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3c;&#x2f;p&#x3e;&#x27;,&#x27;&#x27;&#x29;&#x29;&#x29;,&#xd;&#xa;				iif&#x28;J_DOCUMENT like &#x27;&#x27; or J_DOCUMENT is null,iif&#x28;document2 like &#x27;&#x27; or document2 is null,&#x27;&#x27;,concat&#x28;char&#x28;10&#x29;,&#x27;Documents&#x3a; &#x27;,replace&#x28;replace&#x28;document2,&#x27;&#x3c;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3c;&#x2f;p&#x3e;&#x27;,&#x27;&#x27;&#x29;&#x29;&#x29;,concat&#x28;char&#x28;10&#x29;,&#x27;Documents&#x3a; &#x27;,replace&#x28;replace&#x28;replace&#x28;replace&#x28;convert&#x28;nvarchar&#x28;max&#x29;,j_DOCUMENT&#x29;,&#x27;&#x3c;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3c;&#x2f;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x26;nbsp&#x3b;&#x27;,&#x27; &#x27;&#x29;,&#x27;  &#x27;,&#x27; &#x27;&#x29;&#x29;&#x29;,&#xd;&#xa;				iif&#x28;CREATION_DATE is null, &#x27;&#x27;, concat&#x28;CHAR&#x28;10&#x29;,&#x27;Created Date&#x3a; &#x27;,convert&#x28;varchar&#x28;20&#x29;,CREATION_DATE,120&#x29;&#x29;&#x29;,&#xd;&#xa;				iif&#x28;createdUser &#x3d; &#x27;&#x27; or createdUser is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Created By&#x3a; &#x27;,createdUser&#x29;&#x29;,&#xd;&#xa;				concat&#x28;char&#x28;10&#x29;,&#x27;JE ID&#x3a; &#x27;, JOURNAL_ID&#x29;&#xd;&#xa;				&#x29; as commentContent&#xd;&#xa;from tempJournal2&#xd;&#xa;where companyID is not null&#x29; --and j_DOCUMENT is not null and j_DOCUMENT not like &#x27;&#x27;&#x29;&#xd;&#xa;&#xd;&#xa;select concat&#x28;&#x27;BB&#x27;,contactID&#x29; as ContactExternalId, -10 as userId&#xd;&#xa;		, CREATION_DATE as InsertTimeStamp, -10 as AssignedUserId, &#x27;comment&#x27; as category, &#x27;contact&#x27; as type&#xd;&#xa;		, J_DOCUMENT&#xd;&#xa;		, concat&#x28;&#xd;&#xa;				&#x27;-----MIGRATED FROM JOURNAL ENTRIES-----&#x27;,&#xd;&#xa;				iif&#x28;workflow &#x3d; &#x27;&#x27; or workflow is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Work Flow&#x3a; &#x27;,workflow&#x29;&#x29;,&#xd;&#xa;				iif&#x28;companyName &#x3d; &#x27;&#x27; or companyName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Company&#x3a; &#x27;,companyName&#x29;&#x29;,&#xd;&#xa;				iif&#x28;contactFullName &#x3d; &#x27;&#x27; or contactFullName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Contact&#x3a; &#x27;,contactFullName&#x29;&#x29;,&#xd;&#xa;				iif&#x28;JOB_TITLE &#x3d; &#x27;&#x27; or JOB_TITLE is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Job&#x3a; &#x27;,JOB_TITLE&#x29;&#x29;,&#xd;&#xa;				iif&#x28;candFullName &#x3d; &#x27;&#x27; or candFullName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Candidate&#x3a; &#x27;,candFullName&#x29;&#x29;,&#xd;&#xa;				iif&#x28;J_NOTES like &#x27;&#x27; or candFullName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Notes&#x3a; &#x27;,replace&#x28;replace&#x28;J_NOTES,&#x27;&#x3c;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3c;&#x2f;p&#x3e;&#x27;,&#x27;&#x27;&#x29;&#x29;&#x29;,&#xd;&#xa;				iif&#x28;J_DOCUMENT like &#x27;&#x27; or J_DOCUMENT is null,iif&#x28;document2 like &#x27;&#x27; or document2 is null,&#x27;&#x27;,concat&#x28;char&#x28;10&#x29;,&#x27;Documents&#x3a; &#x27;,replace&#x28;replace&#x28;document2,&#x27;&#x3c;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3c;&#x2f;p&#x3e;&#x27;,&#x27;&#x27;&#x29;&#x29;&#x29;,concat&#x28;char&#x28;10&#x29;,&#x27;Documents&#x3a; &#x27;,replace&#x28;replace&#x28;replace&#x28;replace&#x28;convert&#x28;nvarchar&#x28;max&#x29;,j_DOCUMENT&#x29;,&#x27;&#x3c;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3c;&#x2f;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x26;nbsp&#x3b;&#x27;,&#x27; &#x27;&#x29;,&#x27;  &#x27;,&#x27; &#x27;&#x29;&#x29;&#x29;,&#xd;&#xa;				iif&#x28;CREATION_DATE is null, &#x27;&#x27;, concat&#x28;CHAR&#x28;10&#x29;,&#x27;Created Date&#x3a; &#x27;,convert&#x28;varchar&#x28;20&#x29;,CREATION_DATE,120&#x29;&#x29;&#x29;,&#xd;&#xa;				iif&#x28;createdUser &#x3d; &#x27;&#x27; or createdUser is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Created By&#x3a; &#x27;,createdUser&#x29;&#x29;,&#xd;&#xa;				concat&#x28;char&#x28;10&#x29;,&#x27;JE ID&#x3a; &#x27;, JOURNAL_ID&#x29;&#xd;&#xa;				&#x29; as commentContent&#xd;&#xa;from tempJournal2&#xd;&#xa;where contactID is not null&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>96</xloc>
      <yloc>256</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Database lookup 2 2 2 2 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>BB review</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>contact</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>ContactExternalId</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>id</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>256</xloc>
      <yloc>256</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Insert &#x2f; Update 2_use this</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>BB review</connection>
    <commit>100</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>activity</table>
      <key>
        <name>id</name>
        <field>contact_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>commentContent</name>
        <field>content</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>InsertTimeStamp</name>
        <field>insert_timestamp</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>contact_id</name>
        <rename>id</rename>
        <update>Y</update>
      </value>
      <value>
        <name>user_account_id</name>
        <rename>userId</rename>
        <update>Y</update>
      </value>
      <value>
        <name>insert_timestamp</name>
        <rename>InsertTimeStamp</rename>
        <update>Y</update>
      </value>
      <value>
        <name>content</name>
        <rename>commentContent</rename>
        <update>Y</update>
      </value>
      <value>
        <name>type</name>
        <rename>type</rename>
        <update>Y</update>
      </value>
      <value>
        <name>category</name>
        <rename>category</rename>
        <update>Y</update>
      </value>
      <value>
        <name>assigned_user_id</name>
        <rename>AssignedUserId</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>416</xloc>
      <yloc>256</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Database lookup 2 2 2 2 3</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>BB review</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>position_description</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>JobExternalId</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>id</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>256</xloc>
      <yloc>432</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Input_Job_Event 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>BB local</connection>
    <sql>&#x2f;&#x2a;	SELECT OWNER_ID, STUFF&#x28;&#x28;SELECT DISTINCT &#x27;,&#x27; &#x2b; cast&#x28;DOC_ID as varchar&#x28;max&#x29;&#x29; &#x2b; &#x27;_&#x27; &#xd;&#xa;						&#x2b; replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;DOC_NAME,&#x27;&#x3f;&#x27;,&#x27;&#x27;&#x29;,&#x27; &#x27;,&#x27;_&#x27;&#x29;,&#x27;&#x2f;&#x27;,&#x27;.&#x27;&#x29;,&#x27;&#x27;&#x27;&#x27;,&#x27;&#x27;&#x29;,&#x27;,&#x27;,&#x27;_&#x27;&#x29;,&#x27;&#x2a;&#x27;,&#x27;&#x7e;&#x27;&#x29;,&#x27;&#x22;&#x27;,&#x27;&#x5e;&#x27;&#x29;,&#x27;&#x5c;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x7c;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3a;&#x27;,&#x27;&#x27;&#x29;,char&#x28;10&#x29;,&#x27;&#x27;&#x29;,char&#x28;13&#x29;,&#x27;&#x27;&#x29;&#xd;&#xa;						&#x2b; &#x27;.&#x27; &#x2b; replace&#x28;coalesce&#x28;nullif&#x28;FILE_EXTENSION,&#x27;&#x27;&#x29;,PREVIEW_TYPE&#x29;,&#x27;txt&#x27;,&#x27;rtf&#x27;&#x29;&#xd;&#xa;						from DOCUMENTS &#xd;&#xa;						WHERE OWNER_ID &#x3d; a.OWNER_ID FOR XML PATH &#x28;&#x27;&#x27;&#x29;, TYPE&#x29;.value&#x28;&#x27;.&#x27;, &#x27;nvarchar&#x28;MAX&#x29;&#x27;&#x29;, 1, 1, &#x27;&#x27;&#x29;  AS docs&#xd;&#xa;FROM DOCUMENTS as a&#xd;&#xa;WHERE a.OWNER_ID &#x3d; 116662820196 or a.OWNER_ID &#x3d; 116662888140 or a.OWNER_ID &#x3d; 116667442875 or a.OWNER_ID &#x3d; 116664504104                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          &#xd;&#xa;GROUP BY a.OWNER_ID&#xd;&#xa;&#xd;&#xa;select je.&#x2a;, r1.CONFIG_ROLE_NAME role1, r2.CONFIG_ROLE_NAME role2, r3.CONFIG_ROLE_NAME role3&#xd;&#xa;	, r4.CONFIG_ROLE_NAME role4,r5.CONFIG_ROLE_NAME role5, r6.CONFIG_ROLE_NAME role6, mn.DESCRIPTION&#xd;&#xa;from  JOURNAL_ENTRIES je left join MD_ROLES r1 on je.ROLE_ID_1 &#x3d; r1.ROLE_ID&#xd;&#xa;						 left join MD_ROLES r2 on je.ROLE_ID_2 &#x3d; r2.ROLE_ID&#xd;&#xa;						 left join MD_ROLES r3 on je.ROLE_ID_3 &#x3d; r3.ROLE_ID&#xd;&#xa;						 left join MD_ROLES r4 on je.ROLE_ID_4 &#x3d; r4.ROLE_ID&#xd;&#xa;						 left join MD_ROLES r5 on je.ROLE_ID_5 &#x3d; r5.ROLE_ID&#xd;&#xa;						 left join MD_ROLES r6 on je.ROLE_ID_6 &#x3d; r6.ROLE_ID&#xd;&#xa;						 left join MD_MULTI_NAMES mn on je.BO_ID &#x3d; mn.ID&#xd;&#xa;where je.ID &#x3d; 4310146276 and--je.ROLE_ID_4 is not null and je.ROLE_ID_4 &#x3c;&#x3e; 0 and &#xd;&#xa;mn.LANGUAGE&#x3d;1 and mn.type &#x3d; &#x27;BO&#x27;-- and ENTITY_ID_5 &#x3c;&#x3e; 0&#xd;&#xa;--mn.LANGUAGE&#x3d;1 and &#x28;ENTITY_ID_1 &#x3d; 116669809495 or ENTITY_ID_2 &#x3d; 116669809495 or ENTITY_ID_3 &#x3d; 116669809495 or ENTITY_ID_4 &#x3d; 116669809495&#x29;&#xd;&#xa;&#xd;&#xa;select &#x2a; from LK_ENTITIES_JOURNAL where JOURNAL_ID &#x3d; 4316494027&#xd;&#xa;select &#x2a; from ENTITY_TABLE&#xd;&#xa;select &#x2a; from LK_ENTITY_ROLE&#xd;&#xa;select &#x2a; from JOURNAL_ENTRIES where id &#x3d; 4310146276--bo_id is null&#xd;&#xa;select distinct JOURNAL_ID from LK_ENTITIES_JOURNAL&#xd;&#xa;&#xd;&#xa;select &#x2a; from MD_ROLES where role_id &#x3d; 6990593&#xd;&#xa;&#xd;&#xa;select &#x2a; from PROP_EMPLOYEE_GEN where user_ref &#x3d; 600083253&#xd;&#xa;&#xd;&#xa;select &#x2a; from PROP_EMPLOYEE_GEN where USER_REF &#x3d; 600032024&#xd;&#xa;select &#x2a; from PROP_X_CLIENT_JOB&#x2a;&#x2f;&#xd;&#xa;&#xd;&#xa;with&#xd;&#xa;  contact0 &#x28;CLIENT,CONTACT,rn&#x29; as &#x28;SELECT CLIENT,CONTACT,ROW_NUMBER&#x28;&#x29; OVER&#x28;PARTITION BY cg.CONTACT ORDER BY cg.BISUNIQUEID DESC&#x29; AS rn FROM PROP_X_CLIENT_CON cg&#x29;&#xd;&#xa;&#xd;&#xa;, contact1 as &#x28;select CLIENT,CONTACT from contact0 where rn &#x3d; 1&#x29;&#xd;&#xa;&#xd;&#xa;, contact as&#x28;&#xd;&#xa;select&#xd;&#xa;	ccc.CONTACT,ccc.CLIENT, pg.FIRST_NAME, pg.LAST_NAME, pg.MIDDLE_NAME&#xd;&#xa;	, Stuff&#x28;&#xd;&#xa;			  Coalesce&#x28;&#x27; &#x27; &#x2b; NULLIF&#x28;pg.FIRST_NAME, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;			&#x2b; Coalesce&#x28;&#x27; &#x27; &#x2b; NULLIF&#x28;pg.MIDDLE_NAME, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;			&#x2b; Coalesce&#x28;&#x27; &#x27; &#x2b; NULLIF&#x28;pg.LAST_NAME, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;			, 1, 1, &#x27;&#x27;&#x29; as contactFullName&#xd;&#xa;from PROP_X_CLIENT_CON cc&#xd;&#xa;left join contact1 ccc on cc.CONTACT &#x3d; ccc.CONTACT&#xd;&#xa;left join &#x28;select REFERENCE,FIRST_NAME,LAST_NAME, MIDDLE_NAME, JOB_TITLE, LINKEDIN, SALUTATION from PROP_PERSON_GEN&#x29; pg on ccc.CONTACT &#x3d; pg.REFERENCE&#xd;&#xa;&#x29;&#xd;&#xa;--select &#x2a; from contact&#xd;&#xa;&#xd;&#xa;, tempJournal as &#x28;&#xd;&#xa; select ej.JOURNAL_ID,ej.ENTITY_ID,ej.ENTITY_TYPE&#xd;&#xa;		,je.CREATION_DATE,je.CREATOR_ID,je.J_NOTES,je.J_DOCUMENT&#xd;&#xa;		,mn.DESCRIPTION workflow&#xd;&#xa;		,r.CONFIG_ROLE_NAME as role&#xd;&#xa;		,comp.REFERENCE companyID&#xd;&#xa;		,comp.name companyName&#xd;&#xa;		,con.contact contactID&#xd;&#xa;		,con.contactFullName&#xd;&#xa;		, cj.JOB jobID&#xd;&#xa;		, jg.JOB_TITLE&#xd;&#xa;		, cp.REFERENCE candID&#xd;&#xa;		, Stuff&#x28;&#xd;&#xa;			  Coalesce&#x28;&#x27; &#x27; &#x2b; NULLIF&#x28;pg.FIRST_NAME, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;			&#x2b; Coalesce&#x28;&#x27; &#x27; &#x2b; NULLIF&#x28;pg.MIDDLE_NAME, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;			&#x2b; Coalesce&#x28;&#x27; &#x27; &#x2b; NULLIF&#x28;pg.LAST_NAME, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;			, 1, 1, &#x27;&#x27;&#x29; as candFullName&#xd;&#xa;from LK_ENTITIES_JOURNAL ej left join JOURNAL_ENTRIES je on ej.JOURNAL_ID &#x3d; je.ID&#xd;&#xa;							left join MD_MULTI_NAMES mn on je.BO_ID &#x3d; mn.ID&#xd;&#xa;							left join LK_ENTITY_ROLE AS er ON ej.ENTITY_ID &#x3d; er.ENTITY_ID&#xd;&#xa;							left join MD_ROLES AS r ON er.ROLE_ID &#x3d; r.ROLE_ID&#xd;&#xa;							left join PROP_CLIENT_GEN comp on ej.ENTITY_ID &#x3d; comp.REFERENCE&#xd;&#xa;							left join contact con on ej.ENTITY_ID &#x3d; con.CONTACT&#xd;&#xa;							left join PROP_X_CLIENT_JOB cj on ej.ENTITY_ID &#x3d; cj.JOB--3095 rows&#xd;&#xa;							left join PROP_JOB_GEN jg on cj.JOB &#x3d; jg.REFERENCE&#xd;&#xa;							left join PROP_CAND_PREF cp on ej.ENTITY_ID &#x3d; cp.REFERENCE&#xd;&#xa;							left join PROP_PERSON_GEN pg on cp.REFERENCE &#x3d; pg.REFERENCE&#xd;&#xa;where mn.LANGUAGE&#x3d;1 and mn.type &#x3d; &#x27;BO&#x27; and r.CONFIG_ROLE_NAME is not null&#xd;&#xa;--order by JOURNAL_ID&#xd;&#xa;&#x29;--trong bang LK_ENTITIES_JOURNAL, journal cung link vs user, nhung lai link vs user_ref, trong khi trong bang JOURNAL_ENTRIES, joural do&#x27; link vs reference cua user&#xd;&#xa;--select &#x2a; from tempJournal where JOURNAL_ID &#x3d; 4325187318--4323922531&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;, tempJournal1 as &#x28;select t.&#x2a;, t1.companyID,t1.companyName,t2.contactID,t2.contactFullName,t3.jobID,t3.JOB_TITLE,t4.candID,t4.candFullName&#xd;&#xa;from &#x28;select distinct journal_id, workflow,ENTITY_TYPE from tempJournal&#x29; t&#xd;&#xa;							 left join &#x28;select &#x2a; from tempJournal where companyId is not null&#x29; t1 on t1.JOURNAL_ID &#x3d; t.JOURNAL_ID&#xd;&#xa;							 left join &#x28;select &#x2a; from tempJournal where contactID is not null&#x29; t2 on t2.JOURNAL_ID &#x3d; t.JOURNAL_ID&#xd;&#xa;							 left join &#x28;select &#x2a; from tempJournal where jobID is not null&#x29; t3 on t3.JOURNAL_ID &#x3d; t.JOURNAL_ID&#xd;&#xa;							 left join &#x28;select &#x2a; from tempJournal where candID is not null&#x29; t4 on t4.JOURNAL_ID &#x3d; t.JOURNAL_ID&#xd;&#xa; where t.entity_type &#x3c;&#x3e; &#x27;U&#x27;&#x29;&#xd;&#xa;&#xd;&#xa; , tempJournal2 as &#x28;select j1.&#x2a;, je.CREATION_DATE,eg.NAME createdUser, je.J_NOTES,je.J_DOCUMENT, jn.J_DOCUMENT as document2&#xd;&#xa; from tempJournal1 j1 left join JOURNAL_ENTRIES je on j1.JOURNAL_ID &#x3d; je.ID&#xd;&#xa;						left join JOURNAL_NOTES jn on j1.JOURNAL_ID &#x3d; jn.JOURNAL_ID&#xd;&#xa;						left join PROP_EMPLOYEE_GEN eg on je.CREATOR_ID &#x3d; eg.USER_REF&#x29;&#xd;&#xa;--where jn.J_DOCUMENT is not null&#xd;&#xa;&#xd;&#xa;, companyComments as &#x28;select concat&#x28;&#x27;BB&#x27;,companyID&#x29; as CompanyExternalId, -10 as userId&#xd;&#xa;		, CREATION_DATE as InsertTimeStamp, -10 as AssignedUserId, &#x27;comment&#x27; as category, &#x27;company&#x27; as type&#xd;&#xa;		, J_DOCUMENT&#xd;&#xa;		, concat&#x28;&#xd;&#xa;				&#x27;-----MIGRATED FROM JOURNAL ENTRIES-----&#x27;,&#xd;&#xa;				iif&#x28;workflow &#x3d; &#x27;&#x27; or workflow is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Work Flow&#x3a; &#x27;,workflow&#x29;&#x29;,&#xd;&#xa;				iif&#x28;companyName &#x3d; &#x27;&#x27; or companyName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Company&#x3a; &#x27;,companyName&#x29;&#x29;,&#xd;&#xa;				iif&#x28;contactFullName &#x3d; &#x27;&#x27; or contactFullName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Contact&#x3a; &#x27;,contactFullName&#x29;&#x29;,&#xd;&#xa;				iif&#x28;JOB_TITLE &#x3d; &#x27;&#x27; or JOB_TITLE is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Job&#x3a; &#x27;,JOB_TITLE&#x29;&#x29;,&#xd;&#xa;				iif&#x28;candFullName &#x3d; &#x27;&#x27; or candFullName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Candidate&#x3a; &#x27;,candFullName&#x29;&#x29;,&#xd;&#xa;				iif&#x28;J_NOTES like &#x27;&#x27; or candFullName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Notes&#x3a; &#x27;,replace&#x28;replace&#x28;J_NOTES,&#x27;&#x3c;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3c;&#x2f;p&#x3e;&#x27;,&#x27;&#x27;&#x29;&#x29;&#x29;,&#xd;&#xa;				iif&#x28;J_DOCUMENT like &#x27;&#x27; or J_DOCUMENT is null,iif&#x28;document2 like &#x27;&#x27; or document2 is null,&#x27;&#x27;,concat&#x28;char&#x28;10&#x29;,&#x27;Documents&#x3a; &#x27;,replace&#x28;replace&#x28;document2,&#x27;&#x3c;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3c;&#x2f;p&#x3e;&#x27;,&#x27;&#x27;&#x29;&#x29;&#x29;,concat&#x28;char&#x28;10&#x29;,&#x27;Documents&#x3a; &#x27;,replace&#x28;replace&#x28;replace&#x28;replace&#x28;convert&#x28;nvarchar&#x28;max&#x29;,j_DOCUMENT&#x29;,&#x27;&#x3c;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3c;&#x2f;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x26;nbsp&#x3b;&#x27;,&#x27; &#x27;&#x29;,&#x27;  &#x27;,&#x27; &#x27;&#x29;&#x29;&#x29;,&#xd;&#xa;				iif&#x28;CREATION_DATE is null, &#x27;&#x27;, concat&#x28;CHAR&#x28;10&#x29;,&#x27;Created Date&#x3a; &#x27;,convert&#x28;varchar&#x28;20&#x29;,CREATION_DATE,120&#x29;&#x29;&#x29;,&#xd;&#xa;				iif&#x28;createdUser &#x3d; &#x27;&#x27; or createdUser is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Created By&#x3a; &#x27;,createdUser&#x29;&#x29;,&#xd;&#xa;				concat&#x28;char&#x28;10&#x29;,&#x27;JE ID&#x3a; &#x27;, JOURNAL_ID&#x29;&#xd;&#xa;				&#x29; as commentContent&#xd;&#xa;from tempJournal2&#xd;&#xa;where companyID is not null&#x29; --and j_DOCUMENT is not null and j_DOCUMENT not like &#x27;&#x27;&#x29;&#xd;&#xa;&#xd;&#xa;, contactcomment as &#x28;select concat&#x28;&#x27;BB&#x27;,contactID&#x29; as ContactExternalId, -10 as userId&#xd;&#xa;		, CREATION_DATE as InsertTimeStamp, -10 as AssignedUserId, &#x27;comment&#x27; as category, &#x27;contact&#x27; as type&#xd;&#xa;		, J_DOCUMENT&#xd;&#xa;		, concat&#x28;&#xd;&#xa;				&#x27;-----MIGRATED FROM JOURNAL ENTRIES-----&#x27;,&#xd;&#xa;				iif&#x28;workflow &#x3d; &#x27;&#x27; or workflow is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Work Flow&#x3a; &#x27;,workflow&#x29;&#x29;,&#xd;&#xa;				iif&#x28;companyName &#x3d; &#x27;&#x27; or companyName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Company&#x3a; &#x27;,companyName&#x29;&#x29;,&#xd;&#xa;				iif&#x28;contactFullName &#x3d; &#x27;&#x27; or contactFullName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Contact&#x3a; &#x27;,contactFullName&#x29;&#x29;,&#xd;&#xa;				iif&#x28;JOB_TITLE &#x3d; &#x27;&#x27; or JOB_TITLE is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Job&#x3a; &#x27;,JOB_TITLE&#x29;&#x29;,&#xd;&#xa;				iif&#x28;candFullName &#x3d; &#x27;&#x27; or candFullName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Candidate&#x3a; &#x27;,candFullName&#x29;&#x29;,&#xd;&#xa;				iif&#x28;J_NOTES like &#x27;&#x27; or candFullName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Notes&#x3a; &#x27;,replace&#x28;replace&#x28;J_NOTES,&#x27;&#x3c;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3c;&#x2f;p&#x3e;&#x27;,&#x27;&#x27;&#x29;&#x29;&#x29;,&#xd;&#xa;				iif&#x28;J_DOCUMENT like &#x27;&#x27; or J_DOCUMENT is null,iif&#x28;document2 like &#x27;&#x27; or document2 is null,&#x27;&#x27;,concat&#x28;char&#x28;10&#x29;,&#x27;Documents&#x3a; &#x27;,replace&#x28;replace&#x28;document2,&#x27;&#x3c;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3c;&#x2f;p&#x3e;&#x27;,&#x27;&#x27;&#x29;&#x29;&#x29;,concat&#x28;char&#x28;10&#x29;,&#x27;Documents&#x3a; &#x27;,replace&#x28;replace&#x28;replace&#x28;replace&#x28;convert&#x28;nvarchar&#x28;max&#x29;,j_DOCUMENT&#x29;,&#x27;&#x3c;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3c;&#x2f;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x26;nbsp&#x3b;&#x27;,&#x27; &#x27;&#x29;,&#x27;  &#x27;,&#x27; &#x27;&#x29;&#x29;&#x29;,&#xd;&#xa;				iif&#x28;CREATION_DATE is null, &#x27;&#x27;, concat&#x28;CHAR&#x28;10&#x29;,&#x27;Created Date&#x3a; &#x27;,convert&#x28;varchar&#x28;20&#x29;,CREATION_DATE,120&#x29;&#x29;&#x29;,&#xd;&#xa;				iif&#x28;createdUser &#x3d; &#x27;&#x27; or createdUser is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Created By&#x3a; &#x27;,createdUser&#x29;&#x29;,&#xd;&#xa;				concat&#x28;char&#x28;10&#x29;,&#x27;JE ID&#x3a; &#x27;, JOURNAL_ID&#x29;&#xd;&#xa;				&#x29; as commentContent&#xd;&#xa;from tempJournal2&#xd;&#xa;where contactID is not null&#x29;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;select concat&#x28;&#x27;BB&#x27;,jobID&#x29; as JobExternalId, -10 as userId&#xd;&#xa;		, CREATION_DATE as InsertTimeStamp, -10 as AssignedUserId, &#x27;comment&#x27; as category, &#x27;job&#x27; as type&#xd;&#xa;		, J_DOCUMENT&#xd;&#xa;		, concat&#x28;&#xd;&#xa;				&#x27;-----MIGRATED FROM JOURNAL ENTRIES-----&#x27;,&#xd;&#xa;				iif&#x28;workflow &#x3d; &#x27;&#x27; or workflow is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Work Flow&#x3a; &#x27;,workflow&#x29;&#x29;,&#xd;&#xa;				iif&#x28;companyName &#x3d; &#x27;&#x27; or companyName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Company&#x3a; &#x27;,companyName&#x29;&#x29;,&#xd;&#xa;				iif&#x28;contactFullName &#x3d; &#x27;&#x27; or contactFullName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Contact&#x3a; &#x27;,contactFullName&#x29;&#x29;,&#xd;&#xa;				iif&#x28;JOB_TITLE &#x3d; &#x27;&#x27; or JOB_TITLE is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Job&#x3a; &#x27;,JOB_TITLE&#x29;&#x29;,&#xd;&#xa;				iif&#x28;candFullName &#x3d; &#x27;&#x27; or candFullName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Candidate&#x3a; &#x27;,candFullName&#x29;&#x29;,&#xd;&#xa;				iif&#x28;J_NOTES like &#x27;&#x27; or candFullName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Notes&#x3a; &#x27;,replace&#x28;replace&#x28;J_NOTES,&#x27;&#x3c;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3c;&#x2f;p&#x3e;&#x27;,&#x27;&#x27;&#x29;&#x29;&#x29;,&#xd;&#xa;				iif&#x28;J_DOCUMENT like &#x27;&#x27; or J_DOCUMENT is null,iif&#x28;document2 like &#x27;&#x27; or document2 is null,&#x27;&#x27;,concat&#x28;char&#x28;10&#x29;,&#x27;Documents&#x3a; &#x27;,replace&#x28;replace&#x28;document2,&#x27;&#x3c;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3c;&#x2f;p&#x3e;&#x27;,&#x27;&#x27;&#x29;&#x29;&#x29;,concat&#x28;char&#x28;10&#x29;,&#x27;Documents&#x3a; &#x27;,replace&#x28;replace&#x28;replace&#x28;replace&#x28;convert&#x28;nvarchar&#x28;max&#x29;,j_DOCUMENT&#x29;,&#x27;&#x3c;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3c;&#x2f;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x26;nbsp&#x3b;&#x27;,&#x27; &#x27;&#x29;,&#x27;  &#x27;,&#x27; &#x27;&#x29;&#x29;&#x29;,&#xd;&#xa;				iif&#x28;CREATION_DATE is null, &#x27;&#x27;, concat&#x28;CHAR&#x28;10&#x29;,&#x27;Created Date&#x3a; &#x27;,convert&#x28;varchar&#x28;20&#x29;,CREATION_DATE,120&#x29;&#x29;&#x29;,&#xd;&#xa;				iif&#x28;createdUser &#x3d; &#x27;&#x27; or createdUser is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Created By&#x3a; &#x27;,createdUser&#x29;&#x29;,&#xd;&#xa;				concat&#x28;char&#x28;10&#x29;,&#x27;JE ID&#x3a; &#x27;, JOURNAL_ID&#x29;&#xd;&#xa;				&#x29; as commentContent&#xd;&#xa;from tempJournal2&#xd;&#xa;where jobID is not null&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>96</xloc>
      <yloc>432</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>job comment</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>BB review</connection>
    <sql>select &#x2a; from activity&#xa;where category &#x3d; &#x27;comment&#x27;  and type &#x3d; &#x27;job&#x27; --and id &#x3c;&#x3e; 1103025</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>96</xloc>
      <yloc>496</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Table output 3 2</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>BB review</connection>
    <schema>public</schema>
    <table>activity_job</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>activity_id</column_name>
          <stream_name>id</stream_name>
        </field>
        <field>
          <column_name>job_id</column_name>
          <stream_name>position_id</stream_name>
        </field>
        <field>
          <column_name>insert_timestamp</column_name>
          <stream_name>insert_timestamp</stream_name>
        </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>256</xloc>
      <yloc>496</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Insert &#x2f; Update 2_use this 2</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>BB review</connection>
    <commit>100</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>activity</table>
      <key>
        <name>id</name>
        <field>position_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>commentContent</name>
        <field>content</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>InsertTimeStamp</name>
        <field>insert_timestamp</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>position_id</name>
        <rename>id</rename>
        <update>Y</update>
      </value>
      <value>
        <name>user_account_id</name>
        <rename>userId</rename>
        <update>Y</update>
      </value>
      <value>
        <name>insert_timestamp</name>
        <rename>InsertTimeStamp</rename>
        <update>Y</update>
      </value>
      <value>
        <name>content</name>
        <rename>commentContent</rename>
        <update>Y</update>
      </value>
      <value>
        <name>type</name>
        <rename>type</rename>
        <update>Y</update>
      </value>
      <value>
        <name>category</name>
        <rename>category</rename>
        <update>Y</update>
      </value>
      <value>
        <name>assigned_user_id</name>
        <rename>AssignedUserId</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>416</xloc>
      <yloc>432</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Database lookup 2 2 2 4</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>BB review</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>CanExternalId</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>id</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>256</xloc>
      <yloc>592</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Input_Candidate_Event 4</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>BB local</connection>
    <sql>&#x2f;&#x2a;	SELECT OWNER_ID, STUFF&#x28;&#x28;SELECT DISTINCT &#x27;,&#x27; &#x2b; cast&#x28;DOC_ID as varchar&#x28;max&#x29;&#x29; &#x2b; &#x27;_&#x27; &#xd;&#xa;						&#x2b; replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;DOC_NAME,&#x27;&#x3f;&#x27;,&#x27;&#x27;&#x29;,&#x27; &#x27;,&#x27;_&#x27;&#x29;,&#x27;&#x2f;&#x27;,&#x27;.&#x27;&#x29;,&#x27;&#x27;&#x27;&#x27;,&#x27;&#x27;&#x29;,&#x27;,&#x27;,&#x27;_&#x27;&#x29;,&#x27;&#x2a;&#x27;,&#x27;&#x7e;&#x27;&#x29;,&#x27;&#x22;&#x27;,&#x27;&#x5e;&#x27;&#x29;,&#x27;&#x5c;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x7c;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3a;&#x27;,&#x27;&#x27;&#x29;,char&#x28;10&#x29;,&#x27;&#x27;&#x29;,char&#x28;13&#x29;,&#x27;&#x27;&#x29;&#xd;&#xa;						&#x2b; &#x27;.&#x27; &#x2b; replace&#x28;coalesce&#x28;nullif&#x28;FILE_EXTENSION,&#x27;&#x27;&#x29;,PREVIEW_TYPE&#x29;,&#x27;txt&#x27;,&#x27;rtf&#x27;&#x29;&#xd;&#xa;						from DOCUMENTS &#xd;&#xa;						WHERE OWNER_ID &#x3d; a.OWNER_ID FOR XML PATH &#x28;&#x27;&#x27;&#x29;, TYPE&#x29;.value&#x28;&#x27;.&#x27;, &#x27;nvarchar&#x28;MAX&#x29;&#x27;&#x29;, 1, 1, &#x27;&#x27;&#x29;  AS docs&#xd;&#xa;FROM DOCUMENTS as a&#xd;&#xa;WHERE a.OWNER_ID &#x3d; 116662820196 or a.OWNER_ID &#x3d; 116662888140 or a.OWNER_ID &#x3d; 116667442875 or a.OWNER_ID &#x3d; 116664504104                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          &#xd;&#xa;GROUP BY a.OWNER_ID&#xd;&#xa;&#xd;&#xa;select je.&#x2a;, r1.CONFIG_ROLE_NAME role1, r2.CONFIG_ROLE_NAME role2, r3.CONFIG_ROLE_NAME role3&#xd;&#xa;	, r4.CONFIG_ROLE_NAME role4,r5.CONFIG_ROLE_NAME role5, r6.CONFIG_ROLE_NAME role6, mn.DESCRIPTION&#xd;&#xa;from  JOURNAL_ENTRIES je left join MD_ROLES r1 on je.ROLE_ID_1 &#x3d; r1.ROLE_ID&#xd;&#xa;						 left join MD_ROLES r2 on je.ROLE_ID_2 &#x3d; r2.ROLE_ID&#xd;&#xa;						 left join MD_ROLES r3 on je.ROLE_ID_3 &#x3d; r3.ROLE_ID&#xd;&#xa;						 left join MD_ROLES r4 on je.ROLE_ID_4 &#x3d; r4.ROLE_ID&#xd;&#xa;						 left join MD_ROLES r5 on je.ROLE_ID_5 &#x3d; r5.ROLE_ID&#xd;&#xa;						 left join MD_ROLES r6 on je.ROLE_ID_6 &#x3d; r6.ROLE_ID&#xd;&#xa;						 left join MD_MULTI_NAMES mn on je.BO_ID &#x3d; mn.ID&#xd;&#xa;where je.ID &#x3d; 4310146276 and--je.ROLE_ID_4 is not null and je.ROLE_ID_4 &#x3c;&#x3e; 0 and &#xd;&#xa;mn.LANGUAGE&#x3d;1 and mn.type &#x3d; &#x27;BO&#x27;-- and ENTITY_ID_5 &#x3c;&#x3e; 0&#xd;&#xa;--mn.LANGUAGE&#x3d;1 and &#x28;ENTITY_ID_1 &#x3d; 116669809495 or ENTITY_ID_2 &#x3d; 116669809495 or ENTITY_ID_3 &#x3d; 116669809495 or ENTITY_ID_4 &#x3d; 116669809495&#x29;&#xd;&#xa;&#xd;&#xa;select &#x2a; from LK_ENTITIES_JOURNAL where JOURNAL_ID &#x3d; 4316494027&#xd;&#xa;select &#x2a; from ENTITY_TABLE&#xd;&#xa;select &#x2a; from LK_ENTITY_ROLE&#xd;&#xa;select &#x2a; from JOURNAL_ENTRIES where id &#x3d; 4310146276--bo_id is null&#xd;&#xa;select distinct JOURNAL_ID from LK_ENTITIES_JOURNAL&#xd;&#xa;&#xd;&#xa;select &#x2a; from MD_ROLES where role_id &#x3d; 6990593&#xd;&#xa;&#xd;&#xa;select &#x2a; from PROP_EMPLOYEE_GEN where user_ref &#x3d; 600083253&#xd;&#xa;&#xd;&#xa;select &#x2a; from PROP_EMPLOYEE_GEN where USER_REF &#x3d; 600032024&#xd;&#xa;select &#x2a; from PROP_X_CLIENT_JOB&#x2a;&#x2f;&#xd;&#xa;&#xd;&#xa;with&#xd;&#xa;  contact0 &#x28;CLIENT,CONTACT,rn&#x29; as &#x28;SELECT CLIENT,CONTACT,ROW_NUMBER&#x28;&#x29; OVER&#x28;PARTITION BY cg.CONTACT ORDER BY cg.BISUNIQUEID DESC&#x29; AS rn FROM PROP_X_CLIENT_CON cg&#x29;&#xd;&#xa;&#xd;&#xa;, contact1 as &#x28;select CLIENT,CONTACT from contact0 where rn &#x3d; 1&#x29;&#xd;&#xa;&#xd;&#xa;, contact as&#x28;&#xd;&#xa;select&#xd;&#xa;	ccc.CONTACT,ccc.CLIENT, pg.FIRST_NAME, pg.LAST_NAME, pg.MIDDLE_NAME&#xd;&#xa;	, Stuff&#x28;&#xd;&#xa;			  Coalesce&#x28;&#x27; &#x27; &#x2b; NULLIF&#x28;pg.FIRST_NAME, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;			&#x2b; Coalesce&#x28;&#x27; &#x27; &#x2b; NULLIF&#x28;pg.MIDDLE_NAME, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;			&#x2b; Coalesce&#x28;&#x27; &#x27; &#x2b; NULLIF&#x28;pg.LAST_NAME, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;			, 1, 1, &#x27;&#x27;&#x29; as contactFullName&#xd;&#xa;from PROP_X_CLIENT_CON cc&#xd;&#xa;left join contact1 ccc on cc.CONTACT &#x3d; ccc.CONTACT&#xd;&#xa;left join &#x28;select REFERENCE,FIRST_NAME,LAST_NAME, MIDDLE_NAME, JOB_TITLE, LINKEDIN, SALUTATION from PROP_PERSON_GEN&#x29; pg on ccc.CONTACT &#x3d; pg.REFERENCE&#xd;&#xa;&#x29;&#xd;&#xa;--select &#x2a; from contact&#xd;&#xa;&#xd;&#xa;, tempJournal as &#x28;&#xd;&#xa; select ej.JOURNAL_ID,ej.ENTITY_ID,ej.ENTITY_TYPE&#xd;&#xa;		,je.CREATION_DATE,je.CREATOR_ID,je.J_NOTES,je.J_DOCUMENT&#xd;&#xa;		,mn.DESCRIPTION workflow&#xd;&#xa;		,r.CONFIG_ROLE_NAME as role&#xd;&#xa;		,comp.REFERENCE companyID&#xd;&#xa;		,comp.name companyName&#xd;&#xa;		,con.contact contactID&#xd;&#xa;		,con.contactFullName&#xd;&#xa;		, cj.JOB jobID&#xd;&#xa;		, jg.JOB_TITLE&#xd;&#xa;		, cp.REFERENCE candID&#xd;&#xa;		, Stuff&#x28;&#xd;&#xa;			  Coalesce&#x28;&#x27; &#x27; &#x2b; NULLIF&#x28;pg.FIRST_NAME, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;			&#x2b; Coalesce&#x28;&#x27; &#x27; &#x2b; NULLIF&#x28;pg.MIDDLE_NAME, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;			&#x2b; Coalesce&#x28;&#x27; &#x27; &#x2b; NULLIF&#x28;pg.LAST_NAME, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;			, 1, 1, &#x27;&#x27;&#x29; as candFullName&#xd;&#xa;from LK_ENTITIES_JOURNAL ej left join JOURNAL_ENTRIES je on ej.JOURNAL_ID &#x3d; je.ID&#xd;&#xa;							left join MD_MULTI_NAMES mn on je.BO_ID &#x3d; mn.ID&#xd;&#xa;							left join LK_ENTITY_ROLE AS er ON ej.ENTITY_ID &#x3d; er.ENTITY_ID&#xd;&#xa;							left join MD_ROLES AS r ON er.ROLE_ID &#x3d; r.ROLE_ID&#xd;&#xa;							left join PROP_CLIENT_GEN comp on ej.ENTITY_ID &#x3d; comp.REFERENCE&#xd;&#xa;							left join contact con on ej.ENTITY_ID &#x3d; con.CONTACT&#xd;&#xa;							left join PROP_X_CLIENT_JOB cj on ej.ENTITY_ID &#x3d; cj.JOB--3095 rows&#xd;&#xa;							left join PROP_JOB_GEN jg on cj.JOB &#x3d; jg.REFERENCE&#xd;&#xa;							left join PROP_CAND_PREF cp on ej.ENTITY_ID &#x3d; cp.REFERENCE&#xd;&#xa;							left join PROP_PERSON_GEN pg on cp.REFERENCE &#x3d; pg.REFERENCE&#xd;&#xa;where mn.LANGUAGE&#x3d;1 and mn.type &#x3d; &#x27;BO&#x27; and r.CONFIG_ROLE_NAME is not null&#xd;&#xa;--order by JOURNAL_ID&#xd;&#xa;&#x29;--trong bang LK_ENTITIES_JOURNAL, journal cung link vs user, nhung lai link vs user_ref, trong khi trong bang JOURNAL_ENTRIES, joural do&#x27; link vs reference cua user&#xd;&#xa;--select &#x2a; from tempJournal where JOURNAL_ID &#x3d; 4325187318--4323922531&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;, tempJournal1 as &#x28;select t.&#x2a;, t1.companyID,t1.companyName,t2.contactID,t2.contactFullName,t3.jobID,t3.JOB_TITLE,t4.candID,t4.candFullName&#xd;&#xa;from &#x28;select distinct journal_id, workflow,ENTITY_TYPE from tempJournal&#x29; t&#xd;&#xa;							 left join &#x28;select &#x2a; from tempJournal where companyId is not null&#x29; t1 on t1.JOURNAL_ID &#x3d; t.JOURNAL_ID&#xd;&#xa;							 left join &#x28;select &#x2a; from tempJournal where contactID is not null&#x29; t2 on t2.JOURNAL_ID &#x3d; t.JOURNAL_ID&#xd;&#xa;							 left join &#x28;select &#x2a; from tempJournal where jobID is not null&#x29; t3 on t3.JOURNAL_ID &#x3d; t.JOURNAL_ID&#xd;&#xa;							 left join &#x28;select &#x2a; from tempJournal where candID is not null&#x29; t4 on t4.JOURNAL_ID &#x3d; t.JOURNAL_ID&#xd;&#xa; where t.entity_type &#x3c;&#x3e; &#x27;U&#x27;&#x29;&#xd;&#xa;&#xd;&#xa; , tempJournal2 as &#x28;select j1.&#x2a;, je.CREATION_DATE,eg.NAME createdUser, je.J_NOTES,je.J_DOCUMENT, jn.J_DOCUMENT as document2&#xd;&#xa; from tempJournal1 j1 left join JOURNAL_ENTRIES je on j1.JOURNAL_ID &#x3d; je.ID&#xd;&#xa;						left join JOURNAL_NOTES jn on j1.JOURNAL_ID &#x3d; jn.JOURNAL_ID&#xd;&#xa;						left join PROP_EMPLOYEE_GEN eg on je.CREATOR_ID &#x3d; eg.USER_REF&#x29;&#xd;&#xa;--where jn.J_DOCUMENT is not null&#xd;&#xa;&#xd;&#xa;, companyComments as &#x28;select concat&#x28;&#x27;BB&#x27;,companyID&#x29; as CompanyExternalId, -10 as userId&#xd;&#xa;		, CREATION_DATE as InsertTimeStamp, -10 as AssignedUserId, &#x27;comment&#x27; as category, &#x27;company&#x27; as type&#xd;&#xa;		, J_DOCUMENT&#xd;&#xa;		, concat&#x28;&#xd;&#xa;				&#x27;-----MIGRATED FROM JOURNAL ENTRIES-----&#x27;,&#xd;&#xa;				iif&#x28;workflow &#x3d; &#x27;&#x27; or workflow is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Work Flow&#x3a; &#x27;,workflow&#x29;&#x29;,&#xd;&#xa;				iif&#x28;companyName &#x3d; &#x27;&#x27; or companyName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Company&#x3a; &#x27;,companyName&#x29;&#x29;,&#xd;&#xa;				iif&#x28;contactFullName &#x3d; &#x27;&#x27; or contactFullName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Contact&#x3a; &#x27;,contactFullName&#x29;&#x29;,&#xd;&#xa;				iif&#x28;JOB_TITLE &#x3d; &#x27;&#x27; or JOB_TITLE is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Job&#x3a; &#x27;,JOB_TITLE&#x29;&#x29;,&#xd;&#xa;				iif&#x28;candFullName &#x3d; &#x27;&#x27; or candFullName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Candidate&#x3a; &#x27;,candFullName&#x29;&#x29;,&#xd;&#xa;				iif&#x28;J_NOTES like &#x27;&#x27; or candFullName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Notes&#x3a; &#x27;,replace&#x28;replace&#x28;J_NOTES,&#x27;&#x3c;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3c;&#x2f;p&#x3e;&#x27;,&#x27;&#x27;&#x29;&#x29;&#x29;,&#xd;&#xa;				iif&#x28;J_DOCUMENT like &#x27;&#x27; or J_DOCUMENT is null,iif&#x28;document2 like &#x27;&#x27; or document2 is null,&#x27;&#x27;,concat&#x28;char&#x28;10&#x29;,&#x27;Documents&#x3a; &#x27;,replace&#x28;replace&#x28;document2,&#x27;&#x3c;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3c;&#x2f;p&#x3e;&#x27;,&#x27;&#x27;&#x29;&#x29;&#x29;,concat&#x28;char&#x28;10&#x29;,&#x27;Documents&#x3a; &#x27;,replace&#x28;replace&#x28;replace&#x28;replace&#x28;convert&#x28;nvarchar&#x28;max&#x29;,j_DOCUMENT&#x29;,&#x27;&#x3c;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3c;&#x2f;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x26;nbsp&#x3b;&#x27;,&#x27; &#x27;&#x29;,&#x27;  &#x27;,&#x27; &#x27;&#x29;&#x29;&#x29;,&#xd;&#xa;				iif&#x28;CREATION_DATE is null, &#x27;&#x27;, concat&#x28;CHAR&#x28;10&#x29;,&#x27;Created Date&#x3a; &#x27;,convert&#x28;varchar&#x28;20&#x29;,CREATION_DATE,120&#x29;&#x29;&#x29;,&#xd;&#xa;				iif&#x28;createdUser &#x3d; &#x27;&#x27; or createdUser is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Created By&#x3a; &#x27;,createdUser&#x29;&#x29;,&#xd;&#xa;				concat&#x28;char&#x28;10&#x29;,&#x27;JE ID&#x3a; &#x27;, JOURNAL_ID&#x29;&#xd;&#xa;				&#x29; as commentContent&#xd;&#xa;from tempJournal2&#xd;&#xa;where companyID is not null&#x29; --and j_DOCUMENT is not null and j_DOCUMENT not like &#x27;&#x27;&#x29;&#xd;&#xa;&#xd;&#xa;, contactcomment as &#x28;select concat&#x28;&#x27;BB&#x27;,contactID&#x29; as ContactExternalId, -10 as userId&#xd;&#xa;		, CREATION_DATE as InsertTimeStamp, -10 as AssignedUserId, &#x27;comment&#x27; as category, &#x27;contact&#x27; as type&#xd;&#xa;		, J_DOCUMENT&#xd;&#xa;		, concat&#x28;&#xd;&#xa;				&#x27;-----MIGRATED FROM JOURNAL ENTRIES-----&#x27;,&#xd;&#xa;				iif&#x28;workflow &#x3d; &#x27;&#x27; or workflow is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Work Flow&#x3a; &#x27;,workflow&#x29;&#x29;,&#xd;&#xa;				iif&#x28;companyName &#x3d; &#x27;&#x27; or companyName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Company&#x3a; &#x27;,companyName&#x29;&#x29;,&#xd;&#xa;				iif&#x28;contactFullName &#x3d; &#x27;&#x27; or contactFullName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Contact&#x3a; &#x27;,contactFullName&#x29;&#x29;,&#xd;&#xa;				iif&#x28;JOB_TITLE &#x3d; &#x27;&#x27; or JOB_TITLE is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Job&#x3a; &#x27;,JOB_TITLE&#x29;&#x29;,&#xd;&#xa;				iif&#x28;candFullName &#x3d; &#x27;&#x27; or candFullName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Candidate&#x3a; &#x27;,candFullName&#x29;&#x29;,&#xd;&#xa;				iif&#x28;J_NOTES like &#x27;&#x27; or candFullName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Notes&#x3a; &#x27;,replace&#x28;replace&#x28;J_NOTES,&#x27;&#x3c;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3c;&#x2f;p&#x3e;&#x27;,&#x27;&#x27;&#x29;&#x29;&#x29;,&#xd;&#xa;				iif&#x28;J_DOCUMENT like &#x27;&#x27; or J_DOCUMENT is null,iif&#x28;document2 like &#x27;&#x27; or document2 is null,&#x27;&#x27;,concat&#x28;char&#x28;10&#x29;,&#x27;Documents&#x3a; &#x27;,replace&#x28;replace&#x28;document2,&#x27;&#x3c;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3c;&#x2f;p&#x3e;&#x27;,&#x27;&#x27;&#x29;&#x29;&#x29;,concat&#x28;char&#x28;10&#x29;,&#x27;Documents&#x3a; &#x27;,replace&#x28;replace&#x28;replace&#x28;replace&#x28;convert&#x28;nvarchar&#x28;max&#x29;,j_DOCUMENT&#x29;,&#x27;&#x3c;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3c;&#x2f;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x26;nbsp&#x3b;&#x27;,&#x27; &#x27;&#x29;,&#x27;  &#x27;,&#x27; &#x27;&#x29;&#x29;&#x29;,&#xd;&#xa;				iif&#x28;CREATION_DATE is null, &#x27;&#x27;, concat&#x28;CHAR&#x28;10&#x29;,&#x27;Created Date&#x3a; &#x27;,convert&#x28;varchar&#x28;20&#x29;,CREATION_DATE,120&#x29;&#x29;&#x29;,&#xd;&#xa;				iif&#x28;createdUser &#x3d; &#x27;&#x27; or createdUser is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Created By&#x3a; &#x27;,createdUser&#x29;&#x29;,&#xd;&#xa;				concat&#x28;char&#x28;10&#x29;,&#x27;JE ID&#x3a; &#x27;, JOURNAL_ID&#x29;&#xd;&#xa;				&#x29; as commentContent&#xd;&#xa;from tempJournal2&#xd;&#xa;where contactID is not null&#x29;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;, jobcomment as &#x28;select concat&#x28;&#x27;BB&#x27;,jobID&#x29; as JobExternalId, -10 as userId&#xd;&#xa;		, CREATION_DATE as InsertTimeStamp, -10 as AssignedUserId, &#x27;comment&#x27; as category, &#x27;job&#x27; as type&#xd;&#xa;		, J_DOCUMENT&#xd;&#xa;		, concat&#x28;&#xd;&#xa;				&#x27;-----MIGRATED FROM JOURNAL ENTRIES-----&#x27;,&#xd;&#xa;				iif&#x28;workflow &#x3d; &#x27;&#x27; or workflow is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Work Flow&#x3a; &#x27;,workflow&#x29;&#x29;,&#xd;&#xa;				iif&#x28;companyName &#x3d; &#x27;&#x27; or companyName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Company&#x3a; &#x27;,companyName&#x29;&#x29;,&#xd;&#xa;				iif&#x28;contactFullName &#x3d; &#x27;&#x27; or contactFullName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Contact&#x3a; &#x27;,contactFullName&#x29;&#x29;,&#xd;&#xa;				iif&#x28;JOB_TITLE &#x3d; &#x27;&#x27; or JOB_TITLE is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Job&#x3a; &#x27;,JOB_TITLE&#x29;&#x29;,&#xd;&#xa;				iif&#x28;candFullName &#x3d; &#x27;&#x27; or candFullName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Candidate&#x3a; &#x27;,candFullName&#x29;&#x29;,&#xd;&#xa;				iif&#x28;J_NOTES like &#x27;&#x27; or candFullName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Notes&#x3a; &#x27;,replace&#x28;replace&#x28;J_NOTES,&#x27;&#x3c;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3c;&#x2f;p&#x3e;&#x27;,&#x27;&#x27;&#x29;&#x29;&#x29;,&#xd;&#xa;				iif&#x28;J_DOCUMENT like &#x27;&#x27; or J_DOCUMENT is null,iif&#x28;document2 like &#x27;&#x27; or document2 is null,&#x27;&#x27;,concat&#x28;char&#x28;10&#x29;,&#x27;Documents&#x3a; &#x27;,replace&#x28;replace&#x28;document2,&#x27;&#x3c;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3c;&#x2f;p&#x3e;&#x27;,&#x27;&#x27;&#x29;&#x29;&#x29;,concat&#x28;char&#x28;10&#x29;,&#x27;Documents&#x3a; &#x27;,replace&#x28;replace&#x28;replace&#x28;replace&#x28;convert&#x28;nvarchar&#x28;max&#x29;,j_DOCUMENT&#x29;,&#x27;&#x3c;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3c;&#x2f;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x26;nbsp&#x3b;&#x27;,&#x27; &#x27;&#x29;,&#x27;  &#x27;,&#x27; &#x27;&#x29;&#x29;&#x29;,&#xd;&#xa;				iif&#x28;CREATION_DATE is null, &#x27;&#x27;, concat&#x28;CHAR&#x28;10&#x29;,&#x27;Created Date&#x3a; &#x27;,convert&#x28;varchar&#x28;20&#x29;,CREATION_DATE,120&#x29;&#x29;&#x29;,&#xd;&#xa;				iif&#x28;createdUser &#x3d; &#x27;&#x27; or createdUser is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Created By&#x3a; &#x27;,createdUser&#x29;&#x29;,&#xd;&#xa;				concat&#x28;char&#x28;10&#x29;,&#x27;JE ID&#x3a; &#x27;, JOURNAL_ID&#x29;&#xd;&#xa;				&#x29; as commentContent&#xd;&#xa;from tempJournal2&#xd;&#xa;where jobID is not null&#x29;&#xd;&#xa;&#xd;&#xa;, candidatecomment as &#x28;select concat&#x28;&#x27;BB&#x27;,candID&#x29; as CanExternalId, -10 as userId&#xd;&#xa;		, CREATION_DATE as InsertTimeStamp, -10 as AssignedUserId, &#x27;comment&#x27; as category, &#x27;candidate&#x27; as type&#xd;&#xa;		, J_DOCUMENT&#xd;&#xa;		, concat&#x28;&#xd;&#xa;				&#x27;-----MIGRATED FROM JOURNAL ENTRIES-----&#x27;,&#xd;&#xa;				iif&#x28;workflow &#x3d; &#x27;&#x27; or workflow is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Work Flow&#x3a; &#x27;,workflow&#x29;&#x29;,&#xd;&#xa;				iif&#x28;companyName &#x3d; &#x27;&#x27; or companyName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Company&#x3a; &#x27;,companyName&#x29;&#x29;,&#xd;&#xa;				iif&#x28;contactFullName &#x3d; &#x27;&#x27; or contactFullName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Contact&#x3a; &#x27;,contactFullName&#x29;&#x29;,&#xd;&#xa;				iif&#x28;JOB_TITLE &#x3d; &#x27;&#x27; or JOB_TITLE is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Job&#x3a; &#x27;,JOB_TITLE&#x29;&#x29;,&#xd;&#xa;				iif&#x28;candFullName &#x3d; &#x27;&#x27; or candFullName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Candidate&#x3a; &#x27;,candFullName&#x29;&#x29;,&#xd;&#xa;				iif&#x28;J_NOTES like &#x27;&#x27; or candFullName is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Notes&#x3a; &#x27;,replace&#x28;replace&#x28;J_NOTES,&#x27;&#x3c;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3c;&#x2f;p&#x3e;&#x27;,&#x27;&#x27;&#x29;&#x29;&#x29;,&#xd;&#xa;				iif&#x28;J_DOCUMENT like &#x27;&#x27; or J_DOCUMENT is null,iif&#x28;document2 like &#x27;&#x27; or document2 is null,&#x27;&#x27;,concat&#x28;char&#x28;10&#x29;,&#x27;Documents&#x3a; &#x27;,replace&#x28;replace&#x28;document2,&#x27;&#x3c;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3c;&#x2f;p&#x3e;&#x27;,&#x27;&#x27;&#x29;&#x29;&#x29;,concat&#x28;char&#x28;10&#x29;,&#x27;Documents&#x3a; &#x27;,replace&#x28;replace&#x28;replace&#x28;replace&#x28;convert&#x28;nvarchar&#x28;max&#x29;,j_DOCUMENT&#x29;,&#x27;&#x3c;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x3c;&#x2f;p&#x3e;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#x26;nbsp&#x3b;&#x27;,&#x27; &#x27;&#x29;,&#x27;  &#x27;,&#x27; &#x27;&#x29;&#x29;&#x29;,&#xd;&#xa;				iif&#x28;CREATION_DATE is null, &#x27;&#x27;, concat&#x28;CHAR&#x28;10&#x29;,&#x27;Created Date&#x3a; &#x27;,convert&#x28;varchar&#x28;20&#x29;,CREATION_DATE,120&#x29;&#x29;&#x29;,&#xd;&#xa;				iif&#x28;createdUser &#x3d; &#x27;&#x27; or createdUser is null, &#x27;&#x27;, concat&#x28;char&#x28;10&#x29;,&#x27;Created By&#x3a; &#x27;,createdUser&#x29;&#x29;,&#xd;&#xa;				concat&#x28;char&#x28;10&#x29;,&#x27;JE ID&#x3a; &#x27;, JOURNAL_ID&#x29;&#xd;&#xa;				&#x29; as commentContent&#xd;&#xa;from tempJournal2&#xd;&#xa;where candID is not null&#x29;&#xd;&#xa;&#xd;&#xa;select &#x2a; from candidatecomment&#xd;&#xa;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>96</xloc>
      <yloc>592</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Candidate Comment 2 2 2 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>BB review</connection>
    <sql>select &#x2a; from activity&#xa;where category &#x3d; &#x27;comment&#x27;  and type &#x3d; &#x27;candidate&#x27; --and id &#x3e; 74132</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>96</xloc>
      <yloc>672</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Table output 3 3</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>BB review</connection>
    <schema>public</schema>
    <table>activity_candidate</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>activity_id</column_name>
          <stream_name>id</stream_name>
        </field>
        <field>
          <column_name>candidate_id</column_name>
          <stream_name>candidate_id</stream_name>
        </field>
        <field>
          <column_name>insert_timestamp</column_name>
          <stream_name>insert_timestamp</stream_name>
        </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>256</xloc>
      <yloc>672</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Insert &#x2f; Update 2_use this 2 2</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>BB review</connection>
    <commit>100</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>activity</table>
      <key>
        <name>id</name>
        <field>candidate_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>commentContent</name>
        <field>content</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>InsertTimeStamp</name>
        <field>insert_timestamp</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>candidate_id</name>
        <rename>id</rename>
        <update>Y</update>
      </value>
      <value>
        <name>user_account_id</name>
        <rename>userId</rename>
        <update>Y</update>
      </value>
      <value>
        <name>insert_timestamp</name>
        <rename>InsertTimeStamp</rename>
        <update>Y</update>
      </value>
      <value>
        <name>content</name>
        <rename>commentContent</rename>
        <update>Y</update>
      </value>
      <value>
        <name>type</name>
        <rename>type</rename>
        <update>Y</update>
      </value>
      <value>
        <name>category</name>
        <rename>category</rename>
        <update>Y</update>
      </value>
      <value>
        <name>assigned_user_id</name>
        <rename>AssignedUserId</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>416</xloc>
      <yloc>592</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step_error_handling>
  </step_error_handling>
  <slave-step-copy-partition-distribution>
  </slave-step-copy-partition-distribution>
  <slave_transformation>N</slave_transformation>
</transformation>
