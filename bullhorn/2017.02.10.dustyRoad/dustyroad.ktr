<?xml version="1.0" encoding="UTF-8"?>
<transformation>
  <info>
    <name>pentaho_export</name>
    <description/>
    <extended_description/>
    <trans_version/>
    <trans_type>Normal</trans_type>
    <trans_status>0</trans_status>
    <directory>&#x2f;</directory>
    <parameters>
    </parameters>
    <log>
<trans-log-table><connection/>
<schema/>
<table/>
<size_limit_lines/>
<interval/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field><field><id>TRANSNAME</id><enabled>Y</enabled><name>TRANSNAME</name></field><field><id>STATUS</id><enabled>Y</enabled><name>STATUS</name></field><field><id>LINES_READ</id><enabled>Y</enabled><name>LINES_READ</name><subject/></field><field><id>LINES_WRITTEN</id><enabled>Y</enabled><name>LINES_WRITTEN</name><subject/></field><field><id>LINES_UPDATED</id><enabled>Y</enabled><name>LINES_UPDATED</name><subject/></field><field><id>LINES_INPUT</id><enabled>Y</enabled><name>LINES_INPUT</name><subject/></field><field><id>LINES_OUTPUT</id><enabled>Y</enabled><name>LINES_OUTPUT</name><subject/></field><field><id>LINES_REJECTED</id><enabled>Y</enabled><name>LINES_REJECTED</name><subject/></field><field><id>ERRORS</id><enabled>Y</enabled><name>ERRORS</name></field><field><id>STARTDATE</id><enabled>Y</enabled><name>STARTDATE</name></field><field><id>ENDDATE</id><enabled>Y</enabled><name>ENDDATE</name></field><field><id>LOGDATE</id><enabled>Y</enabled><name>LOGDATE</name></field><field><id>DEPDATE</id><enabled>Y</enabled><name>DEPDATE</name></field><field><id>REPLAYDATE</id><enabled>Y</enabled><name>REPLAYDATE</name></field><field><id>LOG_FIELD</id><enabled>Y</enabled><name>LOG_FIELD</name></field><field><id>EXECUTING_SERVER</id><enabled>N</enabled><name>EXECUTING_SERVER</name></field><field><id>EXECUTING_USER</id><enabled>N</enabled><name>EXECUTING_USER</name></field><field><id>CLIENT</id><enabled>N</enabled><name>CLIENT</name></field></trans-log-table>
<perf-log-table><connection/>
<schema/>
<table/>
<interval/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>SEQ_NR</id><enabled>Y</enabled><name>SEQ_NR</name></field><field><id>LOGDATE</id><enabled>Y</enabled><name>LOGDATE</name></field><field><id>TRANSNAME</id><enabled>Y</enabled><name>TRANSNAME</name></field><field><id>STEPNAME</id><enabled>Y</enabled><name>STEPNAME</name></field><field><id>STEP_COPY</id><enabled>Y</enabled><name>STEP_COPY</name></field><field><id>LINES_READ</id><enabled>Y</enabled><name>LINES_READ</name></field><field><id>LINES_WRITTEN</id><enabled>Y</enabled><name>LINES_WRITTEN</name></field><field><id>LINES_UPDATED</id><enabled>Y</enabled><name>LINES_UPDATED</name></field><field><id>LINES_INPUT</id><enabled>Y</enabled><name>LINES_INPUT</name></field><field><id>LINES_OUTPUT</id><enabled>Y</enabled><name>LINES_OUTPUT</name></field><field><id>LINES_REJECTED</id><enabled>Y</enabled><name>LINES_REJECTED</name></field><field><id>ERRORS</id><enabled>Y</enabled><name>ERRORS</name></field><field><id>INPUT_BUFFER_ROWS</id><enabled>Y</enabled><name>INPUT_BUFFER_ROWS</name></field><field><id>OUTPUT_BUFFER_ROWS</id><enabled>Y</enabled><name>OUTPUT_BUFFER_ROWS</name></field></perf-log-table>
<channel-log-table><connection/>
<schema/>
<table/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field><field><id>LOG_DATE</id><enabled>Y</enabled><name>LOG_DATE</name></field><field><id>LOGGING_OBJECT_TYPE</id><enabled>Y</enabled><name>LOGGING_OBJECT_TYPE</name></field><field><id>OBJECT_NAME</id><enabled>Y</enabled><name>OBJECT_NAME</name></field><field><id>OBJECT_COPY</id><enabled>Y</enabled><name>OBJECT_COPY</name></field><field><id>REPOSITORY_DIRECTORY</id><enabled>Y</enabled><name>REPOSITORY_DIRECTORY</name></field><field><id>FILENAME</id><enabled>Y</enabled><name>FILENAME</name></field><field><id>OBJECT_ID</id><enabled>Y</enabled><name>OBJECT_ID</name></field><field><id>OBJECT_REVISION</id><enabled>Y</enabled><name>OBJECT_REVISION</name></field><field><id>PARENT_CHANNEL_ID</id><enabled>Y</enabled><name>PARENT_CHANNEL_ID</name></field><field><id>ROOT_CHANNEL_ID</id><enabled>Y</enabled><name>ROOT_CHANNEL_ID</name></field></channel-log-table>
<step-log-table><connection/>
<schema/>
<table/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field><field><id>LOG_DATE</id><enabled>Y</enabled><name>LOG_DATE</name></field><field><id>TRANSNAME</id><enabled>Y</enabled><name>TRANSNAME</name></field><field><id>STEPNAME</id><enabled>Y</enabled><name>STEPNAME</name></field><field><id>STEP_COPY</id><enabled>Y</enabled><name>STEP_COPY</name></field><field><id>LINES_READ</id><enabled>Y</enabled><name>LINES_READ</name></field><field><id>LINES_WRITTEN</id><enabled>Y</enabled><name>LINES_WRITTEN</name></field><field><id>LINES_UPDATED</id><enabled>Y</enabled><name>LINES_UPDATED</name></field><field><id>LINES_INPUT</id><enabled>Y</enabled><name>LINES_INPUT</name></field><field><id>LINES_OUTPUT</id><enabled>Y</enabled><name>LINES_OUTPUT</name></field><field><id>LINES_REJECTED</id><enabled>Y</enabled><name>LINES_REJECTED</name></field><field><id>ERRORS</id><enabled>Y</enabled><name>ERRORS</name></field><field><id>LOG_FIELD</id><enabled>N</enabled><name>LOG_FIELD</name></field></step-log-table>
<metrics-log-table><connection/>
<schema/>
<table/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field><field><id>LOG_DATE</id><enabled>Y</enabled><name>LOG_DATE</name></field><field><id>METRICS_DATE</id><enabled>Y</enabled><name>METRICS_DATE</name></field><field><id>METRICS_CODE</id><enabled>Y</enabled><name>METRICS_CODE</name></field><field><id>METRICS_DESCRIPTION</id><enabled>Y</enabled><name>METRICS_DESCRIPTION</name></field><field><id>METRICS_SUBJECT</id><enabled>Y</enabled><name>METRICS_SUBJECT</name></field><field><id>METRICS_TYPE</id><enabled>Y</enabled><name>METRICS_TYPE</name></field><field><id>METRICS_VALUE</id><enabled>Y</enabled><name>METRICS_VALUE</name></field></metrics-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file/>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit/>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
  <created_user/>
  <created_date>2017&#x2f;01&#x2f;20 16&#x3a;14&#x3a;34.085</created_date>
  <modified_user/>
  <modified_date>2017&#x2f;01&#x2f;20 16&#x3a;14&#x3a;34.085</modified_date>
    <key_for_session_key>H4sIAAAAAAAAAAMAAAAAAAAAAAA&#x3d;</key_for_session_key>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
  </notepads>
  <connection>
    <name>export</name>
    <server>192.168.20.130</server>
    <type>MSSQL</type>
    <access>Native</access>
    <database>dustyroad</database>
    <port>1433</port>
    <username>sa</username>
    <password>Encrypted 2be98afc86aa7f2e4cb79ce10bef2bcdb</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1433</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>Y</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <order>
  <hop> <from>Job</from><to>job_</to><enabled>N</enabled> </hop>
  <hop> <from>Contact</from><to>contact_</to><enabled>N</enabled> </hop>
  <hop> <from>Company</from><to>company_ </to><enabled>N</enabled> </hop>
  <hop> <from>Candidate</from><to>candidate_</to><enabled>N</enabled> </hop>
  <hop> <from>Company 2</from><to>company_  2</to><enabled>N</enabled> </hop>
  <hop> <from>JobApplication</from><to>JobApplication_</to><enabled>Y</enabled> </hop>
  </order>
  <step>
    <name>Candidate</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <connection>export</connection>
    <sql>&#xa;with &#xa;----- Resume&#x27;s filename -----&#xa;--t3&#x28;candidateUserID, name&#x29; as &#x28;select a.candidateUserID, a.name from bullhorn1.View_CandidateFile a where a.type &#x3d; &#x27;Resume&#x27;&#x29; -- 2473 lines&#xa;t3&#x28;candidateUserID, name&#x29; as &#x28;select a.candidateUserID, a.name from bullhorn1.View_CandidateFile a where a.type in &#x28;&#x27;CV&#x27;,&#x27;Resume&#x27;&#x29;&#x29;&#xa;--select &#x2a; from t3 where candidateUserID &#x3d; 810 -- 3675 lines&#xa;, t4&#x28;candidateUserID, finame&#x29; as &#x28;SELECT candidateUserID, STUFF&#x28; &#x28;SELECT &#x27;,&#x27; &#x2b; name from t3 WHERE candidateUserID &#x3d; a.candidateUserID FOR XML PATH &#x28;&#x27;&#x27;&#x29;&#x29;, 1, 1, &#x27;&#x27; &#x29; AS URLList FROM t3 AS a GROUP BY a.candidateUserID&#x29;&#xa;--select &#x2a; from t4&#xa;&#xa;------ Email -----&#xa;, tmp_1&#x28;userID, email&#x29; as &#x28;select userID, REPLACE&#x28;ISNULL&#x28;email,&#x27;&#x27;&#x29; &#x2b; &#x27;,&#x27; &#x2b; ISNULL&#x28;email2,&#x27;&#x27;&#x29; &#x2b; &#x27;,&#x27; &#x2b; ISNULL&#x28;email3,&#x27;&#x27;&#x29;, &#x27;,,&#x27;, &#x27;,&#x27;&#x29; as email from bullhorn1.BH_UserContact&#x29;&#xa;--select &#x2a; from tmp_1&#xa;--select userID, email, CHARINDEX&#x28;email,&#x27;,&#x27;,0&#x29; from tmp_1&#xa;, tmp_2&#x28;userID, email&#x29; as &#x28; select userID, CASE WHEN CHARINDEX&#x28;&#x27;,&#x27;,email,1&#x29; &#x3d; 1 THEN RIGHT&#x28;email, len&#x28;email&#x29;-1&#x29; ELSE email END as email from tmp_1&#x29;&#xa;, tmp_3&#x28;userID, email&#x29; as &#x28; select userID, CASE WHEN CHARINDEX&#x28;&#x27;,&#x27;,email,len&#x28;email&#x29;&#x29; &#x3d; len&#x28;email&#x29; THEN LEFT&#x28;email, CASE WHEN len&#x28;email&#x29; &#x3c; 1 THEN 0 ELSE len&#x28;email&#x29; - 1 END&#x29;	ELSE email END as email from tmp_2 &#x29;&#xa;--select &#x2a; from tmp_3&#xa;&#xa;----- Resume&#x27;s ID name -----&#xa;--, tmp_5 &#x28;candidateUserID, name&#x29; as &#x28;select a.candidateUserID, concat&#x28;a.candidateFileID, a.fileExtension&#x29; from bullhorn1.View_CandidateFile a where a.type &#x3d; &#x27;Resume&#x27;&#x29;&#xa;, tmp_5 &#x28;candidateUserID, name&#x29; as &#x28;select a.candidateUserID, concat&#x28;a.candidateFileID, a.fileExtension&#x29; from bullhorn1.View_CandidateFile a where a.type in &#x28;&#x27;CV&#x27;, &#x27;Resume&#x27;&#x29;&#x29;&#xa;--select &#x2a; from tmp_5 where candidateUserID &#x3d; 810&#xa;&#xa;, tmp_6&#x28;candidateUserID, ResumeId&#x29; as &#x28;SELECT candidateUserID, STUFF&#x28; &#x28;SELECT DISTINCT &#x27;,&#x27; &#x2b; name from tmp_5 WHERE candidateUserID &#x3d; a.candidateUserID FOR XML PATH &#x28;&#x27;&#x27;&#x29;&#x29;, 1, 1, &#x27;&#x27;&#x29; AS URLList FROM tmp_5 AS a GROUP BY a.candidateUserID&#x29;&#xa;--select &#x2a; from tmp_6 order by candidateUserID&#xa;&#xa;----- Email by CandidateID -----&#xa;, tmp_email_1 as &#x28;select c.candidateID, case &#xa;	when c.email is not null and c.email &#x3c;&#x3e; &#x27;&#x27; then c.email&#xa;	when c.email2 is not null and c.email2 &#x3c;&#x3e; &#x27;&#x27; then c.email2&#xa;	when c.email3 is not null and c.email3 &#x3c;&#x3e; &#x27;&#x27; then c.email3&#xa;	else &#x27;&#x27;	end as email from bullhorn1.Candidate c&#x29;&#xa;--select &#x2a; from tmp_email_1&#xa;--select email, count&#x28;&#x2a;&#x29; from tmp_email_1 group by email having count&#x28;&#x2a;&#x29; &#x3e; 1&#xa;, tmp_email_2 as &#x28;select email, min&#x28;candidateID&#x29; as candidateID from tmp_email_1 group by email&#x29;&#xa;--select &#x2a; from tmp_email_2&#xa;&#xa;----- Notes -----&#xa;, tmp_note&#x28;Userid, Notes&#x29; as &#x28;SELECT Userid,STUFF&#x28; &#x28;SELECT DISTINCT &#x27; &#x7c;&#x7c; &#x27; &#x2b; convert&#x28;varchar&#x28;10&#x29;, dateAdded, 120&#x29; &#x2b; &#x27;&#x3a; &#x27; &#x2b; cast&#x28;comments as varchar&#x28;max&#x29;&#x29; from  &#x5b;bullhorn1&#x5d;.&#x5b;BH_UserComment&#x5d; WHERE Userid &#x3d; a.Userid FOR XML PATH &#x28;&#x27;&#x27;&#x29;&#x29;, 1, 4, &#x27;&#x27;&#x29; &#xa;AS URLList FROM  &#x5b;bullhorn1&#x5d;.&#x5b;BH_UserComment&#x5d; AS a GROUP BY a.Userid&#x29;&#xa;--select &#x2a; from tmp_note&#xa;&#xa;&#xa;-----Skill-------&#xa;, skill0 &#x28;userid, skillIDList&#x29; as&#xa;&#x28;SELECT userid,LTRIM&#x28;RTRIM&#x28;m.n.value&#x28;&#x27;.&#x5b;1&#x5d;&#x27;,&#x27;varchar&#x28;8000&#x29;&#x27;&#x29;&#x29;&#x29; AS skillIDList &#xa;FROM &#x28;SELECT userid, CAST&#x28;&#x27;&#x3c;XMLRoot&#x3e;&#x3c;RowData&#x3e;&#x27; &#x2b; REPLACE&#x28;cast&#x28;skillIDList as varchar&#x28;max&#x29;&#x29;,&#x27;,&#x27;,&#x27;&#x3c;&#x2f;RowData&#x3e;&#x3c;RowData&#x3e;&#x27;&#x29; &#x2b; &#x27;&#x3c;&#x2f;RowData&#x3e;&#x3c;&#x2f;XMLRoot&#x3e;&#x27; AS XML&#x29; AS x FROM  bullhorn1.BH_UserContact CA where CA.status not like &#x27;&#x25;Archive&#x25;&#x27; and CA.status &#x3c;&#x3e; &#x27;&#x27; &#x29;t&#xa;CROSS APPLY x.nodes&#x28;&#x27;&#x2f;XMLRoot&#x2f;RowData&#x27;&#x29;m&#x28;n&#x29;&#xa;&#x29;&#xa;--select &#x2a; from skill0&#xa;--select cast&#x28;skillIDList as int&#x29; from skill0&#xa;&#xa;, skill1&#x28;userid, skillIDList&#x29; as &#x28;select distinct userid, cast&#x28;skillIDList as varchar&#x28;max&#x29;&#x29; from &#x28;select userid, skillIDList from skill0&#x29; a&#x29;&#xa;--select &#x2a; from skill1&#xa;&#xa;, skill2&#x28;userid, name&#x29; as &#x28;select skill1.userid, cast&#x28;BS.name as varchar&#x28;max&#x29;&#x29; from skill1 inner join bullhorn1.BH_SkillList BS ON skill1.skillIDList &#x3d; BS.skillID&#x29;&#xa;--select &#x2a; from t --where userid &#x3d; 3144 --order by userid &#xa;&#xa;, skill3&#x28;userid, name&#x29; as &#x28;SELECT userid, name &#x3d; &#xa;    STUFF&#x28;&#x28;SELECT DISTINCT &#x27;, &#x27; &#x2b; name&#xa;           FROM skill2 b &#xa;           WHERE b.userid &#x3d; a.userid &#xa;          FOR XML PATH&#x28;&#x27;&#x27;&#x29;&#x29;, 1, 2, &#x27;&#x27;&#x29;&#xa;FROM skill2 a&#xa;GROUP BY userid&#xa;&#x29;&#xa;&#xa;--select &#x2a; from skill3 --where userid &#x3d; 893 order by userid&#xa;----------------&#xa;&#xa;------------candidate-employeeType---------------&#xa;, employmentPreference0 &#x28;userid,employmentPreference&#x29; as &#x28;select userid,employmentPreference from bullhorn1.BH_UserContact&#x29;&#xa; --select &#x2a; from employeetype0&#xa;, employmentPreference1 &#x28;userid, employmentPreference&#x29; as&#xa;&#x28;SELECT userid,LTRIM&#x28;RTRIM&#x28;m.n.value&#x28;&#x27;.&#x5b;1&#x5d;&#x27;,&#x27;varchar&#x28;8000&#x29;&#x27;&#x29;&#x29;&#x29; AS employmentPreference &#xa;FROM &#x28;SELECT userid, CAST&#x28;&#x27;&#x3c;XMLRoot&#x3e;&#x3c;RowData&#x3e;&#x27; &#x2b; REPLACE&#x28;cast&#x28;employmentPreference as varchar&#x28;max&#x29;&#x29;,&#x27;,&#x27;,&#x27;&#x3c;&#x2f;RowData&#x3e;&#x3c;RowData&#x3e;&#x27;&#x29; &#x2b; &#x27;&#x3c;&#x2f;RowData&#x3e;&#x3c;&#x2f;XMLRoot&#x3e;&#x27; AS XML&#x29; AS x FROM  bullhorn1.BH_UserContact CA where CA.status not like &#x27;&#x25;Archive&#x25;&#x27; and CA.status &#x3c;&#x3e; &#x27;&#x27; &#x29;t&#xa;CROSS APPLY x.nodes&#x28;&#x27;&#x2f;XMLRoot&#x2f;RowData&#x27;&#x29;m&#x28;n&#x29;&#x29;&#xa;--select &#x2a; from employmentPreference1 &#xa;, employmentPreference2 as &#x28;select userid, employmentPreference, ROW_NUMBER &#x28;&#x29; OVER &#x28; PARTITION BY userid order by userid &#x29; as ord from employmentPreference1&#x29;&#xa;--select &#x2a; from employmentPreference2 where ord &#x3d; 1&#xa;&#xa;------------businessSector---------------&#xa;, category &#x28;categoryID,name&#x29; as &#x28;select categoryID,name from bullhorn1.BH_Category&#x29;&#xa;, tmp_businessSectorIDList1 &#x28;userid, BussinessID&#x29; as&#xa;&#x28;SELECT userid,LTRIM&#x28;RTRIM&#x28;m.n.value&#x28;&#x27;.&#x5b;1&#x5d;&#x27;,&#x27;varchar&#x28;8000&#x29;&#x27;&#x29;&#x29;&#x29; AS BussinessID &#xa;FROM &#x28;SELECT userid, CAST&#x28;&#x27;&#x3c;XMLRoot&#x3e;&#x3c;RowData&#x3e;&#x27; &#x2b; REPLACE&#x28;cast&#x28;businessSectorIDList as varchar&#x28;max&#x29;&#x29;,&#x27;,&#x27;,&#x27;&#x3c;&#x2f;RowData&#x3e;&#x3c;RowData&#x3e;&#x27;&#x29; &#x2b; &#x27;&#x3c;&#x2f;RowData&#x3e;&#x3c;&#x2f;XMLRoot&#x3e;&#x27; AS XML&#x29; AS x FROM  bullhorn1.BH_UserContact CA where CA.status not like &#x27;&#x25;Archive&#x25;&#x27; and CA.status &#x3c;&#x3e; &#x27;&#x27; &#x29;t&#xa;CROSS APPLY x.nodes&#x28;&#x27;&#x2f;XMLRoot&#x2f;RowData&#x27;&#x29;m&#x28;n&#x29;&#xa;&#x29;&#xa;--select cast&#x28;BussinessID as int&#x29; from tmp_businessSectorIDList1&#xa;&#xa;, tmp_businessSectorIDList2&#x28;userid, bussinesid&#x29; as &#x28;select distinct userid, cast&#x28;BussinessID as varchar&#x28;max&#x29;&#x29; from &#x28;select userid, BussinessID from tmp_businessSectorIDList1&#x29; a&#x29;&#xa;--select &#x2a; from tmp_businessSectorIDList2&#xa;--, t1&#x28;userId, IndustryName&#x29; as &#x28;select tmp_1.userid, BS.name from tmp_1 inner join bullhorn1.BH_BusinessSector BS ON tmp_1.bussinesid &#x3d; BS.businessSectorID&#x29;&#xa;--, t1&#x28;userid, name, bussinesid&#x29; as &#x28;select tmp_businessSectorIDList2.userid, BS.name, tmp_businessSectorIDList2.bussinesid from tmp_businessSectorIDList2 inner join bullhorn1.BH_BusinessSector BS ON tmp_businessSectorIDList2.bussinesid &#x3d; BS.businessSectorID&#x29;&#xa;--, t1&#x28;userid,name,bussinesid&#x29; as &#x28;select tmp_businessSectorIDList2.userid, BS.name, tmp_businessSectorIDList2.bussinesid from tmp_businessSectorIDList2 inner join bullhorn1.BH_BusinessSector BS ON tmp_businessSectorIDList2.bussinesid &#x3d; BS.businessSectorID&#x29;&#xa;--select &#x2a; from t1 order by userid&#xa;, t&#x28;userid, name&#x29; as &#x28;select tmp_businessSectorIDList2.userid, cast&#x28;BS.name as varchar&#x28;max&#x29;&#x29; from tmp_businessSectorIDList2 inner join bullhorn1.BH_BusinessSector BS ON tmp_businessSectorIDList2.bussinesid &#x3d; BS.businessSectorID&#x29;&#xa;--select &#x2a; from t where userid &#x3d; 3144 --order by userid &#xa;&#xa;, tmp_businessSectorIDList3&#x28;userid, name&#x29; as &#x28;SELECT userid, name &#x3d; &#xa;    STUFF&#x28;&#x28;SELECT DISTINCT &#x27;, &#x27; &#x2b; name&#xa;           FROM t b &#xa;           WHERE b.userid &#x3d; a.userid &#xa;          FOR XML PATH&#x28;&#x27;&#x27;&#x29;&#x29;, 1, 2, &#x27;&#x27;&#x29;&#xa;FROM t a&#xa;GROUP BY userid&#xa;&#x29;&#xa;--select &#x2a; from tmp_businessSectorIDList3 where userid &#x3d; 893&#xa;--select &#x2a; from tmp_businessSectorIDList3 order by userid&#xa;&#xa;----------------------------&#xa;, note as &#x28;select &#xa;ca.candidateid &#xa;--, case when &#x28;ca.comments &#x3d; &#x27;&#x27; OR ca.comments is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Notes&#x3a; &#x27;,ca.comments,char&#x28;10&#x29;&#x29; END  as &#x27;comments&#x27;&#xa;, case when &#x28;ISNULL&#x28;REPLACE&#x28;cast&#x28;ca.comments as nvarchar&#x28;max&#x29;&#x29;,CHAR&#x28;13&#x29;,&#x27;&#x27;&#x29;, &#x27;&#x27;&#x29; &#x3d; &#x27;&#x27;&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Notes&#x3a; &#x27;,ca.comments&#x29; END as &#x27;comments&#x27;&#xa;&#xa;, case when &#x28;ca.employeeType &#x3d; &#x27;&#x27; OR ca.employeeType is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Employment Type &#x2f; Job Type&#x3a; &#x27;,ca.employeeType,char&#x28;10&#x29;&#x29; END as &#x27;employeeType&#x27;&#xa;, case when &#x28;cast&#x28;tmp_businessSectorIDList3.name as varchar&#x28;max&#x29;&#x29; &#x3d; &#x27;&#x27; OR tmp_businessSectorIDList3.name is NULL&#x29; THEN &#x27;&#x27; ELSE REPLACE&#x28;REPLACE&#x28;concat&#x28;&#x27;Industry&#x3a; &#x27;,tmp_businessSectorIDList3.name,char&#x28;10&#x29;&#x29;, &#x27;&#x26;amp&#x3b;&#x27;, &#x27;&#x26;&#x27;&#x29;, &#x27;amp&#x3b;&#x27;, &#x27;&#x27;&#x29; END as &#x27;Industry&#x27;&#xa;, case when &#x28;t1.name &#x3d; &#x27;&#x27; OR t1.name is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Functional Expertise&#x3a; &#x27;,t1.name,char&#x28;10&#x29;&#x29; END as &#x27;categoryname&#x27;&#xa;--, case when &#x28;uc.specialtyIDList &#x3d; &#x27;&#x27; OR uc.specialtyIDList is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Sub functional expertise&#x3a; &#x27;,uc.specialtyIDList,char&#x28;10&#x29;&#x29; END as &#x27;uc.specialtyIDList&#x27;&#xa;, case when &#x28;ISNULL&#x28;REPLACE&#x28;cast&#x28;uc.specialtyIDList as nvarchar&#x28;max&#x29;&#x29;,CHAR&#x28;13&#x29;,&#x27;&#x27;&#x29;, &#x27;&#x27;&#x29; &#x3d; &#x27;&#x27;&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Sub functional expertise&#x3a; &#x27;,uc.specialtyIDList&#x29; END as &#x27;specialtyIDList&#x27;&#xa;&#xa;--, case when &#x28;uc.skillIDList &#x3d; &#x27;&#x27; OR uc.skillIDList is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Skills&#x3a; &#x27;,uc.skillIDList,char&#x28;10&#x29;&#x29; END as &#x27;uc.skillIDList&#x27;&#xa;--, case when &#x28;ISNULL&#x28;REPLACE&#x28;cast&#x28;uc.skillIDList as nvarchar&#x28;max&#x29;&#x29;,CHAR&#x28;13&#x29;,&#x27;&#x27;&#x29;, &#x27;&#x27;&#x29; &#x3d; &#x27;&#x27;&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Skills&#x3a; &#x27;,uc.skillIDList&#x29; END as &#x27;skillIDList&#x27;&#xa;&#xa;, case when &#x28;uc.employmentPreference &#x3d; &#x27;&#x27; OR uc.employmentPreference is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Desired Industry&#x3a; &#x27;,uc.employmentPreference,char&#x28;10&#x29;&#x29; END as &#x27;employmentPreference&#x27;&#xa;&#xa;--, case when &#x28;uc.customTextBlock1 &#x3d; &#x27;&#x27; OR uc.customTextBlock1 is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Skills&#x3a; &#x27;,uc.customTextBlock1,char&#x28;10&#x29;&#x29; END as &#x27;uc.customTextBlock1&#x27;&#xa;, case when &#x28;ISNULL&#x28;REPLACE&#x28;cast&#x28;uc.customTextBlock1 as nvarchar&#x28;max&#x29;&#x29;,CHAR&#x28;13&#x29;,&#x27;&#x27;&#x29;, &#x27;&#x27;&#x29; &#x3d; &#x27;&#x27;&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Skills&#x3a; &#x27;,uc.customTextBlock1&#x29; END as &#x27;customTextBlock1&#x27;&#xa;&#xa;--, case when &#x28;uc.skillSet &#x3d; &#x27;&#x27; OR uc.skillSet is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Skills&#x3a; &#x27;,uc.skillSet,char&#x28;10&#x29;&#x29; END as &#x27;uc.skillSet&#x27;&#xa;, case when &#x28;ISNULL&#x28;REPLACE&#x28;cast&#x28;uc.skillSet as nvarchar&#x28;max&#x29;&#x29;,CHAR&#x28;13&#x29;,&#x27;&#x27;&#x29;, &#x27;&#x27;&#x29; &#x3d; &#x27;&#x27;&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Skills&#x3a; &#x27;,uc.skillSet&#x29; END as &#x27;skillSet&#x27;&#xa;&#xa;, case when &#x28;uc.customText4 &#x3d; &#x27;&#x27; OR uc.customText4 is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Candidate picker&#x3a; &#x27;,uc.customText4,char&#x28;10&#x29;&#x29; END as &#x27;customText4&#x27;&#xa;, case when &#x28;uc.customtext1 &#x3d; &#x27;&#x27; OR uc.customtext1 is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Customtext1&#x3a; &#x27;,uc.customtext1,char&#x28;10&#x29;&#x29; END as &#x27;customtext1&#x27;&#xa;, case when &#x28;uc.fax &#x3d; &#x27;&#x27; OR uc.fax is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Skype ID&#x3a; &#x27;,uc.fax,char&#x28;10&#x29;&#x29; END as &#x27;fax&#x27;&#xa;, case when &#x28;uc.customtext11 &#x3d; &#x27;&#x27; OR uc.customtext11 is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;We ve Met&#x3a; &#x27;,uc.customtext11,char&#x28;10&#x29;&#x29; END as &#x27;customtext11&#x27;&#xa;, case when &#x28;ca.type &#x3d; &#x27;&#x27; OR ca.type is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Representation Commitment&#x3a; &#x27;,ca.type,char&#x28;10&#x29;&#x29; END as &#x27;type&#x27;&#xa;, case when &#x28;ca.status &#x3d; &#x27;&#x27; OR ca.status is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Active&#x2f;Passive and general VC Pipeline&#x3a; &#x27;,ca.status,char&#x28;10&#x29;&#x29; END as &#x27;status&#x27;&#xa;, case when &#x28;ca.candidateSourceID &#x3d; &#x27;&#x27; OR ca.candidateSourceID is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Subjective Assessment&#x3a; &#x27;,ca.candidateSourceID,char&#x28;10&#x29;&#x29; END as &#x27;candidateSourceID&#x27;&#xa;, case when &#x28;uc.workAuthorized &#x3d; &#x27;&#x27; OR uc.workAuthorized is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Valid work permit&#x3a; &#x27;,uc.workAuthorized,char&#x28;10&#x29;&#x29; END as &#x27;workAuthorized&#x27;&#xa;, case when &#x28;uc.customtext10 &#x3d; &#x27;&#x27; OR uc.customtext10 is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Will relocate&#x3a; &#x27;,uc.customtext10,char&#x28;10&#x29;&#x29; END as &#x27;customtext10&#x27;&#xa;, case when &#x28;ISNULL&#x28;REPLACE&#x28;cast&#x28;uc.desiredLocations as nvarchar&#x28;max&#x29;&#x29;,CHAR&#x28;13&#x29;,&#x27;&#x27;&#x29;, &#x27;&#x27;&#x29; &#x3d; &#x27;&#x27;&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Work Aspirations Desired locations&#x3a; &#x27;,uc.desiredLocations&#x29; END as &#x27;desiredLocations&#x27;&#xa;, case when &#x28;uc.hourlyRateLow &#x3d; &#x27;&#x27; OR uc.hourlyRateLow is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Contract rate&#x3a; &#x27;,uc.hourlyRateLow,char&#x28;10&#x29;&#x29; END as &#x27;hourlyRateLow&#x27;&#xa;, case when &#x28;uc.hourlyRate &#x3d; &#x27;&#x27; OR uc.hourlyRate is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Desired contract rate&#x3a; &#x27;,uc.hourlyRate,char&#x28;10&#x29;&#x29; END as &#x27;hourlyRate&#x27;&#xa;--, case when &#x28;uc.description &#x3d; &#x27;&#x27; OR uc.description is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Original CV&#x3a; &#x27;,uc.description,char&#x28;10&#x29;&#x29; END as &#x27;uc.description&#x27;&#xa;, case when &#x28;ISNULL&#x28;REPLACE&#x28;cast&#x28;uc.description as nvarchar&#x28;max&#x29;&#x29;,CHAR&#x28;13&#x29;,&#x27;&#x27;&#x29;, &#x27;&#x27;&#x29; &#x3d; &#x27;&#x27;&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Original CV&#x3a; &#x27;,uc.description&#x29; END as &#x27;description&#x27;&#xa;, case when &#x28;uc.customtext2 &#x3d; &#x27;&#x27; OR uc.customtext2 is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;School name&#x3a; &#x27;,uc.customtext2,char&#x28;10&#x29;&#x29; END as &#x27;customtext2&#x27;&#xa;, case when &#x28;uc.referredByUserID &#x3d; &#x27;&#x27; OR uc.referredByUserID is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Referral Source&#x3a; &#x27;,uc.referredByUserID,char&#x28;10&#x29;&#x29; END as &#x27;referredByUserID&#x27;&#xa;	from bullhorn1.BH_Candidate ca&#xa;	left join bullhorn1.BH_UserContact UC on ca.recruiterUserID &#x3d; uc.userID&#xa;	left join tmp_businessSectorIDList3 ON uc.userid &#x3d; tmp_businessSectorIDList3.userid&#xa;	left join category t1 ON UC.categoryID &#x3d; t1.categoryID&#xa;  &#x29;&#xa;&#xa;--select &#x2a; from note&#xa;--select candidateid,count&#x28;&#x2a;&#x29; from notes group by candidateid having count&#x28;&#x2a;&#x29; &#x3e; 1&#xa;, notes as &#x28;select candidateid, concat&#x28;comments,employeeType,Industry,categoryname,specialtyIDList,employmentPreference,customTextBlock1,skillSet,customText4,customtext1,fax,customtext11,type,status,candidateSourceID,workAuthorized,customtext10,desiredLocations,hourlyRateLow,hourlyRate,description,customtext2,referredByUserID&#x29; as &#x27;candidate-note&#x27; from note&#x29;&#xa;--select &#x2a; from notes&#xa;--select jobPostingID, count&#x28;&#x2a;&#x29; from tmp_6 group by jobPostingID having count&#x28;&#x2a;&#x29; &#x3e; 1&#xa;&#xa;------------------&#xa;, t1 as &#x28;select C.userID --NO CandidateID &#x3d; UserContact ID&#xa;	, case C.gender when &#x27;M&#x27; then &#x27;MR&#x27; when &#x27;F&#x27; then &#x27;MS&#x27; else &#x27;&#x27; end as &#x27;candidate-title&#x27;&#xa;	, C.candidateID as &#x27;candidate-externalId&#x27; --NO&#xa;	, C.firstName as &#x27;candidate-firstName&#x27;&#xa;	, C.&#x5b;lastName&#x5d; as &#x27;candidate-Lastname&#x27;&#xa;	, C.middleName as &#x27;candidate-middleName&#x27;&#xa;	, CONVERT&#x28;VARCHAR&#x28;10&#x29;,C.dateOfBirth,110&#x29; as &#x27;candidate-dob&#x27;&#xa;	, CASE WHEN &#x28;tc.abbreviation &#x3d; &#x27;NONE&#x27; OR tc.abbreviation &#x3d; &#x27;NULL&#x27;&#x29; THEN &#x27;&#x27; ELSE tc.abbreviation END as &#x27;candidate-citizenship&#x27;&#xa;	, REPLACE&#x28;REPLACE&#x28;case &#xa;		when &#x28;C.email is not null and C.email &#x3c;&#x3e; &#x27;&#x27; and C.email like &#x27;&#x25;&#x40;&#x25;&#x27;&#x29; then C.email&#xa;		when &#x28;C.email2 is not null and C.email2 &#x3c;&#x3e; &#x27;&#x27; and C.email2 like &#x27;&#x25;&#x40;&#x25;&#x27;&#x29; then C.email2&#xa;		when &#x28;C.email3 is not null and C.email3 &#x3c;&#x3e; &#x27;&#x27; and C.email3 like &#x27;&#x25;&#x40;&#x25;&#x27;&#x29; then C.email3&#xa;		else &#x27;&#x27;	end, &#x27;&#x3f;&#x27;, &#x27;&#x27;&#x29;, &#x27; &#x27;, &#x27;&#x27;&#x29; as &#x27;candidate-email&#x27;&#xa;	, C.mobile as &#x27;candidate-mobile&#x27;&#xa;	, C.phone as &#x27;candidate-phone&#x27;	&#xa;	, C.workPhone as &#x27;candidate-workPhone&#x27;&#xa;	, concat&#x28;C.address1,&#x27; &#x27;,C.address2&#x29; as &#x27;candidate-address&#x27;&#xa;	, C.city as &#x27;candidate-city&#x27;&#xa;	, C.state as &#x27;candidate-state&#x27;&#xa;	, C.zip as &#x27;candidate-zipCode&#x27;&#xa;	, CASE WHEN &#x28;tc.abbreviation &#x3d; &#x27;NONE&#x27; OR tc.abbreviation &#x3d; &#x27;NULL&#x27;&#x29; THEN &#x27;&#x27; ELSE tc.abbreviation END as &#x27;candidate-Country&#x27;&#xa;	, C.salaryLow as &#x27;candidate-currentSalary&#x27;&#xa;	, C.salary as &#x27;candidate-desiredSalary&#x27;&#xa;&#xa;	--, case when &#x28;c.employeeType &#x3d; &#x27;&#x27; OR c.employeeType is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Employment Type &#x2f; Job Type&#x3a; &#x27;,c.employeeType,char&#x28;10&#x29;&#x29; END as &#x27;candidate-employeeType&#x27;&#xa;	--, UPPER&#x28;C.employmentPreference&#x29; as  &#x27;candidate-type&#x27;&#xa;	, UPPER&#x28;REPLACE&#x28;REPLACE&#x28;REPLACE&#x28;REPLACE&#x28;REPLACE&#x28;REPLACE&#x28;tmp_EP.employmentPreference,&#x27;Permanent&#x27;,&#x27;FULL_TIME&#x27;&#x29;,&#x27;Freelance&#x27;,&#x27;PART_TIME&#x27;&#x29;,&#x27;Part-time&#x27;,&#x27;PART_TIME&#x27;&#x29;,&#x27;Contract&#x27;,&#x27;CASUAL&#x27;&#x29;,&#x27;Remote&#x27;,&#x27;CASUAL&#x27;&#x29;,&#x27;Owner&#x2f;Partner&#x27;,&#x27;CASUAL&#x27;&#x29;&#x29; as &#x27;candidate-employmentPreference&#x27;&#xa;	, skill3.name as &#x27;skills&#x27;	&#xa;	, UE.&#x5b;school&#x5d; as &#x27;candidate-schoolName&#x27; --NO&#xa;	, CONVERT&#x28;VARCHAR&#x28;10&#x29;,UE.graduationDate,110&#x29; as &#x27;candidate-graduationDate&#x27; --NO&#xa;	, UE.&#x5b;degree&#x5d; as &#x27;candidate-degreeName&#x27; --NO&#xa;	, UE.&#x5b;gpa&#x5d; as &#x27;candidate-gpa&#x27; --NO&#xa;	, C.companyName as &#x27;candidate-company1&#x27;&#xa;	--, C.companyName as &#x27;candidate-employer1&#x27;&#xa;	, C.occupation as &#x27;candidate-jobTitle1&#x27;&#xa;	--, C.recruiterUserID&#xa;	, t3.email as &#x27;candidate-owners&#x27; --NO&#xa;	, t4.finame as &#x27;candidate-resume-filename&#x27; --filename --NO&#xa;	, tmp_6.ResumeId as &#x27;candidate-resume&#x27; --IDname --NO&#xa;	--, C.comments as &#x27;candidate-note&#x27;&#xa;	, replace&#x28;left&#x28;cast&#x28;tmp_note.Notes as varchar&#x28;max&#x29;&#x29;,30000&#x29;,&#x27;&#x26;&#x23;x0D&#x3b;&#x27;,&#x27;&#x27;&#x29; as &#x27;candidate-comments&#x27;&#xa;from bullhorn1.Candidate C&#xa;left join tmp_country tc ON C.countryID &#x3d; tc.code&#xa;left join bullhorn1.BH_UserContact UC on C.userID &#x3d; UC.userID&#xa;--left join bullhorn1.BH_JobPosting JP ON C.recruiterUserID &#x3d; JP.userID&#xa;--left join bullhorn1.BH_Client Cl ON UC.userID &#x3d; Cl.userID&#xa;&#xa;left join tmp_3 t3 ON C.recruiterUserID &#x3d; t3.userID&#xa;left join &#x28;select userID, min&#x28;userEducationID&#x29; as userEducationID from &#x5b;bullhorn1&#x5d;.&#x5b;BH_UserEducation&#x5d; group by userID&#x29; UE_2 on C.userID &#x3d; UE_2.userID&#xa;left join employmentPreference2 tmp_EP on uc.userID &#x3d; tmp_EP.userid&#xa;left join &#x28;select &#x2a; from &#x5b;bullhorn1&#x5d;.&#x5b;BH_UserEducation&#x5d; where isDeleted &#x3d; 0&#x29; UE on UE.userEducationID &#x3d; UE_2.userEducationID&#xa;&#xa;left join t4 on C.userID &#x3d; t4.candidateUserID --5861 line&#xa;left join tmp_6 on C.userID &#x3d; tmp_6.candidateUserID&#xa;left join tmp_note on C.userID &#x3d; tmp_note.Userid&#xa;left join skill3 on UC.userID &#x3d; skill3.userid&#xa;--inner join bullhorn1.BH_UserContact UC_2 on C.recruiterUserID &#x3d; UC_2.userID&#xa;--left join bullhorn1.BH_ClientCorporation CC ON CC.clientCorporationID &#x3d; C.clientCorporationID&#xa;where C.status not like &#x27;&#x25;Archive&#x25;&#x27; and tmp_EP.ord &#x3d; 1&#xa;&#x29;&#xa;&#xa;&#xa;&#xa;select t1.&#x2a;,notes.&#x5b;candidate-note&#x5d; from t1 left join notes on t1.&#x5b;candidate-externalId&#x5d; &#x3d; notes.candidateID&#xa;--select t1.&#x2a; from t1 --inner join tmp_email_2 on t1.&#x5b;candidate-externalId&#x5d; &#x3d; tmp_email_2.candidateID order by userID&#xa;&#xa;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>464</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Company</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <connection>export</connection>
    <sql>with &#xa;tmp1 as &#x28;&#xa;select CC.clientCorporationID&#xa;--, case when &#x28;CC.dateAdded &#x3d; &#x27;&#x27; OR CC.dateAdded is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Date Added&#x3a; &#x27;,left&#x28;convert&#x28;varchar,CC.dateAdded,110&#x29;,10&#x29;&#x29; END as DateAdded&#xa;, case when &#x28;cast&#x28;CC.notes as varchar&#x28;max&#x29;&#x29; &#x3d; &#x27;&#x27; OR CC.notes is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Company Notes&#x3a; &#x27;,CC.notes&#x29; END as CompanyNotes&#xa;, case when &#x28;cast&#x28;CC.companyDescription as varchar&#x28;max&#x29;&#x29; &#x3d; &#x27;&#x27; OR CC.companyDescription is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Company Description&#x3a;&#x27;, ltrim&#x28;rtrim&#x28;&#x5b;dbo&#x5d;.&#x5b;udf_StripHTML&#x5d;&#x28;CC.companyDescription&#x29;&#x29;&#x29;&#x29; END as CompanyDescription&#xa;, case when &#x28;CC.status &#x3d; &#x27;&#x27; OR CC.status is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Status&#x3a; &#x27;,CC.status&#x29; END as Status1&#xa;, case when &#x28;cast&#x28;CC.businessSectorList as varchar&#x28;max&#x29;&#x29; &#x3d; &#x27;&#x27; OR CC.businessSectorList is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;BusinessSectorList&#x3a; &#x27;,CC.businessSectorList&#x29; END as BusinessSectorList&#xa;--, CC.feeArrangement&#xa;--, CC.culture as Culture&#xa;--, cc.billingContact as BillingContact&#xa;--, case when &#x28;CC.customText2 &#x3d; &#x27;&#x27; OR CC.customText2 is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;CustomText2&#x3a; &#x27;,CC.customText2&#x29; END as customText2&#xa;--, cc.customText3 as customText3&#xa;from bullhorn1.BH_ClientCorporation CC&#x29;&#xa;--select &#x2a; from tmp1&#xa;&#xa;--, tmp2 as &#x28;select clientCorporationID,concat&#x28;CompanyNotes,char&#x28;10&#x29;,CompanyDescription,char&#x28;10&#x29;,Status1,char&#x28;10&#x29;,Culture,char&#x28;10&#x29;,BillingContact,char&#x28;10&#x29;,customText2,char&#x28;10&#x29;,customText3,char&#x28;10&#x29;&#x29; as CombinedNote from tmp1&#x29;&#xa;, tmp2 as &#x28;select clientCorporationID,concat&#x28;CompanyNotes,char&#x28;10&#x29;,CompanyDescription,char&#x28;10&#x29;,Status1,char&#x28;10&#x29;,BusinessSectorList,char&#x28;10&#x29;&#x29; as CombinedNote from tmp1&#x29;&#xa;--select &#x2a; from tmp2&#xa;&#xa;select CC.name as &#x27;company-name&#x27;&#xa;, CC.clientCorporationID as &#x27;company-externalId&#x27;&#xa;, CC.countryID&#xa;, CASE WHEN &#x28;tc.abbreviation &#x3d; &#x27;NONE&#x27; OR tc.abbreviation &#x3d; &#x27;NULL&#x27;&#x29; THEN &#x27;&#x27; ELSE tc.abbreviation END as &#x27;company-locationCountry&#x27;&#xa;--, CC.status&#xa;, CC.parentClientCorporationID&#xa;, CC.companyURL as &#x27;company-URL&#x27;&#xa;--, CC.businessSectorList&#xa;, CC.culture&#xa;--, CC.notes&#xa;--, CC.companyDescription&#xa;, CC.feeArrangement&#xa;, CC.customText2&#xa;, CC.phone as &#x27;company-phone&#x27;&#xa;, concat&#x28;CC.address1,char&#x28;10&#x29;,CC.address2,char&#x28;10&#x29;&#x29; as &#x27;company-locationAddress&#x27;&#xa;, concat&#x28;city,char&#x28;10&#x29;,state,char&#x28;10&#x29;&#x29; as &#x27;company-locationName&#x27;&#xa;, CC.city as &#x27;company-locationCity&#x27;&#xa;, CC.state as &#x27;company-locationState&#x27;&#xa;, CC.zip as &#x27;company-locationZipCode&#x27;&#xa;--, cc.billingContact&#xa;--, cc.customText3&#xa;, tmp2.CombinedNote as &#x27;company-note&#x27;&#xa;from bullhorn1.BH_ClientCorporation CC&#xa;left join tmp_country tc ON CC.countryID &#x3d; tc.code&#xa;left join tmp2 on CC.clientCorporationID &#x3d; tmp2.clientCorporationID&#xa;where CC.name like &#x27;&#x25;Imported Contacts&#x25;&#x27; or CC.status like &#x27;&#x25;Archive&#x25;&#x27; -- order by name</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>128</xloc>
      <yloc>48</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Company 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <connection>export</connection>
    <sql>with &#xa;tmp1 as &#x28;&#xa;select CC.clientCorporationID&#xa;--, case when &#x28;CC.dateAdded &#x3d; &#x27;&#x27; OR CC.dateAdded is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Date Added&#x3a; &#x27;,left&#x28;convert&#x28;varchar,CC.dateAdded,110&#x29;,10&#x29;&#x29; END as DateAdded&#xa;, case when &#x28;cast&#x28;CC.notes as varchar&#x28;max&#x29;&#x29; &#x3d; &#x27;&#x27; OR CC.notes is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Company Notes&#x3a; &#x27;,CC.notes&#x29; END as CompanyNotes&#xa;, case when &#x28;cast&#x28;CC.companyDescription as varchar&#x28;max&#x29;&#x29; &#x3d; &#x27;&#x27; OR CC.companyDescription is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Company Description&#x3a;&#x27;, ltrim&#x28;rtrim&#x28;&#x5b;dbo&#x5d;.&#x5b;udf_StripHTML&#x5d;&#x28;CC.companyDescription&#x29;&#x29;&#x29;&#x29; END as CompanyDescription&#xa;, case when &#x28;CC.status &#x3d; &#x27;&#x27; OR CC.status is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Status&#x3a; &#x27;,CC.status&#x29; END as Status1&#xa;, CC.culture as Culture&#xa;, cc.billingContact as BillingContact&#xa;, case when &#x28;CC.customText2 &#x3d; &#x27;&#x27; OR CC.customText2 is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;CustomText2&#x3a; &#x27;,CC.customText2&#x29; END as customText2&#xa;, cc.customText3 as customText3&#xa;from bullhorn1.BH_ClientCorporation CC&#x29;&#xa;--select &#x2a; from tmp1&#xa;&#xa;, tmp2 as &#x28;select clientCorporationID,concat&#x28;CompanyNotes,char&#x28;10&#x29;,CompanyDescription,char&#x28;10&#x29;,Status1,char&#x28;10&#x29;,Culture,char&#x28;10&#x29;,BillingContact,char&#x28;10&#x29;,customText2,char&#x28;10&#x29;,customText3,char&#x28;10&#x29;&#x29; as CombinedNote from tmp1&#x29;&#xa;--select &#x2a; from tmp2&#xa;&#xa;select CC.clientCorporationID as &#x27;company-externalId&#x27;&#xa;, CC.name as &#x27;company-name&#x27;&#xa;--, CC.countryID&#xa;, CASE WHEN &#x28;tc.abbreviation &#x3d; &#x27;NONE&#x27; OR tc.abbreviation &#x3d; &#x27;NULL&#x27;&#x29; THEN &#x27;&#x27; ELSE tc.abbreviation END as &#x27;company-locationCountry&#x27;&#xa;, CC.status&#xa;, CC.parentClientCorporationID&#xa;, CC.companyURL as &#x27;company-URLwebsite&#x27;&#xa;, CC.businessSectorList&#xa;, CC.culture&#xa;, CC.notes&#xa;, CC.companyDescription&#xa;, CC.feeArrangement&#xa;, CC.customText2&#xa;, CC.phone as &#x27;company-phone&#x27;&#xa;, CC.address1 as &#x27;company-locationAddress1&#x27;&#xa;, CC.address2 as &#x27;company-locationAddress2&#x27;&#xa;, CC.city as &#x27;company-locationCity&#x27;&#xa;, CC.state as &#x27;company-locationState&#x27;&#xa;, CC.zip as &#x27;company-locationZipCode&#x27;&#xa;, cc.billingContact&#xa;, cc.customText3&#xa;, tmp2.CombinedNote as &#x27;company-note&#x27;&#xa;from bullhorn1.BH_ClientCorporation CC&#xa;left join tmp_country tc ON CC.countryID &#x3d; tc.code&#xa;left join tmp2 on CC.clientCorporationID &#x3d; tmp2.clientCorporationID&#xa;where CC.name not like &#x27;&#x25;Imported Contacts&#x25;&#x27; and CC.status not like &#x27;&#x25;Archive&#x25;&#x27; order by name</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>128</xloc>
      <yloc>240</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Contact</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <connection>export</connection>
    <sql>&#xa;with &#xa;tmp_1&#x28;userID, email&#x29; as &#x28;select userID, REPLACE&#x28;ISNULL&#x28;email,&#x27;&#x27;&#x29; &#x2b; &#x27;,&#x27; &#x2b; ISNULL&#x28;email2,&#x27;&#x27;&#x29; &#x2b; &#x27;,&#x27; &#x2b; ISNULL&#x28;email3,&#x27;&#x27;&#x29;, &#x27;,,&#x27;, &#x27;,&#x27;&#x29; as email from bullhorn1.BH_UserContact &#x29;&#xa;--select &#x2a; from tmp_1&#xa;--select userID, email, CHARINDEX&#x28;email,&#x27;,&#x27;,0&#x29; from tmp_1 &#xa;&#xa;, tmp_2&#x28;userID, email&#x29; as &#x28;select userID, CASE WHEN CHARINDEX&#x28;&#x27;,&#x27;,email,1&#x29; &#x3d; 1 THEN RIGHT&#x28;email, len&#x28;email&#x29;-1&#x29;	ELSE email END as email from tmp_1&#x29;&#xa;&#xa;, tmp_3&#x28;userID, email&#x29; as &#x28;select userID, CASE WHEN CHARINDEX&#x28;&#x27;,&#x27;,email,len&#x28;email&#x29;&#x29; &#x3d; len&#x28;email&#x29; THEN LEFT&#x28;email, CASE WHEN len&#x28;email&#x29; &#x3c; 1 THEN 0 ELSE len&#x28;email&#x29; - 1 END&#x29;	ELSE email END as email from tmp_2&#x29;&#xa;&#xa;, tmp_4&#x28;userID, Notes&#x29; as &#x28;SELECT userID, STUFF&#x28;&#xa;    &#x28;SELECT &#x27; &#x7c;&#x7c; &#x27; &#x2b; &#x27;Action&#x3a; &#x27; &#x2b; action &#x2b; &#x27; &#x7c;&#x7c; &#x27; &#x2b; convert&#x28;varchar&#x28;10&#x29;, dateAdded, 120&#x29; &#x2b; &#x27;&#x3a; &#x27; &#x2b; cast&#x28;comments as varchar&#x28;max&#x29;&#x29;&#xa;     from &#x5b;bullhorn1&#x5d;.&#x5b;BH_UserComment&#x5d; WHERE userID &#x3d; a.userID FOR XML PATH &#x28;&#x27;&#x27;&#x29;&#x29;, 1, 4, &#x27;&#x27;&#x29;  AS URLList&#xa;FROM  &#x5b;bullhorn1&#x5d;.&#x5b;BH_UserComment&#x5d; AS a GROUP BY a.userID&#x29;&#xa;--select &#x2a; from tmp_4&#xa;&#xa;&#xa;&#xa;, tmp_7&#x28;userid, recruiterUserID&#x29; as &#x28;select userid, recruiterUserID from bullhorn1.BH_Client&#x29;&#xa;--select &#x2a; from tmp_7&#xa;&#xa;--, tmp_8&#x28;userid, recruiterUserID, email&#x29; as &#x28;select UC.userid, tmp_7.recruiterUserID, UC.email from bullhorn1.BH_UserContact UC left join tmp_7 ON UC.userID &#x3d; tmp_7.recruiterUserID&#x29;&#xa;, tmp_8&#x28;userid, recruiterUserID_email&#x29; as &#x28;select distinct UC.userid, UC.email from bullhorn1.BH_UserContact UC left join tmp_7 ON UC.userID &#x3d; tmp_7.recruiterUserID&#x29;&#xa;--select &#x2a; from tmp_8&#xa;&#xa;----------------------------&#xa;, tmp_businessSectorIDList1 &#x28;userid, BussinessID&#x29; as&#xa;&#x28;SELECT userid,LTRIM&#x28;RTRIM&#x28;m.n.value&#x28;&#x27;.&#x5b;1&#x5d;&#x27;,&#x27;varchar&#x28;8000&#x29;&#x27;&#x29;&#x29;&#x29; AS BussinessID &#xa;FROM &#x28;SELECT userid, CAST&#x28;&#x27;&#x3c;XMLRoot&#x3e;&#x3c;RowData&#x3e;&#x27; &#x2b; REPLACE&#x28;cast&#x28;businessSectorIDList as varchar&#x28;max&#x29;&#x29;,&#x27;,&#x27;,&#x27;&#x3c;&#x2f;RowData&#x3e;&#x3c;RowData&#x3e;&#x27;&#x29; &#x2b; &#x27;&#x3c;&#x2f;RowData&#x3e;&#x3c;&#x2f;XMLRoot&#x3e;&#x27; AS XML&#x29; AS x FROM  bullhorn1.BH_UserContact CA where CA.status not like &#x27;&#x25;Archive&#x25;&#x27; and CA.status &#x3c;&#x3e; &#x27;&#x27; &#x29;t&#xa;CROSS APPLY x.nodes&#x28;&#x27;&#x2f;XMLRoot&#x2f;RowData&#x27;&#x29;m&#x28;n&#x29;&#xa;&#x29;&#xa;--select cast&#x28;BussinessID as int&#x29; from tmp_businessSectorIDList1&#xa;&#xa;, tmp_businessSectorIDList2&#x28;userid, bussinesid&#x29; as &#x28;select distinct userid, cast&#x28;BussinessID as varchar&#x28;max&#x29;&#x29; from &#x28;select userid, BussinessID from tmp_businessSectorIDList1&#x29; a&#x29;&#xa;--select &#x2a; from tmp_businessSectorIDList2&#xa;&#xa;--, t1&#x28;userId, IndustryName&#x29; as &#x28;select tmp_1.userid, BS.name from tmp_1 inner join bullhorn1.BH_BusinessSector BS ON tmp_1.bussinesid &#x3d; BS.businessSectorID&#x29;&#xa;--, t1&#x28;userid, name, bussinesid&#x29; as &#x28;select tmp_businessSectorIDList2.userid, BS.name, tmp_businessSectorIDList2.bussinesid from tmp_businessSectorIDList2 inner join bullhorn1.BH_BusinessSector BS ON tmp_businessSectorIDList2.bussinesid &#x3d; BS.businessSectorID&#x29;&#xa;--, t1&#x28;userid,name,bussinesid&#x29; as &#x28;select tmp_businessSectorIDList2.userid, BS.name, tmp_businessSectorIDList2.bussinesid from tmp_businessSectorIDList2 inner join bullhorn1.BH_BusinessSector BS ON tmp_businessSectorIDList2.bussinesid &#x3d; BS.businessSectorID&#x29;&#xa;--select &#x2a; from t1 order by userid&#xa;&#xa;, t&#x28;userid, name&#x29; as &#x28;select tmp_businessSectorIDList2.userid, cast&#x28;BS.name as varchar&#x28;max&#x29;&#x29; from tmp_businessSectorIDList2 inner join bullhorn1.BH_BusinessSector BS ON tmp_businessSectorIDList2.bussinesid &#x3d; BS.businessSectorID&#x29;&#xa;--select &#x2a; from t where userid &#x3d; 3144 --order by userid &#xa;&#xa;, tmp_businessSectorIDList3&#x28;userid, name&#x29; as &#x28;SELECT userid, name &#x3d; &#xa;    STUFF&#x28;&#x28;SELECT DISTINCT &#x27;, &#x27; &#x2b; name&#xa;           FROM t b &#xa;           WHERE b.userid &#x3d; a.userid &#xa;          FOR XML PATH&#x28;&#x27;&#x27;&#x29;&#x29;, 1, 2, &#x27;&#x27;&#x29;&#xa;FROM t a&#xa;GROUP BY userid&#xa;&#x29;&#xa;--select &#x2a; from tmp_businessSectorIDList3 where userid &#x3d; 893&#xa;--select &#x2a; from tmp_businessSectorIDList3 order by userid&#xa;----------------------------&#xa;, tmp_5 as &#x28;select Cl.userID &#xa;--, concat&#x28;&#x27;Address&#x3a; &#x27;,CC.address1,char&#x28;10&#x29;,&#x27; &#x27;,CC.address2,char&#x28;10&#x29;,&#x27; &#x27;,UC.city,char&#x28;10&#x29;,&#x27; &#x27;,UC.state,char&#x28;10&#x29;,&#x27; &#x27;,UC.zip,char&#x28;10&#x29;&#x29; as &#x27;Address&#x27;&#xa;, concat&#x28;&#x27;Address&#x3a; &#x27;,CC.address1,&#x27; &#x27;,CC.address2,&#x27; &#x27;,UC.city,&#x27; &#x27;,UC.state,&#x27; &#x27;,UC.zip,char&#x28;10&#x29;&#x29; as &#x27;Address&#x27;&#xa;, case when &#x28;Cl.division &#x3d; &#x27;&#x27; OR Cl.division is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Department&#x3a; &#x27;,Cl.division,char&#x28;10&#x29;&#x29; END as Department&#xa;, case when &#x28;UC2.reportToUserID &#x3d; &#x27;&#x27; OR UC2.reportToUserID is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;ReportToUserID&#x3a; &#x27;,Cl.division,char&#x28;10&#x29;&#x29; END as ReportToUserID&#xa;, case when &#x28;Cl.status &#x3d; &#x27;&#x27; OR Cl.status is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Status&#x3a; &#x27;,Cl.status,char&#x28;10&#x29;&#x29; END as Status1&#xa;, case when &#x28;cast&#x28;Cl.desiredCategories as varchar&#x28;max&#x29;&#x29; &#x3d; &#x27;&#x27; OR Cl.desiredCategories is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Designed Categories&#x3a; &#x27;,Cl.desiredCategories,char&#x28;10&#x29;&#x29; END as DesignedCategories&#xa;, case when &#x28;cast&#x28;Cl.desiredSpecialties as varchar&#x28;max&#x29;&#x29; &#x3d; &#x27;&#x27; OR Cl.desiredSpecialties is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Desired Specialties&#x3a; &#x27;,Cl.desiredSpecialties,char&#x28;10&#x29;&#x29; END as DesiredSpecialties&#xa;, case when &#x28;cast&#x28;Cl.comments as varchar&#x28;max&#x29;&#x29; &#x3d; &#x27;&#x27; OR Cl.comments is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Comments&#x3a; &#x27;,Cl.comments,char&#x28;10&#x29;&#x29; END as Comments&#xa;, case when &#x28;UC2.referredByUserID &#x3d; &#x27;&#x27; OR UC2.referredByUserID is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;ReferredByUserID&#x3a; &#x27;,UC2.referredByUserID,char&#x28;10&#x29;&#x29; END as ReferredByUserID&#xa;, case when &#x28;cast&#x28;tmp_businessSectorIDList3.name as varchar&#x28;max&#x29;&#x29; &#x3d; &#x27;&#x27; OR tmp_businessSectorIDList3.name is NULL&#x29; THEN &#x27;&#x27; ELSE REPLACE&#x28;REPLACE&#x28;concat&#x28;&#x27;BusinessSectorName&#x3a; &#x27;,tmp_businessSectorIDList3.name,char&#x28;10&#x29;&#x29;, &#x27;&#x26;amp&#x3b;&#x27;, &#x27;&#x26;&#x27;&#x29;, &#x27;amp&#x3b;&#x27;, &#x27;&#x27;&#x29; END as BusinessSectorName&#xa;, case when &#x28;cast&#x28;tmp_8.recruiterUserID_email as varchar&#x28;max&#x29;&#x29; &#x3d; &#x27;&#x27; OR tmp_8.recruiterUserID_email is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;RecruiterUserEmail&#x3a; &#x27;,tmp_8.recruiterUserID_email,char&#x28;10&#x29;&#x29; END as &#x27;RecruiterUserEmail&#x27;&#xa;--, case when &#x28;cast&#x28;Cl.desiredSkills as varchar&#x28;max&#x29;&#x29; &#x3d; &#x27;&#x27; OR Cl.desiredSkills is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Desired Skills&#x3a; &#x27;,Cl.desiredSkills&#x29; END as DesiredSkills&#xa;	from bullhorn1.BH_Client Cl &#xa;	left join bullhorn1.BH_ClientCorporation CC ON Cl.clientCorporationID &#x3d; CC.clientCorporationID&#xa;	left join bullhorn1.BH_UserContact UC2 on Cl.recruiterUserID &#x3d; UC2.userID&#xa;	left join bullhorn1.BH_UserContact UC ON Cl.userID &#x3d; UC.userID&#xa;	left join tmp_businessSectorIDList3 ON UC.userid &#x3d; tmp_businessSectorIDList3.userid&#xa;	--left join bullhorn1.BH_Candidate CA ON UC.userID &#x3d; CA.userID&#xa;	left join tmp_4 d on Cl.userID &#x3d; d.userID&#xa;	left join tmp_8 ON Cl.recruiterUserID &#x3d; tmp_8.userid&#xa;	--where Cl.status not like &#x27;&#x25;Archive&#x25;&#x27; and Cl.status &#x3c;&#x3e; &#x27;&#x27;&#xa;	where Cl.isPrimaryOwner &#x3d; 1&#xa;  &#x29;&#xa;--select &#x2a; from tmp_5&#xa;&#xa;, tmp_6 as &#x28;select userID, concat&#x28;Address,Status1,Department,ReportToUserID,DesignedCategories,DesiredSpecialties,Comments,ReferredByUserID,BusinessSectorName,RecruiterUserEmail&#x29; as CombinedNote from tmp_5&#x29;&#xa;--, tmp_6 as &#x28;select userID, concat&#x28;Status1,char&#x28;10&#x29;,Department,char&#x28;10&#x29;,ReportToUserID,char&#x28;10&#x29;,DesignedCategories,char&#x28;10&#x29;,DesiredSpecialties,char&#x28;10&#x29;,ReferredByUserID,char&#x28;10&#x29;,BusinessSectorName,char&#x28;10&#x29;,RecruiterUserEmail,char&#x28;10&#x29;&#x29; as CombinedNote from tmp_5&#x29;&#xa;--select &#x2a; from tmp_6&#xa;----------------------------&#xa;--	, tmp_9 &#x28;userID,contactphone&#x29; as &#x28;select Cl.userid, &#xa;--	concat&#x28; case when &#x28;cast&#x28;UC.mobile as varchar&#x28;max&#x29;&#x29; &#x3d; &#x27;&#x27; OR cast&#x28;UC.mobile as varchar&#x28;max&#x29;&#x29; &#x3d; &#x27; &#x27; OR UC.mobile is NULL&#x29; THEN &#x27;&#x27; ELSE UC.mobile END,char&#x28;10&#x29;&#xa;--	, case when UC.phone not LIKE &#x27;&#x25;&#x5b;0-9&#x5d;&#x25;&#x27; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;,&#x27;,UC.phone&#x29; END,char&#x28;10&#x29;&#xa;--	, case when &#x28;UC.workPhone not LIKE &#x27;&#x25;&#x5b;0-9&#x5d;&#x25;&#x27; or UC.workPhone is NULL&#x29;THEN &#x27;&#x27; ELSE concat&#x28;&#x27;,&#x27;,UC.workPhone&#x29; END,char&#x28;10&#x29;&#xa;--	&#x29;&#x29; as &#x27;contactphone&#x27;&#xa;--	from &#xa;--	left join bullhorn1.BH_UserContact UC ON Cl.userID &#x3d; UC.userID&#xa;--select &#x2a; from tmp_9&#xa;&#xa;----------------------------&#xa;select &#xa;	 Cl.clientID as &#x27;contact-externalId&#x27;&#xa;	--,UC.userID&#xa;	, UC.firstName as &#x27;contact-firstName&#x27;&#xa;	, UC.lastName as &#x27;contact-lastName&#x27;&#xa;	, UC.occupation as &#x27;contact-jobTitle&#x27;&#xa;	, UC.clientCorporationID as &#x27;contact-companyId&#x27;&#xa;	--, UC.countryID&#xa;	, CASE WHEN &#x28;tc.abbreviation &#x3d; &#x27;NONE&#x27; OR tc.abbreviation &#x3d; &#x27;NULL&#x27;&#x29; THEN &#x27;&#x27; ELSE tc.abbreviation END as &#x27;company-locationCountry&#x27;&#xa;	--, UC.businessSectorIDList&#xa;	--, tmp_businessSectorIDList3.userid as &#x27;businessSectorIDList_userid&#x27;&#xa;	--, tmp_businessSectorIDList3.name as &#x27;businessSectorIDList_Name&#x27;&#xa;	--, case when &#x28;cast&#x28;tmp_businessSectorIDList3.name as varchar&#x28;max&#x29;&#x29; &#x3d; &#x27;&#x27; OR tmp_businessSectorIDList3.name is NULL&#x29; THEN &#x27;&#x27; ELSE REPLACE&#x28;REPLACE&#x28;tmp_businessSectorIDList3.name, &#x27;&#x26;amp&#x3b;&#x27;, &#x27;&#x26;&#x27;&#x29;, &#x27;amp&#x3b;&#x27;, &#x27;&#x27;&#x29; END as businessSectorIDListName&#xa;	--, Cl.desiredCategories&#xa;	--, Cl.desiredSpecialties&#xa;	--, Cl.recruiterUserID&#xa;	, tmp_8.recruiterUserID_email as &#x27;contact-owners&#x27;&#xa;	--, UC.email as &#x27;contact-owners&#x27;&#xa;	, case when tmp_3.email not LIKE &#x27;&#x25;&#x40;&#x25;&#x27; THEN &#x27;&#x27; ELSE tmp_3.email END as &#x27;contact-email&#x27;&#xa;	--, concat&#x28;CC.city,char&#x28;10&#x29;,CC.state,char&#x28;10&#x29;&#x29; as &#x27;company-locationName&#x27;&#xa;	--, concat&#x28;CC.address1,char&#x28;10&#x29;,CC.address2,char&#x28;10&#x29;&#x29; as &#x27;company-locationAddress&#x27;&#xa;	--, UC.city&#xa;	--, UC.state&#xa;	--, UC.zip&#xa;	--, UC.mobile&#xa;	--, UC.phone&#xa;	--, UC.workPhone&#xa;	, concat&#x28;&#xa;	  case when &#x28;cast&#x28;UC.mobile as varchar&#x28;max&#x29;&#x29; &#x3d; &#x27;&#x27; OR cast&#x28;UC.mobile as varchar&#x28;max&#x29;&#x29; &#x3d; &#x27; &#x27; OR UC.mobile is NULL&#x29; THEN &#x27;&#x27; ELSE UC.mobile END,char&#x28;10&#x29;&#xa;	, case when UC.phone not LIKE &#x27;&#x25;&#x5b;0-9&#x5d;&#x25;&#x27; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;,&#x27;,UC.phone&#x29; END,char&#x28;10&#x29;&#xa;	, case when &#x28;UC.workPhone not LIKE &#x27;&#x25;&#x5b;0-9&#x5d;&#x25;&#x27; or UC.workPhone is NULL&#x29;THEN &#x27;&#x27; ELSE concat&#x28;&#x27;,&#x27;,UC.workPhone&#x29; END,char&#x28;10&#x29;&#xa;	&#x29; as &#x27;contact-phone&#x27;&#xa;	 &#xa;&#xa;	, f.CombinedNote as &#x27;contact-Note&#x27;&#xa;	, UC.lastNote_denormalized as &#x27;contact-comment&#x27;&#xa;	--, UC2.email as &#x27;contact-owners&#x27;&#xa;	--, UC2.name as &#x27;Owners-name&#x27;&#xa;	--, ISNULL&#x28;REPLACE&#x28;cast&#x28;UC.lastNote_denormalized as nvarchar&#x28;max&#x29;&#x29;,CHAR&#x28;13&#x29;,&#x27;&#x27;&#x29;, &#x27;&#x27;&#x29; as &#x27;contact-Note&#x27;&#xa;	--, UC.lastNote_denormalized as &#x27;contact-Note&#x27;&#xa;	--, concat&#x28;f.CombinedNote, d.Notes&#x29; as &#x27;contact-comment&#x27;&#xa;	--, UC.phone as &#x27;contact-phone&#x27;&#xa;	--, case when c.email not LIKE &#x27;&#x25;_&#x40;_&#x25;_.__&#x25;&#x27; THEN &#x27;&#x27; ELSE c.email END as &#x27;contact-email&#x27;&#xa;	--, c.email as &#x27;contact-email&#x27;&#xa;	from bullhorn1.BH_Client Cl&#xa;left join bullhorn1.BH_UserContact UC ON Cl.userID &#x3d; UC.userID&#xa;--left join bullhorn1.BH_Candidate CA ON UC.userID &#x3d; CA.userID&#xa;--left join bullhorn1.BH_UserContact UC2 on Cl.recruiterUserID &#x3d; UC2.userID&#xa;left join tmp_country tc ON UC.countryID &#x3d; tc.code&#xa;left join tmp_3 b on ltrim&#x28;rtrim&#x28;cast&#x28;UC.ownerUserIDList as nvarchar&#x28;max&#x29;&#x29;&#x29;&#x29; &#x3d; cast&#x28;b.userID as nvarchar&#x28;max&#x29;&#x29;&#xa;left join tmp_3 ON Cl.userID &#x3d; tmp_3.userID&#xa;--left join tmp_4 d on Cl.userID &#x3d; d.userID&#xa;left join tmp_6 f on Cl.userID &#x3d; f.userID&#xa;left join tmp_8 ON Cl.recruiterUserID &#x3d; tmp_8.userid&#xa;--left join tmp_businessSectorIDList3 ON UC.userid &#x3d; tmp_businessSectorIDList3.userid&#xa;--where UC.email LIKE &#x27;&#x25;_&#x40;_&#x25;_.__&#x25;&#x27; and c.email LIKE &#x27;&#x25;_&#x40;_&#x25;_.__&#x25;&#x27;&#xa;left JOIN bullhorn1.BH_ClientCorporation CC ON Cl.clientCorporationID &#x3d; CC.clientCorporationID&#xa;where &#xa;--Cl.clientCorporationID &#x3d; 571&#xa;Cl.status like &#x27;&#x25;Archive&#x25;&#x27; or Cl.status &#x3d; &#x27;&#x27; &#xa;and Cl.isPrimaryOwner &#x3d; 1&#xa;--and Cl.userID &#x3d; 9535&#xa;--UC.status not like &#x27;&#x25;Archive&#x25;&#x27; and UC.status &#x3c;&#x3e; &#x27;&#x27; &#xa;--Cl.clientid &#x3d; 910&#xa;--CA.userID &#x3d; 790&#xa;--and UC.userID &#x3d; 1228&#xa;--and Cl.status not like &#x27;&#x25;Archive&#x25;&#x27; and Cl.status &#x3c;&#x3e; &#x27;&#x27; &#xa;--and UC.userID &#x3d; 790&#xa;--and Cl.clientid &#x3d; 790 &#xa;--and Cl.recruiterUserID &#x3d; tmp_8.userid&#xa;&#xa;&#xa;--select recruiterUserID, UC.email from bullhorn1.BH_Client CL&#xa;--left join bullhorn1.BH_UserContact UC on CL.recruiterUserID &#x3d; UC.userID</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>128</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Job</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <connection>export</connection>
    <sql>&#xa;with &#xa;tmp_1&#x28;userID, email&#x29; as &#x28;select userID, REPLACE&#x28;ISNULL&#x28;email,&#x27;&#x27;&#x29; &#x2b; &#x27;,&#x27; &#x2b; ISNULL&#x28;email2,&#x27;&#x27;&#x29; &#x2b; &#x27;,&#x27; &#x2b; ISNULL&#x28;email3,&#x27;&#x27;&#x29;, &#x27;,,&#x27;, &#x27;,&#x27;&#x29; as email from bullhorn1.BH_UserContact &#x29;&#xa; --select &#x2a; from tmp_1&#xa; --select userID, email, CHARINDEX&#x28;email,&#x27;,&#x27;,0&#x29; from tmp_1&#xa; , tmp_2&#x28;userID, email&#x29; as &#x28;select userID, CASE WHEN CHARINDEX&#x28;&#x27;,&#x27;,email,1&#x29; &#x3d; 1 THEN RIGHT&#x28;email, len&#x28;email&#x29;-1&#x29;	ELSE email END as email from tmp_1&#x29;&#xa; , tmp_3&#x28;userID, email&#x29; as &#x28;select userID, CASE WHEN CHARINDEX&#x28;&#x27;,&#x27;,email,len&#x28;email&#x29;&#x29; &#x3d; len&#x28;email&#x29; 	THEN LEFT&#x28;email, CASE WHEN len&#x28;email&#x29; &#x3c; 1 THEN 0 ELSE len&#x28;email&#x29; - 1 END&#x29; ELSE email END as email from tmp_2&#x29;&#xa; --select &#x2a; from tmp_3&#xa;----------------------------&#xa;, tmp1 &#x28;categoryID,name&#x29; as &#x28;select categoryID,name from bullhorn1.BH_Category&#x29;&#xa;, tmp_businessSectorIDList1 &#x28;userid, BussinessID&#x29; as&#xa;&#x28;SELECT userid,LTRIM&#x28;RTRIM&#x28;m.n.value&#x28;&#x27;.&#x5b;1&#x5d;&#x27;,&#x27;varchar&#x28;8000&#x29;&#x27;&#x29;&#x29;&#x29; AS BussinessID &#xa;FROM &#x28;SELECT userid, CAST&#x28;&#x27;&#x3c;XMLRoot&#x3e;&#x3c;RowData&#x3e;&#x27; &#x2b; REPLACE&#x28;cast&#x28;businessSectorIDList as varchar&#x28;max&#x29;&#x29;,&#x27;,&#x27;,&#x27;&#x3c;&#x2f;RowData&#x3e;&#x3c;RowData&#x3e;&#x27;&#x29; &#x2b; &#x27;&#x3c;&#x2f;RowData&#x3e;&#x3c;&#x2f;XMLRoot&#x3e;&#x27; AS XML&#x29; AS x FROM  bullhorn1.BH_UserContact CA where CA.status not like &#x27;&#x25;Archive&#x25;&#x27; and CA.status &#x3c;&#x3e; &#x27;&#x27; &#x29;t&#xa;CROSS APPLY x.nodes&#x28;&#x27;&#x2f;XMLRoot&#x2f;RowData&#x27;&#x29;m&#x28;n&#x29;&#xa;&#x29;&#xa;--select cast&#x28;BussinessID as int&#x29; from tmp_businessSectorIDList1&#xa;&#xa;, tmp_businessSectorIDList2&#x28;userid, bussinesid&#x29; as &#x28;select distinct userid, cast&#x28;BussinessID as varchar&#x28;max&#x29;&#x29; from &#x28;select userid, BussinessID from tmp_businessSectorIDList1&#x29; a&#x29;&#xa;--select &#x2a; from tmp_businessSectorIDList2&#xa;--, t1&#x28;userId, IndustryName&#x29; as &#x28;select tmp_1.userid, BS.name from tmp_1 inner join bullhorn1.BH_BusinessSector BS ON tmp_1.bussinesid &#x3d; BS.businessSectorID&#x29;&#xa;--, t1&#x28;userid, name, bussinesid&#x29; as &#x28;select tmp_businessSectorIDList2.userid, BS.name, tmp_businessSectorIDList2.bussinesid from tmp_businessSectorIDList2 inner join bullhorn1.BH_BusinessSector BS ON tmp_businessSectorIDList2.bussinesid &#x3d; BS.businessSectorID&#x29;&#xa;--, t1&#x28;userid,name,bussinesid&#x29; as &#x28;select tmp_businessSectorIDList2.userid, BS.name, tmp_businessSectorIDList2.bussinesid from tmp_businessSectorIDList2 inner join bullhorn1.BH_BusinessSector BS ON tmp_businessSectorIDList2.bussinesid &#x3d; BS.businessSectorID&#x29;&#xa;--select &#x2a; from t1 order by userid&#xa;, t&#x28;userid, name&#x29; as &#x28;select tmp_businessSectorIDList2.userid, cast&#x28;BS.name as varchar&#x28;max&#x29;&#x29; from tmp_businessSectorIDList2 inner join bullhorn1.BH_BusinessSector BS ON tmp_businessSectorIDList2.bussinesid &#x3d; BS.businessSectorID&#x29;&#xa;--select &#x2a; from t where userid &#x3d; 3144 --order by userid &#xa;&#xa;, tmp_businessSectorIDList3&#x28;userid, name&#x29; as &#x28;SELECT userid, name &#x3d; &#xa;    STUFF&#x28;&#x28;SELECT DISTINCT &#x27;, &#x27; &#x2b; name&#xa;           FROM t b &#xa;           WHERE b.userid &#x3d; a.userid &#xa;          FOR XML PATH&#x28;&#x27;&#x27;&#x29;&#x29;, 1, 2, &#x27;&#x27;&#x29;&#xa;FROM t a&#xa;GROUP BY userid&#xa;&#x29;&#xa;--select &#x2a; from tmp_businessSectorIDList3 where userid &#x3d; 893&#xa;--select &#x2a; from tmp_businessSectorIDList3 order by userid&#xa;----------------------------&#xa;, tmp_5 as &#x28;select &#xa;JP.jobPostingID&#xa;, Cl.userID&#xa;----, CC.clientCorporationID&#xa;, case when &#x28;cast&#x28;tmp_businessSectorIDList3.name as varchar&#x28;max&#x29;&#x29; &#x3d; &#x27;&#x27; OR tmp_businessSectorIDList3.name is NULL&#x29; THEN &#x27;&#x27; ELSE REPLACE&#x28;REPLACE&#x28;concat&#x28;&#x27;BusinessSectorName&#x3a; &#x27;,tmp_businessSectorIDList3.name,char&#x28;10&#x29;&#x29;, &#x27;&#x26;amp&#x3b;&#x27;, &#x27;&#x26;&#x27;&#x29;, &#x27;amp&#x3b;&#x27;, &#x27;&#x27;&#x29; END as &#x27;BusinessSectorName&#x27;&#xa;, CASE WHEN &#x28;tc.abbreviation &#x3d; &#x27;NONE&#x27; OR tc.abbreviation &#x3d; &#x27;NULL&#x27;&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Country&#x3a; &#x27;,tc.abbreviation,char&#x28;10&#x29;&#x29; END as &#x27;Country&#x27;&#xa;--, JP.clientCorporationID as  &#x27;JP.clientCorporationID&#x27;&#xa;, case when &#x28;JP.customText1 &#x3d; &#x27;&#x27; OR JP.customText1 is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;CustomText&#x3a; &#x27;,JP.customText1,char&#x28;10&#x29;&#x29; END as &#x27;CustomText&#x27;&#xa;--, case when &#x28;UC.categoryID &#x3d; &#x27;&#x27; OR UC.categoryID is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;CategoryID&#x3a; &#x27;,UC.categoryID,char&#x28;10&#x29;&#x29; END as &#x27;CategoryID&#x27;&#xa;, case when &#x28;t1.name &#x3d; &#x27;&#x27; OR t1.name is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;CategoryName&#x3a; &#x27;,t1.name,char&#x28;10&#x29;&#x29; END as &#x27;CategoryName&#x27;&#xa;--, case when &#x28;t1.name &#x3d; &#x27;&#x27; OR t1.name is NULL&#x29; THEN &#x27;&#x27; ELSE t1.name END as &#x27;CategoryName&#x27;&#xa;--, UC.categoryIDList&#xa;, UC.specialtyIDList as &#x27;SpecialtyIDList&#x27;&#xa;--, UC.skillIDList&#xa;, JP.skills as &#x27;Skills&#x27;&#xa;, case when &#x28;Cl.status &#x3d; &#x27;&#x27; OR Cl.status is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Status&#x3a; &#x27;,Cl.status,char&#x28;10&#x29;&#x29; END as Status&#xa;, case when &#x28;JP.isOpen &#x3d; &#x27;&#x27; OR JP.isOpen is NULL&#x29; THEN &#x27;&#x27; when &#x28;JP.isOpen &#x3d; 0&#x29; THEN  concat&#x28;&#x27;IsOpen&#x3a; Yesterday&#x27;,char&#x28;10&#x29;&#x29; ELSE &#x27;&#x27; END as &#x27;IsOpen&#x27;&#xa;--, JP.billRateCategoryID&#xa;, JP.reasonClosed as &#x27;ReasonClosed&#x27;&#xa;, case when &#x28;JP.feeArrangement &#x3d; &#x27;&#x27; OR JP.feeArrangement is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;FeeArrangement&#x3a; &#x27;,JP.feeArrangement,char&#x28;10&#x29;&#x29; END as &#x27;FeeArrangement&#x27;&#xa;, case when &#x28;JP.payRate &#x3d; &#x27;&#x27; OR JP.payRate is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;PayRate&#x3a; &#x27;,JP.payRate,char&#x28;10&#x29;&#x29; END as &#x27;PayRate&#x27;&#xa;, case when &#x28;JP.salaryUnit &#x3d; &#x27;&#x27; OR JP.salaryUnit is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;SalaryUnit&#x3a; &#x27;,JP.salaryUnit,char&#x28;10&#x29;&#x29; END as &#x27;SalaryUnit&#x27;&#xa;, case when &#x28;JP.clientBillRate &#x3d; &#x27;&#x27; OR JP.clientBillRate is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;ClientBillRate&#x3a; &#x27;,JP.clientBillRate,char&#x28;10&#x29;&#x29; END as &#x27;ClientBillRate&#x27;&#xa;, case when &#x28;JP.yearsRequired &#x3d; &#x27;&#x27; OR JP.yearsRequired is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;YearsRequired&#x3a; &#x27;,JP.yearsRequired,char&#x28;10&#x29;&#x29; END as &#x27;YearsRequired&#x27;&#xa;, JP.benefits as &#x27;Benefits&#x27;&#xa;--, JP.markUpPercentage&#xa;, case when &#x28;JP.isinterviewRequired &#x3d; &#x27;&#x27; OR JP.isinterviewRequired is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;IsinterviewRequired&#x3a; &#x27;,JP.isinterviewRequired,char&#x28;10&#x29;&#x29; END as &#x27;IsinterviewRequired&#x27;&#xa;, case when &#x28;JP.willRelocate &#x3d; &#x27;&#x27; OR JP.willRelocate is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;WillRelocate&#x3a; &#x27;,JP.willRelocate,char&#x28;10&#x29;&#x29; END as &#x27;WillRelocate&#x27;&#xa;--, JP.contractInfoHeader&#xa;, case when &#x28;JP.durationWeeks &#x3d; &#x27;&#x27; OR JP.durationWeeks is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;DurationWeeks&#x3a; &#x27;,JP.durationWeeks,char&#x28;10&#x29;&#x29; END as &#x27;DurationWeeks&#x27;&#xa;, case when &#x28;JP.willSponsor &#x3d; &#x27;&#x27; OR JP.willSponsor is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;WillSponsor&#x3a; &#x27;,JP.willSponsor,char&#x28;10&#x29;&#x29; END as &#x27;WillSponsor&#x27;&#xa;, case when &#x28;JP.hoursPerWeek &#x3d; &#x27;&#x27; OR JP.hoursPerWeek is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;HoursPerWeek&#x3a; &#x27;,JP.hoursPerWeek,char&#x28;10&#x29;&#x29; END as &#x27;HoursPerWeek&#x27;&#xa;, case when &#x28;JP.onSite &#x3d; &#x27;&#x27; OR JP.onSite is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;OnSite&#x3a; &#x27;,JP.onSite,char&#x28;10&#x29;&#x29; END as &#x27;OnSite&#x27;&#xa;--, JP.descriptionInfoHeader&#xa;, concat&#x28;&#x27;Address&#x3a; &#x27;,JP.address,&#x27; &#x27;,JP.city,&#x27; &#x27;,JP.state,&#x27; &#x27;,JP.zip,char&#x28;10&#x29;&#x29; as &#x27;Address&#x27;&#xa;, case when &#x28;JP.source &#x3d; &#x27;&#x27; OR JP.source is NULL&#x29; THEN &#x27;&#x27; ELSE concat&#x28;&#x27;Source&#x3a; &#x27;,JP.source,char&#x28;10&#x29;&#x29; END as &#x27;Source&#x27;&#xa;&#xa;	from bullhorn1.BH_JobPosting JP &#xa;	left join bullhorn1.BH_Client Cl ON JP.clientUserID &#x3d; Cl.userID&#xa;	----left join bullhorn1.BH_ClientCorporation CC ON Cl.clientCorporationID &#x3d; CC.clientCorporationID&#xa;	--left join bullhorn1.BH_UserContact UC2 on Cl.recruiterUserID &#x3d; UC2.userID&#xa;	left join bullhorn1.BH_UserContact UC ON Cl.userid &#x3d; UC.userID&#xa;	left join tmp1 t1 ON UC.categoryID &#x3d; t1.categoryID&#xa;	left join tmp_country tc ON UC.countryID &#x3d; tc.code&#xa;	left join tmp_businessSectorIDList3 ON UC.userid &#x3d; tmp_businessSectorIDList3.userid&#xa;&#xa;	--left join bullhorn1.BH_Candidate CA ON UC.userID &#x3d; CA.userID&#xa;	--left join tmp_4 d on Cl.userID &#x3d; d.userID&#xa;	--left join tmp_8 ON Cl.recruiterUserID &#x3d; tmp_8.userid&#xa;	--where Cl.status not like &#x27;&#x25;Archive&#x25;&#x27; and Cl.status &#x3c;&#x3e; &#x27;&#x27;&#xa;	where Cl.isPrimaryOwner &#x3d; 1&#xa;  &#x29;&#xa;&#xa;--select &#x2a; from tmp_5&#xa;--select jobPostingID,count&#x28;&#x2a;&#x29; from tmp_5 group by jobPostingID having count&#x28;&#x2a;&#x29; &#x3e; 1&#xa;&#xa;&#xa;, tmp_6 as &#x28;select jobPostingID, concat&#x28;BusinessSectorName,Country,CustomText,CategoryName,SpecialtyIDList,Skills,Status,IsOpen,ReasonClosed,FeeArrangement,PayRate,SalaryUnit,ClientBillRate,YearsRequired,Benefits,IsinterviewRequired,WillRelocate,DurationWeeks,WillSponsor,HoursPerWeek,OnSite,Address,Source&#x29; as CombinedNote from tmp_5&#x29;&#xa;--select &#x2a; from tmp_6&#xa;--select jobPostingID, count&#x28;&#x2a;&#x29; from tmp_6 group by jobPostingID having count&#x28;&#x2a;&#x29; &#x3e; 1&#xa;&#xa;&#xa;----------------------------&#xa;--&#x2f;&#x2a;&#xa;select JP.jobPostingID as &#x27;position-externalId&#x27; &#xa;	, Cl.userid as &#x27;position-contactId&#x27;&#xa;	, CC.name as &#x27;&#x28;CompanyName&#x29;&#x27;&#xa;	, JP.UserID as &#x27;UserID&#x27;&#xa;	, JP.title as &#x27;position-title&#x27;&#xa;	, JP.numOpenings as &#x27;position-headcount&#x27;&#xa;	, t3.email as &#x27;position-owners&#x27; &#xa;	--, a.type as &#x27;position-type&#x27; -- This field only accepts&#x3a; PERMANENT,INTERIM_PROJECT_CONSULTING,TEMPORARY,CONTRACT, TEMPORARY_TO_PERMANENT&#xa;	, UPPER&#x28;REPLACE&#x28;REPLACE&#x28;REPLACE&#x28;REPLACE&#x28;REPLACE&#x28;REPLACE&#x28;REPLACE&#x28;REPLACE&#x28;REPLACE&#x28;REPLACE&#x28;JP.employmentType, &#x27; J2&#x27;, &#x27;&#x27;&#x29;, &#x27; J3&#x27;, &#x27;&#x27;&#x29;, &#x27; J4&#x27;, &#x27;&#x27;&#x29;, &#x27; J5&#x27;,&#x27;&#x27;&#x29;,&#x27; &#x27;,&#x27;_&#x27;&#x29;,&#x27;Contract&#x27;, &#x27;CONTRACT&#x27;&#x29;,&#x27;Freelance&#x27;, &#x27;CONTRACT&#x27;&#x29;,&#x27;Temp&#x27;,&#x27;TEMPORARY&#x27;&#x29;,&#x27;Contract_to_Permanent&#x27;, &#x27;TEMPORARY_TO_PERMANENT&#x27;&#x29;,&#x27;Talent_Brief&#x27;, &#x27;INTERIM_PROJECT_CONSULTING&#x27;&#x29;&#x29; as &#x27;position-type&#x27;	-- This field only accepts&#x3a; FULL_TIME, PART_TIME, CASUAL&#xa;	--, a.employmentType as &#x27;position-employmentType&#x27;	-- This field only accepts&#x3a; FULL_TIME, PART_TIME, CASUAL&#xa;	, JP.salary as &#x27;position-actualSalary&#x27;&#xa;	, JP.publicDescription as &#x27;position-publicDescription&#x27;&#xa;	, JP.description as &#x27;position-internalDescription&#x27;&#xa;	, CONVERT&#x28;VARCHAR&#x28;10&#x29;,JP.startDate,110&#x29; as &#x27;position-startDate&#x27;&#xa;	, JP.dateClosed as &#x27;position-endDate&#x27;&#xa;	, t6.CombinedNote as &#x27;position-Note&#x27;&#xa;--	&#x2a;&#x2f;&#xa;--	select &#x2a;&#xa;from bullhorn1.BH_JobPosting JP&#xa;left join bullhorn1.BH_Client Cl on JP.clientUserID &#x3d; Cl.userID&#xa;left join bullhorn1.BH_ClientCorporation CC on Cl.clientCorporationID &#x3d; CC.clientCorporationID&#xa;left join tmp_3 t3 ON JP.userID &#x3d; t3.userID&#xa;left join tmp_6 t6 on JP.jobPostingID &#x3d; t6.jobPostingID&#xa;--where 1&#x3d;1&#xa;--and a.status not like &#x27;&#x25;Archive&#x25;&#x27;&#xa;--and a.clientUserID in &#x28;8884, 9273&#x29;&#xa;--and b.isPrimaryOwner &#x3d; 1&#xa;--where a.jobPostingID &#x3d; 1096&#xa;--where b.userid &#x3d; 9&#xa;--order by a.jobPostingID&#xa;&#xa;-- select &#x2a; from bullhorn1.BH_JobPosting where jobPostingID &#x3d; 10&#xa;-- select  from bullhorn1.BH_JobPosting&#xa;-- select &#x2a; from bullhorn1.BH_Usercontact where userID &#x3d; 9&#xa;&#xa;--select UC.name, &#x2a; from bullhorn1.BH_Client CL left join bullhorn1.BH_Usercontact UC on CL.userID &#x3d; UC.userID where CL.userID &#x3d; 19295&#xa;&#xa;&#xa;--select userid, count&#x28;&#x2a;&#x29; from bullhorn1.BH_Client&#xa;--where isPrimaryOwner &#x3d; 1&#xa;--group by userID having count&#x28;&#x2a;&#x29; &#x3e; 1&#xa;&#xa;&#x2f;&#x2a;&#xa;select jobPostingID,title,userID,countryID,externalCategoryID,clientUserID,externalID,clientCorporationID,status,address,city,state,zip &#xa;from bullhorn1.BH_JobPosting where clientUserID &#x3d; 690 --and status not like &#x27;&#x25;Archive&#x25;&#x27;&#xa;--title like &#x27;&#x25;CGI Artist&#x25;&#x27;&#xa;--title like &#x27;&#x25;Digital Designer - Senior&#x25;&#x27;&#xa;&#xa;select CC.name as &#x27;&#x28;CompanyName&#x29;&#x27;,Cl.clientid,Cl.userID,Cl.clientCorporationID,Cl.externalID,Cl.status from bullhorn1.BH_Client CL left join bullhorn1.BH_ClientCorporation CC on Cl.clientCorporationID &#x3d; CC.clientCorporationID&#xa; --where Cl.userid &#x3d; 2976 and Cl.status not like &#x27;&#x25;Archive&#x25;&#x27;&#xa; --where Cl.userid &#x3d; 1295 and Cl.status not like &#x27;&#x25;Archive&#x25;&#x27;&#xa; where Cl.userid &#x3d; 690 and Cl.status not like &#x27;&#x25;Archive&#x25;&#x27;&#xa;&#xa;select &#x2a; from bullhorn1.BH_UserContact where userid &#x3d; 690 and status not like &#x27;&#x25;Archive&#x25;&#x27; &#xa;--and name like &#x27;&#x25;Samantha Rouse&#x25;&#x27;&#xa;&#xa;--select jp.jobPostingID, cc.name ,jp.title from bullhorn1.BH_ClientCorporation cc,bullhorn1.BH_JobPosting jp where cc.clientCorporationID &#x3d; jp.clientCorporationID and jp.jobPostingID &#x3d; 19&#xa;&#x2a;&#x2f;&#xa;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>464</xloc>
      <yloc>48</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>candidate_</name>
    <type>ExcelOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <header>Y</header>
    <footer>N</footer>
    <encoding>UTF-8</encoding>
    <append>N</append>
    <add_to_result_filenames>Y</add_to_result_filenames>
    <file>
      <name>&#x2f;home&#x2f;truongpham&#x2f;hrboss&#x2f;datamigration&#x2f;_temp&#x2f;candidate</name>
      <extention>xls</extention>
      <do_not_open_newfile_init>N</do_not_open_newfile_init>
      <create_parent_folder>N</create_parent_folder>
      <split>N</split>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <SpecifyFormat>N</SpecifyFormat>
      <date_time_format/>
      <sheetname>Sheet1</sheetname>
      <autosizecolums>N</autosizecolums>
      <nullisblank>N</nullisblank>
      <protect_sheet>N</protect_sheet>
      <password>Encrypted </password>
      <splitevery>0</splitevery>
      <usetempfiles>N</usetempfiles>
      <tempdirectory/>
      </file>
    <template>
      <enabled>N</enabled>
      <append>N</append>
      <filename>template.xls</filename>
    </template>
    <fields>
      <field>
        <name>userID</name>
        <type>Integer</type>
        <format>0</format>
      </field>
      <field>
        <name>candidate-title</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>candidate-externalId</name>
        <type>Integer</type>
        <format>0</format>
      </field>
      <field>
        <name>candidate-firstName</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>candidate-Lastname</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>candidate-middleName</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>candidate-dob</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>candidate-citizenship</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>candidate-email</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>candidate-mobile</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>candidate-phone</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>candidate-workPhone</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>candidate-address</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>candidate-city</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>candidate-state</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>candidate-zipCode</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>candidate-Country</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>candidate-currentSalary</name>
        <type>BigNumber</type>
        <format>0</format>
      </field>
      <field>
        <name>candidate-desiredSalary</name>
        <type>BigNumber</type>
        <format>0</format>
      </field>
      <field>
        <name>candidate-employmentPreference</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>skills</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>candidate-schoolName</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>candidate-graduationDate</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>candidate-degreeName</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>candidate-gpa</name>
        <type>Number</type>
        <format>0</format>
      </field>
      <field>
        <name>candidate-company1</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>candidate-jobTitle1</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>candidate-owners</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>candidate-resume-filename</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>candidate-resume</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>candidate-comments</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>candidate-note</name>
        <type>String</type>
        <format/>
      </field>
    </fields>
    <custom>
    <header_font_name>arial</header_font_name>
    <header_font_size>10</header_font_size>
    <header_font_bold>N</header_font_bold>
    <header_font_italic>N</header_font_italic>
    <header_font_underline>no</header_font_underline>
    <header_font_orientation>horizontal</header_font_orientation>
    <header_font_color>black</header_font_color>
    <header_background_color>none</header_background_color>
    <header_row_height>255</header_row_height>
    <header_alignment>left</header_alignment>
    <header_image/>
    <row_font_name>arial</row_font_name>
    <row_font_size>10</row_font_size>
    <row_font_color>black</row_font_color>
    <row_background_color>none</row_background_color>
      </custom>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>592</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>company_ </name>
    <type>ExcelOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <header>Y</header>
    <footer>N</footer>
    <encoding>UTF-8</encoding>
    <append>N</append>
    <add_to_result_filenames>Y</add_to_result_filenames>
    <file>
      <name>&#x2f;home&#x2f;truongpham&#x2f;hrboss&#x2f;datamigration&#x2f;_temp&#x2f;company</name>
      <extention>xls</extention>
      <do_not_open_newfile_init>N</do_not_open_newfile_init>
      <create_parent_folder>N</create_parent_folder>
      <split>N</split>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <SpecifyFormat>N</SpecifyFormat>
      <date_time_format/>
      <sheetname>Sheet1</sheetname>
      <autosizecolums>N</autosizecolums>
      <nullisblank>N</nullisblank>
      <protect_sheet>N</protect_sheet>
      <password>Encrypted </password>
      <splitevery>0</splitevery>
      <usetempfiles>N</usetempfiles>
      <tempdirectory/>
      </file>
    <template>
      <enabled>N</enabled>
      <append>N</append>
      <filename>template.xls</filename>
    </template>
    <fields>
      <field>
        <name>company-name</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>company-externalId</name>
        <type>Integer</type>
        <format>0</format>
      </field>
      <field>
        <name>countryID</name>
        <type>Integer</type>
        <format>0</format>
      </field>
      <field>
        <name>company-locationCountry</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>parentClientCorporationID</name>
        <type>Integer</type>
        <format>0</format>
      </field>
      <field>
        <name>company-URL</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>culture</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>feeArrangement</name>
        <type>Number</type>
        <format>0.00</format>
      </field>
      <field>
        <name>customText2</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>company-phone</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>company-locationAddress</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>company-locationName</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>company-locationCity</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>company-locationState</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>company-locationZipCode</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>company-note</name>
        <type>String</type>
        <format/>
      </field>
    </fields>
    <custom>
    <header_font_name>arial</header_font_name>
    <header_font_size>10</header_font_size>
    <header_font_bold>N</header_font_bold>
    <header_font_italic>N</header_font_italic>
    <header_font_underline>no</header_font_underline>
    <header_font_orientation>horizontal</header_font_orientation>
    <header_font_color>black</header_font_color>
    <header_background_color>none</header_background_color>
    <header_row_height>255</header_row_height>
    <header_alignment>left</header_alignment>
    <header_image/>
    <row_font_name>arial</row_font_name>
    <row_font_size>10</row_font_size>
    <row_font_color>black</row_font_color>
    <row_background_color>none</row_background_color>
      </custom>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>256</xloc>
      <yloc>48</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>company_  2</name>
    <type>ExcelOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <header>Y</header>
    <footer>N</footer>
    <encoding>UTF-8</encoding>
    <append>N</append>
    <add_to_result_filenames>Y</add_to_result_filenames>
    <file>
      <name>&#x2f;home&#x2f;truongpham&#x2f;hrboss&#x2f;datamigration&#x2f;_temp&#x2f;company</name>
      <extention>xls</extention>
      <do_not_open_newfile_init>N</do_not_open_newfile_init>
      <create_parent_folder>N</create_parent_folder>
      <split>N</split>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <SpecifyFormat>N</SpecifyFormat>
      <date_time_format/>
      <sheetname>Sheet1</sheetname>
      <autosizecolums>N</autosizecolums>
      <nullisblank>N</nullisblank>
      <protect_sheet>N</protect_sheet>
      <password>Encrypted </password>
      <splitevery>0</splitevery>
      <usetempfiles>N</usetempfiles>
      <tempdirectory/>
      </file>
    <template>
      <enabled>N</enabled>
      <append>N</append>
      <filename>template.xls</filename>
    </template>
    <fields>
      <field>
        <name>company-externalId</name>
        <type>Integer</type>
        <format>0</format>
      </field>
      <field>
        <name>company-name</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>company-locationCountry</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>status</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>parentClientCorporationID</name>
        <type>Integer</type>
        <format>0</format>
      </field>
      <field>
        <name>company-URLwebsite</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>businessSectorList</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>culture</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>notes</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>companyDescription</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>feeArrangement</name>
        <type>Number</type>
        <format>0.00</format>
      </field>
      <field>
        <name>customText2</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>company-phone</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>company-locationAddress1</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>company-locationAddress2</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>company-locationCity</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>company-locationState</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>company-locationZipCode</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>billingContact</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>customText3</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>company-note</name>
        <type>String</type>
        <format/>
      </field>
    </fields>
    <custom>
    <header_font_name>arial</header_font_name>
    <header_font_size>10</header_font_size>
    <header_font_bold>N</header_font_bold>
    <header_font_italic>N</header_font_italic>
    <header_font_underline>no</header_font_underline>
    <header_font_orientation>horizontal</header_font_orientation>
    <header_font_color>black</header_font_color>
    <header_background_color>none</header_background_color>
    <header_row_height>255</header_row_height>
    <header_alignment>left</header_alignment>
    <header_image/>
    <row_font_name>arial</row_font_name>
    <row_font_size>10</row_font_size>
    <row_font_color>black</row_font_color>
    <row_background_color>none</row_background_color>
      </custom>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>256</xloc>
      <yloc>240</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>contact_</name>
    <type>ExcelOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <header>Y</header>
    <footer>N</footer>
    <encoding>UTF-8</encoding>
    <append>N</append>
    <add_to_result_filenames>Y</add_to_result_filenames>
    <file>
      <name>&#x2f;home&#x2f;truongpham&#x2f;hrboss&#x2f;datamigration&#x2f;_temp&#x2f;contact</name>
      <extention>xls</extention>
      <do_not_open_newfile_init>N</do_not_open_newfile_init>
      <create_parent_folder>N</create_parent_folder>
      <split>N</split>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <SpecifyFormat>N</SpecifyFormat>
      <date_time_format/>
      <sheetname>Sheet1</sheetname>
      <autosizecolums>N</autosizecolums>
      <nullisblank>N</nullisblank>
      <protect_sheet>N</protect_sheet>
      <password>Encrypted </password>
      <splitevery>0</splitevery>
      <usetempfiles>N</usetempfiles>
      <tempdirectory/>
      </file>
    <template>
      <enabled>N</enabled>
      <append>N</append>
      <filename>template.xls</filename>
    </template>
    <fields>
      <field>
        <name>contact-externalId</name>
        <type>Integer</type>
        <format>0</format>
      </field>
      <field>
        <name>contact-firstName</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>contact-lastName</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>contact-jobTitle</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>contact-companyId</name>
        <type>Integer</type>
        <format>0</format>
      </field>
      <field>
        <name>company-locationCountry</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>contact-owners</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>contact-email</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>contact-phone</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>contact-Note</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>contact-comment</name>
        <type>String</type>
        <format/>
      </field>
    </fields>
    <custom>
    <header_font_name>arial</header_font_name>
    <header_font_size>10</header_font_size>
    <header_font_bold>N</header_font_bold>
    <header_font_italic>N</header_font_italic>
    <header_font_underline>no</header_font_underline>
    <header_font_orientation>horizontal</header_font_orientation>
    <header_font_color>black</header_font_color>
    <header_background_color>none</header_background_color>
    <header_row_height>255</header_row_height>
    <header_alignment>left</header_alignment>
    <header_image/>
    <row_font_name>arial</row_font_name>
    <row_font_size>10</row_font_size>
    <row_font_color>black</row_font_color>
    <row_background_color>none</row_background_color>
      </custom>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>256</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>job_</name>
    <type>ExcelOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <header>Y</header>
    <footer>N</footer>
    <encoding>UTF-8</encoding>
    <append>N</append>
    <add_to_result_filenames>Y</add_to_result_filenames>
    <file>
      <name>&#x2f;home&#x2f;truongpham&#x2f;hrboss&#x2f;datamigration&#x2f;_temp&#x2f;job</name>
      <extention>xls</extention>
      <do_not_open_newfile_init>N</do_not_open_newfile_init>
      <create_parent_folder>N</create_parent_folder>
      <split>N</split>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <SpecifyFormat>N</SpecifyFormat>
      <date_time_format/>
      <sheetname>Sheet1</sheetname>
      <autosizecolums>N</autosizecolums>
      <nullisblank>N</nullisblank>
      <protect_sheet>N</protect_sheet>
      <password>Encrypted </password>
      <splitevery>0</splitevery>
      <usetempfiles>N</usetempfiles>
      <tempdirectory/>
      </file>
    <template>
      <enabled>N</enabled>
      <append>N</append>
      <filename>template.xls</filename>
    </template>
    <fields>
      <field>
        <name>position-externalId</name>
        <type>Integer</type>
        <format>0</format>
      </field>
      <field>
        <name>position-contactId</name>
        <type>Integer</type>
        <format>0</format>
      </field>
      <field>
        <name>&#x28;CompanyName&#x29;</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>UserID</name>
        <type>Integer</type>
        <format>0</format>
      </field>
      <field>
        <name>position-title</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>position-headcount</name>
        <type>Integer</type>
        <format>0</format>
      </field>
      <field>
        <name>position-owners</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>position-type</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>position-actualSalary</name>
        <type>BigNumber</type>
        <format>0</format>
      </field>
      <field>
        <name>position-publicDescription</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>position-internalDescription</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>position-startDate</name>
        <type>String</type>
        <format/>
      </field>
      <field>
        <name>position-endDate</name>
        <type>Timestamp</type>
        <format/>
      </field>
      <field>
        <name>position-Note</name>
        <type>String</type>
        <format/>
      </field>
    </fields>
    <custom>
    <header_font_name>arial</header_font_name>
    <header_font_size>10</header_font_size>
    <header_font_bold>N</header_font_bold>
    <header_font_italic>N</header_font_italic>
    <header_font_underline>no</header_font_underline>
    <header_font_orientation>horizontal</header_font_orientation>
    <header_font_color>black</header_font_color>
    <header_background_color>none</header_background_color>
    <header_row_height>255</header_row_height>
    <header_alignment>left</header_alignment>
    <header_image/>
    <row_font_name>arial</row_font_name>
    <row_font_size>10</row_font_size>
    <row_font_color>black</row_font_color>
    <row_background_color>none</row_background_color>
      </custom>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>592</xloc>
      <yloc>48</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>JobApplication</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <connection>export</connection>
    <sql>with tmp1 as &#x28;select VA.appointmentID, CA.candidateID from bullhorn1.View_Appointment VA&#xa;left join bullhorn1.Candidate CA on VA.candidateUserID &#x3d; CA.userID&#x29;&#xa;&#xa;, temp as &#x28;&#xa;select JR.jobPostingID as &#x27;application-positionExternalId&#x27;&#xa;, CA.candidateID as &#x27;application-candidateExternalId&#x27;&#xa;, replace&#x28;JR.status,&#x27;Submitted&#x27;,1&#x29; as &#x27;application-stage&#x27;&#xa;, &#x27;&#x27; as &#x27;application-note&#x27;&#xa;from bullhorn1.BH_JobResponse JR&#xa;left join bullhorn1.Candidate CA on JR.userID &#x3d; CA.userID&#xa;where JR.status &#x3d; &#x27;Submitted&#x27;&#xa;and CA.isPrimaryOwner &#x3d; 1&#xa;--order by JR.jobPostingID&#xa;&#xa;UNION&#xa;&#xa;select distinct JP.jobPostingID as &#x27;application-positionExternalId&#x27;&#xa;, CA.candidateID as &#x27;application-candidateExternalId&#x27;&#xa;, 2 as &#x27;application-stage&#x27;&#xa;, &#x27;&#x27; as &#x27;application-note&#x27;&#xa;from bullhorn1.BH_JobPosting JP&#xa;left join bullhorn1.BH_Sendout SO on JP.jobPostingID &#x3d; SO.jobPostingID&#xa;left join bullhorn1.Candidate CA on SO.candidateUserID &#x3d; CA.userID&#xa;where CA.isPrimaryOwner &#x3d; 1&#xa;--order by JP.jobPostingID&#xa;&#xa;UNION&#xa;&#xa;select VJI.jobPostingID as &#x27;application-positionExternalId&#x27;&#xa;, tmp1.candidateID as &#x27;application-candidateExternalId&#x27;&#xa;, 3 as &#x27;application-stage&#x27;&#xa;, max&#x28;VJI.appointmentID&#x29; as &#x27;application-note&#x27;&#xa;from bullhorn1.View_JobInterview VJI&#xa;left join tmp1 on VJI.appointmentID &#x3d; tmp1.appointmentID&#xa;where tmp1.candidateID is not NULL&#xa;group by VJI.jobPostingID, tmp1.candidateID&#xa;--order by VJI.jobPostingID&#xa;&#xa;UNION&#xa;&#xa;select a.jobPostingID as &#x27;application-positionExternalId&#x27;&#xa;	, b.candidateID as &#x27;application-candidateExternalId&#x27;&#xa;	, 4 as &#x27;application-stage&#x27;&#xa;	, &#x27;&#x27; as &#x27;application-note&#x27;&#xa;from bullhorn1.BH_Placement a&#xa;left join bullhorn1.Candidate b ON a.userID &#x3d; b.userID&#xa;where b.isPrimaryOwner &#x3d; 1&#x29;&#xa;&#xa;select &#x5b;application-positionExternalId&#x5d;,&#x5b;application-candidateExternalId&#x5d;&#xa;, case when max&#x28;&#x5b;application-stage&#x5d;&#x29;&#x3d;1 then &#x27;SHORTLISTED&#x27;&#xa;when max&#x28;&#x5b;application-stage&#x5d;&#x29;&#x3d;2 then &#x27;SENT&#x27;&#xa;when max&#x28;&#x5b;application-stage&#x5d;&#x29;&#x3d;3 then &#x27;1ST_INTERVIEW&#x27;&#xa;when max&#x28;&#x5b;application-stage&#x5d;&#x29;&#x3d;4 then &#x27;PLACED&#x27; &#xa;end as Stage &#xa;from temp&#xa;group by &#x5b;application-positionExternalId&#x5d;,&#x5b;application-candidateExternalId&#x5d;&#xa;order by temp.&#x5b;application-candidateExternalId&#x5d;&#xa;&#xa;&#x2f;&#x2a;&#xa;select count&#x28;stage&#x29; from temp2&#xa;where Stage &#x3d; &#x27;PLACED&#x27;&#xa;&#x2a;&#x2f;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>464</xloc>
      <yloc>240</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>JobApplication_</name>
    <type>ExcelOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <header>Y</header>
    <footer>N</footer>
    <encoding>UTF-8</encoding>
    <append>N</append>
    <add_to_result_filenames>Y</add_to_result_filenames>
    <file>
      <name>&#x2f;home&#x2f;truongpham&#x2f;hrboss&#x2f;datamigration&#x2f;_temp&#x2f;jobapplication</name>
      <extention>xls</extention>
      <do_not_open_newfile_init>N</do_not_open_newfile_init>
      <create_parent_folder>N</create_parent_folder>
      <split>N</split>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <SpecifyFormat>N</SpecifyFormat>
      <date_time_format/>
      <sheetname>Sheet1</sheetname>
      <autosizecolums>N</autosizecolums>
      <nullisblank>N</nullisblank>
      <protect_sheet>N</protect_sheet>
      <password>Encrypted </password>
      <splitevery>0</splitevery>
      <usetempfiles>N</usetempfiles>
      <tempdirectory/>
      </file>
    <template>
      <enabled>N</enabled>
      <append>N</append>
      <filename>template.xls</filename>
    </template>
    <fields>
      <field>
        <name>application-positionExternalId</name>
        <type>Integer</type>
        <format>0</format>
      </field>
      <field>
        <name>application-candidateExternalId</name>
        <type>Integer</type>
        <format>0</format>
      </field>
      <field>
        <name>Stage</name>
        <type>String</type>
        <format/>
      </field>
    </fields>
    <custom>
    <header_font_name>arial</header_font_name>
    <header_font_size>10</header_font_size>
    <header_font_bold>N</header_font_bold>
    <header_font_italic>N</header_font_italic>
    <header_font_underline>no</header_font_underline>
    <header_font_orientation>horizontal</header_font_orientation>
    <header_font_color>black</header_font_color>
    <header_background_color>none</header_background_color>
    <header_row_height>255</header_row_height>
    <header_alignment>left</header_alignment>
    <header_image/>
    <row_font_name>arial</row_font_name>
    <row_font_size>10</row_font_size>
    <row_font_color>black</row_font_color>
    <row_background_color>none</row_background_color>
      </custom>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>592</xloc>
      <yloc>240</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step_error_handling>
  </step_error_handling>
   <slave-step-copy-partition-distribution>
</slave-step-copy-partition-distribution>
   <slave_transformation>N</slave_transformation>

</transformation>
