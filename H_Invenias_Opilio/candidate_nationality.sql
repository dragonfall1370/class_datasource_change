WITH functional_expertise AS (
	SELECT
	id,
	jobFunction sub_functional_expertise,
	type functional_expertise
	FROM `alpha_sel_job_function`
	WHERE type IN ('Marketing', 'Project Management', 'Sales')
	AND jobFunction IN ('Ad Operations', 'Brand Marketing', 'Category Manager', 'Chief Marketing Officer', 'Communications & PR', 
												'CRM', 'Digital Marketing', 'eCommerce', 'Insight & Analytics', 'Marketing Events',
												'Media Planning / Buying', 'PPC', 'SEO', 'Social Media', 'Business Analysts',
												'Chief Digital Officer', 'Digital Project Manager', 'Events Manager', 'IT Programme Manager', 'IT Project Manager', 
												'PMO Analyst', 'PMO Assurance', 'Product Developer', 'Product Manager', 'Project Administrator',
												'Project Director', 'Project Manager', 'Project Resource Planner', 'Project Support/Co-ordinator', 'Risk Manager',
												'Transformation and Change Manager', 'COO', 'MD / CEO / VP')
),
candidate_position AS (
	SELECT
	c.person_id candidate_id,
	p.jobFunction_id fe_id,
	ROW_NUMBER() OVER(PARTITION BY c.person_id, p.jobFunction_id ORDER BY c.person_id) rn
	FROM alpha_candidate c
	LEFT JOIN alpha_position p ON c.person_id = p.person_id
	WHERE p.jobFunction_id IS NOT NULL
),
candidate_fe AS (
	SELECT DISTINCT candidate_id
	FROM candidate_position cp
	JOIN functional_expertise fe ON cp.fe_id = fe.id
	WHERE rn = 1
)

SELECT
	c.person_id candidate_id,
	CASE
		WHEN c.nationality = 'United Kingdom' THEN 'GB'
		WHEN c.nationality = 'Austrilian' THEN 'AU'
		WHEN c.nationality = 'United States' THEN 'US'
		WHEN c.nationality = 'british' THEN 'GB'
		WHEN c.nationality = 'France' THEN 'FR'
		WHEN c.nationality = 'German' THEN 'DE'
		WHEN c.nationality = 'Romania' THEN 'RO'
		WHEN c.nationality = 'Sweden' THEN 'SE'
		WHEN c.nationality = 'Italy' THEN 'IT'
		WHEN c.nationality = 'Greece' THEN 'GR'
		WHEN c.nationality = 'Germany' THEN 'DE'
		WHEN c.nationality = 'USA' THEN 'US'
		WHEN c.nationality = 'Belgium' THEN 'BE'
		WHEN c.nationality = 'American' THEN 'AS'
		WHEN c.nationality = 'Czech Republic' THEN 'CZ'
		WHEN c.nationality = 'Irish' THEN 'IE'
		WHEN c.nationality = 'Netherlands' THEN 'NL'
		WHEN c.nationality = 'South Africa' THEN 'ZA'
		WHEN c.nationality = 'New Zealand' THEN 'NZ'
		WHEN c.nationality = 'Finland' THEN 'FI'
		WHEN c.nationality = 'Polish' THEN 'PL'
		WHEN c.nationality = 'Italian' THEN 'IT'
		WHEN c.nationality = 'Portugal' THEN 'PT'
		WHEN c.nationality = 'Poland' THEN 'PL'
		WHEN c.nationality = 'Spain' THEN 'ES'
		WHEN c.nationality = 'Australia' THEN 'AU'
		WHEN c.nationality = 'Nigerian' THEN 'NG'
		WHEN c.nationality = 'India' THEN 'IN'
		WHEN c.nationality = 'Japan' THEN 'JP'
		WHEN c.nationality = 'Sri Lanka' THEN 'LK'
		WHEN c.nationality = 'Zimbabwe' THEN 'ZW'
		WHEN c.nationality = 'China' THEN 'CN'
		WHEN c.nationality = 'Lithuania' THEN 'LT'
		WHEN c.nationality = 'Israel' THEN 'IL'
		WHEN c.nationality = 'Bulgaria' THEN 'BG'
		WHEN c.nationality = 'Russian Federation' THEN 'RU'
		WHEN c.nationality = 'Denmark' THEN 'DK'
		WHEN c.nationality = 'Malta' THEN 'MT'
		WHEN c.nationality = 'Indian' THEN 'IN'
		WHEN c.nationality = 'Egypt' THEN 'EG'
		WHEN c.nationality = 'Ireland' THEN 'IE'
		WHEN c.nationality = 'Swedish' THEN 'SE'
		WHEN c.nationality = 'Hungary' THEN 'HU'
		WHEN c.nationality = 'Turkey' THEN 'TR'
		WHEN c.nationality = 'Norway' THEN 'NO'
		WHEN c.nationality = 'Canada' THEN 'CA'
		WHEN c.nationality = 'French' THEN 'FR'
		WHEN c.nationality = 'Greek' THEN 'GR'
		WHEN c.nationality = 'Austria' THEN 'AT'
		WHEN c.nationality = 'Somalian' THEN 'SO'
		WHEN c.nationality = 'American/British' THEN 'GB'
		WHEN c.nationality = 'Iran, Islamic Republic of' THEN 'IR'
		WHEN c.nationality = 'Taiwan, Province of China' THEN 'TW'
		WHEN c.nationality = 'Brazil' THEN 'BR'
		WHEN c.nationality = 'Iraq' THEN 'IQ'
		WHEN c.nationality = 'Malaysia' THEN 'MY'
		WHEN c.nationality = 'British Passport' THEN 'GB'
		WHEN c.nationality = 'Hungarian' THEN 'HU'
		WHEN c.nationality = 'Pakistan' THEN 'PK'
		WHEN c.nationality = 'Venezuela, Bolivarian Republic of' THEN 'VE'
		WHEN c.nationality = 'Latvia' THEN 'LV'
		WHEN c.nationality = 'Uganda' THEN 'UG'
		WHEN c.nationality = 'Columbian' THEN 'CO'
		WHEN c.nationality = 'australia and Irish nationality' THEN 'IE'
		WHEN c.nationality = 'Portuguese' THEN 'PT'
		WHEN c.nationality = 'Estonia' THEN 'EE'
		WHEN c.nationality = 'Kenya' THEN 'KE'
		WHEN c.nationality = 'Lithuanian' THEN 'LT'
		WHEN c.nationality = 'Lebanon' THEN 'LB'
		WHEN c.nationality = 'Argentina' THEN 'AR'
		WHEN c.nationality = 'Syrian Arab Republic' THEN 'SY'
		WHEN c.nationality = 'Spainish' THEN 'ES'
		WHEN c.nationality = 'Ukraine' THEN 'UA'
		WHEN c.nationality = 'Peru' THEN 'PE'
		WHEN c.nationality = 'Switzerland' THEN 'CH'
		WHEN c.nationality = 'Slovakia' THEN 'SK'
		WHEN c.nationality = 'Mauritius' THEN 'MU'
		WHEN c.nationality = 'Slovenia' THEN 'SI'
		WHEN c.nationality = 'Idian' THEN 'IN'
		WHEN c.nationality = 'Korea, Republic of' THEN 'KP'
		WHEN c.nationality = 'Morocco' THEN 'MA'
		WHEN c.nationality = 'Armenian' THEN 'AM'
		WHEN c.nationality = 'Russian' THEN 'RU'
		WHEN c.nationality = 'Jordan' THEN 'JO'
		WHEN c.nationality = 'Croatia' THEN 'HR'
		WHEN c.nationality = 'Serbia' THEN 'RS'
		WHEN c.nationality = 'Spanish' THEN 'ES'
		WHEN c.nationality = 'South African' THEN 'ZA'
		WHEN c.nationality = 'Indian - Indefinite Leave to Remain' THEN 'GB'
		WHEN c.nationality = 'Nigeria' THEN 'NG'
		WHEN c.nationality = 'Israeli/Polish' THEN 'PL'
		WHEN c.nationality = 'Frencg' THEN 'FR'
		WHEN c.nationality = 'Hong Kong' THEN 'HK'
		WHEN c.nationality = 'Mexico' THEN 'MX'
		WHEN c.nationality = 'Uruguay' THEN 'UY'
		WHEN c.nationality = 'Cyprus' THEN 'CY'
		WHEN c.nationality = 'britosh' THEN 'GB'
		WHEN c.nationality = 'Niger' THEN 'NE'
		WHEN c.nationality = 'Pakistani' THEN 'PK'
		WHEN c.nationality = 'Iceland' THEN 'IS'
		WHEN c.nationality = 'Macedonia, the former Yugoslav Republic of' THEN 'MK'
		WHEN c.nationality = 'Panama' THEN 'PA'
		WHEN c.nationality = 'Kazakhstan' THEN 'KZ'
		WHEN c.nationality = 'Scottish' THEN 'GB'
		WHEN c.nationality = 'Nepal' THEN 'NP'
		WHEN c.nationality = 'Brtiish' THEN 'GB'
		WHEN c.nationality = 'romanian' THEN 'RO'
		WHEN c.nationality = 'Dutch' THEN 'NL'
		WHEN c.nationality = 'British and NZ' THEN 'GB'
		WHEN c.nationality = 'United Arab Emirates' THEN 'AE'
		WHEN c.nationality = 'Chilean' THEN 'CL'
		WHEN c.nationality = 'bulgarian' THEN 'BG'
		WHEN c.nationality = 'Georgia' THEN 'GE'
		WHEN c.nationality = 'British-Colombian' THEN 'GB'
		WHEN c.nationality = 'Morrocan' THEN 'MA'
		WHEN c.nationality = 'Norwegian' THEN 'NO'
		WHEN c.nationality = 'Cypriot' THEN 'CY'
		WHEN c.nationality = 'Irish passport' THEN 'IE'
		WHEN c.nationality = 'Viet Nam' THEN 'VN'
		WHEN c.nationality = 'Portugal - EU Passport' THEN 'PT'
		WHEN c.nationality = 'Maurician' THEN 'MU'
		WHEN c.nationality = 'British/American' THEN 'GB'
		WHEN c.nationality = 'Czech' THEN 'CZ'
		WHEN c.nationality = 'Italian and Brazilian' THEN 'IT'
		WHEN c.nationality = 'Senegal' THEN 'SN'
		WHEN c.nationality = 'American / British' THEN 'GB'
		WHEN c.nationality = 'turkish' THEN 'TR'
		WHEN c.nationality = 'Bangladesh' THEN 'BD'
		WHEN c.nationality = 'nepalese' THEN 'NP'
		WHEN c.nationality = 'Kuwait' THEN 'KW'
		WHEN c.nationality = 'Peruvian' THEN 'PE'
		WHEN c.nationality = 'Singapore' THEN 'SG'
		WHEN c.nationality = 'British - Ivory Coast' THEN 'GB'
		WHEN c.nationality = 'Chinese' THEN 'CN'
		WHEN c.nationality = 'Norweigan' THEN 'NO'
		WHEN c.nationality = 'Australian and British' THEN 'GB'
		WHEN c.nationality = 'Ghana' THEN 'GH'
		WHEN c.nationality = 'mexican' THEN 'MX'
		WHEN c.nationality = 'Portugese' THEN 'PT'
		WHEN c.nationality = 'Russian/British' THEN 'GB'
		WHEN c.nationality = 'Nigerian/British' THEN 'GB'
		WHEN c.nationality = 'US and Spanish' THEN 'US'
		WHEN c.nationality = 'UK Citizen' THEN 'GB'
		WHEN c.nationality = 'Tunisia' THEN 'TN'
		WHEN c.nationality = 'Brazilian' THEN 'BR'
		WHEN c.nationality = 'Chile' THEN 'CL'
		WHEN c.nationality = 'Australian' THEN 'AU'
		WHEN c.nationality = 'moroccan' THEN 'MO'
		WHEN c.nationality = 'Canadian Hungarian' THEN 'HU'
		WHEN c.nationality = 'Canadian National (Indefinite leave to remain)' THEN 'GB'
		WHEN c.nationality = 'Canadian' THEN 'CA'
		WHEN c.nationality = 'Italian & French' THEN 'IT'
		WHEN c.nationality = 'German Passport' THEN 'DE'
		WHEN c.nationality = 'Cameroon' THEN 'CM'
		WHEN c.nationality = 'Germa' THEN 'DE'
		WHEN c.nationality = 'British Citizen' THEN 'GB'
		WHEN c.nationality = 'Belgian' THEN 'BE'
		WHEN c.nationality = 'Argentinean' THEN 'AR'
		WHEN c.nationality = 'British and Irish' THEN 'GB'
		WHEN c.nationality = 'Australian - TIER 5 MOBILITY VISA' THEN 'AU'
		WHEN c.nationality = 'French/British' THEN 'GB'
		WHEN c.nationality = 'south african - portuguese dual nationality' THEN 'PT'
		WHEN c.nationality = 'Dual Austrian and American' THEN 'AU'
		WHEN c.nationality = 'Nigerian  On a Spouse Visa' THEN 'NG'
		WHEN c.nationality = 'British - UK resident' THEN 'GB'
		WHEN c.nationality = 'Jordanian' THEN 'JO'
		WHEN c.nationality = 'Australian / British' THEN 'GB'
		WHEN c.nationality = 'Malaysian' THEN 'MY'
		WHEN c.nationality = 'British and South African' THEN 'GB'
		WHEN c.nationality = 'Serbian' THEN 'RS'
		WHEN c.nationality = 'British (UK)' THEN 'GB'
		WHEN c.nationality = 'Polish (EU)' THEN 'PL'
		WHEN c.nationality = 'Italian, Spanish' THEN 'IT'
		WHEN c.nationality = 'American / French / British' THEN 'GB'
		WHEN c.nationality = 'Britsih' THEN 'GB'
		WHEN c.nationality = 'Republic of Korea' THEN 'KP'
		WHEN c.nationality = 'Colombia' THEN 'CO'
		WHEN c.nationality = 'african' THEN 'CF'
		WHEN c.nationality = 'austrlian' THEN 'AU'
		WHEN c.nationality = 'Jamaica' THEN 'JM'
		WHEN c.nationality = 'English' THEN 'GB'
		WHEN c.nationality = 'Itallian' THEN 'IT'
		WHEN c.nationality = 'New Zealend' THEN 'NZ'
		WHEN c.nationality = 'Latvian' THEN 'LV'
		WHEN c.nationality = 'Nnigerian' THEN 'NG'
		WHEN c.nationality = 'British/Kiwi' THEN 'GB'
		WHEN c.nationality = 'New Zealand / Australian' THEN 'AU'
		WHEN c.nationality = 'British and Russian' THEN 'GB'
		WHEN c.nationality = 'Mauritian' THEN 'MU'
		WHEN c.nationality = 'Sri Lankan' THEN 'SL'
		WHEN c.nationality = 'Ivorian' THEN 'CI'
		WHEN c.nationality = 'Cyrpriot' THEN 'CY'
		WHEN c.nationality = 'Chilean/italian' THEN 'IT'
		WHEN c.nationality = 'French/German' THEN 'FR'
		WHEN c.nationality = 'Finnish' THEN 'FI'
		WHEN c.nationality = 'Amercian' THEN 'US'
		WHEN c.nationality = 'Cameroonian' THEN 'CM'
		WHEN c.nationality = 'Israeli' THEN 'IL'
		WHEN c.nationality = 'British Canadian' THEN 'GB'
		WHEN c.nationality = 'Romainian' THEN 'RO'
		WHEN c.nationality = 'brit' THEN 'GB'
		WHEN c.nationality = 'Philippines' THEN 'PH'
		WHEN c.nationality = 'British - Irish' THEN 'GB'
		WHEN c.nationality = 'Inidan' THEN 'IN'
		WHEN c.nationality = 'Dual Nationality Burundi + British' THEN 'GB'
		WHEN c.nationality = 'Dual Nationality : British/Danish' THEN 'GB'
		WHEN c.nationality = 'British/Indian' THEN 'GB'
		WHEN c.nationality = 'Italian / German' THEN 'IT'
		WHEN c.nationality = 'saudi and egyptian' THEN 'SA'
		WHEN c.nationality = 'Zambian' THEN 'ZM'
		WHEN c.nationality = 'Taiwanese' THEN 'TW'
		WHEN c.nationality = 'Idian - Indefinite leave to remain' THEN 'GB'
		WHEN c.nationality = 'Danish' THEN 'DK'
		WHEN c.nationality = 'Greek/ New Zealander' THEN 'GR'
		WHEN c.nationality = 'British Bangldeshi' THEN 'GB'
		WHEN c.nationality = 'Dannish' THEN 'DK'
		WHEN c.nationality = 'slovenian' THEN 'SI'
		WHEN c.nationality = 'Zimbabwean' THEN 'ZW'
		WHEN c.nationality = 'Austrailian' THEN 'AU'
		WHEN c.nationality = 'British (via Marriage)' THEN 'GB'
		WHEN c.nationality = 'Kenyan' THEN 'KE'
		WHEN c.nationality = 'Bangleshi' THEN 'BD'
		WHEN c.nationality = 'portguese' THEN 'PT'
		WHEN c.nationality = 'British / Swiss' THEN 'GB'
		WHEN c.nationality = 'Italian and Australian' THEN 'IT'
		WHEN c.nationality = 'Indian - tier 2' THEN 'IN'
		WHEN c.nationality = 'Thailand' THEN 'TH'
		WHEN c.nationality = 'Itlaian' THEN 'IT'
		WHEN c.nationality = 'Turkish Passport' THEN 'TR'
		WHEN c.nationality = 'Britsh' THEN 'GB'
		WHEN c.nationality = 'Moroccan / Canadian' THEN 'MO'
		WHEN c.nationality = 'New Zealanders' THEN 'NZ'
		WHEN c.nationality = 'Ghanaian' THEN 'GH'
		WHEN c.nationality = 'British passport - Mauritian orginally' THEN 'GB'
		WHEN c.nationality = 'indian - work permit no sponsership' THEN 'IN'
		WHEN c.nationality = 'Filipino' THEN 'PH'
		WHEN c.nationality = 'EU Passport French/German' THEN 'FR'
		WHEN c.nationality = 'Italian / Brazilian' THEN 'IT'
		WHEN c.nationality = 'New Zealand and Irish' THEN 'IE'
		WHEN c.nationality = 'Slovakian' THEN 'SK'
		WHEN c.nationality = 'dual: French and morrocan' THEN 'FR'
		WHEN c.nationality = 'mayanmar' THEN 'MM'
		WHEN c.nationality = 'Israeli and British' THEN 'GB'
		WHEN c.nationality = 'bangladeshi' THEN 'BD'
		WHEN c.nationality = 'Iranian' THEN 'IR'
		WHEN c.nationality = 'British & NZ European' THEN 'GB'
		WHEN c.nationality = 'Braillian' THEN 'BR'
		WHEN c.nationality = 'Moldova, Republic of' THEN 'MD'
		WHEN c.nationality = 'Venezualan' THEN 'VE'
		WHEN c.nationality = 'Nepali' THEN 'NP'
		WHEN c.nationality = 'Morrocon' THEN 'MO'
		WHEN c.nationality = 'Brtish' THEN 'GB'
		WHEN c.nationality = 'Indian;' THEN 'IN'
		WHEN c.nationality = 'Eritrean' THEN 'ER'
		WHEN c.nationality = 'Swiss' THEN 'CH'
		WHEN c.nationality = 'british/australian' THEN 'GB'
		WHEN c.nationality = 'Colombian' THEN 'CO'
		WHEN c.nationality = 'Canadian / Polish' THEN 'PL'
		WHEN c.nationality = 'British / Jamaican' THEN 'GB'
		WHEN c.nationality = 'british/australiasn' THEN 'GB'
		WHEN c.nationality = 'Algeria' THEN 'DZ'
		WHEN c.nationality = 'marititus' THEN 'MU'
		WHEN c.nationality = 'New Zeland' THEN 'NZ'
		WHEN c.nationality = 'sri lanken' THEN 'SL'
		WHEN c.nationality = 'British - Nigerian' THEN 'GB'
		WHEN c.nationality = 'Bulgarian/English' THEN 'GB'
		WHEN c.nationality = 'Sweedish' THEN 'SE'
		WHEN c.nationality = 'british and italian' THEN 'GB'
		WHEN c.nationality = 'itlalian' THEN 'IT'
		WHEN c.nationality = 'Lebanese' THEN 'LB'
		WHEN c.nationality = 'Spanish/German' THEN 'ES'
		WHEN c.nationality = 'UK' THEN 'GB'
		WHEN c.nationality = 'Bolivian' THEN 'BO'
		WHEN c.nationality = 'Dutch/British' THEN 'GB'
		WHEN c.nationality = 'British/Spanish' THEN 'GB'
		WHEN c.nationality = 'Duel US and UK' THEN 'GB'
		WHEN c.nationality = 'jamaican' THEN 'JM'
		WHEN c.nationality = 'Chinnese' THEN 'CN'
		WHEN c.nationality = 'Bermuda' THEN 'BM'
		WHEN c.nationality = 'Indian; German' THEN 'DE'
		WHEN c.nationality = 'grenadian' THEN 'GD'
		WHEN c.nationality = 'TRINIDADIAN' THEN 'TT'
		WHEN c.nationality = 'Indonesia' THEN 'ID'
		WHEN c.nationality = 'Slovak' THEN 'SK'
		WHEN c.nationality = 'Sudanese' THEN 'SD'
		WHEN c.nationality = 'Estonian' THEN 'EE'
		WHEN c.nationality = 'Vietnamese' THEN 'VM'
		WHEN c.nationality = 'Spanish (EU citizen)' THEN 'ES'
		WHEN c.nationality = 'singaporean' THEN 'SG'
		WHEN c.nationality = 'Libya' THEN 'LY'
		WHEN c.nationality = 'French/Canadian' THEN 'FR'
		WHEN c.nationality = 'Tunisian' THEN 'TN'
		WHEN c.nationality = 'Lebonese' THEN 'LB'
		WHEN c.nationality = 'South Afican' THEN 'ZA'
		WHEN c.nationality = 'Samoan' THEN 'WS'
		WHEN c.nationality = 'Belgain' THEN 'BE'
		WHEN c.nationality = 'British Indian' THEN 'GB'
		WHEN c.nationality = 'Trinidad' THEN 'TT'
		WHEN c.nationality = 'Austalian' THEN 'AU'
		WHEN c.nationality = 'Welsh' THEN 'GB'
		WHEN c.nationality = 'Austrian' THEN 'AT'
		WHEN c.nationality = 'British, Egyptian' THEN 'GB'
		WHEN c.nationality = 'Afgan' THEN 'AF'
		WHEN c.nationality = 'Syrian' THEN 'SY'
		WHEN c.nationality = 'Irish/Russian' THEN 'IE'
		WHEN c.nationality = 'Nicaragua' THEN 'NI'
		WHEN c.nationality = 'Brazilian (Italian dual nationality)' THEN 'IT'
		WHEN c.nationality = 'South Africa/ British' THEN 'GB'
		WHEN c.nationality = 'SriLankan' THEN 'SL'
		WHEN c.nationality = 'Palestinian' THEN 'PS'
		WHEN c.nationality = 'Spannish' THEN 'ES'
		WHEN c.nationality = 'Australian, Italian Passport' THEN 'IT'
		WHEN c.nationality = 'British & Australian (Dual Citizenship)' THEN 'GB'
		WHEN c.nationality = 'Persian' THEN 'IR'
		WHEN c.nationality = 'Albania' THEN 'AL'
		WHEN c.nationality = 'Belarus' THEN 'BY'
		WHEN c.nationality = 'Icelandic' THEN 'IS'
		WHEN c.nationality = 'British/Canadian' THEN 'GB'
		WHEN c.nationality = 'Ugandan' THEN 'UG'
		WHEN c.nationality = 'Romanian - British passport' THEN 'GB'
		WHEN c.nationality = 'British and Chillian' THEN 'GB'
		WHEN c.nationality = 'british,' THEN 'GB'
		WHEN c.nationality = 'Australian/British' THEN 'GB'
		WHEN c.nationality = 'Indian Passport' THEN 'IN'
		WHEN c.nationality = 'New Zealand and Russian Passport' THEN 'NZ'
		WHEN c.nationality = 'Lithuanian nationality' THEN 'LT'
		WHEN c.nationality = 'Dutch Passport' THEN 'NL'
		WHEN c.nationality = 'Egyptian' THEN 'EG'
		WHEN c.nationality = 'Indian - Tier 2 - General Dependant' THEN 'IN'
		WHEN c.nationality = 'USA and French' THEN 'FR'
		WHEN c.nationality = 'Brazilian / Polish' THEN 'PL'
		WHEN c.nationality = 'Belgian Passport' THEN 'BE'
		WHEN c.nationality = 'Black British' THEN 'GB'
		WHEN c.nationality = 'British/Russian' THEN 'GB'
		WHEN c.nationality = 'Ieland' THEN 'IS'
		WHEN c.nationality = 'Belerusian' THEN 'BY'
		WHEN c.nationality = 'Polish and British' THEN 'GB'
		WHEN c.nationality = 'US & British' THEN 'GB'
		WHEN c.nationality = 'French/Egyptian' THEN 'FR'
		WHEN c.nationality = 'Israeli & Romanian' THEN 'RO'
		WHEN c.nationality = 'German/Italian' THEN 'DE'
		WHEN c.nationality = 'Irish Canadian' THEN 'IE'
		WHEN c.nationality = 'Tibetan' THEN 'CN'
		WHEN c.nationality = 'Malasian' THEN 'MY'
		WHEN c.nationality = 'Pakistani Passport' THEN 'PK'
		WHEN c.nationality = 'Korean' THEN 'KP'
		WHEN c.nationality = 'Ukranian' THEN 'UA'
		WHEN c.nationality = 'Sudan' THEN 'SD'
		WHEN c.nationality = 'Brazilian Passport' THEN 'BR'
		WHEN c.nationality = 'Georgian' THEN 'GE'
		WHEN c.nationality = 'Qatar' THEN 'QA'
		WHEN c.nationality = 'Pakistan Passport' THEN 'PK'
		WHEN c.nationality = 'Pakistan- Spouse Visa' THEN 'PK'
		WHEN c.nationality = 'Crostian' THEN 'HR'
		WHEN c.nationality = 'Greek/British' THEN 'GB'
		WHEN c.nationality = 'Rwanda' THEN 'RW'
		WHEN c.nationality = 'USA/Canada' THEN 'US'
		WHEN c.nationality = 'Canadian/Lithuanian' THEN 'LT'
		WHEN c.nationality = 'Barbados' THEN 'BB'
		WHEN c.nationality = 'US Citizen' THEN 'US'
		WHEN c.nationality = 'Belarussian' THEN 'BY'
		WHEN c.nationality = 'US Passport' THEN 'US'
		WHEN c.nationality = 'US' THEN 'US'
		WHEN c.nationality = 'Kyrgyzstan' THEN 'KG'
		WHEN c.nationality = 'Candian' THEN 'CA'
		WHEN c.nationality = 'Croatian' THEN 'HR'
		WHEN c.nationality = 'British/Nigerian' THEN 'GB'
		WHEN c.nationality = 'Belarusian' THEN 'BY'
		WHEN c.nationality = 'Austaliam' THEN 'AU'
		WHEN c.nationality = 'Mexican passport' THEN 'MX'
		WHEN c.nationality = 'Angolian' THEN 'AO'
		WHEN c.nationality = 'United States - British Passport' THEN 'GB'
		WHEN c.nationality = 'Philippine' THEN 'PH'
		WHEN c.nationality = 'Isreal' THEN 'IL'
		WHEN c.nationality = 'Briitsh' THEN 'GB'
		WHEN c.nationality = 'American Irish' THEN 'IE'
		WHEN c.nationality = 'Botswana' THEN 'BW'
		WHEN c.nationality = 'Russian / American' THEN 'US'
		WHEN c.nationality = 'Dominican Republic' THEN 'DO'
		WHEN c.nationality = 'Uzbekistan' THEN 'UZ'
		WHEN c.nationality = 'Venezuelan' THEN 'VE'
		WHEN c.nationality = 'Barbadian National' THEN 'BB'
		WHEN c.nationality = 'Finnish National' THEN 'FI'
		WHEN c.nationality = 'kazakhstani' THEN 'KZ'
		WHEN c.nationality = 'Dual Citizenship of Romanian and Moldavian.' THEN 'RO'
		WHEN c.nationality = 'Ecuadorian' THEN 'EC'
		WHEN c.nationality = 'South Korean' THEN 'KP'
		WHEN c.nationality = 'Maltese' THEN 'MT'
		WHEN c.nationality = 'Nowegian' THEN 'NO'
		WHEN c.nationality = 'b=British' THEN 'GB'
		WHEN c.nationality = 'Ukrainian' THEN 'UA'
		WHEN c.nationality = 'Swiss French National' THEN 'CH'
		WHEN c.nationality = 'Greek/Albanian' THEN 'GR'
		WHEN c.nationality = 'Afghan' THEN 'AF'
		WHEN c.nationality = 'Somalia' THEN 'SO'
		WHEN c.nationality = 'Welsh - EU' THEN 'GB'
		WHEN c.nationality = 'Portuguese/Brazilian' THEN 'PT'
	END nationality
FROM alpha_candidate c
JOIN alpha_person p ON c.person_id = p.id
JOIN candidate_fe cf ON c.person_id = cf.candidate_id
WHERE NULLIF(c.nationality, '') IS NOT NULL