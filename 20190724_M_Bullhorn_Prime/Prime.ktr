<?xml version="1.0" encoding="UTF-8"?>
<transformation>
  <info>
    <name>Prime</name>
    <description/>
    <extended_description/>
    <trans_version/>
    <trans_type>Normal</trans_type>
    <trans_status>0</trans_status>
    <directory>&#x2f;</directory>
    <parameters>
    </parameters>
    <log>
      <trans-log-table>
        <connection/>
        <schema/>
        <table/>
        <size_limit_lines/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
          <subject/>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
          <subject/>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
          <subject/>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
          <subject/>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </trans-log-table>
      <perf-log-table>
        <connection/>
        <schema/>
        <table/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>SEQ_NR</id>
          <enabled>Y</enabled>
          <name>SEQ_NR</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>INPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>INPUT_BUFFER_ROWS</name>
        </field>
        <field>
          <id>OUTPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>OUTPUT_BUFFER_ROWS</name>
        </field>
      </perf-log-table>
      <channel-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
      <step-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
      </step-log-table>
      <metrics-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>METRICS_DATE</id>
          <enabled>Y</enabled>
          <name>METRICS_DATE</name>
        </field>
        <field>
          <id>METRICS_CODE</id>
          <enabled>Y</enabled>
          <name>METRICS_CODE</name>
        </field>
        <field>
          <id>METRICS_DESCRIPTION</id>
          <enabled>Y</enabled>
          <name>METRICS_DESCRIPTION</name>
        </field>
        <field>
          <id>METRICS_SUBJECT</id>
          <enabled>Y</enabled>
          <name>METRICS_SUBJECT</name>
        </field>
        <field>
          <id>METRICS_TYPE</id>
          <enabled>Y</enabled>
          <name>METRICS_TYPE</name>
        </field>
        <field>
          <id>METRICS_VALUE</id>
          <enabled>Y</enabled>
          <name>METRICS_VALUE</name>
        </field>
      </metrics-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file/>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit/>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
    <created_user/>
    <created_date>2017&#x2f;01&#x2f;20 16&#x3a;14&#x3a;34.085</created_date>
    <modified_user/>
    <modified_date>2017&#x2f;01&#x2f;20 16&#x3a;14&#x3a;34.085</modified_date>
    <key_for_session_key>H4sIAAAAAAAAAAMAAAAAAAAAAAA&#x3d;</key_for_session_key>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
    <notepad>
      <note>COMPANY</note>
      <xloc>176</xloc>
      <yloc>32</yloc>
      <width>68</width>
      <heigth>26</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>CONTACT</note>
      <xloc>736</xloc>
      <yloc>32</yloc>
      <width>65</width>
      <heigth>26</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>JOB</note>
      <xloc>1344</xloc>
      <yloc>32</yloc>
      <width>31</width>
      <heigth>26</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>CANDIDATE</note>
      <xloc>1936</xloc>
      <yloc>32</yloc>
      <width>79</width>
      <heigth>26</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>Contact distribution list</note>
      <xloc>576</xloc>
      <yloc>1168</yloc>
      <width>135</width>
      <heigth>26</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>Settings</note>
      <xloc>80</xloc>
      <yloc>1088</yloc>
      <width>53</width>
      <heigth>26</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>done</note>
      <xloc>128</xloc>
      <yloc>544</yloc>
      <width>38</width>
      <heigth>26</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>128</backgroundcolorred>
      <backgroundcolorgreen>255</backgroundcolorgreen>
      <backgroundcolorblue>128</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>No candidate industry</note>
      <xloc>2128</xloc>
      <yloc>960</yloc>
      <width>127</width>
      <heigth>26</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>Null value</note>
      <xloc>2048</xloc>
      <yloc>1360</yloc>
      <width>64</width>
      <heigth>26</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>notice invalid format</note>
      <xloc>1888</xloc>
      <yloc>400</yloc>
      <width>121</width>
      <heigth>26</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
  </notepads>
  <connection>
    <name>from</name>
    <server>localhost</server>
    <type>MSSQL</type>
    <access>Native</access>
    <database>thisisprime</database>
    <port>1433</port>
    <username>sa</username>
    <password>Encrypted 2be98afc86aa7f2d5f94aea35e083b8df</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1433</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>Y</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>from &#x28;PROD&#x29;</name>
    <server>localhost</server>
    <type>MSSQL</type>
    <access>Native</access>
    <database>prime_prod</database>
    <port>1433</port>
    <username>sa</username>
    <password>Encrypted 2be98afc86aa7f2d5f94aea35e083b8df</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1433</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>Y</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>to</name>
    <server>localhost</server>
    <type>POSTGRESQL</type>
    <access>Native</access>
    <database>mike</database>
    <port>5432</port>
    <username>postgres</username>
    <password>Encrypted 2be98afc86aa7f2e4cb79ff228dc6fa8c</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>5432</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>Y</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>to &#x28;PROD&#x29;</name>
    <server>10.0.9.121</server>
    <type>POSTGRESQL</type>
    <access>Native</access>
    <database>prime.vincere.io</database>
    <port>5432</port>
    <username>dbapplication_user</username>
    <password>Encrypted 2be98afc819e8b9aebe11bd63cb8b9ae3</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>5432</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>Y</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <order>
    <hop>
      <from>Comp lookup</from>
      <to>Insert &#x2f; Update activities</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>BULLHORN Job Application - Rejected</from>
      <to>position_description</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>candidate 3 2 2</from>
      <to>Update 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>position_description</from>
      <to>candidate 3 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>candidate id</from>
      <to>industry</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>candidate industry 2</from>
      <to>candidate id</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>industry</from>
      <to>candidate_industry</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>candidate industry</from>
      <to>industry 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>industry 2</from>
      <to>candidate industry 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>contact id 2</from>
      <to>industry 4</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>contact industry 2 2</from>
      <to>contact id 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>industry 4</from>
      <to>contact_industry 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>contact industry 3</from>
      <to>industry 2 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>industry 2 3</from>
      <to>contact industry 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>contact</from>
      <to>additional_form_values InsertUpdate 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>cf 2</from>
      <to>contact</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>contact FE-SFE</from>
      <to>contact id</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>contact id</from>
      <to>fe</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>fe</from>
      <to>contact_functional_expertise 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Can desired_contract_rate</from>
      <to>Update 3 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Comp lookup</from>
      <to>company activity</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Company Location</from>
      <to>comp lookup 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>comp lookup 2</from>
      <to>Insert contact work location</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>DB industry</from>
      <to>Insert new industry</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>company industry</from>
      <to>lookup company</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>lookup company</from>
      <to>lookup industry</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>lookup industry</from>
      <to>VC company_industry</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>BH Contact Location</from>
      <to>contact lookup</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>contact lookup</from>
      <to>Insert &#x2f; Update common loc</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate info</from>
      <to>candidate lookup 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>candidate lookup 3</from>
      <to>candidate reg date</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Job lookup</from>
      <to>compensation</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Job - FromSalary - ToSalary</from>
      <to>Job lookup</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate Comment</from>
      <to>Candidate lookup 6</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate lookup 6</from>
      <to>Insert &#x2f; Update Activity</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate lookup 6</from>
      <to>candidate activities</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Company - table</from>
      <to>Comp lookup 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Comp lookup 3</from>
      <to>employees_number</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Comp lookup 3</from>
      <to>info</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Contact Comment</from>
      <to>contact lookup 4</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>contact lookup 4</from>
      <to> Contact Comment</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>contact lookup 4</from>
      <to>Insert &#x2f; Update - Contact Comment</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>contact FE-SFE 2</from>
      <to>contact id 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>contact id 3</from>
      <to>fe 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>fe 3</from>
      <to>sfe 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>sfe 3</from>
      <to>contact_functional_expertise 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>job lookup 6</from>
      <to>Update public desc</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>position_publicDescription</from>
      <to>job lookup 6</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate desire_salary</from>
      <to>Update Candidate desire_salary</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Company Comment</from>
      <to>Comp lookup</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Contact location</from>
      <to>comp lookup 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Contact Distribution</from>
      <to>Contact lookup 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Contact Distribution DB</from>
      <to>Add Distribution</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Contact lookup 3</from>
      <to>Distribution lookup</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Distribution lookup</from>
      <to>Contact Distribution list</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Contact location 2</from>
      <to>contact lookup</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>company location lookup</from>
      <to>contact work location</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>comp lookup 4</from>
      <to>company location lookup</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>contact lookup</from>
      <to>comp lookup 4</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Functional Exp</from>
      <to>Vincere FE</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>FE lookup 2</from>
      <to>VC SFE</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Sub FE</from>
      <to>FE lookup 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>BULLHORN Contact Info</from>
      <to>contact lookup 5</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>contact lookup 5</from>
      <to>Update contact info</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Job - contract_rate  FROM&#x2f;TO</from>
      <to>Job lookup</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Job lookup</from>
      <to>job contract</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Job info</from>
      <to>Job lookup</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Job lookup</from>
      <to>update job info</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>lookup industry 2</from>
      <to>VC job_industry</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>job industry</from>
      <to>Job lookup 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Job lookup 2</from>
      <to>lookup industry 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>BULLHORN Job Comment</from>
      <to>Job lookup 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Job lookup 3</from>
      <to>Job activity</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Job lookup 3</from>
      <to>Insert &#x2f; Update 2 3 2 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>CF - Industry broadbean</from>
      <to>Job lookup 4</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Job lookup 4</from>
      <to>Insert custom field</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>CF -linkedJobPostingID</from>
      <to>Job lookup 4</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>FE lookup</from>
      <to>VC SFE lookup</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>VC SFE lookup</from>
      <to>Insert &#x2f; Update Contact FESFE</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Contact FE SFE</from>
      <to>Job lookup 5</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Job lookup 5</from>
      <to>FE lookup</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>BH Contact Email Body</from>
      <to>contact lookup 6</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>contact lookup 6</from>
      <to>Insert - Contact Comment 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>contact lookup 6</from>
      <to>Insert &#x2f; Update 2 2 3 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate Source DB</from>
      <to>Insert &#x2f; Update 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate Source</from>
      <to>Candidate lookup</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate lookup</from>
      <to>Candidate source lookup</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate source lookup</from>
      <to>Update candidate source</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Employment history summary</from>
      <to>Candidate lookup 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate lookup 2</from>
      <to>Update work history</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Education summary</from>
      <to>Candidate lookup 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate lookup 2</from>
      <to>Update edu summary</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>BH Candidate Email Body</from>
      <to>Candidate lookup 6</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate lookup 6</from>
      <to>candidate activities 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate lookup 6</from>
      <to>Insert &#x2f; Update 2 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>candidate notes</from>
      <to>Candidate lookup 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate lookup 2</from>
      <to>candidate notes 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate LTD company</from>
      <to>Candidate lookup 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate lookup 2 2</from>
      <to>additional_form_values LTD</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>comp lookup 2</from>
      <to>Insert company location</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Contact Document 2</from>
      <to>contact 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>contact 2 2</from>
      <to>candidate_document 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Extract company document</from>
      <to>lookup companyid</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>lookup company_legal_document</from>
      <to>update legal_document</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>lookup companyid</from>
      <to>lookup company_legal_document</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Extract job document</from>
      <to>lookup jobid</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>lookup jobid</from>
      <to>update job_document</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Extract Candidate Documents</from>
      <to>lookup candidateid</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>lookup candidateid</from>
      <to>update candidate_document</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Job info end date</from>
      <to>Job lookup</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Job lookup</from>
      <to>update job end date</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Job FE</from>
      <to>Job lookup 7</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Job lookup 7</from>
      <to>fe 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>fe 2</from>
      <to>Insert Job FESFE</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate FE&#x2f;SFE</from>
      <to>candidate lookup 5</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>FE lookup 3</from>
      <to>SFE lookup</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>SFE lookup</from>
      <to>Insert candidate FESFE</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>candidate lookup 5</from>
      <to>FE lookup 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate notice period</from>
      <to>candidate lookup 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>candidate lookup 3</from>
      <to>candidate notice</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate desired location</from>
      <to>candidate lookup 4</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>candidate lookup 4</from>
      <to>Common location</to>
      <enabled>N</enabled>
    </hop>
  </order>
  <step>
    <name> Contact Comment</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <schema>public</schema>
    <table>activity</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>N</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field>contactid</partitioning_field>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>contact_id</column_name>
          <stream_name>actual_contactid</stream_name>
        </field>
        <field>
          <column_name>user_account_id</column_name>
          <stream_name>user_account_id</stream_name>
        </field>
        <field>
          <column_name>insert_timestamp</column_name>
          <stream_name>insert_timestamp</stream_name>
        </field>
        <field>
          <column_name>content</column_name>
          <stream_name>content</stream_name>
        </field>
        <field>
          <column_name>type</column_name>
          <stream_name>type</stream_name>
        </field>
        <field>
          <column_name>category</column_name>
          <stream_name>category</stream_name>
        </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>880</xloc>
      <yloc>80</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Add Distribution</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <schema>public</schema>
    <table>contact_group</table>
    <commit>100</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>name</column_name>
          <stream_name>GROUP_NAME</stream_name>
        </field>
        <field>
          <column_name>owner_id</column_name>
          <stream_name>owner_id</stream_name>
        </field>
        <field>
          <column_name>insert_timestamp</column_name>
          <stream_name>insert_timestamp</stream_name>
        </field>
        <field>
          <column_name>share_permission</column_name>
          <stream_name>share_permission</stream_name>
        </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>720</xloc>
      <yloc>1216</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>BH Candidate Email Body</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from &#x28;PROD&#x29;</connection>
    <sql>&#x2f;&#x2a;&#xd;&#xa;alter table BULLHORN1.BH_UserMessage add email_content_ nvarchar&#x28;max&#x29;&#x3b; &#xd;&#xa;alter table BULLHORN1.BH_UserMessage add tmp_decompressed nvarchar&#x28;max&#x29;&#x3b;&#xd;&#xa;alter table BULLHORN1.BH_UserMessage add content_full nvarchar&#x28;max&#x29;&#x3b; &#xd;&#xa;&#xd;&#xa;select count&#x28;&#x2a;&#x29; from tmp_emailbody&#xd;&#xa;select count&#x28;&#x2a;&#x29; from bullhorn1.bh_usermessage where email_content is null&#xd;&#xa;select count&#x28;&#x2a;&#x29; from bullhorn1.bh_usermessage where email_content is not null&#xd;&#xa;select count&#x28;&#x2a;&#x29; from bullhorn1.bh_usermessage where email_content is null and DATALENGTH&#x28;commentsCompressed&#x29; &#x3e; 0&#xd;&#xa;&#xd;&#xa;select top 10 &#x2a; from bullhorn1.bh_usermessage where subject like &#x27;RE&#x3a; Interview Confirmation&#x25; Bain &#x26; Company&#x25;&#x27;&#xd;&#xa;select top 100 userMessageID, commentsCompressed, email_content, email_content_ from bullhorn1.bh_usermessage where userMessageID in &#x28;34750,55242,15187&#x29;&#xd;&#xa;select top 100 userMessageID, email_content from bullhorn1.bh_usermessage where email_content is not null and userMessageID  &#x3e; 289000&#xd;&#xa;select top 100 userMessageID, email_content from bullhorn1.bh_usermessage where email_content is not null&#xd;&#xa;select top 100 userMessageID, email_content from bullhorn1.BH_UserMessage where userMessageID in &#x28;1107448,1187690,1187691, 166320,49950,24748,21116,22785,35342,35370,35800, 852015, 856200,1011600&#x29; order by userMessageID&#xd;&#xa;&#x2a;&#x2f;&#xd;&#xa;&#xd;&#xa;-- EMAIL BODY&#xd;&#xa;&#xd;&#xa;with EmailBody as &#xd;&#xa;&#x28;&#xd;&#xa;        -- RECEIVER&#xd;&#xa;        select --top 100 &#xd;&#xa;                um.userMessageID --,um.sendingUserID&#xd;&#xa;              , ca.candidateid --, ca.userid,ca.recruiteruserid,ca.firstname,ca.lastname,ca.companyname&#xd;&#xa;              , um.externalFrom, um.externalTo, um.externalCC, um.externalBCC, um.SMTPSendDate --,convert&#x28;nvarchar&#x28;max&#x29;,um.externalTo&#x29; as externalTo, convert&#x28;nvarchar&#x28;max&#x29;,um.externalCC&#x29; as externalCC, convert&#x28;nvarchar&#x28;max&#x29;,um.externalBCC&#x29; as externalBCC, um.SMTPSendDate&#xd;&#xa;              , um.subject, um.email_content, um.comments --, convert&#x28;nvarchar&#x28;max&#x29;,um.comments&#x29; as comments&#xd;&#xa;              --,mr.userID,mr.folder,mr.recipientType, mr.email, mr.sendingUserID, mr.subjectSort, mr.externalFrom&#xd;&#xa;              , umf.att --,umf.name, umf.directory&#xd;&#xa;        -- select count&#x28;&#x2a;&#x29; -- select top 2000 &#x2a;&#xd;&#xa;        from bullhorn1.BH_UserMessage um&#xd;&#xa;        --left join INT_UncompressedMessages cont on cont.userMessageID &#x3d; um.userMessageID&#xd;&#xa;        left join bullhorn1.BH_MessageRecipient mr on mr.userMessageID &#x3d; um.userMessageID&#xd;&#xa;        --left join bullhorn1.BH_UserMessageFile umf on umf.userMessageID &#x3d; um.userMessageID&#xd;&#xa;        --left join &#x28;SELECT userMessageID, STUFF&#x28;&#x28;SELECT &#x27;, &#x27; &#x2b; &#x5b;dbo&#x5d;.&#x5b;fn_ConvertHTMLToText&#x5d;&#x28;name&#x29; from bullhorn1.BH_UserMessageFile WHERE userMessageID &#x3d; a.userMessageID order by name asc FOR XML PATH &#x28;&#x27;&#x27;&#x29;, TYPE&#x29;.value&#x28;&#x27;.&#x27;, &#x27;nvarchar&#x28;64&#x29;&#x27;&#x29;, 1, 1, &#x27;&#x27;&#x29; AS att FROM bullhorn1.BH_UserMessageFile AS a GROUP BY a.userMessageID &#x29; umf on umf.userMessageID &#x3d; um.userMessageID&#xd;&#xa;        left join &#x28;SELECT userMessageID, STRING_AGG&#x28;cast&#x28;name as nvarchar&#x28;max&#x29;&#x29;,&#x27;,&#x27; &#x29; WITHIN GROUP &#x28;ORDER BY name&#x29; att &#xd;&#xa;						from bullhorn1.BH_UserMessageFile&#xd;&#xa;						GROUP BY userMessageID&#x29; umf on umf.userMessageID &#x3d; um.userMessageID        &#xd;&#xa;        left join bullhorn1.Candidate ca on ca.userid &#x3d; mr.userid&#xd;&#xa;        where mr.isDeleted &#x3d; 0 and mr.isSpam &#x3d; 0 and ca.userid is not null and ca.isdeleted &#x3c;&#x3e; 1 and ca.status &#x3c;&#x3e; &#x27;Archive&#x27;&#xd;&#xa;        --and um.userMessageID &#x3e; 2110065&#xd;&#xa;        --and um.userMessageID in &#x28;2110065&#x29;&#xd;&#xa;        --and um.comments is not null and convert&#x28;varchar&#x28;max&#x29;,um.comments&#x29; &#x3c;&#x3e; &#x27;&#x27; &#xd;&#xa;        --and ca.candidateid &#x3d; 565        &#xd;&#xa;        --and convert&#x28;nvarchar&#x28;max&#x29;,um.externalCC&#x29; &#x21;&#x3d; &#x27;&#x27; and um.externalCC is not null and convert&#x28;nvarchar&#x28;max&#x29;,um.externalBCC&#x29; &#x21;&#x3d; &#x27;&#x27; and um.externalBCC is not null&#xd;&#xa;        --and um.SMTPSendDate &#x3e; &#x27;2018-01-01&#x27;&#xd;&#xa;&#xd;&#xa;UNION ALL&#xd;&#xa;        -- SENDER&#xd;&#xa;        select --top 100&#xd;&#xa;                um.userMessageID --,um.sendingUserID&#xd;&#xa;              , ca.candidateid --, ca.userid,ca.recruiteruserid,ca.firstname,ca.lastname,ca.companyname&#xd;&#xa;              , um.externalFrom, um.externalTo, um.externalCC, um.externalBCC, um.SMTPSendDate --,convert&#x28;nvarchar&#x28;max&#x29;,um.externalTo&#x29; as externalTo, convert&#x28;nvarchar&#x28;max&#x29;,um.externalCC&#x29; as externalCC, convert&#x28;nvarchar&#x28;max&#x29;,um.externalBCC&#x29; as externalBCC, um.SMTPSendDate&#xd;&#xa;              , um.subject, um.email_content, um.comments --, convert&#x28;nvarchar&#x28;max&#x29;,um.comments&#x29; as comments&#xd;&#xa;              --,mr.userID,mr.folder,mr.recipientType, mr.email, mr.sendingUserID, mr.subjectSort, mr.externalFrom&#xd;&#xa;              , umf.att --,umf.name, umf.directory&#xd;&#xa;        -- select count&#x28;&#x2a;&#x29;&#xd;&#xa;        from bullhorn1.BH_UserMessage um&#xd;&#xa;        --left join INT_UncompressedMessages cont on cont.userMessageID &#x3d; um.userMessageID&#xd;&#xa;        left join bullhorn1.BH_MessageRecipient mr on mr.userMessageID &#x3d; um.userMessageID&#xd;&#xa;        --left join bullhorn1.BH_UserMessageFile umf on umf.userMessageID &#x3d; um.userMessageID&#xd;&#xa;        --left join &#x28;SELECT userMessageID, STUFF&#x28;&#x28;SELECT &#x27;, &#x27; &#x2b; name from bullhorn1.BH_UserMessageFile WHERE userMessageID &#x3d; a.userMessageID order by name asc FOR XML PATH &#x28;&#x27;&#x27;&#x29;, TYPE&#x29;.value&#x28;&#x27;.&#x27;, &#x27;nvarchar&#x28;MAX&#x29;&#x27;&#x29;, 1, 1, &#x27;&#x27;&#x29; AS att FROM bullhorn1.BH_UserMessageFile AS a GROUP BY a.userMessageID &#x29; umf on umf.userMessageID &#x3d; um.userMessageID&#xd;&#xa;        left join &#x28;SELECT userMessageID, STRING_AGG&#x28;cast&#x28;name as nvarchar&#x28;max&#x29;&#x29;,&#x27;,&#x27; &#x29; WITHIN GROUP &#x28;ORDER BY name&#x29; att &#xd;&#xa;						from bullhorn1.BH_UserMessageFile&#xd;&#xa;						GROUP BY userMessageID&#x29; umf on umf.userMessageID &#x3d; um.userMessageID        &#xd;&#xa;        left join bullhorn1.Candidate ca on ca.userid &#x3d; um.sendingUserID&#xd;&#xa;        where um.isSenderDeleted &#x3d; 0 and ca.userid is not null and ca.isdeleted &#x3c;&#x3e; 1 and ca.status &#x3c;&#x3e; &#x27;Archive&#x27;&#xd;&#xa;        --and convert&#x28;nvarchar&#x28;max&#x29;,um.comments&#x29; &#x3c;&#x3e; &#x27;&#x27; &#x29; &#xd;&#xa;        --and ca.candidateid &#x3d; 565&#xd;&#xa;        --and um.SMTPSendDate &#x3e; &#x27;2018-01-01&#x27;&#xd;&#xa;        --and  um.userMessageID in &#x28;6212861, 6204234&#x29;&#xd;&#xa;&#xd;&#xa;&#x29;&#xd;&#xa;&#xd;&#xa;--select count&#x28;&#x2a;&#x29; from EmailBody --357266&#xd;&#xa;-- select top 100 &#x2a; from EmailBody where candidateid between 124602 and 128601&#xd;&#xa;&#x2f;&#x2a; select candidateid, concat&#x28;&#x27;insert into position_candidate_feedback &#x28;candidate_id, user_account_id, feedback_timestamp, comment_body, feedback_score, insert_timestamp, contact_method, json_relate_info, related_status&#x29; values &#x28; &#xd;&#xa;        &#x28;select id from candidate where external_id &#x3d; &#x27;&#x27;&#x27;,candidateid,&#x27;&#x27;&#x27;&#x29;, &#x27;,-10,&#x27;, now&#x28;&#x29;, &#x27;&#x27;&#x27;,replace&#x28;concat&#x28;&#x27;Date Created&#x3a; &#x27;,convert&#x28;varchar,SMTPSendDate,120&#x29;,char&#x28;10&#x29;,&#x27;From&#x3a; &#x27;,externalFrom,char&#x28;10&#x29;,&#x27;To&#x3a; &#x27;,externalTo,char&#x28;10&#x29;,&#x27;CC&#x3a; &#x27;,externalCC,char&#x28;10&#x29;,&#x27;Subject&#x3a; &#x27;,subject,char&#x28;10&#x29;,char&#x28;10&#x29;,&#x27;Content&#x3a; &#x27;,comments&#x29;,&#x27;&#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x29;,&#x27;&#x27;&#x27;, 0, now&#x28;&#x29;, 4, &#x27;&#x27;&#x5b;&#x5d;&#x27;&#x27;, 1&#x29;&#x3b;&#x27;&#x29; as EmailSQL&#xd;&#xa;from EmailBody --where candidateid &#x3d; 33&#xd;&#xa;order by SMTPSendDate desc &#x2a;&#x2f;&#xd;&#xa;&#xd;&#xa;--select count&#x28;&#x2a;&#x29; from EmailBody&#xd;&#xa;&#xd;&#xa;select --top 10&#xd;&#xa;          userMessageID&#xd;&#xa;        --, userid, concat&#x28;firstname, &#x27; &#x27;,lastname&#x29; as fullname, recruiteruserid, companyname, sendingUserID&#xd;&#xa;        , concat&#x28;&#x27;PR&#x27;, candidateid&#x29; as cand_ext_id&#xd;&#xa;        , -10 as &#x27;user_account_id&#x27;&#xd;&#xa;        , &#x27;comment&#x27; as category&#xd;&#xa;        , &#x27;candidate&#x27; as type&#xd;&#xa;        , coalesce&#x28;NULLIF&#x28;convert&#x28;varchar&#x28;20&#x29;, SMTPSendDate, 120&#x29;,&#x27;&#x27;&#x29;, CURRENT_TIMESTAMP&#x29; as &#x27;insert_timestamp&#x27;&#xd;&#xa;        , &#x5b;dbo&#x5d;.&#x5b;F_ReplaceNullChar&#x5d;&#x28;&#xd;&#xa;              &#x5b;dbo&#x5d;.&#x5b;udf_StripHTML&#x5d;&#x28; --&#xd;&#xa;			         REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; REPLACE&#x28;REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; &#xd;&#xa;                     REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; REPLACE&#x28;REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; &#xd;&#xa;                     REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; REPLACE&#x28;REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; REPLACE&#x28;&#xd;&#xa;              replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;&#xd;&#xa;              stuff&#x28;&#x27;&#x2a;&#x2a;&#x2a; EMAIL&#x3a; &#x27; &#x2b; char&#x28;10&#x29;&#xd;&#xa;                &#x2b; coalesce&#x28;&#x27;From&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,externalFrom&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;                &#x2b; coalesce&#x28;&#x27;To&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,externalTo&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;                &#x2b; coalesce&#x28;&#x27;CC&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,externalCC&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;                &#x2b; coalesce&#x28;&#x27;BCC&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,externalBCC&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;                &#x2b; coalesce&#x28;&#x27;Subject&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,subject&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;                &#x2b; coalesce&#x28;&#x27;Body&#x3a; &#x27; &#x2b; NULLIF&#x28;email_content, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;Body&#x3a; &#x27; &#x2b; char&#x28;10&#x29;&#x29;&#xd;&#xa;                &#x2b; coalesce&#x28;&#x27;Attachments&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,att&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;				&#x2b; coalesce&#x28;&#x27;Comments&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,comments&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;              , 1, 0, &#x27;&#x27;&#x29;&#xd;&#xa;              ,&#x27;&#xc2;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#xc2;&#xb7;&#x27;,&#x27;&#x27;&#x29;,&#x27;v&#x5c;&#x3a;&#x2a; &#x7b;behavior&#x3a;url&#x28;&#x23;default&#x23;VML&#x29;&#x3b;&#x7d;&#x27;,&#x27;&#x27;&#x29;,&#x27;o&#x5c;&#x3a;&#x2a; &#x7b;behavior&#x3a;url&#x28;&#x23;default&#x23;VML&#x29;&#x3b;&#x7d;&#x27;,&#x27;&#x27;&#x29;,&#x27;w&#x5c;&#x3a;&#x2a; &#x7b;behavior&#x3a;url&#x28;&#x23;default&#x23;VML&#x29;&#x3b;&#x7d;&#x27;,&#x27;&#x27;&#x29;,&#x27;.shape &#x7b;behavior&#x3a;url&#x28;&#x23;default&#x23;VML&#x29;&#x3b;&#x7d;&#x27;,&#x27;&#x27;&#x29;&#xd;&#xa;                     ,char&#x28;0x0000&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x0001&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x0002&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x0003&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x0004&#x29;,&#x27;&#x27;&#x29; &#xd;&#xa;                     ,char&#x28;0x0005&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x0006&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x0007&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x0008&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x000B&#x29;,&#x27;&#x27;&#x29; &#xd;&#xa;                     ,char&#x28;0x000C&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x000E&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x000F&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x0010&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x0011&#x29;,&#x27;&#x27;&#x29; &#xd;&#xa;                     ,char&#x28;0x0012&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x0013&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x0014&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x0015&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x0016&#x29;,&#x27;&#x27;&#x29; &#xd;&#xa;                     ,char&#x28;0x0017&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x0018&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x0019&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x001A&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x001B&#x29;,&#x27;&#x27;&#x29; &#xd;&#xa;                     ,char&#x28;0x001C&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x001D&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x001E&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x001F&#x29;,&#x27;&#x27;&#x29;&#xd;&#xa;              &#x29;&#xd;&#xa;         &#x29; &#xd;&#xa;         as &#x27;content&#x27;&#xd;&#xa;from EmailBody --29594&#xd;&#xa;order by candidateid&#xd;&#xa;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1840</xloc>
      <yloc>240</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>BH Contact Email Body</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from &#x28;PROD&#x29;</connection>
    <sql>&#xa;-- EMAIL BODY&#xa;---CREATE INSERT CANDIDATE_COMMENTS&#xa;with EmailBody as &#x28;&#xa;        --EMAIL OF CANDIDATE - RECEIVER&#xa;        select --top 100&#xa;                  ca.clientID, ca.userid&#xa;                , um.userMessageID,um.sendingUserID,um.subject, um.externalFrom&#xa;                , um.comments&#xa;                , um.email_content as email_content&#xa;                , convert&#x28;nvarchar&#x28;max&#x29;,um.externalTo&#x29; as externalTo&#xa;				, convert&#x28;nvarchar&#x28;max&#x29;,um.externalCC&#x29; as externalCC&#xa;				, convert&#x28;nvarchar&#x28;max&#x29;,um.externalBCC&#x29; as externalBCC&#xa;				, um.SMTPSendDate&#xa;                , umf.att&#xa;        from bullhorn1.BH_UserMessage um&#xa;        left join bullhorn1.BH_MessageRecipient mr on mr.userMessageID &#x3d; um.userMessageID&#xa;        --left join bullhorn1.BH_UserMessageFile umf on umf.userMessageID &#x3d; um.userMessageID&#xa;        left join &#x28;SELECT userMessageID, STRING_AGG&#x28;cast&#x28;name as nvarchar&#x28;max&#x29;&#x29;,&#x27;,&#x27; &#x29; WITHIN GROUP &#x28;ORDER BY name&#x29; att &#xa;					from bullhorn1.BH_UserMessageFile GROUP BY userMessageID&#x29; umf on umf.userMessageID &#x3d; um.userMessageID&#xa;        left join bullhorn1.BH_Client ca on ca.userid &#x3d; mr.userid&#xa;        where mr.isDeleted &#x3d; 0 and mr.isSpam &#x3d; 0 and ca.userid is not null and ca.isdeleted &#x3c;&#x3e; 1 and ca.status &#x3c;&#x3e; &#x27;Archive&#x27; --&#xa; &#xa;UNION ALL&#xa;        --EMAIL OF CANDIDATE - SENDER&#xa;        select --top 100&#xa;                  ca.clientID, ca.userid&#xa;                , um.userMessageID,um.sendingUserID,um.subject,um.externalFrom&#xa;                , um.comments&#xa;                , um.email_content as email_content&#xa;                ,convert&#x28;nvarchar&#x28;max&#x29;,um.externalTo&#x29; as externalTo&#xa;				, convert&#x28;nvarchar&#x28;max&#x29;,um.externalCC&#x29; as externalCC&#xa;				, convert&#x28;nvarchar&#x28;max&#x29;,um.externalBCC&#x29; as externalBCC&#xa;				, um.SMTPSendDate&#xa;                --mr.userID,mr.folder,mr.recipientType, mr.email, mr.sendingUserID, mr.subjectSort&#xa;                --,mr.userID,mr.folder,mr.recipientType, mr.email, mr.externalFrom&#xa;                , umf.att --,umf.name, umf.directory&#xa;        from bullhorn1.BH_UserMessage um&#xa;        left join bullhorn1.BH_MessageRecipient mr on mr.userMessageID &#x3d; um.userMessageID&#xa;        --left join bullhorn1.BH_UserMessageFile umf on umf.userMessageID &#x3d; um.userMessageID&#xa;        --left join &#x28;SELECT userMessageID, STUFF&#x28;&#x28;SELECT &#x27;, &#x27; &#x2b; name from bullhorn1.BH_UserMessageFile WHERE userMessageID &#x3d; a.userMessageID order by name asc FOR XML PATH &#x28;&#x27;&#x27;&#x29;, TYPE&#x29;.value&#x28;&#x27;.&#x27;, &#x27;nvarchar&#x28;MAX&#x29;&#x27;&#x29;, 1, 1, &#x27;&#x27;&#x29; AS att FROM bullhorn1.BH_UserMessageFile AS a GROUP BY a.userMessageID &#x29; umf on umf.userMessageID &#x3d; um.userMessageID&#xa;        left join &#x28;SELECT userMessageID, STRING_AGG&#x28;cast&#x28;name as nvarchar&#x28;max&#x29;&#x29;,&#x27;,&#x27; &#x29; WITHIN GROUP &#x28;ORDER BY name&#x29; att &#xa;					from bullhorn1.BH_UserMessageFile GROUP BY userMessageID&#x29; umf on umf.userMessageID &#x3d; um.userMessageID&#xa;        left join bullhorn1.BH_Client ca on ca.userid &#x3d; um.sendingUserID&#xa;        where um.isSenderDeleted &#x3d; 0 and ca.userid is not null and ca.isdeleted &#x3c;&#x3e; 1 and ca.status &#x3c;&#x3e; &#x27;Archive&#x27;&#xa;        --and convert&#x28;nvarchar&#x28;max&#x29;,um.comments&#x29; &#x3c;&#x3e; &#x27;&#x27;&#xa;        --and ca.clientID in &#x28;4054&#x29;&#xa;&#x29;&#xa;&#x2f;&#x2a;&#xa;select top 10 clientID, smtpsenddate, count&#x28;&#x2a;&#x29;&#xa;from EmailBody&#xa;group by clientID, smtpsenddate&#xa;having count&#x28;&#x2a;&#x29; &#x3e; 5&#xa;&#x2a;&#x2f;&#xa;&#xa;&#x2f;&#x2a;, dup &#x28;clientID,SMTPSendDate,rn&#x29; as &#x28; SELECT clientID, SMTPSendDate, rn &#x3d; ROW_NUMBER&#x28;&#x29; OVER &#x28;PARTITION BY clientID,SMTPSendDate ORDER BY clientID desc&#x29; FROM EmailBody &#x29;&#xa;select &#x2a; from dup where clientID &#x3d; 1074 and rn &#x3e; 1--and cast&#x28;SMTPSendDate as varchar&#x28;max&#x29;&#x29; like &#x27;&#x25;28&#x2f;01&#x2f;2016&#x25;&#x27;&#x2a;&#x2f;&#xa;&#xa;&#x2f;&#x2a; select &#x2a; from EmailBody where candidateid &#x3d; 33&#xa;candidateid between 124602 and 128601 &#xa;candidateid between 5 and 90000 -&#x3e; 13388&#xa;candidateid between 90001 and 12000 -&#x3e; 0&#xa;candidateid between 12000 and 122601 -&#x3e; 45813&#xa;candidateid between 122602 and 124601 -&#x3e; 21439&#xa;candidateid between 124602 and 128601 -&#x3e; 25914&#xa;&#xa;select candidateid, concat&#x28;&#x27;insert into position_candidate_feedback &#x28;candidate_id, user_account_id, feedback_timestamp, comment_body, feedback_score, insert_timestamp, contact_method, json_relate_info, related_status&#x29; values &#x28; &#xa;        &#x28;select id from candidate where external_id &#x3d; &#x27;&#x27;&#x27;,candidateid,&#x27;&#x27;&#x27;&#x29;, &#x27;,-10,&#x27;, now&#x28;&#x29;, &#x27;&#x27;&#x27;,replace&#x28;concat&#x28;&#x27;Date Created&#x3a; &#x27;,convert&#x28;varchar,SMTPSendDate,120&#x29;,char&#x28;10&#x29;,&#x27;From&#x3a; &#x27;,externalFrom,char&#x28;10&#x29;,&#x27;To&#x3a; &#x27;,externalTo,char&#x28;10&#x29;,&#x27;CC&#x3a; &#x27;,externalCC,char&#x28;10&#x29;,&#x27;Subject&#x3a; &#x27;,subject,char&#x28;10&#x29;,char&#x28;10&#x29;,&#x27;Content&#x3a; &#x27;,comments&#x29;,&#x27;&#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x29;,&#x27;&#x27;&#x27;, 0, now&#x28;&#x29;, 4, &#x27;&#x27;&#x5b;&#x5d;&#x27;&#x27;, 1&#x29;&#x3b;&#x27;&#x29; as EmailSQL&#xa;from EmailBody --where candidateid &#x3d; 33&#xa;order by SMTPSendDate desc&#xa;&#x2a;&#x2f;&#xa;&#xa;--select userMessageID from EmailBody&#xa;--select count&#x28;&#x2a;&#x29; from EmailBody where userMessageID not in &#x28;select userMessageID from bullhorn1.email_m_ID&#x29; --245396 &#xa;--select userMessageID into bullhorn1.email_m_ID_import from EmailBody where userMessageID not in &#x28;select userMessageID from bullhorn1.email_m_ID&#x29;&#xa;&#xa;--select top 100 &#x2a; from EmailBody --where candidateid &#x3d; 33&#xa;&#xa;select --top 20&#xa;          userMessageID&#xa;        , concat&#x28;&#x27;PR&#x27;,clientID&#x29; as ContactExtID&#xa;        , userid&#xa;        , -10 as &#x27;user_account_id&#x27;&#xa;        , cast&#x28;&#x27;4&#x27; as int&#x29; as &#x27;contact_method&#x27;&#xa;        , coalesce&#x28;NULLIF&#x28;convert&#x28;varchar&#x28;20&#x29;, SMTPSendDate, 120&#x29;,&#x27;&#x27;&#x29;, CURRENT_TIMESTAMP&#x29; as &#x27;insert_timestamp&#x27;&#xa;        , &#x27;comment&#x27; as category&#xa;        , &#x27;contact&#x27; as type&#xa;        , --dbo.RemoveNullCharacters&#x28; &#xa;			&#x5b;dbo&#x5d;.&#x5b;F_ReplaceNullChar&#x5d; &#x28;&#xa;              &#x5b;dbo&#x5d;.&#x5b;udf_StripHTML&#x5d;&#x28;&#xa;              replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;&#xa;              Stuff&#x28;&#x27;EMAIL&#x3a; &#x27; &#x2b; char&#x28;10&#x29;&#xa;                &#x2b; Coalesce&#x28;&#x27;From&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,externalFrom&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;                &#x2b; Coalesce&#x28;&#x27;To&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,externalTo&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;                &#x2b; Coalesce&#x28;&#x27;CC&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,externalCC&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;                &#x2b; Coalesce&#x28;&#x27;BCC&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,externalBCC&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;                &#x2b; Coalesce&#x28;&#x27;Subject&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,subject&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;                &#x2b; Coalesce&#x28;&#x27;Comments&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,comments&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;                &#x2b; Coalesce&#x28;&#x27;Attachments&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,att&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;				&#x2b; Coalesce&#x28;&#x27;Body&#x3a; &#x27; &#x2b; NULLIF&#x28;trim&#x28;convert&#x28;nvarchar&#x28;max&#x29;,email_content&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;Body&#x3a; &#x27; &#x2b; char&#x28;10&#x29;&#x29;&#xa;              , 1, 0, &#x27;&#x27;&#x29;&#xa;              ,&#x27;&#xc2;&#x27;,&#x27;&#x27;&#x29;,&#x27;&#xc2;&#xb7;&#x27;,&#x27;&#x27;&#x29;,&#x27;v&#x5c;&#x3a;&#x2a; &#x7b;behavior&#x3a;url&#x28;&#x23;default&#x23;VML&#x29;&#x3b;&#x7d;&#x27;,&#x27;&#x27;&#x29;,&#x27;o&#x5c;&#x3a;&#x2a; &#x7b;behavior&#x3a;url&#x28;&#x23;default&#x23;VML&#x29;&#x3b;&#x7d;&#x27;,&#x27;&#x27;&#x29;,&#x27;w&#x5c;&#x3a;&#x2a; &#x7b;behavior&#x3a;url&#x28;&#x23;default&#x23;VML&#x29;&#x3b;&#x7d;&#x27;,&#x27;&#x27;&#x29;,&#x27;.shape &#x7b;behavior&#x3a;url&#x28;&#x23;default&#x23;VML&#x29;&#x3b;&#x7d;&#x27;,&#x27;&#x27;&#x29;&#xa;              &#x29;&#xa;			&#x29;&#xa;        -- &#x29;&#xa;         as &#x27;content&#x27;&#xa;from EmailBody&#xa;--where userMessageID &#x3d; 1092&#xa;--where userMessageID not in &#x28;select userMessageID from bullhorn1.email_m_ID&#x29;&#xa;--where userMessageID in &#x28;3052313,3052246,3050605&#x29; --3050605&#xa;--where userMessageID &#x3e; 3052233 --3052313 --3052246--3050605&#xa;--and userMessageID &#x3c; 3652959 --3652966 --3652969&#xa;--order by userMessageID desc&#xa;--order by userMessageID desc&#xa;--where comments &#x3c;&#x3e; &#x27;&#x27;&#xa;--where candidateID &#x3d; 2001&#xa;--where clientID in &#x28;4054&#x29;&#xa;&#xa;&#xa;-- select top 100 userMessageID, email_content from bullhorn1.bh_usermessage where userMessageID in &#x28;3054420&#x29;&#xa;    &#xa;&#x2f;&#x2a;&#xa;SELECT SYSDATETIME&#x28;&#x29;  &#xa;    ,SYSDATETIMEOFFSET&#x28;&#x29;  &#xa;    ,SYSUTCDATETIME&#x28;&#x29;  &#xa;    ,CURRENT_TIMESTAMP  &#xa;    ,GETDATE&#x28;&#x29;  &#xa;    ,GETUTCDATE&#x28;&#x29;&#x3b;  &#xa;&#xa;--CREATE DUPLICATE TABLE&#xa;CREATE TABLE EmailSQL2&#xa;&#x28;&#xa;  candidate_id integer,&#xa;  user_account_id integer,&#xa;  feedback_timestamp timestamp without time zone,&#xa;  comment_body character varying NOT NULL,&#xa;  feedback_score double precision,&#xa;  insert_timestamp timestamp without time zone,&#xa;  contact_method integer,&#xa;  json_relate_info text,&#xa;  related_status smallint&#x29;&#x3b;&#xa;  &#xa;CREATE TABLE EMAILSQL &#x28;&#xa;candidateid int,&#xa;EmailSQL text&#x29;&#x3b;&#xa;&#x2a;&#x2f;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>576</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>BH Contact Location</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>select &#xa;	 convert&#x28;varchar&#x28;max&#x29;,Cl.clientID&#x29; as &#x27;contact-externalId&#x27;&#xa;       , Stuff&#x28;&#xa;                                   Coalesce&#x28;&#x27; &#x27; &#x2b; NULLIF&#x28;UC.address1, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xa;                               &#x2b; Coalesce&#x28;&#x27;, &#x27; &#x2b; NULLIF&#x28;UC.address2, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xa;                               &#x2b; Coalesce&#x28;&#x27;, &#x27; &#x2b; NULLIF&#x28;UC.city, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xa;                               &#x2b; Coalesce&#x28;&#x27;, &#x27; &#x2b; NULLIF&#x28;UC.state, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xa;                               &#x2b; Coalesce&#x28;&#x27;, &#x27; &#x2b; NULLIF&#x28;tc.country, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xa;                       , 1, 1, &#x27;&#x27;&#x29; as &#x27;address&#x27;&#xa;       , UC.city&#xa;       , UC.state&#xa;       , UC.zip as &#x27;post_code&#x27;&#xa;       , tc.ABBREVIATION as &#x27;country_code&#x27; --UC.countryID&#xa;       , ltrim&#x28;Stuff&#x28;&#xa;                         Coalesce&#x28;&#x27;, &#x27; &#x2b; NULLIF&#x28;UC.city, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xa;                        &#x2b; Coalesce&#x28;&#x27;, &#x27; &#x2b; NULLIF&#x28;UC.state, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xa;                        &#x2b; Coalesce&#x28;&#x27;, &#x27; &#x2b; NULLIF&#x28;tc.country, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;&#xa;                , 1, 1, &#x27;&#x27;&#x29; &#x29; as &#x27;locationName&#x27;&#xa;-- select count&#x28;&#x2a;&#x29; --7487 -- select top 10 &#x2a;&#xa;from bullhorn1.BH_Client Cl --where isPrimaryOwner &#x3d; 1&#xa;left join bullhorn1.BH_UserContact UC ON Cl.userID &#x3d; UC.userID&#xa;left join tmp_country tc ON UC.countryID &#x3d; tc.code&#xa;where &#x28;Cl.isdeleted &#x3c;&#x3e; 1 and Cl.status &#x3c;&#x3e; &#x27;Archive&#x27;&#x29;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>576</xloc>
      <yloc>464</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>BULLHORN Contact Info</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from &#x28;PROD&#x29;</connection>
    <sql>with&#xd;&#xa;mail1 &#x28;ID,email&#x29; as &#x28;&#xd;&#xa;      select Cl.ClientId&#xd;&#xa;    , replace&#x28;translate&#x28;value, &#x27;&#x21;&#x27;&#x27;&#x3a;&#x22;&#x3c;&#x3e;&#x5b;&#x5d;&#x28;&#x29;&#x3b;,&#x2b;&#x2f;&#x5c;&#x26;&#x3f;&#x2022;&#x2a;&#x7c;&#x2018;&#x27;,&#x27;                     &#x27;&#x29;,char&#x28;9&#x29;,&#x27;&#x27;&#x29; as email --to translate special characters&#xd;&#xa;    from bullhorn1.BH_Client Cl&#xd;&#xa;		left join bullhorn1.BH_UserContact UC ON Cl.userID &#x3d; UC.userID&#xd;&#xa;    cross apply string_split&#x28; concat&#x28;UC.email, &#x27; &#x27;, UC.email2, &#x27; &#x27;, UC.email3&#x29;, &#x27; &#x27;&#x29;&#xd;&#xa;    where &#x28;UC.email like &#x27;&#x25;_&#x40;_&#x25;.__&#x25;&#x27; or UC.email2 like &#x27;&#x25;_&#x40;_&#x25;.__&#x25;&#x27; or UC.email3 like &#x27;&#x25;_&#x40;_&#x25;.__&#x25;&#x27;&#x29; and &#x28;Cl.isdeleted &#x3c;&#x3e; 1 and Cl.status &#x3c;&#x3e; &#x27;Archive&#x27;&#x29;&#xd;&#xa;    &#x29;&#xd;&#xa;--select &#x2a; from mail1 where email &#x3c;&#x3e; &#x27;&#x27;&#xd;&#xa;&#xd;&#xa;, mail2 &#x28;ID,email,rn,ID_rn&#x29; as &#x28;&#xd;&#xa;      select distinct ID&#xd;&#xa;             , trim&#x28;&#x27; &#x27; from email&#x29; as email&#xd;&#xa;             , row_number&#x28;&#x29; over&#x28;partition by trim&#x28;&#x27; &#x27; from email&#x29; order by ID asc&#x29; as rn --distinct email if emails exist more than once&#xd;&#xa;             , row_number&#x28;&#x29; over&#x28;partition by ID order by trim&#x28;&#x27; &#x27; from email&#x29;&#x29; as ID_rn --distinct if contacts may have more than 1 email&#xd;&#xa;    from mail1&#xd;&#xa;    where email like &#x27;&#x25;_&#x40;_&#x25;.__&#x25;&#x27;&#xd;&#xa;    &#x29;&#xd;&#xa;--select &#x2a; from mail2&#xd;&#xa;&#xd;&#xa;, ed &#x28;ID,email&#x29; as &#x28;&#xd;&#xa;      select ID&#xd;&#xa;          , case when rn &#x3e; 1 then concat&#x28;email,&#x27;_&#x27;,rn&#x29;&#xd;&#xa;    else email end as email&#xd;&#xa;    from mail2&#xd;&#xa;    where email is not NULL and email &#x3c;&#x3e; &#x27;&#x27;&#xd;&#xa;    and ID_rn &#x3d; 1&#xd;&#xa;    &#x29;&#xd;&#xa;, e2 &#x28;ID,email&#x29; as &#x28;select ID, email from mail2 where ID_rn &#x3d; 2&#x29;&#xd;&#xa;, e3 &#x28;ID,email&#x29; as &#x28;select ID, email from mail2 where ID_rn &#x3d; 3&#x29;&#xd;&#xa;&#xd;&#xa;select &#xd;&#xa;	 concat&#x28;&#x27;PR&#x27;,Cl.clientID&#x29; as contactExtId&#xd;&#xa;	, NULLIF&#x28;UC.Phone2, &#x27;&#x27;&#x29; as &#x27;home_phone&#x27;&#xd;&#xa;	, UC.Mobile as &#x27;mobile_phone&#x27;&#xd;&#xa;	, Cl.division as &#x27;department&#x27;&#xd;&#xa;	, e2.email as &#x27;personal_email&#x27;&#xd;&#xa;  , cl.dateAdded as reg_date&#xd;&#xa;	, ed.email&#xd;&#xa;from bullhorn1.BH_Client Cl --where isPrimaryOwner &#x3d; 1&#xd;&#xa;left join bullhorn1.BH_UserContact UC ON Cl.userID &#x3d; UC.userID&#xd;&#xa;left join e2 ON Cl.clientID &#x3d; e2.ID -- candidate-email&#xd;&#xa;left join ed on Cl.clientID &#x3d; ed.ID&#xd;&#xa;where &#x28;Cl.isdeleted &#x3c;&#x3e; 1 and Cl.status &#x3c;&#x3e; &#x27;Archive&#x27;&#x29;&#xd;&#xa;--and Cl.clientID &#x3d; 42</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>576</xloc>
      <yloc>352</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>BULLHORN Job Application - Rejected</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>	        &#xa;with&#xa;  JPInfo as &#x28;&#xa;  	select JP.jobPostingID as JobID&#xa;  		, JP.title as JobTitle&#xa;		, Cl.clientID as ContactID&#xa;		, Cl.userID as ClientUserID&#xa;		, UC.name as ContactName&#xa;		, UC.email as ContactEmail&#xa;		, CC.clientCorporationID as CompanyID&#xa;		, CC.name as CompanyName&#xa;	from bullhorn1.BH_JobPosting JP&#xa;	left join bullhorn1.BH_Client Cl on JP.clientUserID &#x3d; Cl.userID&#xa;	left join bullhorn1.BH_UserContact UC on JP.clientUserID &#x3d; UC.userID&#xa;	left join bullhorn1.BH_ClientCorporation CC on JP.clientCorporationID &#x3d; CC.clientCorporationID&#xa;	where 1&#x3d;1 and JP.title &#x3c;&#x3e; &#x27;&#x27; and Cl.isPrimaryOwner &#x3d; 1 &#x29;&#xa;        --select &#x2a; from JPInfo order by JobID&#xa;&#xa;, ja0 as &#x28;&#xa;       select&#xa;                JR.jobPostingID as &#x27;application-positionExternalId&#x27;&#xa;               --, JPI.ClientUserID&#xa;               --, JPI.ContactID, JPI.ContactName, JPI.ContactEmail&#xa;               --, JPI.CompanyID, JPI.CompanyName, JPI.JobID,  JPI.JobTitle&#xa;               --, JR.userID&#xa;               --, CAI.CandidateName as &#x27;&#x23;Candidate Name&#x27;&#xa;               , CAI.candidateID as &#x27;application-candidateExternalId&#x27;&#xa;               , CONVERT&#x28;VARCHAR&#x28;10&#x29;,JR.dateAdded,120&#x29; as &#x27;dateAdded&#x27;&#xa;               --, JR.status as &#x27;&#x23;application-stage&#x27; --This field only accepts&#x3a; SHORTLISTED,SENT,FIRST_INTERVIEW,SECOND_INTERVIEW,OFFERED,PLACED, INVOICED, Other values will not be recognized.&#xa;               , Coalesce&#x28;NULLIF&#x28;case&#xa;&#xa;                     when JR.status &#x3d; &#x27;Candidate Rejected&#x27; then &#x27;SHORTLISTED&#x27; -- &#x3e; REJECTED&#x27;&#xa;                     when JR.status &#x3d; &#x27;Client Rejected&#x27; then &#x27;SHORTLISTED&#x27; -- &#x3e; REJECTED&#x27;&#xa;                     else &#x27;&#x27; end, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29; as &#x27;application-stage&#x27;&#xa;                --, JR.status as &#x27;&#x23;Original-status&#x27;&#xa;        --select count&#x28;&#x2a;&#x29; --5995-- select distinct JR.status -- select top 100 &#x2a;&#xa;        from bullhorn1.BH_JobResponse JR&#xa;        left join &#x28;select CA.userID as CandidateUserID, CA.candidateID, UC.userID, UC.name as CandidateName, UC.email as CandidateEmail from bullhorn1.BH_Candidate CA left join bullhorn1.BH_UserContact UC on CA.userID &#x3d; UC.userID where CA.isPrimaryOwner &#x3d; 1&#x29; CAI on JR.userID &#x3d; CAI.CandidateUserID&#xa;        left join JPInfo JPI on JR.jobPostingID &#x3d; JPI.JobID&#xa;        where CAI.candidateID is not null &#xa;UNION&#xa;       select &#xa;                PL.jobPostingID as &#x27;application-positionExternalId&#x27;&#xa;              , CAI.candidateID as &#x27;application-candidateExternalId&#x27; --, CAI.CandidateName as &#x27;&#x23;Candidate Name&#x27;&#xa;              , CONVERT&#x28;VARCHAR&#x28;10&#x29;,PL.dateAdded,120&#x29; as &#x27;dateAdded&#x27;&#xa;              , &#x27;PLACEMENT_PERMANENT&#x27; as &#x27;application-stage&#x27;&#xa;        from bullhorn1.BH_Placement PL&#xa;        left join &#x28;select CA.userID as CandidateUserID, CA.candidateID, UC.userID, UC.name as CandidateName, UC.email as CandidateEmail from bullhorn1.BH_Candidate CA left join bullhorn1.BH_UserContact UC on CA.userID &#x3d; UC.userID where CA.isPrimaryOwner &#x3d; 1&#x29; CAI on PL.userID &#x3d; CAI.CandidateUserID&#xa;&#x29;&#xa;&#xa;&#xa;, ja1 &#x28;&#x22;application-positionExternalId&#x22;,&#x22;application-candidateExternalId&#x22;,&#x22;application-Stage&#x22;,&#x22;dateAdded&#x22;, rn&#x29; as &#x28;&#xa;       SELECT &#xa;              &#x22;application-positionExternalId&#x22;&#xa;              ,&#x22;application-candidateExternalId&#x22;&#xa;              ,&#x22;application-Stage&#x22;&#xa;              ,&#x22;dateAdded&#x22;&#xa;              , rn &#x3d; ROW_NUMBER&#x28;&#x29; OVER &#x28;PARTITION BY &#x22;application-positionExternalId&#x22;,&#x22;application-candidateExternalId&#x22;,&#x22;application-Stage&#x22; ORDER BY &#x22;application-positionExternalId&#x22; desc&#x29; FROM ja0 &#x29;&#xa;&#xa;&#xa;select &#x22;application-positionExternalId&#x22;,&#x22;application-candidateExternalId&#x22;,&#x22;application-Stage&#x22;, &#x22;dateAdded&#x22;, current_timestamp as &#x27;TIME_REJECTED&#x27;&#xa;from ja1&#xa;where rn &#x3d; 1 --&#x5b;application-stage&#x5d; &#x3c;&#x3e; &#x27;&#x27; --and &#x5b;application-stage&#x5d; not like &#x27;CANDIDATE&#x25;&#x27; --and &#x5b;&#x23;Candidate Name&#x5d; like &#x27;&#x25;Freeman&#x25;&#x27;&#xa;order by &#x5b;application-positionExternalId&#x5d;  asc,&#xa;    CASE &#x5b;application-stage&#x5d;&#xa;        WHEN &#x27;PLACEMENT_PERMANENT&#x27; THEN 1&#xa;        WHEN &#x27;OFFERED&#x27; THEN 2&#xa;        WHEN &#x27;SECOND_INTERVIEW&#x27; THEN 3&#xa;        WHEN &#x27;FIRST_INTERVIEW&#x27; THEN 4&#xa;        WHEN &#x27;SENT&#x27; THEN 5&#xa;        WHEN &#x27;SHORTLISTED&#x27; THEN 6&#xa;    END asc&#xa;&#xa;--select &#x5b;application-stage&#x5d;, count&#x28;&#x2a;&#x29; from jobapp group by &#x5b;application-stage&#x5d;&#xa;&#xa;&#xa;&#xa;&#xa;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1248</xloc>
      <yloc>208</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>BULLHORN Job Comment</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from &#x28;PROD&#x29;</connection>
    <sql>with comments as &#x28;&#xd;&#xa;            select a.jobPostingID&#xd;&#xa;					, UC.dateAdded&#xd;&#xa;					, concat_ws&#x28;char&#x28;10&#x29;&#xd;&#xa;					, &#x27;&#x2a;&#x2a;&#x2a; COMMENT&#x3a;&#x27;&#xd;&#xa;						, coalesce&#x28;&#x27;Created Date&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;varchar,uc.dateAdded,120&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;						, coalesce&#x28;&#x27;Author&#x3a; &#x27; &#x2b; NULLIF&#x28;u.name, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;						, coalesce&#x28;&#x27;Action&#x3a; &#x27; &#x2b; NULLIF&#x28;uc.action, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;						, coalesce&#x28;&#x27;Comments&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;&#x5b;bullhorn1&#x5d;.&#x5b;fn_ConvertHTMLToText&#x5d;&#x28;uc.comments&#x29; as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;						&#x29; as &#x5b;content&#x5d;&#xd;&#xa;					from bullhorn1.BH_UserComment UC --where jobPostingID is not null&#xd;&#xa;					left join bullhorn1.BH_JobPosting a on a.jobPostingID &#x3d; UC.jobPostingID&#xd;&#xa;					left join bullhorn1.BH_User U on U.userID &#x3d; UC.commentingUserID&#xd;&#xa;					where a.jobPostingID is not null&#xd;&#xa;&#xd;&#xa;UNION ALL&#xd;&#xa;&#xd;&#xa;SELECT &#xd;&#xa;			a.jobPostingID&#xd;&#xa;			, a.dateAdded&#xd;&#xa;			, concat_ws&#x28;char&#x28;10&#x29;, &#x27;&#x2a;&#x2a;&#x2a; APPOINTMENT&#x3a; &#x27;&#xd;&#xa;				, coalesce&#x28;&#x27;Contact&#x3a; &#x27; &#x2b; NULLIF&#x28;coalesce&#x28;coalesce&#x28;nullif&#x28;UC1.FirstName,&#x27;&#x27;&#x29; &#x2b; &#x27; &#x27;, NULL&#x29; &#x2b; coalesce&#x28;nullif&#x28;UC1.LastName,&#x27;&#x27;&#x29; &#x2b; &#x27; - &#x27;, NULL&#x29; &#x2b; nullif&#x28;UC1.email,&#x27;&#x27;&#x29;, NULL&#x29;, &#x27;&#x27;&#x29;, NULL&#x29; --a.clientUserID &#xd;&#xa;				, coalesce&#x28;&#x27;Candidate&#x3a; &#x27; &#x2b; NULLIF&#x28;coalesce&#x28;coalesce&#x28;nullif&#x28;UC2.FirstName,&#x27;&#x27;&#x29; &#x2b; &#x27; &#x27;, NULL&#x29; &#x2b; coalesce&#x28;nullif&#x28;UC2.LastName,&#x27;&#x27;&#x29; &#x2b; &#x27; - &#x27;, NULL&#x29; &#x2b; nullif&#x28;UC2.email,&#x27;&#x27;&#x29;, NULL&#x29;, &#x27;&#x27;&#x29;, NULL&#x29; --a.candidateUserID &#xd;&#xa;				, coalesce&#x28;&#x27;Job&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;j.title as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29; --jobPostingID&#xd;&#xa;				, coalesce&#x28;&#x27;Communication Method&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;, a.communicationMethod&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;				, coalesce&#x28;&#x27;Owner&#x3a; &#x27; &#x2b; NULLIF&#x28;coalesce&#x28;coalesce&#x28;nullif&#x28;UC3.FirstName,&#x27;&#x27;&#x29; &#x2b; &#x27; &#x27;, NULL&#x29; &#x2b; coalesce&#x28;nullif&#x28;UC3.LastName,&#x27;&#x27;&#x29; &#x2b; &#x27; - &#x27;, NULL&#x29; &#x2b; nullif&#x28;UC3.email,&#x27;&#x27;&#x29;, NULL&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;				, coalesce&#x28;&#x27;Lead&#x3a; &#x27; &#x2b; NULLIF&#x28;coalesce&#x28;coalesce&#x28;nullif&#x28;UC4.FirstName,&#x27;&#x27;&#x29; &#x2b; &#x27; &#x27;, NULL&#x29; &#x2b; coalesce&#x28;nullif&#x28;UC4.LastName,&#x27;&#x27;&#x29; &#x2b; &#x27; - &#x27;, NULL&#x29; &#x2b; nullif&#x28;UC4.email,&#x27;&#x27;&#x29;, NULL&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;				, coalesce&#x28;&#x27;Date Begin&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;, a.dateBegin, 120&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;				, coalesce&#x28;&#x27;Date End&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,a.dateEnd, 120&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;				, coalesce&#x28;&#x27;Type&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,a.type&#x29;, &#x27;&#x27;&#x29;, NULL&#x29; --CA.activePlacements&#xd;&#xa;				, coalesce&#x28;&#x27;Subject&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,a.subject&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;				--, coalesce&#x28;&#x27;Reminder&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,a.notificationMinutes&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;				, coalesce&#x28;&#x27;Opportunity&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,j2.title&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;				, coalesce&#x28;&#x27;Location&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,a.location&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;				, coalesce&#x28;&#x27;File Name&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,af.name&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;				, coalesce&#x28;char&#x28;10&#x29; &#x2b; &#x27;Description&#x3a; &#x27; &#x2b; &#x5b;bullhorn1&#x5d;.&#x5b;fn_ConvertHTMLToText&#x5d;&#x28;NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,a.description&#x29;, &#x27;&#x27;&#x29;&#x29;, NULL&#x29;&#xd;&#xa;			&#x29; as &#x5b;content&#x5d;&#xd;&#xa;      from bullhorn1.View_Appointment a&#xd;&#xa;      left join bullhorn1.View_AppointmentFile af on af.appointmentID &#x3d; a.appointmentID&#xd;&#xa;      left join bullhorn1.BH_Client Cl on Cl.userID &#x3d; a.ClientUserID&#xd;&#xa;      left join bullhorn1.BH_UserContact UC1 ON UC1.userID &#x3d; Cl.userID&#xd;&#xa;      left join bullhorn1.BH_UserContact UC2 ON UC2.userID &#x3d; a.candidateUserID&#xd;&#xa;      left join bullhorn1.BH_UserContact UC3 ON UC3.userID &#x3d; a.userID&#xd;&#xa;      left join bullhorn1.BH_UserContact UC4 ON UC4.userID &#x3d; a.LeaduserID&#xd;&#xa;      left join bullhorn1.BH_JobPosting j on j.jobPostingID &#x3d; a.jobPostingID&#xd;&#xa;      left join bullhorn1.BH_JobPosting j2 on j.jobPostingID &#x3d; a.opportunityJobPostingID&#xd;&#xa;      where j.jobPostingID is not null --23 rows&#xd;&#xa;		 &#xd;&#xa;UNION ALL&#xd;&#xa;&#xd;&#xa;SELECT ---top 20 &#xd;&#xa;		j.jobPostingID as &#x27;externalid&#x27;&#xd;&#xa;		, a.dateAdded&#xd;&#xa;		, concat_ws&#x28;char&#x28;10&#x29;, &#x27;&#x2a;&#x2a;&#x2a; TASK&#x3a; &#x27;&#xd;&#xa;						, coalesce&#x28;&#x27;Candidate&#x3a; &#x27; &#x2b; NULLIF&#x28;coalesce&#x28;coalesce&#x28;nullif&#x28;UC2.FirstName,&#x27;&#x27;&#x29; &#x2b; &#x27; &#x27;, NULL&#x29; &#x2b; coalesce&#x28;nullif&#x28;UC2.LastName,&#x27;&#x27;&#x29; &#x2b; &#x27; - &#x27;, NULL&#x29; &#x2b; nullif&#x28;UC2.email,&#x27;&#x27;&#x29;, NULL&#x29;, &#x27;&#x27;&#x29;, NULL&#x29; --a.candidateUserID &#xd;&#xa;						--, coalesce&#x28;&#x27;Assigned To&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;a.childTaskOwners as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;						, coalesce&#x28;&#x27;Contact&#x3a; &#x27; &#x2b; NULLIF&#x28;coalesce&#x28;coalesce&#x28;nullif&#x28;UC1.FirstName,&#x27;&#x27;&#x29; &#x2b; &#x27; &#x27;, NULL&#x29; &#x2b; coalesce&#x28;nullif&#x28;UC1.LastName,&#x27;&#x27;&#x29; &#x2b; &#x27; - &#x27;, NULL&#x29; &#x2b; nullif&#x28;UC1.email,&#x27;&#x27;&#x29;, NULL&#x29;, &#x27;&#x27;&#x29;, NULL&#x29; --a.clientUserID &#xd;&#xa;						, coalesce&#x28;&#x27;Due Date And Time&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;, a.dateBegin, 120&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;						, coalesce&#x28;&#x27;Date End&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,a.dateEnd, 120&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;						, coalesce&#x28;&#x27;Job&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;j.title as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29; --jobPostingID&#xd;&#xa;						--, coalesce&#x28;&#x27;Reminder&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;a.notificationMinutes as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;						, coalesce&#x28;&#x27;Opportunity&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;a.opportunityJobPostingID as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;						, coalesce&#x28;&#x27;Placement&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;a.placementID as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;						, coalesce&#x28;&#x27;Priority&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;a.priority as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;						--, coalesce&#x28;&#x27;Recurrence Day Bits&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;a.recurrenceDayBits as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;						--, coalesce&#x28;&#x27;Recurrence Frequency&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;a.recurrenceFrequency as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;						--, coalesce&#x28;&#x27;Recurrence Max&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;a.recurrenceMax as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;						--, coalesce&#x28;&#x27;Recurrence Month Bits&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;a.recurrenceMonthBits as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;						--, coalesce&#x28;&#x27;Recurrence Style&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;a.recurrenceStyle as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;						--, coalesce&#x28;&#x27;Recurrence Type&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;a.recurrenceType as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;						--, coalesce&#x28;&#x27;Visibility&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;a.isPrivate as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;						, coalesce&#x28;&#x27;Subject&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;a.subject as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;						, coalesce&#x28;&#x27;Type&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;a.type as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;						, coalesce&#x28;&#x27;Owner&#x3a; &#x27; &#x2b; NULLIF&#x28;coalesce&#x28;coalesce&#x28;nullif&#x28;UC4.FirstName,&#x27;&#x27;&#x29; &#x2b; &#x27; &#x27;, NULL&#x29; &#x2b; coalesce&#x28;nullif&#x28;UC4.LastName,&#x27;&#x27;&#x29; &#x2b; &#x27; - &#x27;, NULL&#x29; &#x2b; nullif&#x28;UC4.email,&#x27;&#x27;&#x29;, NULL&#x29;, &#x27;&#x27;&#x29;, NULL&#x29; --a.userID&#xd;&#xa;						, coalesce&#x28;char&#x28;10&#x29; &#x2b; &#x27;Description&#x3a; &#x27; &#x2b; &#x5b;bullhorn1&#x5d;.&#x5b;fn_ConvertHTMLToText&#x5d;&#x28;NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,a.description&#x29;, &#x27;&#x27;&#x29;&#x29;, NULL&#x29;&#xd;&#xa;				&#x29; as &#x5b;content&#x5d; &#xd;&#xa;        from bullhorn1.View_Task a&#xd;&#xa;        left join bullhorn1.BH_Client Cl on Cl.userID &#x3d; a.ClientUserID&#xd;&#xa;        left join bullhorn1.BH_UserContact UC1 ON Cl.userID &#x3d; UC1.userID&#xd;&#xa;        left join bullhorn1.BH_UserContact UC2 ON a.candidateUserID &#x3d; UC2.userID&#xd;&#xa;        left join bullhorn1.BH_JobPosting j on j.jobPostingID &#x3d; a.jobPostingID&#xd;&#xa;        left join bullhorn1.BH_UserContact UC3 ON a.leadUserID &#x3d; UC3.userID&#xd;&#xa;        left join bullhorn1.BH_UserContact UC4 ON a.userID &#x3d; UC4.userID&#xd;&#xa;        where j.jobPostingID is not null --5 rows&#xd;&#xa;&#xd;&#xa;UNION ALL&#xd;&#xa;        -- PLACEMENT&#xd;&#xa;        select &#xd;&#xa;        PL.jobPostingID as &#x27;externalid&#x27; &#xd;&#xa;        , pl.dateadded &#xd;&#xa;				, Stuff&#x28; &#x27;&#x2a;&#x2a;&#x2a; PLACEMENT&#x3a; &#x27; &#x2b; char&#x28;10&#x29;&#xd;&#xa;              &#x2b; coalesce&#x28;&#x27;Billing Contact&#x3a; &#x27; &#x2b; NULLIF&#x28;coalesce&#x28;coalesce&#x28;nullif&#x28;UC1.FirstName,&#x27;&#x27;&#x29; &#x2b; &#x27; &#x27;, NULL&#x29; &#xd;&#xa;							&#x2b; coalesce&#x28;nullif&#x28;UC1.LastName,&#x27;&#x27;&#x29; &#x2b; &#x27; - &#x27;, NULL&#x29; &#x2b; nullif&#x28;UC1.email,&#x27;&#x27;&#x29;, NULL&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;  --pl.billingUserID&#xd;&#xa;			--&#x2b; coalesce&#x28;&#x27;Bill Rate Information&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.billRateInfoHeader as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;              &#x2b; coalesce&#x28;&#x27;Bill Rate&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.clientBillRate as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;              &#x2b; coalesce&#x28;&#x27;Over-time Bill Rate&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.clientOverTimeRate as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;              &#x2b; coalesce&#x28;&#x27;Comments&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.comments as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;			--&#x2b; coalesce&#x28;&#x27;Contract Employment Info&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.contractInfoHeader as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;              &#x2b; coalesce&#x28;&#x27;Primary Timesheet Approver&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.correlatedCustomText1 as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;              &#x2b; coalesce&#x28;&#x27;Secondary Timecard Approver&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.correlatedCustomText2 as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;              &#x2b; coalesce&#x28;&#x27;Purchase Order Number&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.correlatedCustomText3 as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;              &#x2b; coalesce&#x28;&#x27;Cost Center&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.costCenter as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;              &#x2b; coalesce&#x28;&#x27;Insurance Reference&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.customText1 as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;              &#x2b; coalesce&#x28;&#x27;Start Date&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,pl.dateBegin,120&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;              &#x2b; coalesce&#x28;&#x27;Effective Date &#x28;Client&#x29;&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,pl.dateClientEffective, 120&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;              &#x2b; coalesce&#x28;&#x27;Effective Date&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,pl.dateEffective, 120&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;              &#x2b; coalesce&#x28;&#x27;Scheduled End&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;, pl.dateEnd, 120&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;              &#x2b; coalesce&#x28;&#x27;Days Guaranteed&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.daysGuaranteed as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;              &#x2b; coalesce&#x28;&#x27;Days Pro-Rated&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.daysProRated as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;              &#x2b; coalesce&#x28;&#x27;Employment Type&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.employmentType as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;              &#x2b; coalesce&#x28;&#x27;Placement Fee &#x28;&#x25;&#x29;&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.fee as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;			--&#x2b; coalesce&#x28;&#x27;Placement Fee &#x28;Flat&#x29;&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.flatFee as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;              &#x2b; coalesce&#x28;&#x27;Hours of Operation&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.hoursOfOperation as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;              &#x2b; coalesce&#x28;&#x27;Hours Per Day&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.hoursPerDay as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;              &#x2b; coalesce&#x28;&#x27;Rate Entry Type&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.isMultirate as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;			--&#x2b; coalesce&#x28;&#x27;Mark-up &#x25;&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.markUpPercentage as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;              &#x2b; coalesce&#x28;&#x27;Over-time Pay Rate&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.overtimeRate as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;              &#x2b; coalesce&#x28;&#x27;Pay Rate&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.payRate as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;			--&#x2b; coalesce&#x28;&#x27;Pay Rate Information&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.payRateInfoHeader as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;			--&#x2b; coalesce&#x28;&#x27;Permanent Employment Info&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.permanentInfoHeader as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;              &#x2b; coalesce&#x28;&#x27;Referral Fee Type&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.referralFeeType as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;              &#x2b; coalesce&#x28;&#x27;Reporting to&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.reportTo as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;              &#x2b; coalesce&#x28;&#x27;Salary&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.salary as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;              &#x2b; coalesce&#x28;&#x27;Pay Unit&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.salaryUnit as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;              &#x2b; coalesce&#x28;&#x27;Status&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.status as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;        , 1, 0, &#x27;&#x27;&#x29; as &#x27;content&#x27;&#xd;&#xa;        from bullhorn1.BH_Placement PL --where PL.reportTo &#x3c;&#x3e; &#x27;&#x27;&#xd;&#xa;        left join bullhorn1.BH_UserContact UC1 ON UC1.userID &#x3d; pl.billingUserID&#xd;&#xa;        left join &#x28;select candidateID, concat&#x28;FirstName,&#x27; &#x27;,LastName&#x29; as fullname, userid from bullhorn1.Candidate&#x29; C on C.userID &#x3d; pl.userid --106 rows&#xd;&#xa;&#x29;&#xd;&#xa;&#xd;&#xa;select --top 100&#xd;&#xa;                   concat&#x28;&#x27;PR&#x27;, jobPostingID&#x29; as JobExtId&#xd;&#xa;                  , -10 as &#x27;user_account_id&#x27;&#xd;&#xa;                  , &#x27;comment&#x27; as &#x27;category&#x27;&#xd;&#xa;                  , &#x27;job&#x27; as &#x27;type&#x27;&#xd;&#xa;                  , dateAdded as &#x27;insert_timestamp&#x27;&#xd;&#xa;                  , content as &#x27;content&#x27;&#xd;&#xa;from comments where &#x27;content&#x27; &#x3c;&#x3e; &#x27;&#x27; &#xd;&#xa;--and candidateID &#x3d; 2988 or fullname like &#x27;&#x25;Philip&#x25;&#x27;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1248</xloc>
      <yloc>112</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Candidate info</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from &#x28;PROD&#x29;</connection>
    <sql>with&#xa;-- EMAIL&#xa;  mail1 &#x28;ID,email&#x29; as &#x28;select C.candidateID, replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;concat&#x28;UC.email,&#x27;,&#x27;,UC.email2,&#x27;,&#x27;,UC.email3&#x29;,&#x27;&#x2f;&#x27;,&#x27; &#x27;&#x29;,&#x27;&#x3c;&#x27;,&#x27; &#x27;&#x29;,&#x27;&#x3e;&#x27;,&#x27; &#x27;&#x29;,&#x27;&#x28;&#x27;,&#x27; &#x27;&#x29;,&#x27;&#x29;&#x27;,&#x27; &#x27;&#x29;,&#x27;&#x3a;&#x27;,&#x27; &#x27;&#x29;,&#x27;.&#x40;&#x27;,&#x27;&#x40;&#x27;&#x29;,&#x27;&#x40;.&#x27;,&#x27;&#x40;&#x27;&#x29;,&#x27;&#x2b;&#x27;,&#x27; &#x27;&#x29;,&#x27;&#x26;&#x27;,&#x27; &#x27;&#x29;,&#x27;&#x5b;&#x27;,&#x27; &#x27;&#x29;,&#x27;&#x5d;&#x27;,&#x27; &#x27;&#x29;,&#x27;&#x3f;&#x27;,&#x27; &#x27;&#x29;,&#x27;&#x27;&#x27;&#x27;,&#x27; &#x27;&#x29;,&#x27;&#x3b;&#x27;,&#x27; &#x27;&#x29;,&#x27;&#x2022;&#x27;,&#x27; &#x27;&#x29;,&#x27;&#x2a;&#x27;,&#x27; &#x27;&#x29;,&#x27;&#x7c;&#x27;,&#x27; &#x27;&#x29;,&#x27;&#x2018;&#x27;,&#x27; &#x27;&#x29;,CHAR&#x28;9&#x29;,&#x27; &#x27;&#x29; as mail from bullhorn1.BH_UserContact UC left join bullhorn1.Candidate C on C.userID &#x3d; UC.UserID where UC.email like &#x27;&#x25;_&#x40;_&#x25;.__&#x25;&#x27; or UC.email2 like &#x27;&#x25;_&#x40;_&#x25;.__&#x25;&#x27; or UC.email3 like &#x27;&#x25;_&#x40;_&#x25;.__&#x25;&#x27; and C.isdeleted &#x3c;&#x3e; 1 and C.status &#x3c;&#x3e; &#x27;Archive&#x27; &#x2f;&#x2a;and C.isPrimaryOwner &#x3d; 1&#x2a;&#x2f; &#x29;&#xa;, mail2 &#x28;ID,email&#x29; as &#x28;SELECT ID, email.value as email FROM mail1 m CROSS APPLY STRING_SPLIT&#x28;m.email,&#x27;,&#x27;&#x29; AS email&#x29;&#xa;, mail3 &#x28;ID,email&#x29; as &#x28;SELECT ID, case when RIGHT&#x28;email, 1&#x29; &#x3d; &#x27;.&#x27; then LEFT&#x28;email, LEN&#x28;email&#x29; - 1&#x29; when LEFT&#x28;email, 1&#x29; &#x3d; &#x27;.&#x27; then RIGHT&#x28;email, LEN&#x28;email&#x29; - 1&#x29; else email end as email from mail2 WHERE email like &#x27;&#x25;_&#x40;_&#x25;.__&#x25;&#x27;&#x29;&#xa;, mail4 &#x28;ID,email,rn&#x29; as &#x28; SELECT ID, email &#x3d; ltrim&#x28;rtrim&#x28;CONVERT&#x28;NVARCHAR&#x28;MAX&#x29;, email&#x29;&#x29;&#x29;, r1 &#x3d; ROW_NUMBER&#x28;&#x29; OVER &#x28;PARTITION BY ID ORDER BY ID desc&#x29; FROM mail3 &#x29;&#xa;, e1 &#x28;ID,email&#x29; as &#x28;select ID, email from mail4 where rn &#x3d; 1&#x29;&#xa;, ed  &#x28;ID,email,rn&#x29; as &#x28;SELECT ID,email,ROW_NUMBER&#x28;&#x29; OVER&#x28;PARTITION BY email ORDER BY ID DESC&#x29; AS rn FROM e1 &#x29;&#xa;, e2 &#x28;ID,email&#x29; as &#x28;select ID, email from mail4 where rn &#x3d; 2&#x29;&#xa;, e3 &#x28;ID,email&#x29; as &#x28;select ID, email from mail4 where rn &#x3d; 3&#x29;&#xa;, e4 as &#x28;select ID, email from mail4 where rn &#x3d; 4&#x29;&#xa;--select &#x2a; from ed&#xa;&#xa;--MAIN SCRIPT&#xa;select --top 10&#xa;		concat&#x28;&#x27;PR&#x27;, C.candidateID&#x29; as cand_ext_id&#xa;		, c.dateAdded as reg_date&#xa;from bullhorn1.Candidate C --where C.isPrimaryOwner &#x3d; 1&#xa;where C.isdeleted &#x3c;&#x3e; 1 and C.status &#x3c;&#x3e; &#x27;Archive&#x27;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1840</xloc>
      <yloc>320</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>CF - Industry broadbean</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>select concat &#x28;&#x27;PR&#x27;, jobPostingID&#x29; as JobExtID&#xa;, &#x27;add_job_info&#x27; as additional_type&#xa;, trim&#x28;customText10&#x29; as Custom_value --trim&#x28;customText10&#x29; only 1 value so get ID&#xa;, 1006 as form_id&#xa;, 1015 as field_id&#xa;, getdate&#x28;&#x29; as Insert_timestamp&#xa;from bullhorn1.BH_JobPosting&#xa;order by jobPostingID</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1248</xloc>
      <yloc>1296</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>CF -linkedJobPostingID</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>select concat &#x28;&#x27;PR&#x27;, jobPostingID&#x29; as JobExtID&#xa;, &#x27;add_job_info&#x27; as additional_type&#xa;, linkedJobPostingID as custom_value&#xa;, 1006 as form_id&#xa;, 1015 as field_id&#xa;, getdate&#x28;&#x29; as Insert_timestamp&#xa;from bullhorn1.BH_JobPosting&#xa;order by jobPostingID</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1248</xloc>
      <yloc>1376</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Can desired_contract_rate</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>select &#xa;       convert&#x28;varchar&#x28;500&#x29;,C.candidateID&#x29; as &#x27;candidate-externalId&#x27;&#xa;       , Coalesce&#x28;NULLIF&#x28;replace&#x28;C.FirstName,&#x27;&#x3f;&#x27;,&#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;, &#x27;No Firstname&#x27;&#x29; as &#x27;contact-firstName&#x27;&#xa;       , Coalesce&#x28;NULLIF&#x28;replace&#x28;C.LastName,&#x27;&#x3f;&#x27;,&#x27;&#x27;&#x29;, &#x27;&#x27;&#x29;, concat&#x28;&#x27;Lastname-&#x27;,C.userID&#x29;&#x29; as &#x27;contact-lastName&#x27;&#xa;       , c.dayRate as &#x27;desired_contract_rate&#x27;&#xa;       , c.dayRateLow as &#x27;contract_rate&#x27;&#xa;-- select count &#x28;&#x2a;&#x29; -- select distinct gender --employmentPreference -- select skillset, skillIDlist, customTextBlock1, companyURL --select top 10 &#x2a; -- select dayRate, dayRateLow&#xa;from bullhorn1.Candidate C&#xa;--where C.isPrimaryOwner &#x3d; 1	</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1840</xloc>
      <yloc>1360</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Candidate Comment</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from &#x28;PROD&#x29;</connection>
    <sql>with comments as &#x28;&#xa;        SELECT --top 1000&#xa;                  C.candidateID&#xa;				, C.fullname&#xa;                , UC.dateAdded&#xa;                        , stuff&#x28;&#x27;&#x2a;&#x2a;&#x2a; COMMENT&#x3a; &#x27; &#x2b; char&#x28;10&#x29;&#xa;                                &#x2b; coalesce&#x28;&#x27;Created Date&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;varchar,UC.dateAdded,120&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;                                &#x2b; coalesce&#x28;&#x27;Author&#x3a; &#x27; &#x2b; NULLIF&#x28;U.name, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;                                &#x2b; coalesce&#x28;&#x27;Action&#x3a; &#x27; &#x2b; NULLIF&#x28;UC.action, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;								&#x2b; coalesce&#x28;&#x27;About&#x3a; &#x27; &#x2b; NULLIF&#x28;C.fullname, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;                                &#x2b; coalesce&#x28;&#x27;Comments&#x3a; &#x27; &#x2b; NULLIF&#x28; &#xa;                                          replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;replace&#x28;&#x5b;dbo&#x5d;.&#x5b;udf_StripHTML&#x5d;&#x28;UC.comments&#x29; --&#x5b;dbo&#x5d;.&#x5b;fn_ConvertHTMLToText&#x5d;&#x28;&#xa;                                          ,&#x27;&#xc2;&#x27;,&#x27;&#x27;&#x29;&#xa;                                          ,&#x27;&#xc2;&#xb7;&#x27;,&#x27;&#x27;&#x29;&#xa;                                          ,&#x27;v&#x5c;&#x3a;&#x2a; &#x7b;behavior&#x3a;url&#x28;&#x23;default&#x23;VML&#x29;&#x3b;&#x7d;&#x27;,&#x27;&#x27;&#x29;&#xa;                                          ,&#x27;o&#x5c;&#x3a;&#x2a; &#x7b;behavior&#x3a;url&#x28;&#x23;default&#x23;VML&#x29;&#x3b;&#x7d;&#x27;,&#x27;&#x27;&#x29;&#xa;                                          ,&#x27;w&#x5c;&#x3a;&#x2a; &#x7b;behavior&#x3a;url&#x28;&#x23;default&#x23;VML&#x29;&#x3b;&#x7d;&#x27;,&#x27;&#x27;&#x29;&#xa;                                          ,&#x27;.shape &#x7b;behavior&#x3a;url&#x28;&#x23;default&#x23;VML&#x29;&#x3b;&#x7d;&#x27;,&#x27;&#x27;&#x29; , &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;                        , 1, 0, &#x27;&#x27;&#x29; as &#x27;content&#x27;&#xa;        from bullhorn1.BH_UserComment UC&#xa;        left join &#x28; select candidateID, concat&#x28;FirstName,&#x27; &#x27;,LastName&#x29; as fullname, userid, isPrimaryOwner from bullhorn1.Candidate&#x29; C on C.userID &#x3d; UC.Userid&#xa;        left join bullhorn1.BH_User U on U.userID &#x3d; UC.commentingUserID&#xa;        where C.candidateID is not null --44836 rows&#xa;&#xa;UNION ALL&#xa;&#xa;        SELECT --top 1000&#xa;                  ch.candidateID ,C.fullname --,UC.Userid&#xa;                , ch.dateAdded&#xa;                , coalesce&#x28;&#x27;&#x2a;&#x2a;&#x2a; HISTORY&#x3a; &#x27; &#x2b; char&#x28;10&#x29;&#xa;		           &#x2b; &#x27;Date Added&#x3a; &#x27; &#x2b; convert&#x28;varchar, ch.dateAdded, 120&#x29; &#x2b; char&#x28;10&#x29; &#xa;		           &#x2b; &#x27;Candidate History&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,ch.comments&#x29;, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29; &#xa;		           as &#x27;content&#x27;&#xa;        from bullhorn1.BH_CandidateHistory CH&#xa;        left join &#x28; select candidateID, concat&#x28;FirstName,&#x27; &#x27;,LastName&#x29; as fullname, userid, isPrimaryOwner from bullhorn1.Candidate &#x29; C on C.candidateID &#x3d; CH.candidateID &#xa;        where C.candidateID is not null and ch.comments is not null --and C.isPrimaryOwner &#x3d; 1 and cast&#x28;ch.comments as varchar&#x28;max&#x29;&#x29; &#x3c;&#x3e; &#x27;&#x27; &#xa;&#xa;UNION ALL&#xa;&#xa;	SELECT --top 20 &#xa;	C.candidateID ,C.fullname  --, a.candidateuserID, C.userID&#xa;	, a.dateAdded&#xa;	, concat_ws&#x28;char&#x28;10&#x29;, &#x27;&#x2a;&#x2a;&#x2a; APPOINTMENT&#x3a; &#x27;&#xa;						, coalesce&#x28;&#x27;Contact&#x3a; &#x27; &#x2b; NULLIF&#x28;coalesce&#x28;coalesce&#x28;nullif&#x28;UC1.FirstName,&#x27;&#x27;&#x29; &#x2b; &#x27; &#x27;, NULL&#x29; &#xa;												&#x2b; coalesce&#x28;nullif&#x28;UC1.LastName,&#x27;&#x27;&#x29; &#x2b; &#x27; - &#x27;, NULL&#x29; &#x2b; nullif&#x28;UC1.email,&#x27;&#x27;&#x29;, NULL&#x29;, &#x27;&#x27;&#x29;, NULL&#x29; --a.clientUserID &#xa;						, coalesce&#x28;&#x27;Candidate&#x3a; &#x27; &#x2b; NULLIF&#x28;coalesce&#x28;coalesce&#x28;nullif&#x28;UC2.FirstName,&#x27;&#x27;&#x29; &#x2b; &#x27; &#x27;, NULL&#x29; &#xa;												&#x2b; coalesce&#x28;nullif&#x28;UC2.LastName,&#x27;&#x27;&#x29; &#x2b; &#x27; - &#x27;, NULL&#x29; &#x2b; nullif&#x28;UC2.email,&#x27;&#x27;&#x29;, NULL&#x29;, &#x27;&#x27;&#x29;, NULL&#x29; --a.candidateUserID &#xa;						, coalesce&#x28;&#x27;Job&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;j.title as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29; --jobPostingID&#xa;						, coalesce&#x28;&#x27;Communication Method&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,a.communicationMethod&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;						, coalesce&#x28;&#x27;Date Begin&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;, a.dateBegin, 120&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xa;						--, coalesce&#x28;&#x27;Date End&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,a.dateEnd, 120&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xa;						--, coalesce&#x28;&#x27;Type&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,a.type&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29; --CA.activePlacements&#xa;						--, coalesce&#x28;&#x27;Subject&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,a.subject&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;						--, coalesce&#x28;&#x27;Reminder&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,a.notificationMinutes&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;						, coalesce&#x28;&#x27;Opportunity&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,j2.title&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;						, coalesce&#x28;&#x27;Location&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,a.location&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;						, coalesce&#x28;&#x27;Owner&#x3a; &#x27; &#x2b; NULLIF&#x28;coalesce&#x28;coalesce&#x28;nullif&#x28;UC3.FirstName,&#x27;&#x27;&#x29; &#x2b; &#x27; &#x27;, NULL&#x29;&#xa;											&#x2b; coalesce&#x28;nullif&#x28;UC3.LastName,&#x27;&#x27;&#x29; &#x2b; &#x27; - &#x27;, NULL&#x29; &#x2b; nullif&#x28;UC3.email,&#x27;&#x27;&#x29;, NULL&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xa;						--, coalesce&#x28;&#x27;Lead&#x3a; &#x27; &#x2b; NULLIF&#x28;coalesce&#x28;coalesce&#x28;nullif&#x28;UC4.FirstName,&#x27;&#x27;&#x29; &#x2b; &#x27; &#x27;, NULL&#x29;&#xa;						--					&#x2b; coalesce&#x28;nullif&#x28;UC4.LastName,&#x27;&#x27;&#x29; &#x2b; &#x27; - &#x27;, NULL&#x29; &#x2b; nullif&#x28;UC4.email,&#x27;&#x27;&#x29;, NULL&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xa;						--, coalesce&#x28;&#x27;File Name&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,af.name&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;						, coalesce&#x28;&#x27;Description&#x3a; &#x27; &#x2b; NULLIF&#x28; convert&#x28;nvarchar&#x28;max&#x29;,a.description&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;				&#x29; as &#x27;content&#x27;&#xa;        from bullhorn1.View_Appointment a&#xa;        left join bullhorn1.View_AppointmentFile af on af.appointmentID &#x3d; a.appointmentID&#xa;        left join &#x28; select candidateID, concat&#x28;FirstName,&#x27; &#x27;,LastName&#x29; as fullname, userid, isPrimaryOwner from bullhorn1.Candidate&#x29; C on C.userID &#x3d; a.candidateuserID&#xa;        left join bullhorn1.BH_UserContact UC1 ON UC1.userID &#x3d; a.ClientuserID&#xa;        left join bullhorn1.BH_UserContact UC2 ON UC2.userID &#x3d; a.candidateUserID&#xa;        left join bullhorn1.BH_UserContact UC3 ON UC3.userID &#x3d; a.userID&#xa;        left join bullhorn1.BH_UserContact UC4 ON UC4.userID &#x3d; a.LeaduserID&#xa;        left join bullhorn1.BH_JobPosting j on j.jobPostingID &#x3d; a.jobPostingID&#xa;        left join bullhorn1.BH_JobPosting j2 on j.jobPostingID &#x3d; a.opportunityJobPostingID        &#xa;        where C.candidateID is not null --C.isPrimaryOwner &#x3d; 1 --2680 rows&#xa;&#xa;UNION ALL&#xa;&#xa;	SELECT --top 20 &#xa;	C.candidateID, C.fullname  --, a.candidateuserID, C.userID&#xa;	, a.dateAdded&#xa;	, concat_ws&#x28;char&#x28;10&#x29;, &#x27;&#x2a;&#x2a;&#x2a; TASK&#x3a; &#x27;&#xa;						, coalesce&#x28;&#x27;Candidate&#x3a; &#x27; &#x2b; NULLIF&#x28;coalesce&#x28;coalesce&#x28;nullif&#x28;UC2.FirstName,&#x27;&#x27;&#x29; &#x2b; &#x27; &#x27;, NULL&#x29; &#xa;												&#x2b; coalesce&#x28;nullif&#x28;UC2.LastName,&#x27;&#x27;&#x29; &#x2b; &#x27; - &#x27;, NULL&#x29; &#x2b; nullif&#x28;UC2.email,&#x27;&#x27;&#x29;, NULL&#x29;, &#x27;&#x27;&#x29;, NULL&#x29; --a.candidateUserID &#xa;						--, coalesce&#x28;&#x27;Assigned To&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;a.childTaskOwners as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;						, coalesce&#x28;&#x27;Assigned To&#x3a; &#x27; &#x2b; NULLIF&#x28;coalesce&#x28;coalesce&#x28;nullif&#x28;UC4.FirstName,&#x27;&#x27;&#x29; &#x2b; &#x27; &#x27;, NULL&#x29;&#xa;												&#x2b; coalesce&#x28;nullif&#x28;UC4.LastName,&#x27;&#x27;&#x29; &#x2b; &#x27; - &#x27;, NULL&#x29; &#x2b; nullif&#x28;UC4.email,&#x27;&#x27;&#x29;, NULL&#x29;, &#x27;&#x27;&#x29;, NULL&#x29; --a.userID&#xa;						, coalesce&#x28;&#x27;Contact&#x3a; &#x27; &#x2b; NULLIF&#x28;coalesce&#x28;coalesce&#x28;nullif&#x28;UC1.FirstName,&#x27;&#x27;&#x29; &#x2b; &#x27; &#x27;, NULL&#x29;&#xa;												&#x2b; coalesce&#x28;nullif&#x28;UC1.LastName,&#x27;&#x27;&#x29; &#x2b; &#x27; - &#x27;, NULL&#x29; &#x2b; nullif&#x28;UC1.email,&#x27;&#x27;&#x29;, NULL&#x29;, &#x27;&#x27;&#x29;, NULL&#x29; --a.clientUserID &#xa;						, coalesce&#x28;&#x27;Due Date And Time&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;, a.dateBegin, 120&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xa;						, coalesce&#x28;&#x27;Date End&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,a.dateEnd, 120&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xa;						, coalesce&#x28;&#x27;Description&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28; a.description as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29; --&#x5b;dbo&#x5d;.&#x5b;fn_ConvertHTMLToText&#x5d;&#x28;&#xa;						--, coalesce&#x28;&#x27;Visibility&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;a.isPrivate as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;						, coalesce&#x28;&#x27;Job&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;j.title as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29; --jobPostingID&#xa;						--, coalesce&#x28;&#x27;Lead&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28; concat&#x28;UC3.FirstName,&#x27; &#x27;,UC3.LastName,&#x27;     &#x27;,UC3.email&#x29; as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29; --a.leadUserID&#xa;						--, coalesce&#x28;&#x27;Reminder&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;a.notificationMinutes as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;						, coalesce&#x28;&#x27;Opportunity&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;j2.title as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29; --a.opportunityJobPostingID &#xa;						, coalesce&#x28;&#x27;Placement&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;a.placementID as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;						, coalesce&#x28;&#x27;Priority&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;a.priority as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;						--, coalesce&#x28;&#x27;Recurrence Day Bits&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;a.recurrenceDayBits as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;						--, coalesce&#x28;&#x27;Recurrence Frequency&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;a.recurrenceFrequency as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;						--, coalesce&#x28;&#x27;Recurrence Max&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;a.recurrenceMax as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;						--, coalesce&#x28;&#x27;Recurrence Month Bits&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;a.recurrenceMonthBits as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;						--, coalesce&#x28;&#x27;Recurrence Style&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;a.recurrenceStyle as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;						--, coalesce&#x28;&#x27;Recurrence Type&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;a.recurrenceType as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;						, coalesce&#x28;&#x27;Subject&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;a.subject as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;						, coalesce&#x28;&#x27;Type&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;a.type as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;						, coalesce&#x28;&#x27;Owner&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28; concat&#x28;UC4.FirstName,&#x27; &#x27;,UC4.LastName,&#x27;     &#x27;,UC4.email&#x29; as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29; --a.userID&#xa;				&#x29; as &#x27;content&#x27;       &#xa;        from bullhorn1.View_Task a&#xa;        left join bullhorn1.BH_Client Cl on Cl.userID &#x3d; a.ClientUserID&#xa;        left join bullhorn1.BH_UserContact UC1 ON Cl.userID &#x3d; UC1.userID&#xa;        left join bullhorn1.BH_UserContact UC2 ON a.candidateUserID &#x3d; UC2.userID&#xa;        left join bullhorn1.BH_JobPosting j on j.jobPostingID &#x3d; a.jobPostingID&#xa;        left join bullhorn1.BH_UserContact UC3 ON a.leadUserID &#x3d; UC3.userID&#xa;        left join bullhorn1.BH_UserContact UC4 ON a.userID &#x3d; UC4.userID&#xa;        left join &#x28; select candidateID, concat&#x28;FirstName,&#x27; &#x27;,LastName&#x29; as fullname, userid, isPrimaryOwner from bullhorn1.Candidate&#x29; C on C.userID &#x3d; a.candidateuserID &#xa;        left join bullhorn1.BH_JobPosting j2 on j2.jobPostingID &#x3d; a.opportunityJobPostingID&#xa;        where C.candidateID is not null --C.isPrimaryOwner &#x3d; 1 --&#xa;&#xa;&#xa;UNION ALL&#xa;       -- PLACEMENT&#xa;		select &#xa;		C.candidateid, C.fullname&#xa;		, pl.dateadded &#xa;		, stuff&#x28; &#x27;&#x2a;&#x2a;&#x2a; PLACEMENT&#x3a; &#x27; &#x2b; char&#x28;10&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Billing Contact&#x3a; &#x27; &#x2b; NULLIF&#x28;coalesce&#x28;coalesce&#x28;nullif&#x28;UC1.FirstName,&#x27;&#x27;&#x29; &#x2b; &#x27; &#x27;, NULL&#x29;&#xa;										&#x2b; coalesce&#x28;nullif&#x28;UC1.LastName,&#x27;&#x27;&#x29; &#x2b; &#x27; - &#x27;, NULL&#x29; &#x2b; nullif&#x28;UC1.email,&#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, NULL&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;  --pl.billingUserID&#xa;			--&#x2b; coalesce&#x28;&#x27;Bill Rate Information&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.billRateInfoHeader as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Bill Rate&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.clientBillRate as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Over-time Bill Rate&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.clientOverTimeRate as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Comments&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.comments as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;			--&#x2b; coalesce&#x28;&#x27;Contract Employment Info&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.contractInfoHeader as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Primary Timesheet Approver&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.correlatedCustomText1 as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Secondary Timecard Approver&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.correlatedCustomText2 as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Purchase Order Number&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.correlatedCustomText3 as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Cost Center&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.costCenter as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Insurance Reference&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.customText1 as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Start Date&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;10&#x29;, pl.dateBegin, 120&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Effective Date &#x28;Client&#x29;&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;10&#x29;, pl.dateClientEffective, 120&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Effective Date&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;10&#x29;, pl.dateEffective, 120&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Scheduled End&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;10&#x29;, pl.dateEnd, 120&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Days Guaranteed&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.daysGuaranteed as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Days Pro-Rated&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.daysProRated as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Employment Type&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.employmentType as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Placement Fee &#x28;&#x25;&#x29;&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.fee as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;			--&#x2b; coalesce&#x28;&#x27;Placement Fee &#x28;Flat&#x29;&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.flatFee as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Hours of Operation&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.hoursOfOperation as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Hours Per Day&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.hoursPerDay as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Rate Entry Type&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.isMultirate as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;			--&#x2b; coalesce&#x28;&#x27;Mark-up &#x25;&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.markUpPercentage as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Over-time Pay Rate&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.overtimeRate as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Pay Rate&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.payRate as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;			--&#x2b; coalesce&#x28;&#x27;Pay Rate Information&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.payRateInfoHeader as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;			--&#x2b; coalesce&#x28;&#x27;Permanent Employment Info&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.permanentInfoHeader as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Referral Fee Type&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.referralFeeType as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Reporting to&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.reportTo as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Salary&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.salary as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Pay Unit&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.salaryUnit as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Status&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;pl.status as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;        , 1, 0, &#x27;&#x27;&#x29; as &#x27;content&#x27;&#xa;        from bullhorn1.BH_Placement PL --where PL.reportTo &#x3c;&#x3e; &#x27;&#x27;&#xa;        left join bullhorn1.BH_UserContact UC1 ON UC1.userID &#x3d; pl.billingUserID&#xa;        left join &#x28; select candidateID, concat&#x28;FirstName,&#x27; &#x27;,LastName&#x29; as fullname, userid from bullhorn1.Candidate&#x29; C on C.userID &#x3d; pl.userid&#xa;&#xa;UNION ALL&#xa;       -- Job Submission&#xa;			select &#xa;			C.candidateid, C.fullname&#xa;			, jr.dateadded&#xa;			, stuff&#x28;&#x27;&#x2a;&#x2a;&#x2a; JOB SUBMISSION&#x3a; &#x27; &#x2b; char&#x28;10&#x29;&#xa;                 --coalesce&#x28;&#x27;Appointments&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;jr.appointments as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Bill Rate&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;jr.billRate as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Comments&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;jr.comments as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Date Added&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;10&#x29;, jr.dateAdded, 120&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              --&#x2b; coalesce&#x28;&#x27;Date Last Modified&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;jr.dateLastModified as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Date Web Response&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;jr.dateWebResponse as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Job Order&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;j.title as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29; --jr.jobPostingID&#xa;              &#x2b; coalesce&#x28;&#x27;Latest Appointment&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;jr.latestAppointmentID as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Migrate GUID&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;jr.migrateGUID as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              --&#x2b; coalesce&#x28;&#x27;Owners&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;jr.owners as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Pay Rate&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;jr.payRate as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Salary&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;jr.salary as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Added By&#x3a; &#x27; &#x2b; NULLIF&#x28;coalesce&#x28;coalesce&#x28;nullif&#x28;UC2.FirstName,&#x27;&#x27;&#x29; &#x2b; &#x27; &#x27;, NULL&#x29;&#xa;								&#x2b; coalesce&#x28;nullif&#x28;UC2.LastName,&#x27;&#x27;&#x29; &#x2b; &#x27; - &#x27;, NULL&#x29; &#x2b; nullif&#x28;UC2.email,&#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, NULL&#x29;, &#x27;&#x27;&#x29;, NULL&#x29; --jr.sendingUserID&#xa;              &#x2b; coalesce&#x28;&#x27;Source&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;jr.source as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Status&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;jr.status as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              --&#x2b; coalesce&#x28;&#x27;Task&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;jr.tasks as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xa;              &#x2b; coalesce&#x28;&#x27;Candidate&#x3a; &#x27; &#x2b; NULLIF&#x28;coalesce&#x28;coalesce&#x28;nullif&#x28;UC1.FirstName,&#x27;&#x27;&#x29; &#x2b; &#x27; &#x27;, NULL&#x29;&#xa;										&#x2b; coalesce&#x28;nullif&#x28;UC1.LastName,&#x27;&#x27;&#x29; &#x2b; &#x27; - &#x27;, NULL&#x29; &#x2b; nullif&#x28;UC1.email,&#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, NULL&#x29;, &#x27;&#x27;&#x29;, NULL&#x29; --jr.userID &#xa;        , 1, 0, &#x27;&#x27;&#x29; as note&#xa;        from bullhorn1.View_JobResponse jr&#xa;        left join bullhorn1.BH_UserContact UC1 ON UC1.userID &#x3d; jr.userID&#xa;        left join bullhorn1.BH_UserContact UC2 ON UC2.userID &#x3d; jr.sendingUserID&#xa;        left join bullhorn1.BH_JobPosting j on j.jobPostingID &#x3d; jr.jobPostingID        &#xa;        left join &#x28; select candidateID, concat&#x28;FirstName,&#x27; &#x27;,LastName&#x29; as fullname, userid from bullhorn1.Candidate&#x29; C on C.userID &#x3d; jr.userid&#xa;        --where jr.userid &#x3c;&#x3e; jr.sendingUserID&#xa;&#x29;&#xa;&#xa;select --top 100&#xa;                   concat&#x28;&#x27;PR&#x27;, candidateID&#x29; as cand_ext_id&#xa;                  , -10 as &#x27;user_account_id&#x27;&#xa;                  , &#x27;comment&#x27; as &#x27;category&#x27;&#xa;                  , &#x27;candidate&#x27; as &#x27;type&#x27;&#xa;                  , dateAdded as &#x27;insert_timestamp&#x27;&#xa;                  , &#x5b;dbo&#x5d;.&#x5b;udf_StripHTML&#x5d;&#x28;content&#x29; as content&#xa;from comments where content &#x3c;&#x3e; &#x27;&#x27; --55563&#xa;order by candidateID</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1840</xloc>
      <yloc>112</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Candidate LTD company</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>select userID&#xa;, convert&#x28;nvarchar&#x28;max&#x29;,customText3&#x29;&#xa;, customText5&#xa;, secondaryAddress1&#xa;, secondaryAddress2&#xa;, secondaryCity&#xa;, secondaryCountryID&#xa;, tc.COUNTRY&#xa;, secondaryState&#xa;, secondaryZip&#xa;from bullhorn1.BH_UserContact uc&#xa;left join tmp_country tc on tc.CODE &#x3d; uc.secondaryCountryID</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1840</xloc>
      <yloc>768</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Candidate Source</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from &#x28;PROD&#x29;</connection>
    <sql>&#x2f;&#x2a; CANDIDATE SOURCE&#xd;&#xa;select distinct value&#xd;&#xa;from bullhorn1.Candidate&#xd;&#xa;cross apply string_split&#x28;source, &#x27;,&#x27;&#x29;&#xd;&#xa;where source is not NULL&#xd;&#xa;order by value&#xd;&#xa;&#x2a;&#x2f;&#xd;&#xa;&#xd;&#xa;with cand as &#x28;select concat&#x28;&#x27;PR&#x27;, candidateID&#x29; as cand_ext_id&#xd;&#xa;, trim&#x28;value&#x29; as source&#xd;&#xa;, row_number&#x28;&#x29; over &#x28;partition by candidateID order by value&#x29; as rn&#xd;&#xa;from bullhorn1.Candidate&#xd;&#xa;cross apply string_split&#x28;source, &#x27;,&#x27;&#x29;&#xd;&#xa;where source is not NULL&#xd;&#xa;--order by candidateID&#xd;&#xa;&#x29;&#xd;&#xa;&#xd;&#xa;select &#x2a;&#xd;&#xa;from cand&#xd;&#xa;where rn &#x3d; 1</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1840</xloc>
      <yloc>1536</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Candidate Source DB</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>select distinct value&#xd;&#xa;from bullhorn1.Candidate&#xd;&#xa;cross apply string_split&#x28;source, &#x27;,&#x27;&#x29;&#xd;&#xa;where source is not NULL&#xd;&#xa;order by value</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>80</xloc>
      <yloc>1392</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Candidate desire_salary</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from &#x28;PROD&#x29;</connection>
    <sql>-- SALARY&#xd;&#xa;select&#xd;&#xa;         concat&#x28;&#x27;PR&#x27;, C.candidateID&#x29; as cand_ext_id&#xd;&#xa;       , 2 as &#x27;salary_type&#x27;&#xd;&#xa;       , 12 as &#x27;months_per_year&#x27;&#xd;&#xa;	, cast&#x28;C.salaryLow as int&#x29; as &#x27;present_salary_rate&#x27;&#xd;&#xa;	, cast&#x28;C.salaryLow&#x2a;12 as int&#x29; as &#x27;current_salary&#x27;&#xd;&#xa;	, cast&#x28;C.salary as int&#x29; as &#x27;desire_salary&#x27;&#xd;&#xa;from bullhorn1.Candidate C&#xd;&#xa;where C.isdeleted &#x3c;&#x3e; 1 and C.status &#x3c;&#x3e; &#x27;Archive&#x27;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1840</xloc>
      <yloc>1440</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Candidate lookup</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema/>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>cand_ext_id</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCCandidateID</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2000</xloc>
      <yloc>1536</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Candidate lookup 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema/>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>cand_ext_id</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCCandidateID</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2000</xloc>
      <yloc>592</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Candidate lookup 2 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema/>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>candidateextid</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCCandidateID</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2000</xloc>
      <yloc>768</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Candidate source lookup</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema/>
      <table>candidate_source</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>source</name>
        <field>name</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCCandSourceID</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2160</xloc>
      <yloc>1536</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Comp lookup</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>company</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>com_ext_id</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCCompanyID</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>256</xloc>
      <yloc>160</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Comp lookup 3</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>company</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>CompanyExtId</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>final_company_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>208</xloc>
      <yloc>704</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Company - table</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from &#x28;PROD&#x29;</connection>
    <sql>select --top 100 &#xa;       concat&#x28;&#x27;PR&#x27;,CC.clientCorporationID&#x29; as CompanyExtId&#xa;       , CC.name as &#x27;company-name&#x27;&#xa;       , CC.numEmployees&#xa;       , CC.dateadded as RegDate&#xa;from bullhorn1.BH_ClientCorporation CC&#xa;order by clientCorporationID</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>80</xloc>
      <yloc>704</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Company Comment</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from &#x28;PROD&#x29;</connection>
    <sql>with &#xd;&#xa;t as &#x28;&#xd;&#xa;       select &#xd;&#xa;                 UC1.clientCorporationID&#xd;&#xa;               , UC.dateAdded&#xd;&#xa;							 , author.name as &#x27;authorname&#x27;&#xd;&#xa;							 , author.email as &#x27;authoremail&#x27;--author.userID, &#xd;&#xa;               , about.name as &#x27;aboutname&#x27;&#xd;&#xa;							 , about.email as &#x27;aboutemail&#x27; --, about.userID &#xd;&#xa;               , UC.action&#xd;&#xa;							 , UC.comments&#xd;&#xa;       from bullhorn1.BH_UserComment UC&#xd;&#xa;       left join &#x28;select &#x2a; from bullhorn1.BH_UserContact&#x29; author ON author.userID &#x3d; UC.commentingUserID&#xd;&#xa;       left join &#x28;select &#x2a; from bullhorn1.BH_UserContact&#x29; about ON about.userID &#x3d; UC.userID&#xd;&#xa;       --left join bullhorn1.BH_ClientCorporation on Cl.userID &#x3d; UC.userID&#xd;&#xa;       --left join bullhorn1.BH_Client Cl on Cl.userID &#x3d; UC.userID&#xd;&#xa;       left join bullhorn1.BH_UserContact UC1 ON UC1.userID &#x3d; UC.userID&#xd;&#xa;       where UC1.clientCorporationID is not null&#xd;&#xa;       --and UC.dateAdded between &#x27;2017-09-01&#x27; AND &#x27;2017-11-01&#x27; --&#x3c;&#x3c;&#x3c;&#x3c;&#x3c;&#xd;&#xa;       --and &#x28;UC.dateAdded &#x3c; &#x27;2017-09-01&#x27; or &#x27;2017-11-01&#x27; &#x3c; UC.dateAdded &#x29; --&#x3c;&#x3c;&#x3c;&#x3c;&#x3c;&#xd;&#xa;       &#x2f;&#x2a;order by UC.dateAdded desc &#xd;&#xa;       and UC1.clientCorporationID &#x3d; 4666 &#xd;&#xa;       and UC.comments like &#x27;Can you put&#x25;&#x27;  &#xd;&#xa;       or UC1.userid in &#x28;98297,180534&#x29; or U.userid in &#x28;98297,180534&#x29; &#x2a;&#x2f;&#xd;&#xa;       &#x29;&#xd;&#xa;&#xd;&#xa;select&#xd;&#xa;           concat&#x28;&#x27;PR&#x27;, clientCorporationID&#x29; as com_ext_id&#xd;&#xa;         , cast&#x28;&#x27;-10&#x27; as int&#x29; as &#x27;user_account_id&#x27;&#xd;&#xa;         , &#x27;comment&#x27; as category&#xd;&#xa;         , &#x27;company&#x27; as type	&#xd;&#xa;         , dateAdded as insert_timestamp&#xd;&#xa;         ,  &#x5b;bullhorn1&#x5d;.&#x5b;fn_ConvertHTMLToText&#x5d;&#x28;&#xd;&#xa;            Stuff&#x28;  coalesce&#x28;&#x27;Author Name&#x3a; &#x27; &#x2b; nullif&#x28;convert&#x28;varchar&#x28;max&#x29;,authorname&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;                        &#x2b; coalesce&#x28;&#x27;Author Email&#x3a; &#x27; &#x2b; nullif&#x28;convert&#x28;varchar&#x28;max&#x29;,authoremail&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;                        &#x2b; coalesce&#x28;&#x27;Author Name&#x3a; &#x27; &#x2b; nullif&#x28;convert&#x28;varchar&#x28;max&#x29;,aboutname&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;                        &#x2b; coalesce&#x28;&#x27;About Email&#x3a; &#x27; &#x2b; nullif&#x28;convert&#x28;varchar&#x28;max&#x29;,aboutemail&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;                        &#x2b; coalesce&#x28;&#x27;Action&#x3a; &#x27; &#x2b; nullif&#x28;convert&#x28;varchar&#x28;max&#x29;,&#x5b;action&#x5d;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;                        &#x2b; coalesce&#x28;&#x27;Comments&#x3a; &#x27; &#x2b; nullif&#x28;convert&#x28;varchar&#x28;max&#x29;,comments&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;              , 1, 0, &#x27;&#x27;&#x29;&#x29; as content&#xd;&#xa;        -- select  top 10 &#x2a;&#xd;&#xa;from t --1624 rows</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>80</xloc>
      <yloc>160</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Company Location</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from &#x28;PROD&#x29;</connection>
    <sql>--Company additional location&#xd;&#xa;select concat&#x28;&#x27;PR&#x27;, CC.clientCorporationID&#x29; as com_ext_id&#xd;&#xa;	, left&#x28;concat_ws&#x28;&#x27;, &#x27;, nullif&#x28;billingAddress1,&#x27;&#x27;&#x29;, nullif&#x28;billingAddress2,&#x27;&#x27;&#x29;, nullif&#x28;cc.billingCity,&#x27;&#x27;&#x29;, nullif&#x28;cc.billingState,&#x27;&#x27;&#x29;&#xd;&#xa;			, nullif&#x28;cc.billingZip,&#x27;&#x27;&#x29;, nullif&#x28;tc.COUNTRY,&#x27;&#x27;&#x29;&#x29;,300&#x29; as locationName&#xd;&#xa;	, left&#x28;concat_ws&#x28;&#x27;, &#x27;, nullif&#x28;billingAddress1,&#x27;&#x27;&#x29;, nullif&#x28;billingAddress2,&#x27;&#x27;&#x29;, nullif&#x28;cc.billingCity,&#x27;&#x27;&#x29;, nullif&#x28;cc.billingState,&#x27;&#x27;&#x29;&#xd;&#xa;			, nullif&#x28;cc.billingZip,&#x27;&#x27;&#x29;, nullif&#x28;tc.COUNTRY,&#x27;&#x27;&#x29;&#x29;,300&#x29; as locationAddress&#xd;&#xa;	, &#x27;BILLING_ADDRESS&#x27; as location_type&#xd;&#xa;	, getdate&#x28;&#x29; as insert_timestamp&#xd;&#xa;	, cc.billingState as &#x5b;state&#x5d;&#xd;&#xa;	, cc.billingZip as post_code&#xd;&#xa;	, cc.billingCity as city&#xd;&#xa;from bullhorn1.BH_ClientCorporation cc&#xd;&#xa;left join tmp_country tc ON CC.billingCountryID &#x3d; tc.code&#xd;&#xa;where billingAddress1 &#x3c;&#x3e; &#x27;&#x27; or billingAddress2 &#x3c;&#x3e; &#x27;&#x27; or billingCountryID &#x3c;&#x3e; &#x27;&#x27;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>80</xloc>
      <yloc>464</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Contact Comment</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from &#x28;PROD&#x29;</connection>
    <sql>with comments as &#x28;&#xd;&#xa;       select &#xd;&#xa;                 cl.clientID as contact_id&#xd;&#xa;               , uc.dateAdded&#xd;&#xa;               , concat_ws&#x28;char&#x28;10&#x29;&#xd;&#xa;					, &#x27;&#x2a;&#x2a;&#x2a; COMMENT&#x3a;&#x27;&#xd;&#xa;                    , coalesce&#x28;&#x27;Created Date&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;varchar,uc.dateAdded,120&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;                    --, coalesce&#x28;&#x27;Author&#x3a; &#x27; &#x2b; NULLIF&#x28;u.name, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;                    , coalesce&#x28;&#x27;Action&#x3a; &#x27; &#x2b; NULLIF&#x28;uc.action, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;					--, coalesce&#x28;&#x27;About&#x3a; &#x27; &#x2b; NULLIF&#x28;coalesce&#x28;coalesce&#x28;nullif&#x28;UC1.FirstName,&#x27;&#x27;&#x29; &#x2b; &#x27; &#x27;, NULL&#x29; &#x2b; coalesce&#x28;nullif&#x28;UC1.LastName,&#x27;&#x27;&#x29; &#x2b; &#x27; - &#x27;, NULL&#x29; &#x2b; nullif&#x28;UC1.email,&#x27;&#x27;&#x29;, NULL&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;                    , coalesce&#x28;&#x27;Comments&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;uc.comments as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;               &#x29; as &#x5b;content&#x5d;&#xd;&#xa;       from bullhorn1.BH_UserComment uc&#xd;&#xa;       left join bullhorn1.BH_Client cl on cl.userID &#x3d; uc.userID&#xd;&#xa;       left join bullhorn1.BH_UserContact uc1 ON Cl.userID &#x3d; uc1.userID&#xd;&#xa;       left join bullhorn1.BH_User u on u.userID &#x3d; uc.commentingUserID&#xd;&#xa;       where cl.clientID is not null and &#x28;cl.isdeleted &#x3c;&#x3e; 1 and cl.status &#x3c;&#x3e; &#x27;Archive&#x27;&#x29;&#xd;&#xa;&#xd;&#xa;UNION ALL&#xd;&#xa;&#xd;&#xa;	select&#xd;&#xa;                Cl.clientID as contact_id&#xd;&#xa;              , a.dateAdded&#xd;&#xa;              , concat_ws&#x28;char&#x28;10&#x29;, &#x27;&#x2a;&#x2a;&#x2a; APPOINTMENT&#x3a; &#x27;&#xd;&#xa;					, coalesce&#x28;&#x27;Contact&#x3a; &#x27; &#x2b; NULLIF&#x28;coalesce&#x28;coalesce&#x28;nullif&#x28;UC1.FirstName,&#x27;&#x27;&#x29; &#x2b; &#x27; &#x27;, NULL&#x29; &#x2b; coalesce&#x28;nullif&#x28;UC1.LastName,&#x27;&#x27;&#x29; &#x2b; &#x27; - &#x27;, NULL&#x29; &#x2b; nullif&#x28;UC1.email,&#x27;&#x27;&#x29;, NULL&#x29;, &#x27;&#x27;&#x29;, NULL&#x29; --a.clientUserID &#xd;&#xa;					, coalesce&#x28;&#x27;Candidate&#x3a; &#x27; &#x2b; NULLIF&#x28;coalesce&#x28;coalesce&#x28;nullif&#x28;UC2.FirstName,&#x27;&#x27;&#x29; &#x2b; &#x27; &#x27;, NULL&#x29; &#x2b; coalesce&#x28;nullif&#x28;UC2.LastName,&#x27;&#x27;&#x29; &#x2b; &#x27; - &#x27;, NULL&#x29; &#x2b; nullif&#x28;UC2.email,&#x27;&#x27;&#x29;, NULL&#x29;, &#x27;&#x27;&#x29;, NULL&#x29; --a.candidateUserID &#xd;&#xa;					, coalesce&#x28;&#x27;Job&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;j.title as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29; --jobPostingID&#xd;&#xa;					--, coalesce&#x28;&#x27;Communication Method&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29; ,a.communicationMethod&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;					--, coalesce&#x28;&#x27;Owner&#x3a; &#x27; &#x2b; NULLIF&#x28;coalesce&#x28;coalesce&#x28;nullif&#x28;UC3.FirstName,&#x27;&#x27;&#x29; &#x2b; &#x27; &#x27;, NULL&#x29; &#x2b; coalesce&#x28;nullif&#x28;UC3.LastName,&#x27;&#x27;&#x29; &#x2b; &#x27; - &#x27;, NULL&#x29; &#x2b; nullif&#x28;UC3.email,&#x27;&#x27;&#x29;, NULL&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;					--, coalesce&#x28;&#x27;Lead&#x3a; &#x27; &#x2b; NULLIF&#x28;coalesce&#x28;coalesce&#x28;nullif&#x28;UC4.FirstName,&#x27;&#x27;&#x29; &#x2b; &#x27; &#x27;, NULL&#x29; &#x2b; coalesce&#x28;nullif&#x28;UC4.LastName,&#x27;&#x27;&#x29; &#x2b; &#x27; - &#x27;, NULL&#x29; &#x2b; nullif&#x28;UC4.email,&#x27;&#x27;&#x29;, NULL&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;					, coalesce&#x28;&#x27;Date Begin&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;, a.dateBegin, 120&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;					, coalesce&#x28;&#x27;Date End&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,a.dateEnd, 120&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;					--, coalesce&#x28;&#x27;Type&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,a.type&#x29;, &#x27;&#x27;&#x29;, NULL&#x29; --CA.activePlacements&#xd;&#xa;					--, coalesce&#x28;&#x27;Subject&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,a.subject&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;					--, coalesce&#x28;&#x27;Reminder&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,a.notificationMinutes&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;					, coalesce&#x28;&#x27;Opportunity&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,j2.title&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;					, coalesce&#x28;&#x27;Location&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,a.location&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;					--, coalesce&#x28;&#x27;File Name&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,af.name&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;					, coalesce&#x28;char&#x28;10&#x29; &#x2b; &#x27;Description&#x3a; &#x27; &#x2b; &#x5b;bullhorn1&#x5d;.&#x5b;fn_ConvertHTMLToText&#x5d;&#x28;NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,a.description&#x29;, &#x27;&#x27;&#x29;&#x29;, NULL&#x29;&#xd;&#xa;				&#x29; as &#x5b;content&#x5d; &#xd;&#xa;       from bullhorn1.View_Appointment a&#xd;&#xa;       left join bullhorn1.View_AppointmentFile af on af.appointmentID &#x3d; a.appointmentID&#xd;&#xa;       left join bullhorn1.BH_Client Cl on Cl.userID &#x3d; a.ClientUserID&#xd;&#xa;       left join bullhorn1.BH_UserContact UC1 ON UC1.userID &#x3d; Cl.userID&#xd;&#xa;       left join bullhorn1.BH_UserContact UC2 ON UC2.userID &#x3d; a.candidateUserID&#xd;&#xa;       left join bullhorn1.BH_UserContact UC3 ON UC3.userID &#x3d; a.userID&#xd;&#xa;       left join bullhorn1.BH_UserContact UC4 ON UC4.userID &#x3d; a.LeaduserID&#xd;&#xa;       left join bullhorn1.BH_JobPosting j on j.jobPostingID &#x3d; a.jobPostingID&#xd;&#xa;       left join bullhorn1.BH_JobPosting j2 on j.jobPostingID &#x3d; a.opportunityJobPostingID&#xd;&#xa;       where Cl.clientID is not null and &#x28;Cl.isdeleted &#x3c;&#x3e; 1 and Cl.status &#x3c;&#x3e; &#x27;Archive&#x27;&#x29;&#xd;&#xa;&#xd;&#xa;UNION ALL&#xd;&#xa;&#xd;&#xa;	select ---top 20 &#xd;&#xa;                Cl.clientID as &#x27;contact_id&#x27; --,concat&#x28;UC1.firstName,&#x27; &#x27;,UC1.lastName&#x29; as fullname&#xd;&#xa;              , a.dateAdded&#xd;&#xa;              , concat_ws&#x28;char&#x28;10&#x29;, &#x27;&#x2a;&#x2a;&#x2a; TASK&#x3a; &#x27;&#xd;&#xa;						, coalesce&#x28;&#x27;Candidate&#x3a; &#x27; &#x2b; NULLIF&#x28;coalesce&#x28;coalesce&#x28;nullif&#x28;UC2.FirstName,&#x27;&#x27;&#x29; &#x2b; &#x27; &#x27;, NULL&#x29; &#x2b; coalesce&#x28;nullif&#x28;UC2.LastName,&#x27;&#x27;&#x29; &#x2b; &#x27; - &#x27;, NULL&#x29; &#x2b; nullif&#x28;UC2.email,&#x27;&#x27;&#x29;, NULL&#x29;, &#x27;&#x27;&#x29;, NULL&#x29; --a.candidateUserID &#xd;&#xa;						--, coalesce&#x28;&#x27;Assigned To&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;a.childTaskOwners as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;						, coalesce&#x28;&#x27;Assigned To&#x3a; &#x27; &#x2b; NULLIF&#x28;coalesce&#x28;coalesce&#x28;nullif&#x28;UC4.FirstName,&#x27;&#x27;&#x29; &#x2b; &#x27; &#x27;, NULL&#x29; &#x2b; coalesce&#x28;nullif&#x28;UC4.LastName,&#x27;&#x27;&#x29; &#x2b; &#x27; - &#x27;, NULL&#x29; &#x2b; nullif&#x28;UC4.email,&#x27;&#x27;&#x29;, NULL&#x29;, &#x27;&#x27;&#x29;, NULL&#x29; --a.userID&#xd;&#xa;						, coalesce&#x28;&#x27;Contact&#x3a; &#x27; &#x2b; NULLIF&#x28;coalesce&#x28;coalesce&#x28;nullif&#x28;UC1.FirstName,&#x27;&#x27;&#x29; &#x2b; &#x27; &#x27;, NULL&#x29; &#x2b; coalesce&#x28;nullif&#x28;UC1.LastName,&#x27;&#x27;&#x29; &#x2b; &#x27; - &#x27;, NULL&#x29; &#x2b; nullif&#x28;UC1.email,&#x27;&#x27;&#x29;, NULL&#x29;, &#x27;&#x27;&#x29;, NULL&#x29; --a.clientUserID &#xd;&#xa;						--, coalesce&#x28;&#x27;Due Date And Time&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;, a.dateBegin, 120&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;						--, coalesce&#x28;&#x27;Date End&#x3a; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,a.dateEnd, 120&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;						, coalesce&#x28;&#x27;Job&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;j.title as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29; --jobPostingID&#xd;&#xa;						--, coalesce&#x28;&#x27;Lead&#x3a; &#x27; &#x2b; NULLIF&#x28;coalesce&#x28;coalesce&#x28;nullif&#x28;UC3.FirstName,&#x27;&#x27;&#x29; &#x2b; &#x27; &#x27;, NULL&#x29; &#x2b; coalesce&#x28;nullif&#x28;UC3.LastName,&#x27;&#x27;&#x29; &#x2b; &#x27; - &#x27;, NULL&#x29; &#x2b; nullif&#x28;UC3.email,&#x27;&#x27;&#x29;, NULL&#x29;, &#x27;&#x27;&#x29;, NULL&#x29; --a.leadUserID&#xd;&#xa;						--, coalesce&#x28;&#x27;Reminder&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;a.notificationMinutes as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;						--, coalesce&#x28;&#x27;Opportunity&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;a.opportunityJobPostingID as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;						, coalesce&#x28;&#x27;Placement&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;a.placementID as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;						--, coalesce&#x28;&#x27;Priority&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;a.priority as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;						--, coalesce&#x28;&#x27;Visibility&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;a.isPrivate as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;						, coalesce&#x28;&#x27;Subject&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;a.subject as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;						, coalesce&#x28;&#x27;Type&#x3a; &#x27; &#x2b; NULLIF&#x28;cast&#x28;a.type as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;						, coalesce&#x28;char&#x28;10&#x29; &#x2b; &#x27;Description&#x3a; &#x27; &#x2b; &#x5b;bullhorn1&#x5d;.&#x5b;fn_ConvertHTMLToText&#x5d;&#x28;NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,a.description&#x29;, &#x27;&#x27;&#x29;&#x29;, NULL&#x29;&#xd;&#xa;					&#x29; as &#x5b;content&#x5d; &#xd;&#xa;        from bullhorn1.View_Task a&#xd;&#xa;        left join bullhorn1.BH_Client Cl on Cl.userID &#x3d; a.ClientUserID&#xd;&#xa;        left join bullhorn1.BH_UserContact UC1 ON Cl.userID &#x3d; UC1.userID&#xd;&#xa;        left join bullhorn1.BH_UserContact UC2 ON a.candidateUserID &#x3d; UC2.userID&#xd;&#xa;        left join bullhorn1.BH_JobPosting j on j.jobPostingID &#x3d; a.jobPostingID&#xd;&#xa;        left join bullhorn1.BH_UserContact UC3 ON a.leadUserID &#x3d; UC3.userID&#xd;&#xa;        left join bullhorn1.BH_UserContact UC4 ON a.userID &#x3d; UC4.userID&#xd;&#xa;        where Cl.clientID is not null and &#x28;Cl.isdeleted &#x3c;&#x3e; 1 and Cl.status &#x3c;&#x3e; &#x27;Archive&#x27;&#x29;&#xd;&#xa;&#x29;&#xd;&#xa;&#xd;&#xa;select --top 100&#xd;&#xa;                   concat&#x28;&#x27;PR&#x27;, contact_id&#x29; as ContactExtId&#xd;&#xa;                  , -10 as user_account_id&#xd;&#xa;                  , &#x27;comment&#x27; as &#x27;category&#x27;&#xd;&#xa;                  , &#x27;contact&#x27; as &#x5b;type&#x5d;&#xd;&#xa;                  , dateAdded as insert_timestamp&#xd;&#xa;                  , content&#xd;&#xa;from comments&#xd;&#xa;order by contact_id --4155 rows</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>576</xloc>
      <yloc>112</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Contact Distribution</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>select concat&#x28;&#x27;PR&#x27;,c.clientID&#x29; as contactExtId&#xa;, c.userID&#xa;, d.groupName&#xa;, d.name&#xa;from bullhorn1.BH_Client c&#xa;left join bullhorn1.BH_DistributionListMember dm on dm.userID &#x3d; c.userID&#xa;left join bullhorn1.BH_DistributionList d on d.distributionListID &#x3d; dm.distributionListID&#xa;where d.name is not NULL&#xa;order by c.clientID</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>576</xloc>
      <yloc>1296</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Contact Distribution DB</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>select distinct name as GROUP_NAME&#xa;, -10 as owner_id&#xa;, 1 as share_permission&#xa;, getdate&#x28;&#x29; as insert_timestamp&#xa;from bullhorn1.&#x5b;BH_DistributionList&#x5d;&#xa;order by name&#xa;&#xa;--total&#x3a; 9</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>576</xloc>
      <yloc>1216</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Contact Distribution list</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <schema>public</schema>
    <table>contact_group_contact</table>
    <commit>100</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>contact_id</column_name>
          <stream_name>VCContactID</stream_name>
        </field>
        <field>
          <column_name>contact_group_id</column_name>
          <stream_name>VCContactGroupID</stream_name>
        </field>
        <field>
          <column_name>insert_timestamp</column_name>
          <stream_name>insert_timestamp</stream_name>
        </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1040</xloc>
      <yloc>1296</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Contact Document 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from &#x28;PROD&#x29;</connection>
    <sql>SELECT &#x27;contact&#x27; as Category&#xd;&#xa;, concat&#x28;&#x27;PR&#x27;,Cl.clientid&#x29; as ContactExtID&#xd;&#xa;, concat&#x28;F.clientContactFileID, F.fileExtension&#x29; as UploadedName&#xd;&#xa;, case when right&#x28;F.name, charindex&#x28;&#x27;.&#x27;, reverse&#x28;name&#x29;&#x29;&#x29; &#x3d; F.fileExtension then F.Name&#xd;&#xa;	else concat&#x28;F.name, F.fileExtension&#x29; end as RealName&#xd;&#xa;, F.dateadded as created&#xd;&#xa;, &#x27;document&#x27; as document_type&#xd;&#xa;from bullhorn1.View_ClientContactFile F &#xd;&#xa;left join bullhorn1.BH_Client Cl on Cl.userid &#x3d; F.clientcontactuserid --34 rows&#xd;&#xa;--where F.fileExtension in &#x28;&#x27;.doc&#x27;,&#x27;.docx&#x27;,&#x27;.pdf&#x27;,&#x27;.xls&#x27;,&#x27;.xlsx&#x27;,&#x27;.rtf&#x27;,&#x27;.html&#x27;&#x29; --18 rows</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>576</xloc>
      <yloc>1536</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Contact FE SFE</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>select cs.categoryID&#xa;, c.occupation as FE&#xa;, s.name as SFE&#xa;, getdate&#x28;&#x29; as insert_timestamp&#xa;from bullhorn1.BH_CategorySkillAssociation cs&#xa;left join bullhorn1.BH_CategoryList c on c.categoryID &#x3d; cs.categoryID&#xa;left join bullhorn1.BH_SkillList s on s.skillID &#x3d; cs.skillID&#xa;order by FE, SFE</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>576</xloc>
      <yloc>1392</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Contact location</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from &#x28;PROD&#x29;</connection>
    <sql>with contactloc as &#x28;select clientID&#xd;&#xa;		, cl.clientCorporationID&#xd;&#xa;		, uc.address1&#xd;&#xa;		, uc.address2&#xd;&#xa;		, uc.city&#xd;&#xa;		, uc.state&#xd;&#xa;		, uc.zip&#xd;&#xa;		, uc.countryID&#xd;&#xa;		, tc.COUNTRY&#xd;&#xa;		, tc.ABBREVIATION&#xd;&#xa;		, row_number&#x28;&#x29; over&#x28;partition by cl.clientCorporationID order by lower&#x28;concat&#x28;uc.address1, uc.address2, city, state, zip, tc.COUNTRY&#x29;&#x29;&#x29; as rn&#xd;&#xa;from bullhorn1.BH_Client cl&#xd;&#xa;left join bullhorn1.BH_UserContact uc ON cl.userID &#x3d; uc.userID&#xd;&#xa;left join tmp_country tc on tc.CODE &#x3d; uc.countryID&#xd;&#xa;where 1&#x3d;1&#xd;&#xa;--and &#x28;uc.address1 is not NULL or uc.address2 is not NULL&#x29;&#xd;&#xa;and &#x28;uc.address1 &#x3c;&#x3e; &#x27;&#x27; or uc.address2 &#x3c;&#x3e; &#x27;&#x27;&#x29;&#x29;&#xd;&#xa;&#xd;&#xa;--CONTACT LOCATION AS COMPANY LOCATION&#xd;&#xa;select concat&#x28;&#x27;PR&#x27;, clientID&#x29; as con_ext_id&#xd;&#xa;	, concat&#x28;&#x27;PR&#x27;, clientCorporationID&#x29; as com_ext_id&#xd;&#xa;	, left&#x28;concat_ws&#x28;&#x27;, &#x27;, nullif&#x28;address1,&#x27;&#x27;&#x29;, nullif&#x28;address2,&#x27;&#x27;&#x29;, nullif&#x28;city,&#x27;&#x27;&#x29;, nullif&#x28;state,&#x27;&#x27;&#x29;&#xd;&#xa;			, nullif&#x28;zip,&#x27;&#x27;&#x29;, nullif&#x28;COUNTRY,&#x27;&#x27;&#x29;&#x29;,300&#x29; as locationName&#xd;&#xa;	, left&#x28;concat_ws&#x28;&#x27;, &#x27;, nullif&#x28;address1,&#x27;&#x27;&#x29;, nullif&#x28;address2,&#x27;&#x27;&#x29;, nullif&#x28;city,&#x27;&#x27;&#x29;, nullif&#x28;state,&#x27;&#x27;&#x29;&#xd;&#xa;			, nullif&#x28;zip,&#x27;&#x27;&#x29;, nullif&#x28;COUNTRY,&#x27;&#x27;&#x29;&#x29;,300&#x29; as locationAddress&#xd;&#xa;	, city as city&#xd;&#xa;	, state as &#x5b;state&#x5d;&#xd;&#xa;	, zip as post_code&#xd;&#xa;	, ABBREVIATION as country_code&#xd;&#xa;	, &#x27;PERSONAL_ADDRESS&#x27; as location_type&#xd;&#xa;	, getdate&#x28;&#x29; as insert_timestamp&#xd;&#xa;	, concat_ws&#x28;&#x27;-&#x27;, &#x27;PR&#x27;, clientCorporationID, clientID&#x29; as note --combination of company-contact IDs&#xd;&#xa;from contactloc&#xd;&#xa;where 1&#x3d;1&#xd;&#xa;and rn &#x3d; 1 --249 rows&#xd;&#xa;and lower&#x28;concat&#x28;address1, address2, city, state, zip, countryID&#x29;&#x29; not in &#x28;select lower&#x28;concat&#x28;address1, address2, city, state, zip, countryID&#x29;&#x29; from bullhorn1.BH_ClientCorporation&#x29; --70 rows</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>80</xloc>
      <yloc>544</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Contact location 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from &#x28;PROD&#x29;</connection>
    <sql>with contactloc as &#x28;select clientID&#xd;&#xa;		, cl.clientCorporationID&#xd;&#xa;		, uc.address1&#xd;&#xa;		, uc.address2&#xd;&#xa;		, uc.city&#xd;&#xa;		, uc.state&#xd;&#xa;		, uc.zip&#xd;&#xa;		, uc.countryID&#xd;&#xa;		, tc.COUNTRY&#xd;&#xa;		, tc.ABBREVIATION&#xd;&#xa;		, row_number&#x28;&#x29; over&#x28;partition by cl.clientCorporationID order by lower&#x28;concat&#x28;uc.address1, uc.address2, city, state, zip, tc.COUNTRY&#x29;&#x29;&#x29; as rn&#xd;&#xa;from bullhorn1.BH_Client cl&#xd;&#xa;left join bullhorn1.BH_UserContact uc ON cl.userID &#x3d; uc.userID&#xd;&#xa;left join tmp_country tc on tc.CODE &#x3d; uc.countryID&#xd;&#xa;where 1&#x3d;1&#xd;&#xa;--and &#x28;uc.address1 is not NULL or uc.address2 is not NULL&#x29;&#xd;&#xa;and &#x28;uc.address1 &#x3c;&#x3e; &#x27;&#x27; or uc.address2 &#x3c;&#x3e; &#x27;&#x27;&#x29;&#x29;&#xd;&#xa;&#xd;&#xa;--CONTACT LOCATION AS COMPANY LOCATION&#xd;&#xa;select concat&#x28;&#x27;PR&#x27;, clientID&#x29; as con_ext_id&#xd;&#xa;	, concat&#x28;&#x27;PR&#x27;, clientCorporationID&#x29; as com_ext_id&#xd;&#xa;	, left&#x28;concat_ws&#x28;&#x27;, &#x27;, nullif&#x28;address1,&#x27;&#x27;&#x29;, nullif&#x28;address2,&#x27;&#x27;&#x29;, nullif&#x28;city,&#x27;&#x27;&#x29;, nullif&#x28;state,&#x27;&#x27;&#x29;&#xd;&#xa;			, nullif&#x28;zip,&#x27;&#x27;&#x29;, nullif&#x28;COUNTRY,&#x27;&#x27;&#x29;&#x29;,300&#x29; as locationName&#xd;&#xa;	, left&#x28;concat_ws&#x28;&#x27;, &#x27;, nullif&#x28;address1,&#x27;&#x27;&#x29;, nullif&#x28;address2,&#x27;&#x27;&#x29;, nullif&#x28;city,&#x27;&#x27;&#x29;, nullif&#x28;state,&#x27;&#x27;&#x29;&#xd;&#xa;			, nullif&#x28;zip,&#x27;&#x27;&#x29;, nullif&#x28;COUNTRY,&#x27;&#x27;&#x29;&#x29;,300&#x29; as locationAddress&#xd;&#xa;	, city as city&#xd;&#xa;	, state as &#x5b;state&#x5d;&#xd;&#xa;	, zip as post_code&#xd;&#xa;	, ABBREVIATION as country_code&#xd;&#xa;	, &#x27;PERSONAL_ADDRESS&#x27; as location_type&#xd;&#xa;	, getdate&#x28;&#x29; as insert_timestamp&#xd;&#xa;	, concat_ws&#x28;&#x27;-&#x27;, &#x27;PR&#x27;, clientCorporationID, clientID&#x29; as note --combination of company-contact IDs&#xd;&#xa;from contactloc&#xd;&#xa;where 1&#x3d;1&#xd;&#xa;--and rn &#x3d; 1 --249 rows&#xd;&#xa;--and lower&#x28;concat&#x28;address1, address2, city, state, zip, countryID&#x29;&#x29; not in &#x28;select lower&#x28;concat&#x28;address1, address2, city, state, zip, countryID&#x29;&#x29; from bullhorn1.BH_ClientCorporation&#x29; --70 rows</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>576</xloc>
      <yloc>544</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Contact lookup 3</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>contact</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>contactExtId</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCContactID</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>720</xloc>
      <yloc>1296</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>DB industry</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from &#x28;PROD&#x29;</connection>
    <sql>&#x2f;&#x2a; OLD SCRIPT&#xa;with&#xa;ind &#x28;clientCorporationID,ind&#x29; as &#x28;SELECT clientCorporationID&#xa;	, ind.value as ind &#xa;	FROM bullhorn1.BH_ClientCorporation m &#xa;	CROSS APPLY STRING_SPLIT&#x28; ltrim&#x28;rtrim&#x28;convert&#x28;varchar&#x28;max&#x29;, m.businessSectorList&#x29; &#x29;&#x29;, &#x27;&#x3b;&#x27;&#x29; AS ind&#x29;&#xa;&#xa;select&#xa;       distinct ind as &#x27;company-industry&#x27;&#xa;       , getdate&#x28;&#x29; as insert_timestamp&#xa;from ind&#xa;where ind &#x3c;&#x3e; &#x27;&#x27;&#xa;order by &#x27;company-industry&#x27; &#x2a;&#x2f;&#xa;&#xa;select distinct name as industry&#xa;, getdate&#x28;&#x29; as insert_timestamp&#xa;from bullhorn1.BH_BusinessSectorList&#xa;order by name</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>80</xloc>
      <yloc>1136</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Candidate lookup 6</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>cand_ext_id</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>actual_candidate_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2000</xloc>
      <yloc>112</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Distribution lookup</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>contact_group</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>GROUP_NAME</name>
        <field>name</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCContactGroupID</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>880</xloc>
      <yloc>1296</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Education summary</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from &#x28;PROD&#x29;</connection>
    <sql>with&#xd;&#xa;admissionRows &#x28;userId, CombinedText, dateadded&#x29; as &#xd;&#xa;	&#x28;select UCOI.userID, concat&#x28;text1,&#x27; &#x27;,text2&#x29; as CombinedText, COI.dateadded&#xd;&#xa;		from bullhorn1.BH_UserCustomObjectInstance UCOI&#xd;&#xa;		inner join bullhorn1.BH_CustomObjectInstance COI On UCOI.instanceID &#x3d; COI.instanceID&#x29;&#xd;&#xa;&#xd;&#xa;, admission&#x28;Userid, Admission&#x29; as &#x28;SELECT userid, STRING_AGG&#x28; CombinedText,&#x27;&#x7c;&#x7c; &#x27; &#x29; WITHIN GROUP &#x28;ORDER BY dateadded&#x29; name&#xd;&#xa;		from admissionRows&#xd;&#xa;		where CombinedText &#x3c;&#x3e; &#x27;&#x27; GROUP BY userid &#x29;&#xd;&#xa;--select top 10 &#x2a; from admission&#xd;&#xa;&#xd;&#xa;-- NEWEST EDUCATION&#xd;&#xa;-- select &#x2a; from bullhorn1.BH_UserEducation &#xd;&#xa;, EducationGroup as &#x28;select userID, max&#x28;userEducationID&#x29; as userEducationID from bullhorn1.BH_UserEducation group by userID&#x29;&#xd;&#xa;&#xd;&#xa;, Education as &#x28;&#xd;&#xa;       select EG.userID&#xd;&#xa;              , UE.certification&#xd;&#xa;              , UE.city&#xd;&#xa;              , UE.comments&#xd;&#xa;              --, UE.customText1&#xd;&#xa;              , UE.dateAdded&#xd;&#xa;              , UE.degree&#xd;&#xa;              , UE.endDate&#xd;&#xa;              , UE.expirationDate&#xd;&#xa;              , UE.gpa&#xd;&#xa;              , convert&#x28;varchar&#x28;10&#x29;,UE.graduationDate,120&#x29; as graduationDate&#xd;&#xa;              , UE.major&#xd;&#xa;              , UE.school&#xd;&#xa;              , UE.startDate&#xd;&#xa;              , UE.state&#xd;&#xa;              , UE.userEducationID       &#xd;&#xa;       from EducationGroup EG left join bullhorn1.BH_UserEducation UE on EG.userEducationID &#x3d; UE.userEducationID&#x29;&#xd;&#xa;&#xd;&#xa;-- Education Summary&#xd;&#xa;, EducationSummary&#x28;userId, es&#x29; as &#x28;&#xd;&#xa;       SELECT userId&#xd;&#xa;       , STRING_AGG&#x28;&#xd;&#xa;                     REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; REPLACE&#x28;REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; &#xd;&#xa;                     REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; REPLACE&#x28;REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; &#xd;&#xa;                     REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; REPLACE&#x28;REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; &#xd;&#xa;									concat_ws&#x28; char&#x28;10&#x29;&#xd;&#xa;									, coalesce&#x28;&#x27;Date Added&#x3a; &#x27; &#x2b; nullif&#x28;convert&#x28;nvarchar&#x28;10&#x29;, dateAdded, 120&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;									, coalesce&#x28;&#x27;Start Date&#x3a; &#x27; &#x2b; nullif&#x28;convert&#x28;nvarchar&#x28;10&#x29;, startDate, 120&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;									, coalesce&#x28;&#x27;End Date&#x3a; &#x27; &#x2b; nullif&#x28;convert&#x28;nvarchar&#x28;10&#x29;, endDate, 120&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;									, coalesce&#x28;&#x27;School&#x3a; &#x27; &#x2b; nullif&#x28;cast&#x28;school as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;									, coalesce&#x28;&#x27;Graduation Date&#x3a; &#x27; &#x2b; nullif&#x28;convert&#x28;nvarchar&#x28;10&#x29;, graduationDate, 120&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;									, coalesce&#x28;&#x27;Major&#x3a; &#x27; &#x2b; nullif&#x28;cast&#x28;major as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;									, coalesce&#x28;&#x27;Degree&#x3a; &#x27; &#x2b; nullif&#x28;cast&#x28;degree as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;									, coalesce&#x28;&#x27;GPA&#x3a; &#x27; &#x2b; nullif&#x28;cast&#x28;gpa as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;									, coalesce&#x28;&#x27;Certification&#x3a; &#x27; &#x2b; nullif&#x28;cast&#x28;certification as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;									, coalesce&#x28;&#x27;Expiration Date&#x3a; &#x27; &#x2b; nullif&#x28;convert&#x28;nvarchar&#x28;10&#x29;, expirationDate, 120&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;									, coalesce&#x28;&#x27;Comments&#x3a; &#x27; &#x2b; nullif&#x28;cast&#x28;comments as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;									, coalesce&#x28;&#x27;City&#x3a; &#x27; &#x2b; nullif&#x28;cast&#x28;city as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;									, coalesce&#x28;&#x27;County&#x3a; &#x27; &#x2b; nullif&#x28;cast&#x28;state as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;									, coalesce&#x28;&#x27;Education ID&#x3a; &#x27; &#x2b; nullif&#x28;cast&#x28;userEducationID as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; &#x2b; char&#x28;10&#x29;, &#x27;&#x27;&#x29;&#xd;&#xa;							&#x29;&#xd;&#xa;                  ,char&#x28;0x0000&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x0001&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x0002&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x0003&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x0004&#x29;,&#x27;&#x27;&#x29; &#xd;&#xa;                  ,char&#x28;0x0005&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x0006&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x0007&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x0008&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x000B&#x29;,&#x27;&#x27;&#x29; &#xd;&#xa;                  ,char&#x28;0x000C&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x000E&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x000F&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x0010&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x0011&#x29;,&#x27;&#x27;&#x29; &#xd;&#xa;                  ,char&#x28;0x0012&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x0013&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x0014&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x0015&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x0016&#x29;,&#x27;&#x27;&#x29; &#xd;&#xa;                  ,char&#x28;0x0017&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x0018&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x0019&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x001A&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x001B&#x29;,&#x27;&#x27;&#x29; &#xd;&#xa;                  ,char&#x28;0x001C&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x001D&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x001E&#x29;,&#x27;&#x27;&#x29; ,char&#x28;0x001F&#x29;,&#x27;&#x27;&#x29; --as es&#xd;&#xa;       , concat&#x28;char&#x28;10&#x29;, char&#x28;13&#x29;&#x29;&#x29; WITHIN GROUP &#x28;ORDER BY dateadded&#x29; es&#xd;&#xa;       FROM bullhorn1.BH_UserEducation GROUP BY userId        &#xd;&#xa;       &#x29;&#xd;&#xa;--select top 10 &#x2a; from EducationSummary where userid in &#x28;163454&#x29;&#x3b;&#xd;&#xa;-- select &#x2a; from bullhorn1.BH_UserEducation where customText1 is not null&#xd;&#xa;-- select &#x2a; from bullhorn1.BH_UserCertification where licenseNumber is not null&#x3b;&#xd;&#xa;-- select referenceTitle,&#x2a; from bullhorn1.BH_UserReference where referenceTitle is not null&#x3b;&#xd;&#xa;&#xd;&#xa;--WEB RESPONSES&#xd;&#xa;, wr as &#x28;&#xd;&#xa;        select jr.userid, jp.title,jr.status&#xd;&#xa;        from bullhorn1.BH_JobResponse JR&#xd;&#xa;        left join &#x28;select CA.userID as CandidateUserID, CA.candidateID, UC.userID, UC.name as CandidateName, UC.email as CandidateEmail from bullhorn1.BH_Candidate CA left join bullhorn1.BH_UserContact UC on CA.userID &#x3d; UC.userID where CA.isdeleted &#x3c;&#x3e; 1 and CA.status &#x3c;&#x3e; &#x27;Archive&#x27;&#x29; CAI on JR.userID &#x3d; CAI.CandidateUserID&#xd;&#xa;        left join bullhorn1.BH_JobPosting  jp on jp.jobPostingID &#x3d; jr.jobPostingID &#x29;&#xd;&#xa;, wr1 as &#x28;SELECT userID, STRING_AGG&#x28; concat&#x28;&#x27;Title&#x3a; &#x27;,title,&#x27; - Status&#x3a; &#x27;,status&#x29; ,char&#x28;10&#x29;&#x29; WITHIN GROUP &#x28;ORDER BY title&#x29; name from wr GROUP BY userID &#x29;&#xd;&#xa;--select top 10 &#x2a; from wr1&#xd;&#xa;&#xd;&#xa;--LATEST COMMENT&#xd;&#xa;, lc &#x28;userid,comments,dateAdded,rn&#x29; as &#x28; SELECT userid, comments, dateAdded, r1 &#x3d; ROW_NUMBER&#x28;&#x29; OVER &#x28;PARTITION BY userid ORDER BY dateAdded desc&#x29;&#xd;&#xa;		FROM bullhorn1.BH_UserComment &#x29;&#xd;&#xa;&#xd;&#xa;--CANDIDATE CERTIFICATE &#x28;no value&#x29;&#xd;&#xa;&#xd;&#xa;--OWNER&#xd;&#xa;, owner as &#x28; select ca.candidateid, ca.recruiterUserID, ca.owneruseridlist, concat&#x28;ca.recruiterUserID,&#x27;,&#x27;, ca.ownerUserIDList&#x29; as owners &#xd;&#xa;		from bullhorn1.Candidate CA&#xd;&#xa;		left join bullhorn1.BH_UserContact UC on CA.recruiterUserID &#x3d; UC.userID&#xd;&#xa;		where CA.isdeleted &#x3c;&#x3e; 1 and CA.status &#x3c;&#x3e; &#x27;Archive&#x27;&#x29;&#xd;&#xa;--select ca.owneruseridlist from bullhorn1.Candidate CA where owneruseridlist like &#x27;&#x25;,&#x25;&#x27;&#xd;&#xa;, owner2a as &#x28;SELECT candidateid, Split.a.value&#x28;&#x27;.&#x27;, &#x27;VARCHAR&#x28;100&#x29;&#x27;&#x29; AS String&#xd;&#xa;		FROM &#x28;SELECT candidateid, CAST &#x28;&#x27;&#x3c;M&#x3e;&#x27; &#x2b; REPLACE&#x28;convert&#x28;nvarchar&#x28;max&#x29;,owners&#x29;,&#x27;,&#x27;,&#x27;&#x3c;&#x2f;M&#x3e;&#x3c;M&#x3e;&#x27;&#x29; &#x2b; &#x27;&#x3c;&#x2f;M&#x3e;&#x27; AS XML&#x29; AS Data FROM owner&#xd;&#xa;					where owners is not null and owners &#x3c;&#x3e; &#x27;&#x27;&#x29; AS A CROSS APPLY Data.nodes &#x28;&#x27;&#x2f;M&#x27;&#x29; AS Split&#x28;a&#x29;&#x29;&#xd;&#xa;--, owner2b as &#x28;select distinct owner2a.candidateid, UC.email, UC.name from owner2a left join &#x28;select ca.candidateid, uc.email, uc.name from bullhorn1.Candidate CA left join bullhorn1.BH_UserContact UC on CA.UserID &#x3d; UC.userID &#x29; UC on UC.candidateid &#x3d; owner2a.String&#x29;&#xd;&#xa;, owner2b as &#x28; select distinct owner2a.candidateid, UC.email, UC.name&#xd;&#xa;		from owner2a&#xd;&#xa;		left join bullhorn1.BH_UserContact UC on UC.userid &#x3d; owner2a.String&#x29;&#xd;&#xa;--select top 10 &#x2a; from owner2b where candidateid in &#x28;31595&#x29; and email &#x3c;&#x3e; &#x27;&#x27; and email is not null&#xd;&#xa;, owner2c as &#x28;SELECT candidateid, STRING_AGG&#x28; email,&#x27;,&#x27;&#x29; WITHIN GROUP &#x28;ORDER BY email&#x29; email&#xd;&#xa;		from owner2b&#xd;&#xa;		where email like &#x27;&#x25;_&#x40;_&#x25;.__&#x25;&#x27; GROUP BY candidateid &#x29;&#xd;&#xa;--select top 10 &#x2a; from owner2c where candidateid in &#x28;31595&#x29; and email like &#x27;&#x25;,&#x25;&#x27; --candidateid in &#x28;39194&#x29;&#xd;&#xa;&#xd;&#xa;-- DOCUMENT&#xd;&#xa;, files&#x28;candidateUserID, files&#x29; as &#x28;SELECT candidateUserID, STRING_AGG&#x28; concat&#x28;candidateFileID, fileExtension&#x29;,&#x27;,&#x27; &#x29; WITHIN GROUP &#x28;ORDER BY candidateFileID&#x29; files&#xd;&#xa;		from bullhorn1.View_CandidateFile GROUP BY candidateUserID&#x29;&#xd;&#xa;--select top 10 &#x2a; from files&#xd;&#xa;, placementfiles&#x28;userID, files&#x29; as &#x28;SELECT userID, STRING_AGG&#x28; concat&#x28;placementFileID, fileExtension&#x29;,&#x27;,&#x27; &#x29; WITHIN GROUP &#x28;ORDER BY placementFileID&#x29; files&#xd;&#xa;		from bullhorn1.View_PlacementFile GROUP BY userID&#x29;&#xd;&#xa;--select top 10 &#x2a; from placementfiles&#xd;&#xa;, doc&#x28;Userid, files&#x29; as &#x28; select f.candidateUserID, STRING_AGG&#x28; f.files,&#x27;,&#x27; &#x29; WITHIN GROUP &#x28;ORDER BY f.files&#x29; files&#xd;&#xa;		from &#x28;SELECT &#x2a; from files &#xd;&#xa;				UNION ALL SELECT &#x2a; from placementfiles&#x29; f&#xd;&#xa;		GROUP BY f.candidateUserID &#x29;&#xd;&#xa;--select top 10 &#x2a; from doc&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;--MAIN SCRIPT&#xd;&#xa;select&#xd;&#xa;         concat&#x28;&#x27;PR&#x27;, c.candidateID&#x29; as cand_ext_id&#xd;&#xa;	--, note.note as &#x27;candidate-note&#x27; --&#x2a;&#x2a;&#x2a; Injected later&#xd;&#xa;	, es.es as education --&#x2a;&#x2a;&#x2a; Injected later&#xd;&#xa;	--, eh.eh as &#x27;candidate-workHistory&#x27; --&#x2a;&#x2a;&#x2a; Injected later&#xd;&#xa;from bullhorn1.Candidate C --where C.isPrimaryOwner &#x3d; 1&#xd;&#xa;left join EducationSummary es on es.userID &#x3d; C.userID --Education Summary&#xd;&#xa;where C.isdeleted &#x3c;&#x3e; 1 and C.status &#x3c;&#x3e; &#x27;Archive&#x27; --where C.isPrimaryOwner &#x3d; 1 --24681 rows&#xd;&#xa;and es.es is not NULL&#xd;&#xa;order by c.candidateID --22986 rows</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1840</xloc>
      <yloc>672</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Employment history summary</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from &#x28;PROD&#x29;</connection>
    <sql>with&#xd;&#xa;--EMPLOYMENT HISTORY -- select &#x2a;  from bullhorn1.BH_userWorkHistory&#xd;&#xa;EmploymentHistory&#x28;userId, eh&#x29; as &#x28;&#xd;&#xa;       SELECT userId&#xd;&#xa;         , STRING_AGG&#x28; &#xd;&#xa;                     REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; REPLACE&#x28;REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; &#xd;&#xa;                     REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; REPLACE&#x28;REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; &#xd;&#xa;                     REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; REPLACE&#x28;REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; REPLACE&#x28; &#xd;&#xa;												concat_ws&#x28;&#x27;&#x3c;br&#x2f;&#x3e;&#x27;&#xd;&#xa;												, coalesce&#x28;&#x27;Title&#x3a; &#x27; &#x2b; nullif&#x28;cast&#x28;title as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;												, coalesce&#x28;&#x27;Client Corporation&#x3a; &#x27; &#x2b; nullif&#x28;cast&#x28;clientCorporationID as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;												, coalesce&#x28;&#x27;Company Name&#x3a; &#x27; &#x2b; nullif&#x28;cast&#x28;companyName as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;												, coalesce&#x28;&#x27;Start Date&#x3a; &#x27; &#x2b; nullif&#x28;convert&#x28;nvarchar&#x28;10&#x29;, startDate, 120&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;												, coalesce&#x28;&#x27;End Date&#x3a; &#x27; &#x2b; nullif&#x28;convert&#x28;nvarchar&#x28;10&#x29;, endDate, 120&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;												, coalesce&#x28;&#x27;Date Added&#x3a; &#x27; &#x2b; nullif&#x28;convert&#x28;nvarchar&#x28;10&#x29;, dateAdded, 120&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;												, coalesce&#x28;&#x27;Job Posting&#x3a; &#x27; &#x2b; nullif&#x28;cast&#x28;title as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29; --jobPostingID&#xd;&#xa;												, coalesce&#x28;&#x27;Placement&#x3a; &#x27; &#x2b; nullif&#x28;cast&#x28;placementID as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;												, coalesce&#x28;&#x27;Termination Reason&#x3a; &#x27; &#x2b; nullif&#x28;cast&#x28;terminationReason as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;												, coalesce&#x28;&#x27;Salary Type&#x3a; &#x27; &#x2b; nullif&#x28;cast&#x28;salaryType as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;												, coalesce&#x28;&#x27;Salary Low&#x3a; &#x27; &#x2b; nullif&#x28;cast&#x28;salary1 as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;												, coalesce&#x28;&#x27;Salary High&#x3a; &#x27; &#x2b; nullif&#x28;cast&#x28;salary2 as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;												, coalesce&#x28;&#x27;User Work History ID&#x3a; &#x27; &#x2b; nullif&#x28;cast&#x28;userWorkHistoryID as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;												, coalesce&#x28;&#x27;Commission&#x3a; &#x27; &#x2b; nullif&#x28;cast&#x28;commission as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;												, coalesce&#x28;&#x27;Bonus&#x3a; &#x27; &#x2b; nullif&#x28;cast&#x28;bonus as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;												, coalesce&#x28;&#x27;Comments&#x3a; &#x27; &#x2b; nullif&#x28;cast&#x28;comments as nvarchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29;, NULL&#x29;&#xd;&#xa;                        &#x29;&#xd;&#xa;                     , char&#x28;0x0000&#x29;,&#x27;&#x27;&#x29;, char&#x28;0x0001&#x29;,&#x27;&#x27;&#x29;, char&#x28;0x0002&#x29;,&#x27;&#x27;&#x29;, char&#x28;0x0003&#x29;,&#x27;&#x27;&#x29;, char&#x28;0x0004&#x29;,&#x27;&#x27;&#x29; &#xd;&#xa;                     , char&#x28;0x0005&#x29;,&#x27;&#x27;&#x29;, char&#x28;0x0006&#x29;,&#x27;&#x27;&#x29;, char&#x28;0x0007&#x29;,&#x27;&#x27;&#x29;, char&#x28;0x0008&#x29;,&#x27;&#x27;&#x29;, char&#x28;0x000B&#x29;,&#x27;&#x27;&#x29; &#xd;&#xa;                     , char&#x28;0x000C&#x29;,&#x27;&#x27;&#x29;, char&#x28;0x000E&#x29;,&#x27;&#x27;&#x29;, char&#x28;0x000F&#x29;,&#x27;&#x27;&#x29;, char&#x28;0x0010&#x29;,&#x27;&#x27;&#x29;, char&#x28;0x0011&#x29;,&#x27;&#x27;&#x29; &#xd;&#xa;                     , char&#x28;0x0012&#x29;,&#x27;&#x27;&#x29;, char&#x28;0x0013&#x29;,&#x27;&#x27;&#x29;, char&#x28;0x0014&#x29;,&#x27;&#x27;&#x29;, char&#x28;0x0015&#x29;,&#x27;&#x27;&#x29;, char&#x28;0x0016&#x29;,&#x27;&#x27;&#x29; &#xd;&#xa;                     , char&#x28;0x0017&#x29;,&#x27;&#x27;&#x29;, char&#x28;0x0018&#x29;,&#x27;&#x27;&#x29;, char&#x28;0x0019&#x29;,&#x27;&#x27;&#x29;, char&#x28;0x001A&#x29;,&#x27;&#x27;&#x29;, char&#x28;0x001B&#x29;,&#x27;&#x27;&#x29; &#xd;&#xa;                     , char&#x28;0x001C&#x29;,&#x27;&#x27;&#x29;, char&#x28;0x001D&#x29;,&#x27;&#x27;&#x29;, char&#x28;0x001E&#x29;,&#x27;&#x27;&#x29;, char&#x28;0x001F&#x29;,&#x27;&#x27;&#x29; --as eh&#xd;&#xa;       , &#x27;&#x3c;br&#x2f;&#x3e;&#x27; &#x29; WITHIN GROUP &#x28;ORDER BY startDate desc, dateAdded desc&#x29; eh&#xd;&#xa;       FROM bullhorn1.BH_userWorkHistory GROUP BY userId&#xd;&#xa;       &#x29;&#xd;&#xa;&#xd;&#xa;--MAIN SCRIPT&#xd;&#xa;select --top 1&#xd;&#xa;		concat&#x28;&#x27;PR&#x27;, c.candidateID&#x29; as cand_ext_id&#xd;&#xa;	, eh.eh as workHistory --&#x2a;&#x2a;&#x2a; Injected later&#xd;&#xa;from bullhorn1.Candidate C --where C.isPrimaryOwner &#x3d; 1&#xd;&#xa;left join EmploymentHistory eh on EH.userid &#x3d; C.userid --WORK HISTORY&#xd;&#xa;where C.isdeleted &#x3c;&#x3e; 1 and C.status &#x3c;&#x3e; &#x27;Archive&#x27; --where C.isPrimaryOwner &#x3d; 1 --24681 rows&#xd;&#xa;order by c.candidateID</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1840</xloc>
      <yloc>592</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Extract Candidate Documents</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from &#x28;PROD&#x29;</connection>
    <sql>SELECT &#x27;candidateUserID&#x27; as Category&#xd;&#xa;		, concat&#x28;&#x27;PR&#x27;, c.candidateid&#x29; as CandidateExtID&#xd;&#xa;		, concat&#x28;F.candidateFileID, F.fileExtension&#x29; as UploadedName&#xd;&#xa;		, case when right&#x28;F.name, charindex&#x28;&#x27;.&#x27;, reverse&#x28;F.name&#x29;&#x29;&#x29; &#x3d; F.fileExtension then F.Name&#xd;&#xa;		else concat&#x28;F.name, F.fileExtension&#x29; end as RealName&#xd;&#xa;		, F.dateadded as created&#xd;&#xa;		from bullhorn1.View_CandidateFile F &#xd;&#xa;		left join bullhorn1.Candidate C on C.userid &#x3d; F.candidateuserid&#xd;&#xa;		--WHERE F.fileExtension in &#x28;&#x27;.doc&#x27;,&#x27;.docx&#x27;,&#x27;.pdf&#x27;,&#x27;.xls&#x27;,&#x27;.xlsx&#x27;,&#x27;.rtf&#x27;,&#x27;.html&#x27;&#x29;&#xd;&#xa;--select top 10 &#x2a; from candidate&#xd;&#xa;UNION&#xd;&#xa;&#xd;&#xa;SELECT &#x27;placementUserID&#x27;&#xd;&#xa;	, concat&#x28;&#x27;PR&#x27;, c.candidateid&#x29; as CandidateExtID&#xd;&#xa;	, concat&#x28;placementFileID, fileExtension&#x29; as UploadedName&#xd;&#xa;	, case when right&#x28;F.name, charindex&#x28;&#x27;.&#x27;, reverse&#x28;F.name&#x29;&#x29;&#x29; &#x3d; F.fileExtension then F.Name&#xd;&#xa;		else concat&#x28;F.name, F.fileExtension&#x29; end as RealName&#xd;&#xa;		, F.dateadded as created&#xd;&#xa;	from bullhorn1.View_PlacementFile F&#xd;&#xa;	left join bullhorn1.Candidate C on C.userid &#x3d; F.userid&#xd;&#xa;	--WHERE fileExtension in &#x28;&#x27;.doc&#x27;,&#x27;.docx&#x27;,&#x27;.pdf&#x27;,&#x27;.xls&#x27;,&#x27;.xlsx&#x27;,&#x27;.rtf&#x27;,&#x27;.html&#x27;&#x29; &#xd;&#xa;--total 28021</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1840</xloc>
      <yloc>1632</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Extract company document</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from &#x28;PROD&#x29;</connection>
    <sql>SELECT &#x27;company&#x27; as category&#xd;&#xa;, concat&#x28;&#x27;PR&#x27;,clientCorporationID&#x29; as CompanyExtID&#xd;&#xa;, concat&#x28;F.clientCorporationFileID,F.fileExtension&#x29; as UploadedName&#xd;&#xa;, case when right&#x28;F.name, charindex&#x28;&#x27;.&#x27;, reverse&#x28;name&#x29;&#x29;&#x29; &#x3d; F.fileExtension then F.Name&#xd;&#xa;	else concat&#x28;F.name, F.fileExtension&#x29; end as RealName&#xd;&#xa;, F.dateadded as created&#xd;&#xa;from bullhorn1.BH_ClientCorporationFile F --96 rows&#xd;&#xa;--where F.fileExtension in &#x28;&#x27;.doc&#x27;,&#x27;.docx&#x27;,&#x27;.pdf&#x27;,&#x27;.xls&#x27;,&#x27;.xlsx&#x27;,&#x27;.rtf&#x27;,&#x27;.html&#x27;&#x29; --57 rows</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>80</xloc>
      <yloc>864</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Extract job document</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>SELECT &#x27;job&#x27; as Category&#xa;, concat&#x28;&#x27;PR&#x27;,jobPostingID&#x29; as JobExtID&#xa;, concat&#x28;jobPostingFileID, fileExtension&#x29; as UploadedName&#xa;, case when right&#x28;F.name, charindex&#x28;&#x27;.&#x27;, reverse&#x28;name&#x29;&#x29;&#x29; &#x3d; F.fileExtension then F.Name&#xa;	else concat&#x28;F.name, F.fileExtension&#x29; end as RealName&#xa;, F.dateadded as created&#xa;, &#x27;job_description&#x27; as document_type &#xa;from bullhorn1.View_JobPostingFile F&#xa;where fileExtension in &#x28;&#x27;.doc&#x27;,&#x27;.docx&#x27;,&#x27;.pdf&#x27;,&#x27;.xls&#x27;,&#x27;.xlsx&#x27;,&#x27;.rtf&#x27;,&#x27;.html&#x27;&#x29; --0 rows</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1248</xloc>
      <yloc>1104</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>FE lookup</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema/>
      <table>functional_expertise</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>FE</name>
        <field>name</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCFEID</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>880</xloc>
      <yloc>1392</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>FE lookup 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>functional_expertise</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>Functional_Expertise</name>
        <field>name</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCFE_ID</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>240</xloc>
      <yloc>1296</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Functional Exp</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <sql>&#x2f;&#x2a; Create FE sequence before running &#x2a;&#x2f;&#xa;&#xa;select listvalue as Functional_Expertise&#xa;, getdate&#x28;&#x29; as insert_timestamp &#xa;from common.Lists &#xa;where listkey &#x3d; &#x27;tblVacancyJobFunctions&#x27;&#xa;order by listvalue</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>80</xloc>
      <yloc>1216</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Insert - Contact Comment 2</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <schema>public</schema>
    <table>activity</table>
    <commit>100</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>N</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field>contactid</partitioning_field>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>contact_id</column_name>
          <stream_name>VCContactID</stream_name>
        </field>
        <field>
          <column_name>user_account_id</column_name>
          <stream_name>user_account_id</stream_name>
        </field>
        <field>
          <column_name>insert_timestamp</column_name>
          <stream_name>insert_timestamp</stream_name>
        </field>
        <field>
          <column_name>content</column_name>
          <stream_name>content</stream_name>
        </field>
        <field>
          <column_name>type</column_name>
          <stream_name>type</stream_name>
        </field>
        <field>
          <column_name>category</column_name>
          <stream_name>category</stream_name>
        </field>
        <field>
          <column_name>userMessageID</column_name>
          <stream_name>userMessageID</stream_name>
        </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>880</xloc>
      <yloc>208</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Insert &#x2f; Update - Contact Comment</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>activity</table>
      <key>
        <name>actual_contactid</name>
        <field>contact_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>content</name>
        <field>content</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>insert_timestamp</name>
        <field>insert_timestamp</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>contact_id</name>
        <rename>actual_contactid</rename>
        <update>Y</update>
      </value>
      <value>
        <name>user_account_id</name>
        <rename>user_account_id</rename>
        <update>Y</update>
      </value>
      <value>
        <name>insert_timestamp</name>
        <rename>insert_timestamp</rename>
        <update>Y</update>
      </value>
      <value>
        <name>content</name>
        <rename>content</rename>
        <update>Y</update>
      </value>
      <value>
        <name>type</name>
        <rename>type</rename>
        <update>Y</update>
      </value>
      <value>
        <name>category</name>
        <rename>category</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>880</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Insert &#x2f; Update 2</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <commit>100</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema/>
      <table>lookup table</table>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>240</xloc>
      <yloc>1392</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Insert &#x2f; Update 2 2 3 3</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <commit>500</commit>
    <update_bypassed>Y</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>activity</table>
      <key>
        <name>actual_contactid</name>
        <field>contact_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>insert_timestamp</name>
        <field>insert_timestamp</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>content</name>
        <field>content</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>contact_id</name>
        <rename>actual_contactid</rename>
        <update>Y</update>
      </value>
      <value>
        <name>user_account_id</name>
        <rename>user_account_id</rename>
        <update>Y</update>
      </value>
      <value>
        <name>insert_timestamp</name>
        <rename>insert_timestamp</rename>
        <update>Y</update>
      </value>
      <value>
        <name>content</name>
        <rename>content</rename>
        <update>Y</update>
      </value>
      <value>
        <name>type</name>
        <rename>type</rename>
        <update>Y</update>
      </value>
      <value>
        <name>category</name>
        <rename>category</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>880</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Insert &#x2f; Update 2 3</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <commit>1000</commit>
    <update_bypassed>Y</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>activity</table>
      <key>
        <name>actual_candidateid</name>
        <field>candidate_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>content</name>
        <field>content</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>insert_timestamp</name>
        <field>insert_timestamp</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>userMessageID</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>candidate_id</name>
        <rename>actual_candidateid</rename>
        <update>Y</update>
      </value>
      <value>
        <name>user_account_id</name>
        <rename>user_account_id</rename>
        <update>Y</update>
      </value>
      <value>
        <name>insert_timestamp</name>
        <rename>insert_timestamp</rename>
        <update>Y</update>
      </value>
      <value>
        <name>content</name>
        <rename>content</rename>
        <update>Y</update>
      </value>
      <value>
        <name>type</name>
        <rename>type</rename>
        <update>Y</update>
      </value>
      <value>
        <name>category</name>
        <rename>category</rename>
        <update>Y</update>
      </value>
      <value>
        <name>userMessageID</name>
        <rename>userMessageID</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2176</xloc>
      <yloc>176</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Insert &#x2f; Update 2 3 2 2 2</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>activity</table>
      <key>
        <name>actual_id</name>
        <field>position_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>content</name>
        <field>content</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>insert_timestamp</name>
        <field>insert_timestamp</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>position_id</name>
        <rename>actual_id</rename>
        <update>Y</update>
      </value>
      <value>
        <name>user_account_id</name>
        <rename>user_account_id</rename>
        <update>Y</update>
      </value>
      <value>
        <name>insert_timestamp</name>
        <rename>insert_timestamp</rename>
        <update>Y</update>
      </value>
      <value>
        <name>content</name>
        <rename>content</rename>
        <update>Y</update>
      </value>
      <value>
        <name>type</name>
        <rename>type</rename>
        <update>Y</update>
      </value>
      <value>
        <name>category</name>
        <rename>category</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1552</xloc>
      <yloc>112</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Insert Job FESFE</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <commit>1000</commit>
    <update_bypassed>Y</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>position_description_functional_expertise</table>
      <key>
        <name>actual_id</name>
        <field>position_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>final_fe_id</name>
        <field>functional_expertise_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>position_id</name>
        <rename>actual_id</rename>
        <update>Y</update>
      </value>
      <value>
        <name>functional_expertise_id</name>
        <rename>final_fe_id</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1552</xloc>
      <yloc>992</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Insert &#x2f; Update Activity</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <commit>1000</commit>
    <update_bypassed>Y</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>activity</table>
      <key>
        <name>actual_candidate_id</name>
        <field>candidate_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>insert_timestamp</name>
        <field>insert_timestamp</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>content</name>
        <field>content</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>candidate_id</name>
        <rename>actual_candidate_id</rename>
        <update>Y</update>
      </value>
      <value>
        <name>user_account_id</name>
        <rename>user_account_id</rename>
        <update>Y</update>
      </value>
      <value>
        <name>insert_timestamp</name>
        <rename>insert_timestamp</rename>
        <update>Y</update>
      </value>
      <value>
        <name>content</name>
        <rename>content</rename>
        <update>Y</update>
      </value>
      <value>
        <name>type</name>
        <rename>type</rename>
        <update>Y</update>
      </value>
      <value>
        <name>category</name>
        <rename>category</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2176</xloc>
      <yloc>48</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Insert &#x2f; Update Contact FESFE</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <commit>100</commit>
    <update_bypassed>Y</update_bypassed>
    <lookup>
      <schema/>
      <table>contact_functional_expertise</table>
      <key>
        <name>VCContactID</name>
        <field>contact_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>VCFEID</name>
        <field>functional_expertise_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>VCSFEID</name>
        <field>sub_functional_expertise_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>contact_id</name>
        <rename>VCContactID</rename>
        <update>Y</update>
      </value>
      <value>
        <name>functional_expertise_id</name>
        <rename>VCFEID</rename>
        <update>Y</update>
      </value>
      <value>
        <name>sub_functional_expertise_id</name>
        <rename>VCSFEID</rename>
        <update>Y</update>
      </value>
      <value>
        <name>insert_timestamp</name>
        <rename>insert_timestamp</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1040</xloc>
      <yloc>1472</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Insert &#x2f; Update activities</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>activity</table>
      <key>
        <name>actual_id</name>
        <field>company_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>content</name>
        <field>content</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>insert_timestamp</name>
        <field>insert_timestamp</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>company_id</name>
        <rename>actual_id</rename>
        <update>Y</update>
      </value>
      <value>
        <name>user_account_id</name>
        <rename>user_account_id</rename>
        <update>Y</update>
      </value>
      <value>
        <name>insert_timestamp</name>
        <rename>insert_timestamp</rename>
        <update>Y</update>
      </value>
      <value>
        <name>content</name>
        <rename>content</rename>
        <update>Y</update>
      </value>
      <value>
        <name>type</name>
        <rename>type</rename>
        <update>Y</update>
      </value>
      <value>
        <name>category</name>
        <rename>category</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>432</xloc>
      <yloc>160</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Insert &#x2f; Update common loc</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <commit>1000</commit>
    <update_bypassed>Y</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>common_location</table>
      <key>
        <name>contact-externalId</name>
        <field>tmp_externalid</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>state</name>
        <rename>state</rename>
        <update>Y</update>
      </value>
      <value>
        <name>city</name>
        <rename>city</rename>
        <update>Y</update>
      </value>
      <value>
        <name>post_code</name>
        <rename>post_code</rename>
        <update>Y</update>
      </value>
      <value>
        <name>country_code</name>
        <rename>country_code</rename>
        <update>Y</update>
      </value>
      <value>
        <name>address</name>
        <rename>address</rename>
        <update>Y</update>
      </value>
      <value>
        <name>location_name</name>
        <rename>locationName</rename>
        <update>Y</update>
      </value>
      <value>
        <name>tmp_externalid</name>
        <rename>contact-externalId</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>880</xloc>
      <yloc>464</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Insert company location</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <schema/>
    <table>company_location</table>
    <commit>100</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>company_id</column_name>
          <stream_name>VCCompanyID</stream_name>
        </field>
        <field>
          <column_name>address</column_name>
          <stream_name>locationAddress</stream_name>
        </field>
        <field>
          <column_name>location_name</column_name>
          <stream_name>locationName</stream_name>
        </field>
        <field>
          <column_name>post_code</column_name>
          <stream_name>post_code</stream_name>
        </field>
        <field>
          <column_name>location_type</column_name>
          <stream_name>location_type</stream_name>
        </field>
        <field>
          <column_name>insert_timestamp</column_name>
          <stream_name>insert_timestamp</stream_name>
        </field>
        <field>
          <column_name>city</column_name>
          <stream_name>city</stream_name>
        </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>432</xloc>
      <yloc>464</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Insert contact work location</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <commit>100</commit>
    <update_bypassed>Y</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>company_location</table>
      <key>
        <name>VCCompanyID</name>
        <field>company_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>locationName</name>
        <field>location_name</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>city</name>
        <rename>city</rename>
        <update>Y</update>
      </value>
      <value>
        <name>address</name>
        <rename>locationAddress</rename>
        <update>Y</update>
      </value>
      <value>
        <name>location_name</name>
        <rename>locationName</rename>
        <update>Y</update>
      </value>
      <value>
        <name>country_code</name>
        <rename>country_code</rename>
        <update>Y</update>
      </value>
      <value>
        <name>post_code</name>
        <rename>post_code</rename>
        <update>Y</update>
      </value>
      <value>
        <name>company_id</name>
        <rename>VCCompanyID</rename>
        <update>Y</update>
      </value>
      <value>
        <name>note</name>
        <rename>note</rename>
        <update>Y</update>
      </value>
      <value>
        <name>insert_timestamp</name>
        <rename>insert_timestamp</rename>
        <update>Y</update>
      </value>
      <value>
        <name>location_type</name>
        <rename>location_type</rename>
        <update>Y</update>
      </value>
      <value>
        <name>state</name>
        <rename>state</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>432</xloc>
      <yloc>544</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Insert custom field</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>additional_form_values</table>
      <key>
        <name>additional_type</name>
        <field>additional_type</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>actual_id</name>
        <field>additional_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>form_id</name>
        <field>form_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>field_id</name>
        <field>field_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>additional_type</name>
        <rename>additional_type</rename>
        <update>Y</update>
      </value>
      <value>
        <name>additional_id</name>
        <rename>actual_id</rename>
        <update>Y</update>
      </value>
      <value>
        <name>form_id</name>
        <rename>form_id</rename>
        <update>Y</update>
      </value>
      <value>
        <name>field_id</name>
        <rename>field_id</rename>
        <update>Y</update>
      </value>
      <value>
        <name>field_value</name>
        <rename>field_value</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1552</xloc>
      <yloc>1296</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Insert new industry</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>vertical</table>
      <key>
        <name>industry</name>
        <field>name</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>name</name>
        <rename>industry</rename>
        <update>Y</update>
      </value>
      <value>
        <name>insert_timestamp</name>
        <rename>insert_timestamp</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>240</xloc>
      <yloc>1136</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Job - FromSalary - ToSalary</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from &#x28;PROD&#x29;</connection>
    <sql>select&#xd;&#xa;		concat&#x28;&#x27;PR&#x27;, a.jobPostingID&#x29; as JobExtID&#xd;&#xa;		, convert&#x28;int, a.salary&#x29; as &#x27;FromSalary&#x27;&#xd;&#xa;		, convert&#x28;int, a.customfloat1&#x29; as &#x27;ToSalary&#x27;&#xd;&#xa;		, a.feeArrangement &#x2a; 100 as &#x27;quickfeeforecast&#x27;&#xd;&#xa;		, 1 as &#x27;use_quick_fee_forecast&#x27;&#xd;&#xa;	, case &#xd;&#xa;		when salaryUnit &#x3d; &#x27;Per Hour&#x27; then 1&#xd;&#xa;		when salaryUnit &#x3d; &#x27;Per Day&#x27; then 2&#xd;&#xa;		when salaryUnit &#x3d; &#x27;Per Week&#x27; then 3&#xd;&#xa;		when salaryUnit &#x3d; &#x27;Per Month&#x27; then 4&#xd;&#xa;		else NULL end as &#x27;contract_rate_type&#x27;&#xd;&#xa;from bullhorn1.BH_JobPosting a</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1248</xloc>
      <yloc>592</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Job - contract_rate  FROM&#x2f;TO</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from &#x28;PROD&#x29;</connection>
    <sql>select&#xa;	concat&#x28;&#x27;PR&#x27;, a.jobPostingID&#x29; as JobExtID&#xa;	, convert&#x28;int, a.salary&#x29; as &#x27;PayRateFrom&#x27;&#xa;	, convert&#x28;int, a.customfloat1&#x29; as &#x27;PayRateTo&#x27;&#xa;	, case &#xa;		when salaryUnit &#x3d; &#x27;Per Hour&#x27; then 1&#xa;		when salaryUnit &#x3d; &#x27;Per Day&#x27; then 2&#xa;		--when salaryUnit &#x3d; &#x27;Per Week&#x27; then 3&#xa;		--when salaryUnit &#x3d; &#x27;Per Month&#x27; then 4&#xa;		else NULL end as &#x27;contract_rate_type&#x27;&#xa;from bullhorn1.BH_JobPosting a&#xa;where a.employmentType &#x3d; &#x27;Fixed Contract&#x27;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>Y</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1248</xloc>
      <yloc>672</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Job FE</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from &#x28;PROD&#x29;</connection>
    <sql>with FESFE as &#x28;select cs.categoryID&#xd;&#xa;				, c.occupation as FE&#xd;&#xa;				, s.name as SFE&#xd;&#xa;				, getdate&#x28;&#x29; as insert_timestamp&#xd;&#xa;				from bullhorn1.BH_CategorySkillAssociation cs&#xd;&#xa;				left join bullhorn1.BH_CategoryList c on c.categoryID &#x3d; cs.categoryID&#xd;&#xa;				left join bullhorn1.BH_SkillList s on s.skillID &#x3d; cs.skillID&#xd;&#xa;--order by FE, SFE&#xd;&#xa;&#x29;&#xd;&#xa;&#xd;&#xa;select concat&#x28;&#x27;PR&#x27;, j.jobPostingID&#x29; as JobExtID&#xd;&#xa;, j.categoryID&#xd;&#xa;, fe.FE&#xd;&#xa;from bullhorn1.BH_JobCategory j&#xd;&#xa;left join &#x28;select distinct categoryID, FE from FESFE&#x29; fe on fe.categoryID &#x3d; j.categoryID</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1248</xloc>
      <yloc>864</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Job activity</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <schema>public</schema>
    <table>activity</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>Y</ignore_errors>
    <use_batch>N</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field>contactid</partitioning_field>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>position_id</column_name>
          <stream_name>actual_id</stream_name>
        </field>
        <field>
          <column_name>user_account_id</column_name>
          <stream_name>user_account_id</stream_name>
        </field>
        <field>
          <column_name>insert_timestamp</column_name>
          <stream_name>insert_timestamp</stream_name>
        </field>
        <field>
          <column_name>content</column_name>
          <stream_name>content</stream_name>
        </field>
        <field>
          <column_name>type</column_name>
          <stream_name>type</stream_name>
        </field>
        <field>
          <column_name>category</column_name>
          <stream_name>category</stream_name>
        </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1552</xloc>
      <yloc>48</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Job info</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from &#x28;PROD&#x29;</connection>
    <sql>select&#xd;&#xa;		concat&#x28;&#x27;PR&#x27;, a.jobPostingID&#x29; as JobExtID&#xd;&#xa;		, dateAdded as insert_timestamp --reg_date&#xd;&#xa;		, a.isOpen&#xd;&#xa;		, convert&#x28;datetime,iif&#x28;a.isOpen in &#x28;null,0&#x29;, getdate&#x28;&#x29; - 7, NULL&#x29;, 120&#x29; as &#x27;position-endDate&#x27; &#xd;&#xa;		, cast&#x28;a.publicDescription as nvarchar&#x28;max&#x29;&#x29; as jobdesc --public description&#xd;&#xa;		, &#x5b;dbo&#x5d;.&#x5b;udf_StripHTML&#x5d;&#x28;ltrim&#x28;stuff&#x28; &#xd;&#xa;                coalesce&#x28;&#x27; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,jds.skills&#x29;, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29; &#xd;&#xa;              &#x2b; coalesce&#x28;&#x27;, &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,a.skills&#x29;, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29; &#xd;&#xa;              , 1, 1, &#x27;&#x27;&#x29; &#x29;&#x29; as &#x27;key_words&#x27;&#xd;&#xa;from bullhorn1.BH_JobPosting a&#xd;&#xa;left join bullhorn1.View_JobDelimitedSkills jds on jds.jobpostingid &#x3d; a.jobPostingID&#xd;&#xa;order by a.jobPostingID</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1248</xloc>
      <yloc>512</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Job lookup</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>position_description</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>JobExtID</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>actual_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1392</xloc>
      <yloc>592</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Job lookup 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>position_description</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>jobExtID</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>actual_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1392</xloc>
      <yloc>320</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Job lookup 3</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>position_description</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>JobExtId</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>actual_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1392</xloc>
      <yloc>112</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Job lookup 4</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>position_description</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>JobExtID</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>actual_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1392</xloc>
      <yloc>1296</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Job lookup 5</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>position_description</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>JobExtID</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>actual_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>720</xloc>
      <yloc>1392</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Sub FE</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>select cs.categoryID&#xd;&#xa;				, c.occupation as FE&#xd;&#xa;				, s.name as SFE&#xd;&#xa;				, getdate&#x28;&#x29; as insert_timestamp&#xd;&#xa;				from bullhorn1.BH_CategorySkillAssociation cs&#xd;&#xa;				left join bullhorn1.BH_CategoryList c on c.categoryID &#x3d; cs.categoryID&#xd;&#xa;				left join bullhorn1.BH_SkillList s on s.skillID &#x3d; cs.skillID&#xd;&#xa;order by FE, SFE</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>80</xloc>
      <yloc>1296</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Update 2 2</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <skip_lookup>N</skip_lookup>
    <commit>1000</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema>public</schema>
      <table>position_candidate</table>
      <key>
        <name>final_candidate_id</name>
        <field>candidate_id</field>
        <condition>&#x3d;</condition>
        <name2/>
        </key>
      <key>
        <name>final_position_id</name>
        <field>position_description_id</field>
        <condition>&#x3d;</condition>
        <name2/>
        </key>
      <value>
        <name>rejected_date</name>
        <rename>TIME_REJECTED</rename>
        </value>
      </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1680</xloc>
      <yloc>208</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Update 3 2</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <skip_lookup>Y</skip_lookup>
    <commit>300</commit>
    <use_batch>N</use_batch>
    <error_ignored>N</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <key>
        <name>candidate-externalId</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
        </key>
      <value>
        <name>desired_contract_rate</name>
        <rename>desired_contract_rate</rename>
        </value>
      <value>
        <name>contract_rate</name>
        <rename>contract_rate</rename>
        </value>
      </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2000</xloc>
      <yloc>1360</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Update public desc</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema>public</schema>
      <table>position_description</table>
      <key>
        <name>final_job_id</name>
        <field>id</field>
        <condition>&#x3d;</condition>
        <name2/>
        </key>
      <value>
        <name>public_description</name>
        <rename>position-publicDescription</rename>
        </value>
      </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1552</xloc>
      <yloc>768</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Update Candidate desire_salary</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <skip_lookup>N</skip_lookup>
    <commit>300</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <key>
        <name>cand_ext_id</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
        </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
        </key>
      <value>
        <name>desire_salary</name>
        <rename>desire_salary</rename>
        </value>
      <value>
        <name>months_per_year</name>
        <rename>months_per_year</rename>
        </value>
      <value>
        <name>present_salary_rate</name>
        <rename>present_salary_rate</rename>
        </value>
      <value>
        <name>salary_type</name>
        <rename>salary_type</rename>
        </value>
      <value>
        <name>current_salary</name>
        <rename>current_salary</rename>
        </value>
      </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2000</xloc>
      <yloc>1440</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Update candidate source</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema/>
      <table>candidate</table>
      <key>
        <name>VCCandidateID</name>
        <field>id</field>
        <condition>&#x3d;</condition>
        <name2/>
        </key>
      <value>
        <name>candidate_source_id</name>
        <rename>VCCandSourceID</rename>
        </value>
      </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2336</xloc>
      <yloc>1536</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Update contact info</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema>public</schema>
      <table>contact</table>
      <key>
        <name>VCContactID</name>
        <field>id</field>
        <condition>&#x3d;</condition>
        <name2/>
        </key>
      <value>
        <name>mobile_phone</name>
        <rename>mobile_phone</rename>
        </value>
      <value>
        <name>home_phone</name>
        <rename>home_phone</rename>
        </value>
      <value>
        <name>insert_timestamp</name>
        <rename>reg_date</rename>
        </value>
      <value>
        <name>personal_email</name>
        <rename>personal_email</rename>
        </value>
      </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>880</xloc>
      <yloc>352</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Update edu summary</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <skip_lookup>N</skip_lookup>
    <commit>1000</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <key>
        <name>VCCandidateID</name>
        <field>id</field>
        <condition>&#x3d;</condition>
        <name2/>
        </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
        </key>
      <value>
        <name>education_summary</name>
        <rename>education</rename>
        </value>
      </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2176</xloc>
      <yloc>672</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Update work history</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <skip_lookup>Y</skip_lookup>
    <commit>1000</commit>
    <use_batch>N</use_batch>
    <error_ignored>N</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <key>
        <name>VCCandidateID</name>
        <field>id</field>
        <condition>&#x3d;</condition>
        <name2/>
        </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
        </key>
      <value>
        <name>experience</name>
        <rename>workHistory</rename>
        </value>
      </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2176</xloc>
      <yloc>592</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>VC SFE</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <schema>public</schema>
    <table>sub_functional_expertise</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>functional_expertise_id</column_name>
          <stream_name>VCFE_ID</stream_name>
        </field>
        <field>
          <column_name>name</column_name>
          <stream_name>SubFunctional_Expertise</stream_name>
        </field>
        <field>
          <column_name>insert_timestamp</column_name>
          <stream_name>insert_timestamp</stream_name>
        </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>384</xloc>
      <yloc>1296</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>VC SFE lookup</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>sub_functional_expertise</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>N</eat_row_on_failure>
      <key>
        <name>VCFEID</name>
        <field>functional_expertise_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>SFE</name>
        <field>name</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCSFEID</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1040</xloc>
      <yloc>1392</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>VC company_industry</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>company_industry</table>
      <key>
        <name>final_industry_id</name>
        <field>industry_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>final_company_id</name>
        <field>company_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>industry_id</name>
        <rename>final_industry_id</rename>
        <update>Y</update>
      </value>
      <value>
        <name>company_id</name>
        <rename>final_company_id</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>432</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>VC job_industry</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>position_description</table>
      <key>
        <name>actual_id</name>
        <field>id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>vertical_id</name>
        <rename>final_industry_id</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1680</xloc>
      <yloc>320</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Vincere FE</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <schema>public</schema>
    <table>functional_expertise</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>name</column_name>
          <stream_name>Functional_Expertise</stream_name>
        </field>
        <field>
          <column_name>insert_timestamp</column_name>
          <stream_name>insert_timestamp</stream_name>
        </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>240</xloc>
      <yloc>1216</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>additional_form_values InsertUpdate 2</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>additional_form_values</table>
      <key>
        <name>additional_type</name>
        <field>additional_type</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>final_additional_id</name>
        <field>additional_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>form_id</name>
        <field>form_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>field_id</name>
        <field>field_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>field_value</name>
        <field>field_value</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>additional_type</name>
        <rename>additional_type</rename>
        <update>N</update>
      </value>
      <value>
        <name>additional_id</name>
        <rename>final_additional_id</rename>
        <update>N</update>
      </value>
      <value>
        <name>form_id</name>
        <rename>form_id</rename>
        <update>N</update>
      </value>
      <value>
        <name>field_id</name>
        <rename>field_id</rename>
        <update>N</update>
      </value>
      <value>
        <name>field_value</name>
        <rename>field_value</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>864</xloc>
      <yloc>784</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>additional_form_values LTD</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>additional_form_values</table>
      <key>
        <name>additional_type</name>
        <field>additional_type</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>final_additional_id</name>
        <field>additional_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>form_id</name>
        <field>form_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>field_id</name>
        <field>field_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>additional_type</name>
        <rename>additional_type</rename>
        <update>N</update>
      </value>
      <value>
        <name>additional_id</name>
        <rename>final_additional_id</rename>
        <update>N</update>
      </value>
      <value>
        <name>form_id</name>
        <rename>form_id</rename>
        <update>N</update>
      </value>
      <value>
        <name>field_id</name>
        <rename>field_id</rename>
        <update>N</update>
      </value>
      <value>
        <name>field_value</name>
        <rename>field_value</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2176</xloc>
      <yloc>768</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>candidate 3 2 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>application-candidateExternalId</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>final_candidate_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1552</xloc>
      <yloc>208</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>candidate activities</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <schema>public</schema>
    <table>activity</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>N</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field>contactid</partitioning_field>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>candidate_id</column_name>
          <stream_name>actual_candidate_id</stream_name>
        </field>
        <field>
          <column_name>user_account_id</column_name>
          <stream_name>user_account_id</stream_name>
        </field>
        <field>
          <column_name>insert_timestamp</column_name>
          <stream_name>insert_timestamp</stream_name>
        </field>
        <field>
          <column_name>content</column_name>
          <stream_name>content</stream_name>
        </field>
        <field>
          <column_name>type</column_name>
          <stream_name>type</stream_name>
        </field>
        <field>
          <column_name>category</column_name>
          <stream_name>category</stream_name>
        </field>
        <field>
          <column_name>userMessageID</column_name>
          <stream_name>userMessageID</stream_name>
        </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2176</xloc>
      <yloc>112</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>candidate activities 2</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <schema>public</schema>
    <table>activity</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>N</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field>contactid</partitioning_field>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>candidate_id</column_name>
          <stream_name>actual_candidateid</stream_name>
        </field>
        <field>
          <column_name>user_account_id</column_name>
          <stream_name>user_account_id</stream_name>
        </field>
        <field>
          <column_name>insert_timestamp</column_name>
          <stream_name>insert_timestamp</stream_name>
        </field>
        <field>
          <column_name>content</column_name>
          <stream_name>content</stream_name>
        </field>
        <field>
          <column_name>type</column_name>
          <stream_name>type</stream_name>
        </field>
        <field>
          <column_name>category</column_name>
          <stream_name>category</stream_name>
        </field>
        <field>
          <column_name>userMessageID</column_name>
          <stream_name>userMessageID</stream_name>
        </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2176</xloc>
      <yloc>240</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>candidate id</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>candidateID</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>final_candidate_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2080</xloc>
      <yloc>960</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>candidate industry</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>&#xd;&#xa;select --top 10&#xd;&#xa;		concat&#x28;&#x27;PR&#x27;, C.candidateID&#x29; as cand_ext_id&#xd;&#xa;		,  uc.businessSectorIDList&#xd;&#xa;		, c.dateAdded as reg_date&#xd;&#xa;from bullhorn1.Candidate C --where C.isPrimaryOwner &#x3d; 1&#xd;&#xa;left join bullhorn1.BH_UserContact uc on uc.userID &#x3d; c.userID&#xd;&#xa;where C.isdeleted &#x3c;&#x3e; 1 and C.status &#x3c;&#x3e; &#x27;Archive&#x27;&#xd;&#xa;and uc.businessSectorIDList is not NULL</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1840</xloc>
      <yloc>880</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>candidate industry 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>&#xa;-- BusinessSector&#x3a; split by separate rows by comma, then combine them into Business Sector&#x28;Industry&#x29;&#xa;with&#xa;  BusinessSector0&#x28;userid, businessSectorID&#x29; as &#x28;SELECT userid, a.value as ind FROM  bullhorn1.Candidate m CROSS APPLY STRING_SPLIT&#x28; ltrim&#x28;rtrim&#x28; convert&#x28;varchar&#x28;100&#x29;,m.businessSectorIDList&#x29; &#x29;&#x29;, &#x27;,&#x27;&#x29; AS a where isPrimaryOwner &#x3d; 1 &#x29;&#xa;, BusinessSector&#x28;userId, BusinessSector&#x29; as &#x28;SELECT userId, ltrim&#x28;rtrim&#x28;BSL.name&#x29;&#x29; as BusinessSector from BusinessSector0 left join bullhorn1.BH_BusinessSectorList BSL ON BusinessSector0.businessSectorID &#x3d; BSL.businessSectorID WHERE BusinessSector0.businessSectorID &#x3c;&#x3e; &#x27;&#x27; &#x29;&#xa;&#x2f;&#x2a;select &#xa;       distinct BusinessSector&#xa;       , current_timestamp as insert_timestamp&#xa;from BusinessSector&#x2a;&#x2f;&#xa;  &#xa; &#xa;SELECT&#xa;         CA.candidateID&#xa;       , BS.BusinessSector&#xa;       , current_timestamp as insert_timestamp&#xa;from bullhorn1.Candidate CA&#xa;left join BusinessSector BS on CA.userID &#x3d; BS.userId&#xa;where CA.isPrimaryOwner &#x3d; 1</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1952</xloc>
      <yloc>960</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>candidate lookup 3</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>cand_ext_id</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>actual_candidate_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2000</xloc>
      <yloc>320</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>candidate notes</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from &#x28;PROD&#x29;</connection>
    <sql>with&#xd;&#xa;--LATEST COMMENT&#xd;&#xa;lc as &#x28;SELECT userid&#xd;&#xa;		, comments&#xd;&#xa;		, dateAdded&#xd;&#xa;		, ROW_NUMBER&#x28;&#x29; OVER &#x28;PARTITION BY userid ORDER BY dateAdded desc&#x29; as rn&#xd;&#xa;		FROM bullhorn1.BH_UserComment &#x29;&#xd;&#xa;&#xd;&#xa;-- NOTE&#xd;&#xa;SELECT concat&#x28;&#x27;PR&#x27;, CA.candidateid&#x29; as cand_ext_id&#xd;&#xa;		 , concat_ws&#x28;&#x27;&#x3c;br&#x2f;&#x3e;&#x27; &#xd;&#xa;						, coalesce&#x28;&#x27;BH Candidate ID&#x3a; &#x27; &#x2b; nullif&#x28;cast&#x28;CA.userID as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; , &#x27;&#x27;&#x29;&#xd;&#xa;						, coalesce&#x28;&#x27;Date available&#x3a; &#x27; &#x2b; nullif&#x28;convert&#x28;nvarchar&#x28;10&#x29;,ca.dateAvailable,120&#x29;, &#x27;&#x27;&#x29; , &#x27;&#x27;&#x29;&#xd;&#xa;            --, coalesce&#x28;&#x27;Other email&#x3a; &#x27; &#x2b; nullif&#x28;cast&#x28;e3.email as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; , &#x27;&#x27;&#x29;&#xd;&#xa;            --, coalesce&#x28;&#x27;Desired Locations&#x3a; &#x27; &#x2b; nullif&#x28;cast&#x28;CA.desiredLocations as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; , &#x27;&#x27;&#x29;&#xd;&#xa;            , coalesce&#x28;&#x27;Employment Preference&#x3a; &#x27; &#x2b; nullif&#x28;cast&#x28;CA.employmentPreference as varchar&#x28;max&#x29;&#x29;, &#x27;&#x27;&#x29; , &#x27;&#x27;&#x29;&#xd;&#xa;            , coalesce&#x28;&#x27;Referred By &#x28;Other&#x29;&#x3a; &#x27; &#x2b; nullif&#x28;convert&#x28;varchar&#x28;max&#x29;,CA.referredBy&#x29;, &#x27;&#x27;&#x29; , &#x27;&#x27;&#x29;&#xd;&#xa;            , coalesce&#x28;&#x27;Referred By&#x3a; &#x27; &#x2b; nullif&#x28;convert&#x28;varchar&#x28;max&#x29;,CA.referredByUserID&#x29;, &#x27;&#x27;&#x29; &#x2b; &#x27; - &#x27; &#x2b; UC.firstname &#x2b; &#x27; &#x27; &#x2b; UC.lastname , &#x27;&#x27;&#x29;&#xd;&#xa;            , coalesce&#x28;&#x27;Status&#x3a; &#x27; &#x2b; nullif&#x28;convert&#x28;varchar&#x28;max&#x29;,CA.Status&#x29;, &#x27;&#x27;&#x29; , &#x27;&#x27;&#x29;&#xd;&#xa;            , coalesce&#x28;&#x27;CV&#x3a; &#x27; &#x2b; nullif&#x28;trim&#x28;UC1.description&#x29;, &#x27;&#x27;&#x29; , &#x27;&#x27;&#x29;&#xd;&#xa;            , coalesce&#x28;&#x27;General Comments&#x3a; &#x27; &#x2b; nullif&#x28;convert&#x28;varchar&#x28;max&#x29;,CA.comments&#x29;, &#x27;&#x27;&#x29; , &#x27;&#x27;&#x29;&#xd;&#xa;						--, coalesce&#x28;&#x27;CV&#x3a; &#x27; &#x2b; nullif&#x28;UW.description, &#x27;&#x27;&#x29; , &#x27;&#x27;&#x29;&#xd;&#xa;						, coalesce&#x28;&#x27;Latest Comment&#x3a; &#x27; &#x2b; nullif&#x28;&#x5b;bullhorn1&#x5d;.&#x5b;fn_ConvertHTMLToText&#x5d;&#x28;lc.comments&#x29;, &#x27;&#x27;&#x29; , &#x27;&#x27;&#x29;&#xd;&#xa;					&#x29; as note&#xd;&#xa;from bullhorn1.Candidate CA --where CA.isPrimaryOwner &#x3d; 1 --where convert&#x28;varchar&#x28;max&#x29;,CA.comments&#x29; &#x3c;&#x3e; &#x27;&#x27;&#xd;&#xa;left join &#x28; select userid, firstname, lastname from bullhorn1.BH_UserContact &#x29;UC ON UC.userID &#x3d; CA.referredByUserID&#xd;&#xa;left join &#x28;select userid, trim&#x28;&#x5b;bullhorn1&#x5d;.&#x5b;fn_ConvertHTMLToText&#x5d;&#x28;description&#x29;&#x29; as description from bullhorn1.BH_UserContact&#x29; UC1 on CA.UserID &#x3d; UC1.userID&#xd;&#xa;left join &#x28;select &#x2a; from lc where rn &#x3d; 1&#x29; lc on lc.userid &#x3d; CA.userid --last comment&#xd;&#xa;where isdeleted &#x3c;&#x3e; 1 and status &#x3c;&#x3e; &#x27;Archive&#x27;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1840</xloc>
      <yloc>512</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>candidate notes 2</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <key>
        <name>VCCandidateID</name>
        <field>id</field>
        <condition>&#x3d;</condition>
        <name2/>
        </key>
      <value>
        <name>note</name>
        <rename>note</rename>
        </value>
      </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2176</xloc>
      <yloc>528</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>candidate reg date</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <skip_lookup>N</skip_lookup>
    <commit>1000</commit>
    <use_batch>N</use_batch>
    <error_ignored>N</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <key>
        <name>actual_candidate_id</name>
        <field>id</field>
        <condition>&#x3d;</condition>
        <name2/>
        </key>
      <value>
        <name>insert_timestamp</name>
        <rename>reg_date</rename>
        </value>
      </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2176</xloc>
      <yloc>320</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>candidate_document 2 2</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema>public</schema>
      <table>candidate_document</table>
      <key>
        <name>final_contact_id</name>
        <field>contact_id</field>
        <condition>&#x3d;</condition>
        <name2/>
        </key>
      <key>
        <name>UploadedName</name>
        <field>uploaded_filename</field>
        <condition>&#x3d;</condition>
        <name2/>
        </key>
      <value>
        <name>uploaded_filename</name>
        <rename>RealName</rename>
        </value>
      <value>
        <name>created</name>
        <rename>created</rename>
        </value>
      </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>880</xloc>
      <yloc>1536</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>candidate_industry</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <schema>public</schema>
    <table>candidate_industry</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>Y</ignore_errors>
    <use_batch>N</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field>contactid</partitioning_field>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>vertical_id</column_name>
          <stream_name>final_industry_id</stream_name>
        </field>
        <field>
          <column_name>candidate_id</column_name>
          <stream_name>final_candidate_id</stream_name>
        </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2192</xloc>
      <yloc>880</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>cf 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>&#xa;-- TV Business Area&#xa;select&#xa;        Cl.clientID as &#x27;external_additional_id&#x27;&#xa;        , &#x27;add_con_info&#x27; as additional_type&#xa;        , 1007 as form_id&#xa;        , 1019 as field_id&#xa;        , replace&#x28;replace&#x28;replace&#x28;replace&#x28; ltrim&#x28;rtrim&#x28;UC.customText1&#x29;&#x29;,&#x27;Advisory&#x27;,1&#x29;,&#x27;General&#x27;,2&#x29;,&#x27;Investment&#x27;,3&#x29;,&#x27;TT Client&#x27;,4&#x29; as field_value&#xa;-- select distinct ltrim&#x28;rtrim&#x28;UC.customText1&#x29;&#x29;&#xa;from bullhorn1.BH_Client Cl&#xa;left join bullhorn1.BH_UserContact UC ON Cl.userID &#x3d; UC.userID&#xa;where Cl.isPrimaryOwner &#x3d; 1 and UC.customText1 &#x3c;&#x3e; &#x27;&#x27;&#xa;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>576</xloc>
      <yloc>784</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>comp lookup 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>company</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>com_ext_id</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCCompanyID</rename>
        <default/>
        <type>Number</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>208</xloc>
      <yloc>464</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>comp lookup 4</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>company</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>com_ext_id</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCCompanyID</rename>
        <default/>
        <type>Number</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>736</xloc>
      <yloc>544</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>company activity</name>
    <type>TableOutput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <schema>public</schema>
    <table>activity</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>N</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field>contactid</partitioning_field>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>company_id</column_name>
          <stream_name>VCCompanyID</stream_name>
        </field>
        <field>
          <column_name>user_account_id</column_name>
          <stream_name>user_account_id</stream_name>
        </field>
        <field>
          <column_name>insert_timestamp</column_name>
          <stream_name>insert_timestamp</stream_name>
        </field>
        <field>
          <column_name>content</column_name>
          <stream_name>content</stream_name>
        </field>
        <field>
          <column_name>type</column_name>
          <stream_name>type</stream_name>
        </field>
        <field>
          <column_name>category</column_name>
          <stream_name>category</stream_name>
        </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>432</xloc>
      <yloc>96</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>company industry</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from &#x28;PROD&#x29;</connection>
    <sql>with&#xa;ind &#x28;clientCorporationID,ind&#x29; as &#x28;SELECT clientCorporationID&#xa;	, ind.value as ind &#xa;	FROM bullhorn1.BH_ClientCorporation m &#xa;	CROSS APPLY STRING_SPLIT&#x28; ltrim&#x28;rtrim&#x28; convert&#x28;varchar&#x28;max&#x29;,m.businessSectorList&#x29; &#x29;&#x29;, &#x27;&#x3b;&#x27;&#x29; AS ind&#x29;&#xa;&#xa;select &#xa;        concat&#x28;&#x27;PR&#x27;,clientCorporationID&#x29; as clientCorporationID&#xa;       , ind as &#x27;company_industry&#x27; &#xa;from ind&#xa;where ind &#x3c;&#x3e; &#x27;&#x27;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>80</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>company location lookup</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>company_location</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>VCCompanyID</name>
        <field>company_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>locationAddress</name>
        <field>address</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCAddressID</rename>
        <default/>
        <type>Number</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>880</xloc>
      <yloc>544</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>compensation</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <skip_lookup>N</skip_lookup>
    <commit>1000</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema>public</schema>
      <table>compensation</table>
      <key>
        <name>actual_id</name>
        <field>position_id</field>
        <condition>&#x3d;</condition>
        <name2/>
        </key>
      <value>
        <name>annual_salary_from</name>
        <rename>FromSalary</rename>
        </value>
      <value>
        <name>annual_salary_to</name>
        <rename>ToSalary</rename>
        </value>
      <value>
        <name>percentage_of_annual_salary</name>
        <rename>quickfeeforecast</rename>
        </value>
      <value>
        <name>use_quick_fee_forecast</name>
        <rename>use_quick_fee_forecast</rename>
        </value>
      <value>
        <name>contract_rate_type</name>
        <rename>contract_rate_type</rename>
        </value>
      </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1552</xloc>
      <yloc>592</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>contact</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>contact</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>external_additional_id</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>final_additional_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>704</xloc>
      <yloc>784</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>contact 2 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>contact</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>ContactExtID</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>final_contact_id</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>720</xloc>
      <yloc>1536</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>contact FE-SFE</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>&#xa;-- FE&#xa;select &#xa;       Cl.clientid&#xa;       --, UC.categoryID&#xa;       , cat.occupation&#xa;from bullhorn1.BH_Client Cl &#xa;left join bullhorn1.BH_UserContact UC ON Cl.userID &#x3d; UC.userID &#xa;left join bullhorn1.BH_CategoryList cat ON cat.categoryID &#x3d; UC.categoryID&#xa;where Cl.isPrimaryOwner &#x3d; 1&#xa;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>576</xloc>
      <yloc>864</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>contact FE-SFE 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <sql>&#xa;with skill as &#x28;select c.contactid,ss.skill from Contacts c left join SkillInstances si on c.contactid &#x3d; si.objectid  left join skills ss on si.skillid &#x3d; ss.skillid&#x29;&#xa;select --top 200&#xa;                  CL.ContactId&#xa;                --, CL.FirstName, CL.LastName&#xa;         &#xa;		--, CL.Sector as &#x27;INDUSTRY&#x27; --&#x3e; VC vertical.name&#xa;                , case&#xa;                        when CL.Sector &#x3d; &#x27;Ad Networks&#x27; then &#x27;Advertising Networks&#x2f;Adtech Agency&#x27;&#xa;                        when CL.Sector &#x3d; &#x27;Advertising&#x27; then &#x27;Advertising Agency&#x27;&#xa;                        when CL.Sector &#x3d; &#x27;Branding&#x2f;Design&#x27; then &#x27;Branding and Design Agency&#x27;&#xa;                        when CL.Sector &#x3d; &#x27;Business Intelligence&#x27; then &#x27;Business Intelligence Agency&#x27;&#xa;                        when CL.Sector &#x3d; &#x27;Consulting Services&#x27; then &#x27;&#x27;&#xa;                        when CL.Sector &#x3d; &#x27;Digital&#x27; then &#x27;Digital Agency&#x27;&#xa;                        when CL.Sector &#x3d; &#x27;Market Research&#x2f;Insights&#x27; then &#x27;Market Research&#x2f;Insights Agency&#x27;&#xa;                        when CL.Sector &#x3d; &#x27;Marketing&#x27; then &#x27;Marketing Agency&#x27;&#xa;                        when CL.Sector &#x3d; &#x27;Marketing Services&#x27; then &#x27;Marketing Agency&#x27;&#xa;                        when CL.Sector &#x3d; &#x27;Media&#x27; then &#x27;Media Agency&#x27;&#xa;                        when CL.Sector &#x3d; &#x27;Medical Education&#x27; then &#x27;Medical Education Agency&#x27;&#xa;                        when CL.Sector &#x3d; &#x27;Mobile Marketing&#x27; then &#x27;Mobile Marketing Agency&#x27;&#xa;                        when CL.Sector &#x3d; &#x27;Non Dept Gov Body&#x27; then &#x27;Non Dept Gov Body&#x27;&#xa;                        when CL.Sector &#x3d; &#x27;Pharmacuetical&#x2f;Bio Tech&#x27; then &#x27;Pharmaceutical and BioTech&#x27;&#xa;                        when CL.Sector &#x3d; &#x27;Platforms&#x27; then &#x27;Technology&#x27;&#xa;                        when CL.Sector &#x3d; &#x27;PR and Communications&#x27; then &#x27;PR and Communications Agency&#x27;&#xa;                        when CL.Sector &#x3d; &#x27;Public Affairs&#x27; then &#x27;Public Affairs Agency&#x27;&#xa;                        when CL.Sector &#x3d; &#x27;Shopping Marketing&#x27; then &#x27;Shopper Marketing Agency&#x27;&#xa;                        when CL.Sector &#x3d; &#x27;Social Media&#x27; then &#x27;Social Media Agency&#x27;&#xa;                        when CL.Sector &#x3d; &#x27;Strategy Consulting&#x27; then &#x27;Strategy Consulting Agency&#x27;&#xa;                        when CL.Sector &#x3d; &#x27;&#x27; then &#x27;Content Agency&#x27;&#xa;                        when CL.Sector is null then &#x27;Content Agency&#x27;&#xa;                        else CL.Sector&#xa;                        end as &#x27;INDUSTRY&#x27; --&#x3e; VC vertical.name&#xa;                &#xa;                --, CL.Segment as &#x27;FUNCTIONAL_EXPERTISE&#x28;old&#x29;&#x27; --&#x3e; VC functional_expertise.name&#xa;                , Coalesce&#x28;NULLIF&#x28;case&#xa;                        when CL.Segment &#x3d; &#x27;&#x27; then &#x27;&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Asset management&#x27; then &#x27;&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Branding&#x2f;Design&#x27; then &#x27;Branding and Design&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Broadcast&#x27; then &#x27;&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Broadcasting Agency&#x27; then &#x27;&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Broadcasting PR&#x27; then &#x27;Broadcast PR&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Business Services&#x27; then &#x27;&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Commercial Support&#x27; then &#x27;&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Comms&#x27; then &#x27;Communications Planning&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Consumer&#x27; then &#x27;Consumer PR&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Consumer Tech&#x27; then &#x27;&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;corporate&#x27; then &#x27;Corporate PR&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Cross&#x27; then &#x27;Media Cross&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Defence&#x27; then &#x27;&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Education&#x27; then &#x27;&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Energy&#x27; then &#x27;&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Entertainment&#x27; then &#x27;&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;financial&#x27; then &#x27;Financial PR&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Financial Services&#x27; then &#x27;&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;FMCG&#x27; then &#x27;&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;healthcare&#x27; then &#x27;&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Healthcare &#x2f; Pharma&#x27; then &#x27;&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;HR&#x27; then &#x27;Human Resources&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Internal Communictions&#x27; then &#x27;Internal Communications&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Internal PR&#x27; then &#x27;Internal Communications&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Luxury&#x27; then &#x27;&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Management Consultancy&#x27; then &#x27;&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Market Reseach&#x2f;Insight&#x27; then &#x27;Market Research and Insights &#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Market Research&#x27; then &#x27;Market Research and Insights &#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Market Research &#x2f; Insights&#x27; then &#x27;Market Research and Insights &#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Market Research&#x2f;Insight&#x27; then &#x27;Market Research and Insights &#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Market Research&#x2f;Insights&#x27; then &#x27;&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Marketing &#x2f; Insight&#x27; then &#x27;&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Marketing Services&#x27; then &#x27;&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Marketing&#x2f;Insight&#x27; then &#x27;&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Media&#x27; then &#x27;&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Medical Education&#x27; then &#x27;Medical Affairs&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Not for profit&#x27; then &#x27;&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Office&#x27; then &#x27;&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Planning and Buying Agency&#x27; then &#x27;Planning and Buying&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;PR and Communications&#x27; then &#x27;&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Production Agency&#x27; then &#x27;&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Professional Services&#x27; then &#x27;&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Project Management&#x27; then &#x27;&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Public Relations&#x27; then &#x27;&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Public Sector&#x27; then &#x27;&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Pure Player&#x27; then &#x27;Pure Play Digital &#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Retail&#x27; then &#x27;&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Sale&#x27; then &#x27;Sales&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Shopping Marketing&#x27; then &#x27;Shopper Marketing&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Strategy Consultancy&#x27; then &#x27;&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Strategy Consulting&#x27; then &#x27;&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Supply Side Platform&#x27; then &#x27;Supply Side Platform &#x27;&#xa;                        when CL.Segment &#x3d; &#x27;technology&#x27; then &#x27;Technology  &#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Transport&#x27; then &#x27;&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Utilities&#x27; then &#x27;&#x27;&#xa;                        when CL.Segment &#x3d; &#x27;Web&#x27; then &#x27;&#x27;&#xa;                else CL.Segment&#xa;                end, &#x27;&#x27;&#x29;, &#x27;Others&#x27;&#x29; as &#x27;FUNCTIONAL_EXPERTISE&#x27; --&#x3e; VC functional_expertise.name&#xa;                &#xa;		--, skill.skill as &#x27;SUB-FUNCTIONAL_EXPERTISE&#x28;old&#x29;&#x27; --&#x3e; VC sub_functional_expertise.name&#xa;		, case&#xa;                        when skill.skill &#x3d; &#x27;Advertising&#x27; then &#x27;&#x27;&#xa;                        when skill.skill &#x3d; &#x27;Consumer Technology&#x27; then &#x27;&#x27;&#xa;                        when skill.skill &#x3d; &#x27;Consumer Technology&#x27; then &#x27;&#x27;&#xa;                        when skill.skill &#x3d; &#x27;Crisis &#x26; Issues Managment&#x27; then &#x27;Crisis &#x26; Issues Management&#x27;&#xa;                        when skill.skill &#x3d; &#x27;Data &#x26; Analysis&#x27; then &#x27;Data Analytics&#x27;&#xa;                        when skill.skill &#x3d; &#x27;Defence and Security&#x27; then &#x27;Defence&#x27;&#xa;                        when skill.skill &#x3d; &#x27;Field Marketing&#x27; then &#x27;&#x27;&#xa;                        when skill.skill &#x3d; &#x27;Field Sales&#x27; then &#x27;&#x27;&#xa;                        when skill.skill &#x3d; &#x27;Hibernate&#x27; then &#x27;&#x27;&#xa;                        when skill.skill &#x3d; &#x27;Information Architecture&#x27; then &#x27;&#x27;&#xa;                        when skill.skill &#x3d; &#x27;Java&#x27; then &#x27;Javascript&#x27;&#xa;                        when skill.skill &#x3d; &#x27;Logistics &#x26; Express&#x27; then &#x27;&#x27;&#xa;                        when skill.skill &#x3d; &#x27;Magento&#x27; then &#x27;&#x27;&#xa;                        when skill.skill &#x3d; &#x27;Measurement &#x26; Evaluation&#x27; then &#x27;Analytics&#x27;&#xa;                        when skill.skill &#x3d; &#x27;Modeling&#x27; then &#x27;&#x27;&#xa;                        when skill.skill &#x3d; &#x27;NodeJS&#x27; then &#x27;&#x27;&#xa;                        when skill.skill &#x3d; &#x27;Objective-c&#x27; then &#x27;&#x27;&#xa;                        when skill.skill &#x3d; &#x27;On Rails&#x27; then &#x27;&#x27;&#xa;                        when skill.skill &#x3d; &#x27;OOH&#x27; then &#x27;&#x27;&#xa;                        when skill.skill &#x3d; &#x27;OS&#x27; then &#x27;&#x27;&#xa;                        when skill.skill &#x3d; &#x27;OTC&#x27; then &#x27;&#x27;&#xa;                        when skill.skill &#x3d; &#x27;pharmaceuticals&#x27; then &#x27;Pharamaceutical&#x27;&#xa;                        when skill.skill &#x3d; &#x27;Prestashop&#x27; then &#x27;&#x27;&#xa;                        when skill.skill &#x3d; &#x27;Pricing and Reimbursement&#x27; then &#x27;&#x27;&#xa;                        when skill.skill &#x3d; &#x27;Print&#x27; then &#x27;&#x27;&#xa;                        when skill.skill &#x3d; &#x27;Product Design&#x27; then &#x27;&#x27;&#xa;                        when skill.skill &#x3d; &#x27;Quantitative research&#x27; then &#x27;Quantative Research&#x27;&#xa;                        when skill.skill &#x3d; &#x27;Spring&#x27; then &#x27;&#x27;&#xa;                        when skill.skill &#x3d; &#x27;SVN&#x27; then &#x27;&#x27;&#xa;                        when skill.skill &#x3d; &#x27;Swift&#x27; then &#x27;&#x27;&#xa;                        when skill.skill &#x3d; &#x27;Trade Activation&#x27; then &#x27;&#x27;&#xa;                        when skill.skill &#x3d; &#x27;Transport&#x27; then &#x27;&#x27;&#xa;                        when skill.skill &#x3d; &#x27;Travel &#x26; Tourism&#x27; then &#x27;Travel and Tourism&#x27;&#xa;                        when skill.skill &#x3d; &#x27;Unix&#x27; then &#x27;&#x27;&#xa;                        when skill.skill &#x3d; &#x27;UX&#x27; then &#x27;&#x27;&#xa;                        when skill.skill &#x3d; &#x27;W3C compliance,&#x27; then &#x27;&#x27;&#xa;                        when skill.skill &#x3d; &#x27;Windows&#x27; then &#x27;&#x27;&#xa;                        when skill.skill &#x3d; &#x27;Wireless&#x27; then &#x27;&#x27;&#xa;                else skill.skill&#xa;                end as &#x27;SUB-FUNCTIONAL_EXPERTISE&#x27; --&#x3e; VC sub_functional_expertise.name&#xa;&#xa;from Contacts CL&#xa;left join skill on CL.contactid &#x3d; skill.contactid&#xa;left join &#x28;SELECT contactid, skill &#x3d; STUFF&#x28;&#x28;SELECT skill &#x2b; char&#x28;10&#x29; FROM skill b WHERE b.contactid &#x3d; a.contactid FOR XML PATH&#x28;&#x27;&#x27;&#x29;, TYPE&#x29;.value&#x28;&#x27;.&#x27;, &#x27;nvarchar&#x28;MAX&#x29;&#x27;&#x29;, 1, 0, &#x27;&#x27;&#x29; FROM skill a GROUP BY contactid&#x29; skills on CL.contactid &#x3d; skills.contactid&#xa;where cl.descriptor &#x3d; 1&#xa;--and CL.ContactId in &#x28;&#x27;909076-2318-15147&#x27;&#x29;&#xa;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>576</xloc>
      <yloc>944</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>contact id</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>contact</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>clientid</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>final_contact_id</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>704</xloc>
      <yloc>864</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>contact id 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>contact</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>contact-externalId</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>final_contact_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>832</xloc>
      <yloc>704</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>contact id 3</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>contact</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>ContactId</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>final_contact_id</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>688</xloc>
      <yloc>944</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>contact industry 2 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>&#xa;-- BusinessSector&#x3a; split by separate rows by comma, then combine them into Business Sector&#x28;Industry&#x29;&#xa;with&#xa;  BusinessSector0&#x28;userid, businessSectorID&#x29; as &#x28;SELECT userid, a.value as ind FROM  &#x28; select Cl.userID, UC.businessSectorIDList from bullhorn1.BH_Client Cl left join bullhorn1.BH_UserContact UC ON Cl.userID &#x3d; UC.userID where Cl.isPrimaryOwner &#x3d; 1 and convert&#x28;varchar&#x28;100&#x29;,UC.businessSectorIDList&#x29; &#x3c;&#x3e; &#x27;&#x27; and UC.businessSectorIDList is not null &#x29; m CROSS APPLY STRING_SPLIT&#x28; ltrim&#x28;rtrim&#x28; convert&#x28;varchar&#x28;100&#x29;,m.businessSectorIDList&#x29; &#x29;&#x29;, &#x27;,&#x27;&#x29; AS a &#x29;&#xa;, BusinessSector&#x28;userId, BusinessSector&#x29; as &#x28;SELECT userId, ltrim&#x28;rtrim&#x28;BSL.name&#x29;&#x29; as BusinessSector from BusinessSector0 left join bullhorn1.BH_BusinessSectorList BSL ON BusinessSector0.businessSectorID &#x3d; BSL.businessSectorID WHERE BusinessSector0.businessSectorID &#x3c;&#x3e; &#x27;&#x27; &#x29;&#xa;-- select &#x2a; from BusinessSector&#xa;&#x2f;&#x2a;select&#xa;       distinct BusinessSector&#xa;       , current_timestamp as insert_timestamp&#xa;from BusinessSector&#x2a;&#x2f;&#xa;  &#xa; &#xa;SELECT&#xa;         Cl.clientID as &#x27;contact-externalId&#x27;&#xa;--       , case when &#x28;ltrim&#x28;replace&#x28;UC.firstName,&#x27;&#x3f;&#x27;,&#x27;&#x27;&#x29;&#x29; &#x3d; &#x27;&#x27; or  UC.firstName is null&#x29; then &#x27;Firstname&#x27; else ltrim&#x28;replace&#x28;UC.firstName,&#x27;&#x3f;&#x27;,&#x27;&#x27;&#x29;&#x29; end as &#x27;contact-firstName&#x27;&#xa;--	, case when &#x28;ltrim&#x28;replace&#x28;UC.lastName,&#x27;&#x3f;&#x27;,&#x27;&#x27;&#x29;&#x29; &#x3d; &#x27;&#x27; or  UC.lastName is null&#x29; then concat&#x28;&#x27;Lastname-&#x27;,Cl.clientID&#x29; else ltrim&#x28;replace&#x28;UC.lastName,&#x27;&#x3f;&#x27;,&#x27;&#x27;&#x29;&#x29; end as &#x27;contact-Lastname&#x27;&#xa;       , BS.BusinessSector&#xa;from bullhorn1.BH_Client Cl&#xa;left join bullhorn1.BH_UserContact UC ON Cl.userID &#x3d; UC.userID&#xa;left join BusinessSector BS on Cl.userID &#x3d; BS.userId&#xa;where cl.isPrimaryOwner &#x3d; 1 and BS.BusinessSector is not null</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>688</xloc>
      <yloc>704</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>contact industry 3</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>&#xa;-- BusinessSector&#x3a; split by separate rows by comma, then combine them into Business Sector&#x28;Industry&#x29;&#xa;with&#xa;  BusinessSector0&#x28;userid, businessSectorID&#x29; as &#x28;SELECT userid, a.value as ind FROM  &#x28; select Cl.userID, UC.businessSectorIDList from bullhorn1.BH_Client Cl left join bullhorn1.BH_UserContact UC ON Cl.userID &#x3d; UC.userID where Cl.isPrimaryOwner &#x3d; 1 and convert&#x28;varchar&#x28;100&#x29;,UC.businessSectorIDList&#x29; &#x3c;&#x3e; &#x27;&#x27; and UC.businessSectorIDList is not null &#x29; m CROSS APPLY STRING_SPLIT&#x28; ltrim&#x28;rtrim&#x28; convert&#x28;varchar&#x28;100&#x29;,m.businessSectorIDList&#x29; &#x29;&#x29;, &#x27;,&#x27;&#x29; AS a &#x29;&#xa;, BusinessSector&#x28;userId, BusinessSector&#x29; as &#x28;SELECT userId, ltrim&#x28;rtrim&#x28;BSL.name&#x29;&#x29; as BusinessSector from BusinessSector0 left join bullhorn1.BH_BusinessSectorList BSL ON BusinessSector0.businessSectorID &#x3d; BSL.businessSectorID WHERE BusinessSector0.businessSectorID &#x3c;&#x3e; &#x27;&#x27; &#x29;&#xa;-- select &#x2a; from BusinessSector&#xa;select&#xa;       distinct BusinessSector&#xa;       , current_timestamp as insert_timestamp&#xa;from BusinessSector</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>576</xloc>
      <yloc>624</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>contact lookup</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>contact</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>con_ext_id</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCContactID</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>736</xloc>
      <yloc>464</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>contact lookup 4</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>contact</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>ContactExtId</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>actual_contactid</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>736</xloc>
      <yloc>112</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>contact lookup 5</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>contact</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>contactExtId</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCContactID</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>736</xloc>
      <yloc>352</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>contact lookup 6</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>contact</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>ContactExtID</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCContactID</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>736</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>contact work location</name>
    <type>TableOutput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <schema>public</schema>
    <table>contact_location</table>
    <commit>100</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>N</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field>contactid</partitioning_field>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>contact_id</column_name>
          <stream_name>VCContactID</stream_name>
        </field>
        <field>
          <column_name>insert_timestamp</column_name>
          <stream_name>insert_timestamp</stream_name>
        </field>
        <field>
          <column_name>company_location_id</column_name>
          <stream_name>VCAddressID</stream_name>
        </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1024</xloc>
      <yloc>544</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>contact_functional_expertise 2</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>contact_functional_expertise</table>
      <key>
        <name>final_contact_id</name>
        <field>contact_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>functional_expertise_id</name>
        <rename>final_fe_id</rename>
        <update>Y</update>
      </value>
      <value>
        <name>contact_id</name>
        <rename>final_contact_id</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>912</xloc>
      <yloc>864</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>contact_functional_expertise 2 2</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>contact_functional_expertise</table>
      <key>
        <name>final_contact_id</name>
        <field>contact_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>functional_expertise_id</name>
        <rename>final_fe_id</rename>
        <update>Y</update>
      </value>
      <value>
        <name>sub_functional_expertise_id</name>
        <rename>final_sfe_id</rename>
        <update>Y</update>
      </value>
      <value>
        <name>contact_id</name>
        <rename>final_contact_id</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>944</xloc>
      <yloc>944</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>contact_industry 3</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <schema>public</schema>
    <table>contact_industry</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>Y</ignore_errors>
    <use_batch>N</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field>contactid</partitioning_field>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>industry_id</column_name>
          <stream_name>final_industry_id</stream_name>
        </field>
        <field>
          <column_name>contact_id</column_name>
          <stream_name>final_contact_id</stream_name>
        </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>928</xloc>
      <yloc>624</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>employees_number</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema>public</schema>
      <table>company</table>
      <key>
        <name>final_company_id</name>
        <field>id</field>
        <condition>&#x3d;</condition>
        <name2/>
        </key>
      <value>
        <name>employees_number</name>
        <rename>numEmployees</rename>
        </value>
      </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>432</xloc>
      <yloc>704</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>fe</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>functional_expertise</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>N</eat_row_on_failure>
      <key>
        <name>occupation</name>
        <field>name</field>
        <condition>LIKE</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>final_fe_id</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>800</xloc>
      <yloc>864</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>fe 3</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <cache>Y</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>functional_expertise</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>N</eat_row_on_failure>
      <key>
        <name>FUNCTIONAL_EXPERTISE</name>
        <field>name</field>
        <condition>LIKE</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>final_fe_id</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>768</xloc>
      <yloc>944</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>industry</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>vertical</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>BusinessSector</name>
        <field>name</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>final_industry_id</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2080</xloc>
      <yloc>880</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>industry 2</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>vertical</table>
      <key>
        <name>BusinessSector</name>
        <field>name</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>name</name>
        <rename>BusinessSector</rename>
        <update>Y</update>
      </value>
      <value>
        <name>insert_timestamp</name>
        <rename>insert_timestamp</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1952</xloc>
      <yloc>880</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>industry 2 3</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>vertical</table>
      <key>
        <name>BusinessSector</name>
        <field>name</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>name</name>
        <rename>BusinessSector</rename>
        <update>Y</update>
      </value>
      <value>
        <name>insert_timestamp</name>
        <rename>insert_timestamp</rename>
        <update>N</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>688</xloc>
      <yloc>624</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>industry 4</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>vertical</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>BusinessSector</name>
        <field>name</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>final_industry_id</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>832</xloc>
      <yloc>624</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>info</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema>public</schema>
      <table>company</table>
      <key>
        <name>final_company_id</name>
        <field>id</field>
        <condition>&#x3d;</condition>
        <name2/>
        </key>
      <value>
        <name>insert_timestamp</name>
        <rename>RegDate</rename>
        </value>
      </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>432</xloc>
      <yloc>768</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>job contract</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <commit>100</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>compensation</table>
      <key>
        <name>actual_id</name>
        <field>position_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>contract_rate_from</name>
        <rename>PayRateFrom</rename>
        <update>Y</update>
      </value>
      <value>
        <name>contract_rate_to</name>
        <rename>PayRateTo</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1552</xloc>
      <yloc>672</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>job industry</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from &#x28;PROD&#x29;</connection>
    <sql>select concat&#x28;&#x27;PR&#x27;, j.jobPostingID&#x29; as jobExtID&#xa;, s.name as job_industry&#xa;from bullhorn1.BH_JobPostingBusinessSector j&#xa;left join bullhorn1.BH_BusinessSectorList s on s.businessSectorID &#x3d; j.businessSectorID</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1248</xloc>
      <yloc>320</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>lookup candidateid</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema/>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>CandidateExtID</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>candidateid</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2000</xloc>
      <yloc>1632</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>lookup company</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>company</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>clientCorporationID</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>final_company_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>208</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>lookup company_legal_document</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema/>
      <table>company_legal_document</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>companyid</name>
        <field>company_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>legal_doc_id</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>432</xloc>
      <yloc>864</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>lookup companyid</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema/>
      <table>company</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>CompanyExtID</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>companyid</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>208</xloc>
      <yloc>864</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>lookup industry</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>vertical</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>company_industry</name>
        <field>name</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>final_industry_id</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>320</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>lookup industry 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>vertical</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>job_industry</name>
        <field>name</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>final_industry_id</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1552</xloc>
      <yloc>320</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>lookup jobid</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema/>
      <table>position_description</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>JobExtID</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>jobid</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1392</xloc>
      <yloc>1104</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>position_description</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>position_description</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>application-positionExternalId</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>final_position_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1392</xloc>
      <yloc>208</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>job lookup 6</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>position_description</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>position-externalId</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>final_job_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1408</xloc>
      <yloc>768</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>position_publicDescription</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from &#x28;PROD&#x29;</connection>
    <sql>with t as &#x28;select --top 100&#xd;&#xa;   concat&#x28;&#x27;PR&#x27;, a.jobPostingID&#x29; as &#x27;position-externalId&#x27;&#xd;&#xa;	, cast&#x28;a.publicDescription as nvarchar&#x28;max&#x29;&#x29; as &#x27;position-publicDescription&#x27;&#xd;&#xa;	from bullhorn1.BH_JobPosting a&#xd;&#xa;&#x29;&#xd;&#xa;&#xd;&#xa;select &#x2a;&#xd;&#xa;from t &#xd;&#xa;where &#x5b;position-publicDescription&#x5d; is not null and &#x5b;position-publicDescription&#x5d; &#x3c;&#x3e; &#x27;&#x27;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1248</xloc>
      <yloc>768</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>sfe 3</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <cache>Y</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>sub_functional_expertise</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>SUB-FUNCTIONAL_EXPERTISE</name>
        <field>name</field>
        <condition>LIKE</condition>
        <name2/>
      </key>
      <key>
        <name>final_fe_id</name>
        <field>functional_expertise_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>final_sfe_id</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>848</xloc>
      <yloc>944</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>update candidate_document</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <skip_lookup>N</skip_lookup>
    <commit>200</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema/>
      <table>candidate_document</table>
      <key>
        <name>candidateid</name>
        <field>candidate_id</field>
        <condition>&#x3d;</condition>
        <name2/>
        </key>
      <key>
        <name>UploadedName</name>
        <field>uploaded_filename</field>
        <condition>&#x3d;</condition>
        <name2/>
        </key>
      <value>
        <name>uploaded_filename</name>
        <rename>RealName</rename>
        </value>
      <value>
        <name>created</name>
        <rename>created</rename>
        </value>
      </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2160</xloc>
      <yloc>1632</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>update job info</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <skip_lookup>N</skip_lookup>
    <commit>1000</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema>public</schema>
      <table>position_description</table>
      <key>
        <name>actual_id</name>
        <field>id</field>
        <condition>&#x3d;</condition>
        <name2/>
        </key>
      <value>
        <name>insert_timestamp</name>
        <rename>insert_timestamp</rename>
        </value>
      <value>
        <name>key_words</name>
        <rename>key_words</rename>
        </value>
      </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1552</xloc>
      <yloc>512</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>update job_document</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <skip_lookup>N</skip_lookup>
    <commit>10000</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema/>
      <table>candidate_document</table>
      <key>
        <name>UploadedName</name>
        <field>uploaded_filename</field>
        <condition>&#x3d;</condition>
        <name2/>
        </key>
      <key>
        <name>jobid</name>
        <field>position_description_id</field>
        <condition>&#x3d;</condition>
        <name2/>
        </key>
      <value>
        <name>uploaded_filename</name>
        <rename>RealName</rename>
        </value>
      <value>
        <name>created</name>
        <rename>created</rename>
        </value>
      </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1552</xloc>
      <yloc>1104</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>update legal_document</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <skip_lookup>N</skip_lookup>
    <commit>1000</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema/>
      <table>candidate_document</table>
      <key>
        <name>UploadedName</name>
        <field>uploaded_filename</field>
        <condition>&#x3d;</condition>
        <name2/>
        </key>
      <key>
        <name>legal_doc_id</name>
        <field>legal_doc_id</field>
        <condition>&#x3d;</condition>
        <name2/>
        </key>
      <value>
        <name>uploaded_filename</name>
        <rename>RealName</rename>
        </value>
      <value>
        <name>created</name>
        <rename>created</rename>
        </value>
      </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>432</xloc>
      <yloc>960</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>update job end date</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <skip_lookup>N</skip_lookup>
    <commit>1000</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema>public</schema>
      <table>position_description</table>
      <key>
        <name>actual_id</name>
        <field>id</field>
        <condition>&#x3d;</condition>
        <name2/>
        </key>
      <value>
        <name>head_count_close_date</name>
        <rename>position-endDate</rename>
        </value>
      </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1552</xloc>
      <yloc>432</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Job info end date</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from &#x28;PROD&#x29;</connection>
    <sql>select&#xd;&#xa;		concat&#x28;&#x27;PR&#x27;, a.jobPostingID&#x29; as JobExtID&#xd;&#xa;		, dateAdded as insert_timestamp --reg_date&#xd;&#xa;		, a.isOpen&#xd;&#xa;		, convert&#x28;datetime,iif&#x28;a.isOpen in &#x28;null,0&#x29;, getdate&#x28;&#x29; - 7, NULL&#x29;, 120&#x29; as &#x27;position-endDate&#x27; &#xd;&#xa;		, cast&#x28;a.publicDescription as nvarchar&#x28;max&#x29;&#x29; as jobdesc --public description&#xd;&#xa;		, &#x5b;dbo&#x5d;.&#x5b;udf_StripHTML&#x5d;&#x28;ltrim&#x28;stuff&#x28; &#xd;&#xa;                coalesce&#x28;&#x27; &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,jds.skills&#x29;, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29; &#xd;&#xa;              &#x2b; coalesce&#x28;&#x27;, &#x27; &#x2b; NULLIF&#x28;convert&#x28;nvarchar&#x28;max&#x29;,a.skills&#x29;, &#x27;&#x27;&#x29;, &#x27;&#x27;&#x29; &#xd;&#xa;              , 1, 1, &#x27;&#x27;&#x29; &#x29;&#x29; as &#x27;key_words&#x27;&#xd;&#xa;from bullhorn1.BH_JobPosting a&#xd;&#xa;left join bullhorn1.View_JobDelimitedSkills jds on jds.jobpostingid &#x3d; a.jobPostingID&#xd;&#xa;where a.isOpen in &#x28;null,0&#x29;&#xd;&#xa;order by a.jobPostingID</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1248</xloc>
      <yloc>432</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Job lookup 7</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>position_description</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>JobExtID</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>actual_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1408</xloc>
      <yloc>864</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>fe 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>functional_expertise</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>FE</name>
        <field>name</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>final_fe_id</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1552</xloc>
      <yloc>864</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Candidate FE&#x2f;SFE</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from &#x28;PROD&#x29;</connection>
    <sql>with &#xd;&#xa;FESFE as &#x28;select cs.categoryID&#xd;&#xa;				, c.occupation as FE&#xd;&#xa;				, s.skillID&#xd;&#xa;				, s.name as SFE&#xd;&#xa;				, getdate&#x28;&#x29; as insert_timestamp&#xd;&#xa;				from bullhorn1.BH_CategorySkillAssociation cs&#xd;&#xa;				left join bullhorn1.BH_CategoryList c on c.categoryID &#x3d; cs.categoryID&#xd;&#xa;				left join bullhorn1.BH_SkillList s on s.skillID &#x3d; cs.skillID&#xd;&#xa;&#x29;&#xd;&#xa;&#xd;&#xa;, SKILL as &#x28;&#xd;&#xa;              SELECT &#x5b;BH_Candidate&#x5d;.candidateID&#xd;&#xa;									, &#x5b;BH_Candidate&#x5d;.userID&#xd;&#xa;									, &#x5b;BH_UserSkill&#x5d;.skillID&#xd;&#xa;									, &#x5b;BH_SkillList&#x5d;.name&#xd;&#xa;									, &#x5b;BH_SkillList&#x5d;.enabled&#xd;&#xa;              FROM &#x5b;bullhorn1&#x5d;.&#x5b;BH_Candidate&#x5d;&#xd;&#xa;              LEFT JOIN &#x5b;bullhorn1&#x5d;.BH_User on &#x5b;BH_User&#x5d;.userID &#x3d; &#x5b;BH_Candidate&#x5d;.userID&#xd;&#xa;              LEFT JOIN &#x5b;bullhorn1&#x5d;.BH_UserSkill on &#x5b;BH_Candidate&#x5d;.userID &#x3d; &#x5b;BH_UserSkill&#x5d;.userID&#xd;&#xa;              LEFT JOIN &#x5b;bullhorn1&#x5d;.BH_SkillList on &#x5b;BH_UserSkill&#x5d;.skillID &#x3d; &#x5b;BH_SkillList&#x5d;.skillID&#xd;&#xa;              WHERE &#x5b;BH_SkillList&#x5d;.name is not null &#xd;&#xa;							and &#x5b;BH_SkillList&#x5d;.name &#x3c;&#x3e; &#x27;&#x27; &#xd;&#xa;							and &#x5b;BH_Candidate&#x5d;.isdeleted &#x3c;&#x3e; 1 &#xd;&#xa;							and &#x5b;BH_Candidate&#x5d;.status &#x3c;&#x3e; &#x27;Archive&#x27; &#xd;&#xa;       &#x29;&#xd;&#xa;&#xd;&#xa;select concat&#x28;&#x27;PR&#x27;, s.candidateID&#x29; as cand_ext_id&#xd;&#xa;, s.userID&#xd;&#xa;, fe.FE&#xd;&#xa;, s.name as SFE&#xd;&#xa;, s.skillID as SFEID&#xd;&#xa;, getdate&#x28;&#x29; as insert_timestamp&#xd;&#xa;from SKILL s&#xd;&#xa;left join FESFE fe on fe.skillID &#x3d; s.skillID</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1840</xloc>
      <yloc>1168</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>FE lookup 3</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema/>
      <table>functional_expertise</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>FE</name>
        <field>name</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCFEID</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2000</xloc>
      <yloc>1280</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Insert candidate FESFE</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <commit>100</commit>
    <update_bypassed>Y</update_bypassed>
    <lookup>
      <schema/>
      <table>candidate_functional_expertise</table>
      <key>
        <name>VCCandidateID</name>
        <field>candidate_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>VCFEID</name>
        <field>functional_expertise_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>VCSFEID</name>
        <field>sub_functional_expertise_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>candidate_id</name>
        <rename>VCCandidateID</rename>
        <update>Y</update>
      </value>
      <value>
        <name>functional_expertise_id</name>
        <rename>VCFEID</rename>
        <update>Y</update>
      </value>
      <value>
        <name>sub_functional_expertise_id</name>
        <rename>VCSFEID</rename>
        <update>Y</update>
      </value>
      <value>
        <name>insert_timestamp</name>
        <rename>insert_timestamp</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2160</xloc>
      <yloc>1168</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>SFE lookup</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema/>
      <table>sub_functional_expertise</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>N</eat_row_on_failure>
      <key>
        <name>VCFEID</name>
        <field>functional_expertise_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>SFE</name>
        <field>name</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCSFEID</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2160</xloc>
      <yloc>1280</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>candidate lookup 5</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>cand_ext_id</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCCandidateID</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2000</xloc>
      <yloc>1168</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Candidate notice period</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from &#x28;PROD&#x29;</connection>
    <sql>select --top 10&#xd;&#xa;		concat&#x28;&#x27;PR&#x27;, C.candidateID&#x29; as cand_ext_id&#xd;&#xa;		, uc.customText11 as notice_period&#xd;&#xa;		, c.dateAdded as reg_date&#xd;&#xa;from bullhorn1.Candidate C --where C.isPrimaryOwner &#x3d; 1&#xd;&#xa;left join bullhorn1.BH_UserContact uc on uc.userID &#x3d; c.userID&#xd;&#xa;where C.isdeleted &#x3c;&#x3e; 1 and C.status &#x3c;&#x3e; &#x27;Archive&#x27;&#xd;&#xa;and uc.customText11 is not NULL and uc.customText11 &#x3c;&#x3e; &#x27;&#x27;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1840</xloc>
      <yloc>400</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>candidate notice</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <key>
        <name>actual_candidate_id</name>
        <field>id</field>
        <condition>&#x3d;</condition>
        <name2/>
        </key>
      <value>
        <name>notice_period</name>
        <rename>notice_period</rename>
        </value>
      </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2176</xloc>
      <yloc>400</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Candidate desired location</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from &#x28;PROD&#x29;</connection>
    <sql>select --top 10&#xd;&#xa;		concat&#x28;&#x27;PR&#x27;, C.candidateID&#x29; as cand_ext_id&#xd;&#xa;		, concat&#x28;&#x27;Desired Location&#x3a; &#x27;, uc.desiredLocations&#x29; as location_name&#xd;&#xa;		, uc.desiredLocations&#xd;&#xa;		, getdate&#x28;&#x29; as insert_timestamp&#xd;&#xa;from bullhorn1.Candidate C --where C.isPrimaryOwner &#x3d; 1&#xd;&#xa;left join bullhorn1.BH_UserContact uc on uc.userID &#x3d; c.userID&#xd;&#xa;where C.isdeleted &#x3c;&#x3e; 1 and C.status &#x3c;&#x3e; &#x27;Archive&#x27;&#xd;&#xa;and uc.desiredLocations is not NULL&#xd;&#xa;and cast&#x28;uc.desiredLocations as varchar&#x28;max&#x29;&#x29; &#x3c;&#x3e; &#x27;&#x27;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1840</xloc>
      <yloc>1072</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>candidate lookup 4</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>cand_ext_id</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCCandidateID</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2000</xloc>
      <yloc>1072</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Common location</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to &#x28;PROD&#x29;</connection>
    <schema/>
    <table>common_location</table>
    <commit>100</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>city</column_name>
          <stream_name>desiredLocations</stream_name>
        </field>
        <field>
          <column_name>location_name</column_name>
          <stream_name>location_name</stream_name>
        </field>
        <field>
          <column_name>desired_location_candidate_id</column_name>
          <stream_name>VCCandidateID</stream_name>
        </field>
        <field>
          <column_name>insert_timestamp</column_name>
          <stream_name>insert_timestamp</stream_name>
        </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2160</xloc>
      <yloc>1072</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step_error_handling>
  </step_error_handling>
  <slave-step-copy-partition-distribution>
  </slave-step-copy-partition-distribution>
  <slave_transformation>N</slave_transformation>
</transformation>
