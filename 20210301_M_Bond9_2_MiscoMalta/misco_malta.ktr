<?xml version="1.0" encoding="UTF-8"?>
<transformation>
  <info>
    <name>misco_malta</name>
    <description/>
    <extended_description/>
    <trans_version/>
    <trans_type>Normal</trans_type>
    <trans_status>0</trans_status>
    <directory>/</directory>
    <parameters>
    </parameters>
    <log>
      <trans-log-table>
        <connection/>
        <schema/>
        <table/>
        <size_limit_lines/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
          <subject/>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
          <subject/>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
          <subject/>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
          <subject/>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </trans-log-table>
      <perf-log-table>
        <connection/>
        <schema/>
        <table/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>SEQ_NR</id>
          <enabled>Y</enabled>
          <name>SEQ_NR</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>INPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>INPUT_BUFFER_ROWS</name>
        </field>
        <field>
          <id>OUTPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>OUTPUT_BUFFER_ROWS</name>
        </field>
      </perf-log-table>
      <channel-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
      <step-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
      </step-log-table>
      <metrics-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>METRICS_DATE</id>
          <enabled>Y</enabled>
          <name>METRICS_DATE</name>
        </field>
        <field>
          <id>METRICS_CODE</id>
          <enabled>Y</enabled>
          <name>METRICS_CODE</name>
        </field>
        <field>
          <id>METRICS_DESCRIPTION</id>
          <enabled>Y</enabled>
          <name>METRICS_DESCRIPTION</name>
        </field>
        <field>
          <id>METRICS_SUBJECT</id>
          <enabled>Y</enabled>
          <name>METRICS_SUBJECT</name>
        </field>
        <field>
          <id>METRICS_TYPE</id>
          <enabled>Y</enabled>
          <name>METRICS_TYPE</name>
        </field>
        <field>
          <id>METRICS_VALUE</id>
          <enabled>Y</enabled>
          <name>METRICS_VALUE</name>
        </field>
      </metrics-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file/>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
    <created_user>-</created_user>
    <created_date>2020/10/26 13:10:59.223</created_date>
    <modified_user>-</modified_user>
    <modified_date>2020/10/26 13:10:59.223</modified_date>
    <key_for_session_key>H4sIAAAAAAAAAAMAAAAAAAAAAAA=</key_for_session_key>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
    <notepad>
      <note>--Add column in common_location--
alter table common_location
add column contact_id bigint

select *
from common_location
where insert_timestamp >= '2020-09-21 17:00:00' --insert time

--Update current_location_id --
update contact
set current_location_id = common_location.id
from common_location
where common_location.contact_id = contact.id
and contact.external_id is not NULL
and contact.deleted_timestamp is NULL
and common_location.contact_id is not NULL
--and common_location.insert_timestamp >= '2020-09-21 17:00:00'</note>
      <xloc>816</xloc>
      <yloc>544</yloc>
      <width>365</width>
      <heigth>280</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>Company</note>
      <xloc>48</xloc>
      <yloc>32</yloc>
      <width>62</width>
      <heigth>26</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>company industry</note>
      <xloc>16</xloc>
      <yloc>416</yloc>
      <width>106</width>
      <heigth>26</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>Candidate</note>
      <xloc>48</xloc>
      <yloc>864</yloc>
      <width>65</width>
      <heigth>26</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>Candidate Source n/a</note>
      <xloc>816</xloc>
      <yloc>1472</yloc>
      <width>125</width>
      <heigth>26</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>update candidate c
set personal_location_id = cl.id
from common_location cl
where cl.personal_location_candidate_id = c.id
and c.external_id is not NULL
and c.deleted_timestamp is NULL
and cl.insert_timestamp >= '2020-07-05' --insert from now()</note>
      <xloc>48</xloc>
      <yloc>1424</yloc>
      <width>327</width>
      <heigth>122</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>Email subscription</note>
      <xloc>48</xloc>
      <yloc>1568</yloc>
      <width>107</width>
      <heigth>26</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>Industry List</note>
      <xloc>16</xloc>
      <yloc>544</yloc>
      <width>75</width>
      <heigth>26</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>check physical documents</note>
      <xloc>1328</xloc>
      <yloc>1712</yloc>
      <width>151</width>
      <heigth>26</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>Custom work</note>
      <xloc>1504</xloc>
      <yloc>1472</yloc>
      <width>81</width>
      <heigth>26</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>Document mapping (NEW)</note>
      <xloc>816</xloc>
      <yloc>1712</yloc>
      <width>154</width>
      <heigth>26</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>--upload files to tenant S3
aws s3 sync . s3://file-server-prod-fra/miscomalta.vincere.io/documents/</note>
      <xloc>816</xloc>
      <yloc>2096</yloc>
      <width>396</width>
      <heigth>42</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>select *
from contact
where last_name ilike 'Default contact%'

--
update contact
set insert_timestamp = now() - interval '1 year'
where last_name ilike 'Default contact%'</note>
      <xloc>1264</xloc>
      <yloc>32</yloc>
      <width>254</width>
      <heigth>137</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>--update currency - country
update compensation
set currency_type = 'euro', country_code = 'MT'</note>
      <xloc>1600</xloc>
      <yloc>272</yloc>
      <width>262</width>
      <heigth>58</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>--Clean up candidate location
select *
from common_location
where location_name is NULL and address is not NULL

update common_location
set location_name = address
where location_name is NULL and address is not NULL

select *
from common_location
where location_name is NULL and address is NULL --1489</note>
      <xloc>1248</xloc>
      <yloc>1168</yloc>
      <width>313</width>
      <heigth>200</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>--Set closed status to all jobs
update position_description
set active = 2</note>
      <xloc>1600</xloc>
      <yloc>448</yloc>
      <width>162</width>
      <heigth>58</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
  </notepads>
  <connection>
    <name>from DB</name>
    <server>localhost</server>
    <type>POSTGRESQL</type>
    <access>Native</access>
    <database>miscomalta_prod</database>
    <port>5432</port>
    <username>postgres</username>
    <password>Encrypted 2be98afc86aa7f2e4cb79ff228dc6fa8c</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>5432</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>from DB (parsed)</name>
    <server>localhost</server>
    <type>MSSQL</type>
    <access>Native</access>
    <database>misco_parsed_documents</database>
    <port>1433</port>
    <username>sa</username>
    <password>Encrypted 2be98afc86aa7f2d5f94aea35e083b8df</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>1433</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>to EU</name>
    <server>rdbmdm</server>
    <type>POSTGRESQL</type>
    <access>Native</access>
    <database>miscomalta.vincere.io</database>
    <port>5432</port>
    <username>mike.le</username>
    <password>Encrypted 2cadcfaae3fe687a7931ff97d8793a3db</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>5432</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <order>
    <hop>
      <from>Contact Location</from>
      <to>contact lookup</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>contact lookup</from>
      <to>Current location</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Company lookup</from>
      <to>Insert history</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Company lookup</from>
      <to>User join</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Company History</from>
      <to>Company lookup</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Company activity</from>
      <to>Company lookup</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Company Reg Date</from>
      <to>Company lookup 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Company lookup 2</from>
      <to>Update reg_date</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Contact Reg Date</from>
      <to>contact lookup 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>contact lookup 2</from>
      <to>Update reg_date 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Contact nick name</from>
      <to>contact lookup 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>contact lookup 2</from>
      <to>Update nickname</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Contact gender title</from>
      <to>contact lookup 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Contact mobile</from>
      <to>contact lookup 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>contact lookup 2</from>
      <to>mobile</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>contact lookup 2</from>
      <to>Update gender title</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>company industry</from>
      <to>lookup company</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>lookup company</from>
      <to>lookup industry</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>lookup industry</from>
      <to>VC company_industry</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Job From-To Salary DB</from>
      <to>Job lookup</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Job Industry n/a</from>
      <to>Job lookup</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Job Industry lookup</from>
      <to>Insert #1 Job Industry</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Job Industry lookup</from>
      <to>Update #2 vertical</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Job lookup</from>
      <to>Job Industry lookup</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Job lookup</from>
      <to>Update from/to</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate lookup 3</from>
      <to>Update available start</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate lookup 3</from>
      <to>Update reg date</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Available for work</from>
      <to>Candidate lookup 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Reg date</from>
      <to>Candidate lookup 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate Source</from>
      <to>Candidate lookup 5</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate Source Setting</from>
      <to>Insert candidate_source</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate lookup 5</from>
      <to>Candidate source lookup</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate source lookup</from>
      <to>Update candidate source</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate lookup 2</from>
      <to>User join 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Company lookup 3</from>
      <to>Contact lookup </to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Company lookup 3</from>
      <to>Job lookup 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Contact lookup </from>
      <to>Job lookup 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Job activity</from>
      <to>Company lookup 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Job lookup 2</from>
      <to>Candidate lookup 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate activity</from>
      <to>Company lookup 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>User join 2</from>
      <to>Insert activity</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>User join 2</from>
      <to>Insert cand activity</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate lookup</from>
      <to>Common location</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Personal location n/a</from>
      <to>Candidate lookup</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Website</from>
      <to>Candidate lookup 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate lookup 3</from>
      <to>Update website</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Cand nickname</from>
      <to>Candidate lookup 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate lookup 3</from>
      <to>Update cand nickname</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Cand subscribed</from>
      <to>Candidate lookup 4</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate lookup 4</from>
      <to>email_subscription</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Language json</from>
      <to>Candidate lookup 4</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate lookup 4</from>
      <to>Update Language</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>User join</from>
      <to>Insert activities</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Work history (format)</from>
      <to>Candidate lookup 6</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate lookup 6</from>
      <to>Update work history</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Passport</from>
      <to>Candidate lookup 6</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate lookup 6</from>
      <to>Update passport</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Industry List</from>
      <to>Insert industry</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>FE lookup 2</from>
      <to>Insert SFE</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Functional Exp</from>
      <to>Insert FE</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Sub FE</from>
      <to>FE lookup 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate met</from>
      <to>Candidate lookup 4</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate lookup 4</from>
      <to>update met_not_met</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Fname lname (review)</from>
      <to>Candidate lookup 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate lookup 3</from>
      <to>Update fname lname</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Contact category</from>
      <to>contact lookup 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>contact lookup 3</from>
      <to>FE lookup</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>FE lookup</from>
      <to>Insert contact FESFE</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Job open-close date (review)</from>
      <to>Job lookup</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Job lookup</from>
      <to>Update open-close</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Parsed documents</from>
      <to>Parsed doc (Postgres)</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Interview notes tab</from>
      <to>Candidate lookup 8</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate lookup 8</from>
      <to>Brief new tab</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Company lookup 4</from>
      <to>Comp Document mapping</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Company Document</from>
      <to>Company lookup 4</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>CF: CV rcv date</from>
      <to>Candidate lookup 4</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate lookup 4</from>
      <to>Insert CF Date</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Cand active/passive</from>
      <to>Candidate lookup 4</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate lookup 4</from>
      <to>Active Passive</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Contact document</from>
      <to>contact lookup 4</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>contact lookup 4</from>
      <to>Contact doc mapping</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Job document</from>
      <to>Job lookup 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Job lookup 3</from>
      <to>Job document mapping</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate doc</from>
      <to>Candidate lookup 9</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate lookup 9</from>
      <to>Cand doc mapping</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate Edu</from>
      <to>Candidate lookup 6</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate lookup 6</from>
      <to>Update education</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Contact physical doc</from>
      <to>Tmp contact doc</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>FE lookup 3</from>
      <to>Insert candidate FESFE</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate category</from>
      <to>Candidate lookup 7</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate lookup 7</from>
      <to>FE lookup 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>FE lookup 4</from>
      <to>Insert job FESFE</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Job category</from>
      <to>Job lookup 4</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Job lookup 4</from>
      <to>FE lookup 4</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>lookup industry 2</from>
      <to>VC candidate industry</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate industry</from>
      <to>Candidate lookup 10</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate lookup 10</from>
      <to>lookup industry 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Cand note</from>
      <to>Candidate lookup 7</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate lookup 7</from>
      <to>Update candidate note</to>
      <enabled>N</enabled>
    </hop>
  </order>
  <step>
    <name>Active Passive</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema/>
      <table>candidate</table>
      <key>
        <name>VCCandidateID</name>
        <field>id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>active</name>
        <rename>active</rename>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>416</xloc>
      <yloc>2000</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Available for work</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>select uniqueid as cand_ext_id
, to_date("134 avail from date", 'DD/MM/YY') as availability_start
from f01
where 1=1
and "101 candidate codegroup  23" = 'Y'
and "134 avail from date" is not NULL</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>48</xloc>
      <yloc>1008</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Brief new tab</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <schema/>
    <table>candidate_note</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>candidate_id</column_name>
        <stream_name>VCCandidateID</stream_name>
      </field>
      <field>
        <column_name>title</column_name>
        <stream_name>title</stream_name>
      </field>
      <field>
        <column_name>note</column_name>
        <stream_name>cand_brief_tab</stream_name>
      </field>
      <field>
        <column_name>insert_timestamp</column_name>
        <stream_name>insert_timestamp</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1840</xloc>
      <yloc>1616</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>CF: CV rcv date</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>select uniqueid as cand_ext_id
, 'add_cand_info' as additional_type
, 1005 as form_id
, 11265 as field_id
, to_date("104 cv receive date", 'DD/MM/YY') as field_date_value
, current_timestamp as insert_timestamp
from f01
where 1=1
and "101 candidate codegroup  23" = 'Y'
and "104 cv receive date" is not NULL</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>48</xloc>
      <yloc>1904</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Cand active/passive</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>select uniqueid as cand_ext_id
, "3 status codegroup   4"
, case when c.description = 'Active' then 1
		when c.description = 'Pre-Registered' then 0
		when c.description = 'Temp to Perm' then 3
		when c.description = 'Placed by Us' then 2
		end as active
from f01 f
left join (select * from codes where codegroup = '4') c on c.code = f."3 status codegroup   4"
where "3 status codegroup   4" is not NULL
and "101 candidate codegroup  23" = 'Y' </sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>48</xloc>
      <yloc>2000</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Cand doc mapping</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <schema/>
    <table>candidate_document</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>candidate_id</column_name>
        <stream_name>VCCandidateID</stream_name>
      </field>
      <field>
        <column_name>uploaded_filename</column_name>
        <stream_name>uploaded_filename</stream_name>
      </field>
      <field>
        <column_name>saved_filename</column_name>
        <stream_name>saved_filename</stream_name>
      </field>
      <field>
        <column_name>mime_type</column_name>
        <stream_name>mime_type</stream_name>
      </field>
      <field>
        <column_name>created</column_name>
        <stream_name>created</stream_name>
      </field>
      <field>
        <column_name>insert_timestamp</column_name>
        <stream_name>insert_timestamp</stream_name>
      </field>
      <field>
        <column_name>trigger_index_update_timestamp</column_name>
        <stream_name>trigger_index_update_timestamp</stream_name>
      </field>
      <field>
        <column_name>document_type</column_name>
        <stream_name>document_type</stream_name>
      </field>
      <field>
        <column_name>document_types_id</column_name>
        <stream_name>document_types_id</stream_name>
      </field>
      <field>
        <column_name>entity_type</column_name>
        <stream_name>entity_type</stream_name>
      </field>
      <field>
        <column_name>user_account_id</column_name>
        <stream_name>user_account_id</stream_name>
      </field>
      <field>
        <column_name>successful_parsing_percent</column_name>
        <stream_name>successful_parsing_percent</stream_name>
      </field>
      <field>
        <column_name>primary_document</column_name>
        <stream_name>primary_document</stream_name>
      </field>
      <field>
        <column_name>legal_doc_id</column_name>
        <stream_name>legal_doc_id</stream_name>
      </field>
      <field>
        <column_name>google_viewer</column_name>
        <stream_name>google_viewer</stream_name>
      </field>
      <field>
        <column_name>temporary</column_name>
        <stream_name>temporary</stream_name>
      </field>
      <field>
        <column_name>user_id</column_name>
        <stream_name>user_id</stream_name>
      </field>
      <field>
        <column_name>s3_html_support</column_name>
        <stream_name>s3_html_support</stream_name>
      </field>
      <field>
        <column_name>customer_portal</column_name>
        <stream_name>customer_portal</stream_name>
      </field>
      <field>
        <column_name>visible</column_name>
        <stream_name>visible</stream_name>
      </field>
      <field>
        <column_name>version_no</column_name>
        <stream_name>version_no</stream_name>
      </field>
      <field>
        <column_name>note</column_name>
        <stream_name>note</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1152</xloc>
      <yloc>2032</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Fname lname (review)</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>select c.uniqueid as cand_ext_id
, c."4 ref no numeric"
, c."26 salutation alphanumeric" as nick_name --#inject
, coalesce(c."185 surname alphanumeric", c."26 salutation alphanumeric", 'No lastname') as "candidate-lastName" --changed on 20201126
, coalesce(c."186 forenames alphanumeric", c."26 salutation alphanumeric", 'No firstname -' || c."4 ref no numeric") as "candidate-firstName" --changed on 20201126
from f01 c
where 1=1
and c."101 candidate codegroup  23" = 'Y'</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>48</xloc>
      <yloc>1264</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Cand nickname</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>select uniqueid as cand_ext_id
, "26 salutation alphanumeric" as nickname
from f01
where 1=1
and "101 candidate codegroup  23" = 'Y'
and nullif("26 salutation alphanumeric", '') is not NULL</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>48</xloc>
      <yloc>1168</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Cand subscribed</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>with 
--EMAIL ADDRESS
email as (select uniqueid
	, "4 ref no numeric" ref_id
	, "33 e-mail alphanumeric" org_email
	, a.email
	, case when position('--' in email) > 0 or position('?' in email) > 0 or email = '' then NULL
		else trim('''' from trim(email)) end as new_email
	, a.splitrn
	from f01, unnest(string_to_array("33 e-mail alphanumeric", '~')) with ordinality as a(email, splitrn)
	where "33 e-mail alphanumeric" ilike '%_@_%.__%')
	
, person_email as (select uniqueid, ref_id, org_email, new_email, splitrn
	, row_number() over(partition by new_email order by ref_id) as rn --distinct email if more than once
	, row_number() over(partition by uniqueid order by splitrn, new_email desc) as person_rn --distinct if candidates may have more than 1 email
	from email
	where new_email is not NULL
	) --select * from person_email


--MAIN SCRIPT
select c.uniqueid as cand_ext_id
--CAND INFO
, case when pe.rn > 1 then pe.rn || '_' || pe.new_email
		else coalesce(pe.new_email, c."4 ref no numeric" || '_candidate@noemail.com') end as "candidate-email"
, "74 maillist yn"
, case when c."74 maillist yn" = 'Y' then 1 else 0 end as email_subscription
from f01 c
left join (select * from person_email where person_rn=1) pe on pe.uniqueid = c.uniqueid --get only 1 email for candidate
where 1=1
and c."101 candidate codegroup  23" = 'Y'
--and c."74 maillist yn" = 'Y'
--and "1 name alphanumeric" ilike '%Eduardo%Cano%' --test candidate
--and c."4 ref no numeric" = '2891'</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>48</xloc>
      <yloc>1616</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Candidate Edu</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>with --EDUCATION | TEMP TABLE
edu_summary as (select uniqueid
	, string_agg(concat_ws(chr(10)
			, ('Highest Education level: ' || edu_lvl)
			, ('Date: ' || edu_date), ('To date: ' || edu_to), ('Subject: ' || edu_text), ('Educations details: ' || edu_qualification)
			, ('Grade: ' || edu_grade), ('Professional Qualifications: ' || edu_prod_qualif), ('Study status: ') || study_stat)
			, chr(10) || chr(13) order by arn) as person_edu_summary
	from education
	group by uniqueid
	)
	
--MAIN SCRIPT
select c.uniqueid as cand_ext_id
, es.person_edu_summary as education
from f01 c
left join edu_summary es on es.uniqueid = c.uniqueid
where 1=1
and c."101 candidate codegroup  23" = 'Y'
--and c."4 ref no numeric" = '2891'</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>816</xloc>
      <yloc>1360</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Candidate Source</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>select c.id as cand_ext_id
, c.ts2__candidate_source__c
, trim(s.name) as candidate_source
from contact c
left join ts2__source__c s on s.id = c.ts2__candidate_source__c
where 1=1
and c.ts2__candidate_source__c is not NULL
and c.RecordTypeId not in ('012i0000000eOPX')
order by s.name</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>816</xloc>
      <yloc>1616</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Candidate Source Setting</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>select distinct c.ts2__candidate_source__c
, trim(s.name) as candidate_source
, s.ts2__type__c
, 1 source_type
, 0 payment_style
, current_timestamp insert_timestamp
, current_timestamp periodic_payment_start_date
, current_timestamp + interval '2 years' periodic_payment_end_date
, 1 included_job_count
, 1 show_job
from contact c
join ts2__source__c s on s.id = c.ts2__candidate_source__c
order by trim(s.name)</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>816</xloc>
      <yloc>1520</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Candidate activity</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>--CANDIATE ACTIVITY FLATTEN BY NOTES
select a.UniqueID as activity_ext_id
  , "field 2" as com_ext_id
  , "field 1" as cand_ext_id
	, "field 3" as job_ext_id
	, f17."72 email add alphanumeric" as user_email
	, -10 as default_user_id
	, 'comment' as category
	, to_timestamp(concat_ws(' ', "post date", "post time"), 'DD/MM/YY HH24:MI') as insert_timestamp
	, c94.code
	, c94.description 
	, concat_ws(chr(10)
			, coalesce('Action: [' || c94.code || ']' || c94.description, NULL)
			, coalesce('Created by: ' || f17."1 name alphanumeric" || ' - ' || f17."72 email add alphanumeric", NULL)
			, concat_ws(chr(10)
					, coalesce('[Notes 1]' || ' ' || nullif("notes 1", ''), NULL)
					, coalesce('[Notes 2]' || ' ' || nullif("notes 2", ''), NULL)
					, coalesce('[Notes 3]' || ' ' || nullif("notes 3", ''), NULL)
					, coalesce('[Notes 4]' || ' ' || nullif("notes 4", ''), NULL)
					, coalesce('[Notes 5]' || ' ' || nullif("notes 5", ''), NULL)
					, coalesce('[Notes 6]' || ' ' || nullif("notes 6", ''), NULL)
					, coalesce('[Notes 7]' || ' ' || nullif("notes 7", ''), NULL)
					)
			, concat_ws(chr(10)
					, coalesce('Email note: ' || a2."21 email note", NULL)
					, coalesce('Subject note: ' || a2."22 subject note", NULL)
					, coalesce('Template note: ' || a2."23 template note", NULL)
					)
			, concat_ws(chr(10)
					, coalesce('Title note: ' || a3."8 cons title note", NULL)
					, coalesce('RC note: ' || a3."20 rc note note", NULL)
					)
		) as activity_comment
from act as a
	join (select * from f01 where "101 candidate codegroup  23" = 'Y') as b on b.UniqueID = a."field 1" --candidate
left join (select * from codes where codegroup = '94') as c94 on c94.code = a."field 5"
left join F17 on f17.UniqueID = a."field 4"
left join (SELECT uniqueid, "1 name alphanumeric" from f02) as com on com.uniqueid = a."field 2" --company
left join f03 as job on job.uniqueid = a."field 3" --job
left join act_spe a2 on a2."spe uniqueid" = a.uniqueid
left join act_spc a3 on a3."spc uniqueid" = a.uniqueid
where 1=1
--and c94.description not in ('Batch F/U', 'CV F/Up', 'Int F/Up', 'F/Up PP')</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>816</xloc>
      <yloc>1088</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Candidate doc</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>with cand_doc as (select cand_ext_id
	, candidate_document as uploaded_filename
	, uid || right(candidate_document, position('.' in reverse(candidate_document))) as saved_filename
	, row_number() over(partition by cand_ext_id
							order by case when note in ('People Notes', 'Window 1') then 1 else 2 end desc --original CV should go first
							, case when right(candidate_document, position('.' in reverse(candidate_document))) in ('.pdf', '.doc', '.docx') then 1 else 2 end asc --pdf, doc, docx go first
							, created desc --latest file go first
						) as cand_doc_primary
	, mime_type
	, created
	, now() insert_timestamp
	, now() trigger_index_update_timestamp
	, 'resume' document_type
	, 1 document_types_id
	, 'CANDIDATE' entity_type
	, -10 user_account_id
	, cast(0.0 as float) successful_parsing_percent
	, note
	--, 0 primary_document
	, 0 legal_doc_id
	, -1 google_viewer
	, 1 "temporary"
	, 0 user_id
	, 0 s3_html_support
	, 0 customer_portal
	, 1 as visible
	, 1 version_no
	from candidate_document
	)
	
select cd.*
, case when cand_doc_primary=1 then 1
	else 0 end as primary_document
from cand_doc cd
join candidate_physical_doc cpd on cpd.file_id = cd.saved_filename --join to get mapping if physical exists</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>816</xloc>
      <yloc>2032</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Candidate lookup</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema/>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>cand_ext_id</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCCandidateID</rename>
        <default/>
        <type>BigNumber</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>224</xloc>
      <yloc>1360</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Candidate lookup 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>cand_ext_id</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCCandidateID</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1520</xloc>
      <yloc>912</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Candidate lookup 3</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>cand_ext_id</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCCandidateID</rename>
        <default/>
        <type>Number</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>224</xloc>
      <yloc>1008</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Candidate lookup 4</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema/>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>cand_ext_id</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCCandidateID</rename>
        <default/>
        <type>BigNumber</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>224</xloc>
      <yloc>1808</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Candidate lookup 5</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema/>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>cand_ext_id</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCCandidateID</rename>
        <default/>
        <type>Number</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>992</xloc>
      <yloc>1616</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Candidate lookup 6</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>cand_ext_id</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCCandidateID</rename>
        <default/>
        <type>Number</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>992</xloc>
      <yloc>1264</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Candidate lookup 8</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema/>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>cand_ext_id</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCCandidateID</rename>
        <default/>
        <type>BigNumber</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1680</xloc>
      <yloc>1616</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Candidate lookup 9</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema/>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>cand_ext_id</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCCandidateID</rename>
        <default/>
        <type>BigNumber</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>992</xloc>
      <yloc>2032</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Candidate met</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>select uniqueid as cand_ext_id
, "105 perm cons xref" perm_owner
, 1 as met_notmet --1 met
from f01
where nullif("105 perm cons xref", '') is not NULL</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>48</xloc>
      <yloc>1808</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Candidate source lookup</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema/>
      <table>candidate_source</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>candidate_source</name>
        <field>name</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCCandSourceID</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1152</xloc>
      <yloc>1616</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Common location</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <schema/>
    <table>common_location</table>
    <commit>100</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>location_name</column_name>
        <stream_name>location_name</stream_name>
      </field>
      <field>
        <column_name>address</column_name>
        <stream_name>location_address</stream_name>
      </field>
      <field>
        <column_name>city</column_name>
        <stream_name>town</stream_name>
      </field>
      <field>
        <column_name>country_code</column_name>
        <stream_name>country</stream_name>
      </field>
      <field>
        <column_name>personal_location_candidate_id</column_name>
        <stream_name>VCCandidateID</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>416</xloc>
      <yloc>1360</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Comp Document mapping</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <schema/>
    <table>candidate_document</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>company_id</column_name>
        <stream_name>VCCompanyID</stream_name>
      </field>
      <field>
        <column_name>uploaded_filename</column_name>
        <stream_name>uploaded_filename</stream_name>
      </field>
      <field>
        <column_name>saved_filename</column_name>
        <stream_name>saved_filename</stream_name>
      </field>
      <field>
        <column_name>mime_type</column_name>
        <stream_name>mime_type</stream_name>
      </field>
      <field>
        <column_name>created</column_name>
        <stream_name>created</stream_name>
      </field>
      <field>
        <column_name>insert_timestamp</column_name>
        <stream_name>insert_timestamp</stream_name>
      </field>
      <field>
        <column_name>trigger_index_update_timestamp</column_name>
        <stream_name>trigger_index_update_timestamp</stream_name>
      </field>
      <field>
        <column_name>document_type</column_name>
        <stream_name>document_type</stream_name>
      </field>
      <field>
        <column_name>document_types_id</column_name>
        <stream_name>document_types_id</stream_name>
      </field>
      <field>
        <column_name>entity_type</column_name>
        <stream_name>entity_type</stream_name>
      </field>
      <field>
        <column_name>user_account_id</column_name>
        <stream_name>user_account_id</stream_name>
      </field>
      <field>
        <column_name>successful_parsing_percent</column_name>
        <stream_name>successful_parsing_percent</stream_name>
      </field>
      <field>
        <column_name>primary_document</column_name>
        <stream_name>primary_document</stream_name>
      </field>
      <field>
        <column_name>legal_doc_id</column_name>
        <stream_name>legal_doc_id</stream_name>
      </field>
      <field>
        <column_name>google_viewer</column_name>
        <stream_name>google_viewer</stream_name>
      </field>
      <field>
        <column_name>temporary</column_name>
        <stream_name>temporary</stream_name>
      </field>
      <field>
        <column_name>user_id</column_name>
        <stream_name>user_id</stream_name>
      </field>
      <field>
        <column_name>s3_html_support</column_name>
        <stream_name>s3_html_support</stream_name>
      </field>
      <field>
        <column_name>customer_portal</column_name>
        <stream_name>customer_portal</stream_name>
      </field>
      <field>
        <column_name>visible</column_name>
        <stream_name>visible</stream_name>
      </field>
      <field>
        <column_name>version_no</column_name>
        <stream_name>version_no</stream_name>
      </field>
      <field>
        <column_name>note</column_name>
        <stream_name>note</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1152</xloc>
      <yloc>1760</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Contact doc mapping</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <schema/>
    <table>candidate_document</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>contact_id</column_name>
        <stream_name>VCContactID</stream_name>
      </field>
      <field>
        <column_name>uploaded_filename</column_name>
        <stream_name>uploaded_filename</stream_name>
      </field>
      <field>
        <column_name>saved_filename</column_name>
        <stream_name>saved_filename</stream_name>
      </field>
      <field>
        <column_name>mime_type</column_name>
        <stream_name>mime_type</stream_name>
      </field>
      <field>
        <column_name>created</column_name>
        <stream_name>created</stream_name>
      </field>
      <field>
        <column_name>insert_timestamp</column_name>
        <stream_name>insert_timestamp</stream_name>
      </field>
      <field>
        <column_name>trigger_index_update_timestamp</column_name>
        <stream_name>trigger_index_update_timestamp</stream_name>
      </field>
      <field>
        <column_name>document_type</column_name>
        <stream_name>document_type</stream_name>
      </field>
      <field>
        <column_name>document_types_id</column_name>
        <stream_name>document_types_id</stream_name>
      </field>
      <field>
        <column_name>entity_type</column_name>
        <stream_name>entity_type</stream_name>
      </field>
      <field>
        <column_name>user_account_id</column_name>
        <stream_name>user_account_id</stream_name>
      </field>
      <field>
        <column_name>successful_parsing_percent</column_name>
        <stream_name>successful_parsing_percent</stream_name>
      </field>
      <field>
        <column_name>primary_document</column_name>
        <stream_name>primary_document</stream_name>
      </field>
      <field>
        <column_name>legal_doc_id</column_name>
        <stream_name>legal_doc_id</stream_name>
      </field>
      <field>
        <column_name>google_viewer</column_name>
        <stream_name>google_viewer</stream_name>
      </field>
      <field>
        <column_name>temporary</column_name>
        <stream_name>temporary</stream_name>
      </field>
      <field>
        <column_name>user_id</column_name>
        <stream_name>user_id</stream_name>
      </field>
      <field>
        <column_name>s3_html_support</column_name>
        <stream_name>s3_html_support</stream_name>
      </field>
      <field>
        <column_name>customer_portal</column_name>
        <stream_name>customer_portal</stream_name>
      </field>
      <field>
        <column_name>visible</column_name>
        <stream_name>visible</stream_name>
      </field>
      <field>
        <column_name>version_no</column_name>
        <stream_name>version_no</stream_name>
      </field>
      <field>
        <column_name>note</column_name>
        <stream_name>note</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1152</xloc>
      <yloc>1840</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Job document mapping</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <schema/>
    <table>candidate_document</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>position_description_id</column_name>
        <stream_name>VCJobID</stream_name>
      </field>
      <field>
        <column_name>uploaded_filename</column_name>
        <stream_name>uploaded_filename</stream_name>
      </field>
      <field>
        <column_name>saved_filename</column_name>
        <stream_name>saved_filename</stream_name>
      </field>
      <field>
        <column_name>mime_type</column_name>
        <stream_name>mime_type</stream_name>
      </field>
      <field>
        <column_name>created</column_name>
        <stream_name>created</stream_name>
      </field>
      <field>
        <column_name>insert_timestamp</column_name>
        <stream_name>insert_timestamp</stream_name>
      </field>
      <field>
        <column_name>trigger_index_update_timestamp</column_name>
        <stream_name>trigger_index_update_timestamp</stream_name>
      </field>
      <field>
        <column_name>document_type</column_name>
        <stream_name>document_type</stream_name>
      </field>
      <field>
        <column_name>document_types_id</column_name>
        <stream_name>document_types_id</stream_name>
      </field>
      <field>
        <column_name>entity_type</column_name>
        <stream_name>entity_type</stream_name>
      </field>
      <field>
        <column_name>user_account_id</column_name>
        <stream_name>user_account_id</stream_name>
      </field>
      <field>
        <column_name>successful_parsing_percent</column_name>
        <stream_name>successful_parsing_percent</stream_name>
      </field>
      <field>
        <column_name>primary_document</column_name>
        <stream_name>primary_document</stream_name>
      </field>
      <field>
        <column_name>legal_doc_id</column_name>
        <stream_name>legal_doc_id</stream_name>
      </field>
      <field>
        <column_name>google_viewer</column_name>
        <stream_name>google_viewer</stream_name>
      </field>
      <field>
        <column_name>temporary</column_name>
        <stream_name>temporary</stream_name>
      </field>
      <field>
        <column_name>user_id</column_name>
        <stream_name>user_id</stream_name>
      </field>
      <field>
        <column_name>s3_html_support</column_name>
        <stream_name>s3_html_support</stream_name>
      </field>
      <field>
        <column_name>customer_portal</column_name>
        <stream_name>customer_portal</stream_name>
      </field>
      <field>
        <column_name>visible</column_name>
        <stream_name>visible</stream_name>
      </field>
      <field>
        <column_name>version_no</column_name>
        <stream_name>version_no</stream_name>
      </field>
      <field>
        <column_name>note</column_name>
        <stream_name>note</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1152</xloc>
      <yloc>1936</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Company Document</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>select com_ext_id
, company_document as uploaded_filename
, uid || right(company_document, position('.' in reverse(company_document))) as saved_filename
, mime_type
, created
, now() insert_timestamp
, now() trigger_index_update_timestamp
, 'legacy_company_document' document_type
, 21 document_types_id
, 'COMPANY' entity_type
, -10 user_account_id
, cast(0.0 as Float) successful_parsing_percent
, note
, 0 primary_document
, 0 legal_doc_id
, -1 google_viewer
, 1 "temporary"
, 0 user_id
, 0 s3_html_support
, 0 customer_portal
, 1 as visible
, 1 version_no
from company_document</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>816</xloc>
      <yloc>1760</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Company History</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>select f02.uniqueid as com_ext_id
--, f02."11 created by xref"
--, f02."9 created date"
--, f02."10 updated date"
--, f02."12 updated by xref"
--, f02."17 last p job date"
--, f02."19 last t job date"
--, f02."70 last cont date"
--, f02."79 tob date date"
--, f02."86 last con date"
--, f02."58 lpermj by xref"
--, f02."59 ltempj by xref"
, concat_ws(chr(10)
	, coalesce('Created date: ' || f02."9 created date", NULL)
	, coalesce('Created by: ' || f17."1 name alphanumeric" || ' - ' || f17."72 email add alphanumeric", NULL)
	, coalesce('Updated: ' || f02."10 updated date", NULL)
	, coalesce('Updated by: ' || u2."1 name alphanumeric" || ' - ' || u2."72 email add alphanumeric", NULL)
	, coalesce('Last permanent job: ' || f02."10 updated date", NULL)
	, coalesce('Last permanent job by: ' || u4."1 name alphanumeric" || ' - ' || u4."72 email add alphanumeric", NULL)
	, coalesce('Last temp job: ' || f02."10 updated date", NULL)
	, coalesce('Last temp job by: ' || u5."1 name alphanumeric" || ' - ' || u5."72 email add alphanumeric", NULL)
	, coalesce('Last contract date: ' || f02."86 last con date", NULL)
	, coalesce('Contract by: ' || u3."1 name alphanumeric" || ' - ' || u3."72 email add alphanumeric", NULL)
	, coalesce('Last contact date: ' || f02."70 last cont date", NULL)
	, coalesce('Last TOB: ' || f02."79 tob date date", NULL)
	) as activity_comment
, -10 as user_id
, 'company' as type
, 'comment' as category
, current_timestamp as insert_timestamp
from f02
left join f17 on f17.uniqueid = f02."11 created by xref"
left join f17 u2 on u2.uniqueid = f02."12 updated by xref"
left join f17 u3 on u3.uniqueid = f02."87 contr by xref"
left join f17 u4 on u4.uniqueid = f02."58 lpermj by xref"
left join f17 u5 on u5.uniqueid = f02."59 ltempj by xref"</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>48</xloc>
      <yloc>224</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Company Reg Date</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>select uniqueid as com_ext_id
, to_date("9 created date", 'DD/MM/YY') as reg_date
from f02</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>48</xloc>
      <yloc>112</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Company activity</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>select a.UniqueID as activity_external_id
  , "field 2" as com_ext_id
  , "field 1" as con_text_id
	, "field 3" as job_ext_id
	, f17."72 email add alphanumeric" as user_email
	, -10 as default_user_id
	, 'comment' as category
	, to_timestamp(concat_ws(' ', "post date", "post time"), 'DD/MM/YY HH24:MI') as insert_timestamp
	, c94.code
	, c94.description 
	, concat_ws(chr(10)
			, coalesce('Action: ' || c94.description, NULL)
			, coalesce('Created by: ' || f17."1 name alphanumeric" || ' - ' || f17."72 email add alphanumeric", NULL)
			, concat_ws(chr(10)
					, coalesce('[Notes 1]' || ' ' || nullif("notes 1", ''), NULL)
					, coalesce('[Notes 2]' || ' ' || nullif("notes 2", ''), NULL)
					, coalesce('[Notes 3]' || ' ' || nullif("notes 3", ''), NULL)
					, coalesce('[Notes 4]' || ' ' || nullif("notes 4", ''), NULL)
					, coalesce('[Notes 5]' || ' ' || nullif("notes 5", ''), NULL)
					, coalesce('[Notes 6]' || ' ' || nullif("notes 6", ''), NULL)
					, coalesce('[Notes 7]' || ' ' || nullif("notes 7", ''), NULL)
					)
				, case when a."field 5" = 'PC' then
						concat_ws(chr(10)
							, coalesce('Last contact date: ' || a3."9 last cont date", NULL)
							, coalesce('Job: ' || a3."11 job text note", NULL)
							)
					else NULL end
		) as activity_comment
from act as a
	join f02 as b on b.UniqueID = a."field 2"
LEFT JOIN (select * from codes where codegroup = '94') as c94 on c94.code = a."field 5"
LEFT JOIN F17 on f17.UniqueID = a."field 4"
LEFT JOIN (SELECT uniqueid, "1 name alphanumeric" from f01) as con on con.uniqueid = a."field 1"
LEFT JOIN f03 as job on job.uniqueid = a."field 3"
left join act_fn as a2 on a2." fn uniqueid"  = a.UniqueID
left join act_pc as a3 on a3." pc uniqueid" = a.UniqueID
where 1=1
--and [Field 2] is not NULL
and "field 5" in ('PH', 'PC1', 'PC', 'TAE', 'TAP')</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>48</xloc>
      <yloc>304</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Company lookup</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>company</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>com_ext_id</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCCompanyID</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>192</xloc>
      <yloc>224</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Company lookup 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>company</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>com_ext_id</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCCompanyID</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>192</xloc>
      <yloc>112</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Company lookup 3</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>company</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>N</eat_row_on_failure>
      <key>
        <name>com_ext_id</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCCompanyID</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>992</xloc>
      <yloc>992</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Company lookup 4</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema/>
      <table>company</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>com_ext_id</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCCompanyID</rename>
        <default/>
        <type>BigNumber</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>992</xloc>
      <yloc>1760</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Contact Location</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>select uniqueid as con_ext_id
	, "100 contact codegroup  23"
	, "101 candidate codegroup  23"
	--, "109 cont addr alphanumeric" as location_name
	--, "109 cont addr alphanumeric" as location_address
	, replace(concat_ws(', '
		, coalesce(nullif(split_part("109 cont addr alphanumeric", '~', 1), ''), NULL)
		, coalesce(nullif(split_part("109 cont addr alphanumeric", '~', 2), ''), NULL)
		, coalesce(nullif(split_part("109 cont addr alphanumeric", '~', 3), ''), NULL)
		, coalesce(nullif(split_part("109 cont addr alphanumeric", '~', 4), ''), NULL)
		, coalesce(nullif(split_part("109 cont addr alphanumeric", '~', 5), ''), NULL)
		), ',,', '') as location_name
	, replace(concat_ws(', '
		, coalesce(nullif(split_part("109 cont addr alphanumeric", '~', 1), ''), NULL)
		, coalesce(nullif(split_part("109 cont addr alphanumeric", '~', 2), ''), NULL)
		, coalesce(nullif(split_part("109 cont addr alphanumeric", '~', 3), ''), NULL)
		, coalesce(nullif(split_part("109 cont addr alphanumeric", '~', 4), ''), NULL)
		, coalesce(nullif(split_part("109 cont addr alphanumeric", '~', 5), ''), NULL)
		), ',,', '') as location_address
	, split_part("109 cont addr alphanumeric", '~', 3) as town
	, split_part("109 cont addr alphanumeric", '~', 5) as org_country
	, "110 cont pstcd alphanumeric" as post_code
	, case split_part("109 cont addr alphanumeric", '~', 5) --multiple cases can be changed
		when 'New York, United States' then 'US'
		when 'Malta' then 'MT'
		when 'Cyprus' then 'CY'
		when 'US' then 'US'
		when 'Pakistan' then 'PK'
		when 'United States' then 'US'
		when 'Italy' then 'IT'
		when 'Isle Of Man' then 'IM'
		when 'India' then 'IN'
		when 'Switzerland' then 'CH'
		when 'Sweden' then 'SE'
		when 'Malta ' then 'MT'
		when 'Saudi Arabia' then 'SA'
		when 'United Kingdom' then 'GB'
		when 'Germany' then 'DE'
		when 'Hong Kong' then 'HK'
		when 'UK' then 'GB'
		when 'Great Britain' then 'GB'
		when 'UNITED KINGDOM' then 'GB'
		when 'NIGERIA ' then 'NG'
		when 'Gibraltar' then 'GI'
		when 'Ireland' then 'IE'
		when 'London' then 'GB'
		when 'MALTA' then 'MT'
		when 'Ukraine' then 'UA'
		when 'Usa' then 'US'
		when 'Italia' then 'IT'
		when 'Spain' then 'ES'
		when 'malta' then 'MT'
		when 'Qatar ' then 'QA'
		when 'South Africa ' then 'ZA'
		when 'France' then 'FR'
		when 'United Arab Emirates' then 'AE'
		when 'Malaysia' then 'MY'
	else NULL end as country
	from f01
	where nullif("109 cont addr alphanumeric", '') is not NULL
	and "100 contact codegroup  23" = 'Y'</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>816</xloc>
      <yloc>464</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Contact Reg Date</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>select uniqueid as con_ext_id
, to_date("28 created date", 'DD/MM/YY') as reg_date
from f01
where "100 contact codegroup  23" = 'Y'</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>816</xloc>
      <yloc>32</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Contact category</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>with person_category as (select uniqueid
	, "127 job cat codegroup  24"
	, a.category
	, a.splitrn
	from f01, unnest(string_to_array("127 job cat codegroup  24", '~')) with ordinality as a(category, splitrn)
	where 1=1
	and "127 job cat codegroup  24" is not NULL
	and "100 contact codegroup  23" = 'Y' --contact filter
	)

select distinct pc.uniqueid as con_ext_id
, pc.category
, c.description as final_category
from person_category pc
left join (select * from codes where codegroup = '24') c on c.code = pc.category
where c.description is not NULL
order by pc.uniqueid</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>816</xloc>
      <yloc>368</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Contact document</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>select con_ext_id
, contact_document as uploaded_filename
, uid || right(contact_document, position('.' in reverse(contact_document))) as saved_filename
, mime_type
, created
, now() insert_timestamp
, now() trigger_index_update_timestamp
, 'legacy_contact_document' document_type
, 19 document_types_id
, 'CONTACT' entity_type
, -10 user_account_id
, cast(0.0 as Float) successful_parsing_percent
, note
, 0 primary_document
, 0 legal_doc_id
, -1 google_viewer
, 1 "temporary"
, 0 user_id
, 0 s3_html_support
, 0 customer_portal
, 1 as visible
, 1 version_no
from contact_document</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>816</xloc>
      <yloc>1840</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Contact gender title</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>select c.uniqueid as con_ext_id
, case 
		when "27 title codegroup  16" in ('MS') then 'Ms.'
		when "27 title codegroup  16" in ('MRS') then 'Mrs.'
		when "27 title codegroup  16" in ('MR') then 'Mr.'
		when "27 title codegroup  16" in ('DR') then 'Dr.'
		when "27 title codegroup  16" in ('MIS') then 'Miss.'
		end as title
from f01 c
where c."100 contact codegroup  23" = 'Y'
and nullif("27 title codegroup  16", '') is not NULL</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>816</xloc>
      <yloc>192</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Contact lookup </name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>contact</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>N</eat_row_on_failure>
      <key>
        <name>con_ext_id</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCContactID</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1168</xloc>
      <yloc>1088</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Contact mobile</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>with 
--PHONE ADDRESS INCLUDING ALL H-W-M PHONES
phone as (select uniqueid
	, "38 ph hwo alphanumeric" as org_phone
	, regexp_replace(regexp_replace(regexp_replace(split_part("38 ph hwo alphanumeric", '~', 1), '[^0-9]+ - ', ''), '[^\w -/]', '', 'g'), '[[:alpha:]]', '', 'g') as homephone
	, regexp_replace(regexp_replace(regexp_replace(split_part("38 ph hwo alphanumeric", '~', 2), '[^0-9]+ - ', ''), '[^\w -/]', '', 'g'), '[[:alpha:]]', '', 'g') as workphone
	, regexp_replace(regexp_replace(regexp_replace(split_part("38 ph hwo alphanumeric", '~', 3), '[^0-9]+ - ', ''), '[^\w -/]', '', 'g'), '[[:alpha:]]', '', 'g') as mobile
	from f01
	where nullif("38 ph hwo alphanumeric", '') is not NULL
	)

--MAIN SCRIPT
select c.uniqueid as con_ext_id
, p.mobile as mobile
from f01 c
left join phone p on p.uniqueid = c.uniqueid --all phone
where c."100 contact codegroup  23" = 'Y'
and nullif(p.mobile, '') is not NULL</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>816</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Contact nick name</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>select uniqueid as con_ext_id
, "26 salutation alphanumeric" as nick_name
from f01
where "100 contact codegroup  23" = 'Y'
and "26 salutation alphanumeric" is not NULL</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>816</xloc>
      <yloc>112</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Current location</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <schema/>
    <table>common_location</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>contact_id</column_name>
        <stream_name>VCContactID</stream_name>
      </field>
      <field>
        <column_name>location_name</column_name>
        <stream_name>location_name</stream_name>
      </field>
      <field>
        <column_name>address</column_name>
        <stream_name>location_address</stream_name>
      </field>
      <field>
        <column_name>city</column_name>
        <stream_name>town</stream_name>
      </field>
      <field>
        <column_name>country_code</column_name>
        <stream_name>country</stream_name>
      </field>
      <field>
        <column_name>post_code</column_name>
        <stream_name>post_code</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1184</xloc>
      <yloc>464</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>FE lookup</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema/>
      <table>functional_expertise</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>final_category</name>
        <field>name</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCFEID</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1184</xloc>
      <yloc>368</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>FE lookup 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>functional_expertise</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>fe</name>
        <field>name</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCFE_ID</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>224</xloc>
      <yloc>800</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Functional Exp</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>select code
, trim(description) as fe
from codes
where codegroup = '24'
order by description --70</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>48</xloc>
      <yloc>704</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Industry List</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>select sub.uniqueid
, sub."1 attribute alphanumeric" as industry
, case sub."11 rootkey codegroup  58"
		when 'A' then 'Skills'
		when 'B' then 'Industry'
		when 'C' then 'Categories'
		end as code_type
, sub."2 parent xref"
, main."1 attribute alphanumeric" as main_type
, current_timestamp as insert_timestamp
from f12 sub
left join f12 main on main.uniqueid = sub."2 parent xref"
where 1=1
--and main."2 parent xref" is NULL --combination with codegroup
and main."11 rootkey codegroup  58" = 'B' --Industry
--and main."11 rootkey codegroup  58" = 'A' --Skills
--and main."11 rootkey codegroup  58" = 'C' --Categories
--and main."11 rootkey codegroup  58" in ('A', 'B', 'C')
--and main."11 rootkey codegroup  58" not in ('A', 'B', 'C') --Other types
--and sub."2 parent xref" is not NULL --checking hierachy mapping
order by main."1 attribute alphanumeric", sub."1 attribute alphanumeric"</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>48</xloc>
      <yloc>608</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert #1 Job Industry</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <schema/>
    <table>position_description_industry</table>
    <commit>100</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>position_id</column_name>
        <stream_name>VCJobID</stream_name>
      </field>
      <field>
        <column_name>industry_id</column_name>
        <stream_name>VCIndustryID</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2112</xloc>
      <yloc>112</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert CF Date</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <schema/>
    <table>additional_form_values</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>additional_type</column_name>
        <stream_name>additional_type</stream_name>
      </field>
      <field>
        <column_name>additional_id</column_name>
        <stream_name>VCCandidateID</stream_name>
      </field>
      <field>
        <column_name>form_id</column_name>
        <stream_name>form_id</stream_name>
      </field>
      <field>
        <column_name>field_id</column_name>
        <stream_name>field_id</stream_name>
      </field>
      <field>
        <column_name>field_date_value</column_name>
        <stream_name>field_date_value</stream_name>
      </field>
      <field>
        <column_name>insert_timestamp</column_name>
        <stream_name>insert_timestamp</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>416</xloc>
      <yloc>1904</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert FE</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <schema>public</schema>
    <table>functional_expertise</table>
    <commit>100</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>name</column_name>
        <stream_name>fe</stream_name>
      </field>
      <field>
        <column_name>business_units</column_name>
        <stream_name>fe</stream_name>
      </field>
      <field>
        <column_name>department</column_name>
        <stream_name>fe</stream_name>
      </field>
      <field>
        <column_name>expertise</column_name>
        <stream_name>fe</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>224</xloc>
      <yloc>704</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert SFE</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <schema>public</schema>
    <table>sub_functional_expertise</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>functional_expertise_id</column_name>
        <stream_name>VCFE_ID</stream_name>
      </field>
      <field>
        <column_name>name</column_name>
        <stream_name>sfe</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>416</xloc>
      <yloc>800</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert activities</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <schema>public</schema>
    <table>activity</table>
    <commit>200</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>company_id</column_name>
        <stream_name>VCCompanyID</stream_name>
      </field>
      <field>
        <column_name>user_account_id</column_name>
        <stream_name>vc_user_id</stream_name>
      </field>
      <field>
        <column_name>insert_timestamp</column_name>
        <stream_name>insert_timestamp</stream_name>
      </field>
      <field>
        <column_name>content</column_name>
        <stream_name>activity_comment</stream_name>
      </field>
      <field>
        <column_name>category</column_name>
        <stream_name>category</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>496</xloc>
      <yloc>304</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert activity</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <schema>public</schema>
    <table>activity</table>
    <commit>200</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>company_id</column_name>
        <stream_name>VCCompanyID</stream_name>
      </field>
      <field>
        <column_name>position_id</column_name>
        <stream_name>VCJobID</stream_name>
      </field>
      <field>
        <column_name>candidate_id</column_name>
        <stream_name>VCCandidateID</stream_name>
      </field>
      <field>
        <column_name>user_account_id</column_name>
        <stream_name>vc_user_account_id</stream_name>
      </field>
      <field>
        <column_name>insert_timestamp</column_name>
        <stream_name>insert_timestamp</stream_name>
      </field>
      <field>
        <column_name>content</column_name>
        <stream_name>activity_comment</stream_name>
      </field>
      <field>
        <column_name>category</column_name>
        <stream_name>category</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1920</xloc>
      <yloc>912</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert candidate_source</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <commit>1000</commit>
    <update_bypassed>Y</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>candidate_source</table>
      <key>
        <name>candidate_source</name>
        <field>name</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>name</name>
        <rename>candidate_source</rename>
        <update>Y</update>
      </value>
      <value>
        <name>source_type</name>
        <rename>source_type</rename>
        <update>Y</update>
      </value>
      <value>
        <name>payment_style</name>
        <rename>payment_style</rename>
        <update>Y</update>
      </value>
      <value>
        <name>insert_timestamp</name>
        <rename>insert_timestamp</rename>
        <update>Y</update>
      </value>
      <value>
        <name>periodic_payment_start_date</name>
        <rename>periodic_payment_start_date</rename>
        <update>Y</update>
      </value>
      <value>
        <name>periodic_payment_end_date</name>
        <rename>periodic_payment_end_date</rename>
        <update>Y</update>
      </value>
      <value>
        <name>included_job_count</name>
        <rename>included_job_count</rename>
        <update>Y</update>
      </value>
      <value>
        <name>show_job</name>
        <rename>show_job</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>992</xloc>
      <yloc>1520</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert contact FESFE</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <schema/>
    <table>contact_functional_expertise</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>contact_id</column_name>
        <stream_name>VCContactID</stream_name>
      </field>
      <field>
        <column_name>functional_expertise_id</column_name>
        <stream_name>VCFEID</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1360</xloc>
      <yloc>368</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert history</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <schema>public</schema>
    <table>activity</table>
    <commit>200</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>company_id</column_name>
        <stream_name>VCCompanyID</stream_name>
      </field>
      <field>
        <column_name>user_account_id</column_name>
        <stream_name>user_id</stream_name>
      </field>
      <field>
        <column_name>insert_timestamp</column_name>
        <stream_name>insert_timestamp</stream_name>
      </field>
      <field>
        <column_name>content</column_name>
        <stream_name>activity_comment</stream_name>
      </field>
      <field>
        <column_name>category</column_name>
        <stream_name>category</stream_name>
      </field>
      <field>
        <column_name>type</column_name>
        <stream_name>type</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>496</xloc>
      <yloc>224</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert industry</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <schema/>
    <table>vertical</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>name</column_name>
        <stream_name>industry</stream_name>
      </field>
      <field>
        <column_name>insert_timestamp</column_name>
        <stream_name>insert_timestamp</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>224</xloc>
      <yloc>608</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert cand activity</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <schema>public</schema>
    <table>activity</table>
    <commit>200</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>company_id</column_name>
        <stream_name>VCCompanyID</stream_name>
      </field>
      <field>
        <column_name>contact_id</column_name>
        <stream_name>VCContactID</stream_name>
      </field>
      <field>
        <column_name>position_id</column_name>
        <stream_name>VCJobID</stream_name>
      </field>
      <field>
        <column_name>candidate_id</column_name>
        <stream_name>VCCandidateID</stream_name>
      </field>
      <field>
        <column_name>user_account_id</column_name>
        <stream_name>vc_user_account_id</stream_name>
      </field>
      <field>
        <column_name>insert_timestamp</column_name>
        <stream_name>insert_timestamp</stream_name>
      </field>
      <field>
        <column_name>content</column_name>
        <stream_name>comment_activities</stream_name>
      </field>
      <field>
        <column_name>category</column_name>
        <stream_name>category</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1920</xloc>
      <yloc>1088</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Interview notes tab</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>with person_doc as (select uniqueid
	--, replace(right("relative document path", position(E'\\' in reverse("relative document path")) - 1), 'txt', 'rtf') as cand_doc
	, right("relative document path", position(E'\\' in reverse("relative document path")) - 1) as cand_doc
	, description
	, to_date(date, 'DD/MM/YY') created
	, row_number() over(partition by uniqueid, right("relative document path", position(E'\\' in reverse("relative document path")) - 1) order by to_date(date, 'DD/MM/YY') desc) as rn
	from f01docs1_edited
	where right("relative document path", position(E'\\' in reverse("relative document path")) - 1) &lt;&gt; 'rtf' --updated valid format on 20210226
)

, cand_doc as (select uniqueid cand_ext_id
	, cand_doc
	, description as note
	, created
	, replace(replace(encode(doc_content, 'escape'), chr(10), '&lt;br/>'), chr(13), '&lt;br/>') as parsed_doc_content --remember to switch to HTML format
	from person_doc p
	left join parsed_document pd on pd.doc_name = p.cand_doc
	where description in ('People Notes', 'Window 1')
	) --select * from cand_doc where cand_ext_id = '8081010180808280'

select cand_ext_id
, 'People Notes' title
, string_agg(concat_ws('&lt;br/>'
			, case when note = 'People Notes' then '[People Notes]&lt;br/>'
					when note = 'Window 1' then '[Window 1]&lt;br/>'
					end
			, '&lt;br/>[Created date: ' || to_char(created, 'DD/MM/YY') || ']'
			, '&lt;br/>' || nullif(replace(replace(parsed_doc_content, chr(10), '&lt;br/>'), chr(13), '&lt;br/>'), '')
			), '&lt;br/>' order by created desc) as cand_brief_tab
, current_timestamp as insert_timestamp
from cand_doc
where nullif(parsed_doc_content, '') is not NULL
group by cand_ext_id</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1504</xloc>
      <yloc>1616</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Job From-To Salary DB</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>select uniqueid as job_ext_id
, "32 sal from numeric"
, coalesce(nullif(split_part("32 sal from numeric", '~', 1), '')::float, 0) as salaryFrom
, coalesce(nullif(split_part("32 sal from numeric", '~', 2), '')::float, 0) as salaryTo
from f03
where nullif("32 sal from numeric", '') is not NULL</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1600</xloc>
      <yloc>112</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Job Industry n/a</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>select id as job_ext_id
, job_type__c as industry
from ts2__job__c
where job_type__c is not NULL</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1600</xloc>
      <yloc>32</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Job Industry lookup</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>vertical</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>industry</name>
        <field>name</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCIndustryID</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1936</xloc>
      <yloc>32</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Job activity</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>select a.UniqueID as activity_ext_id
  , "field 2" as com_ext_id
  , "field 1" as cand_ext_id
	, "field 3" as job_ext_id
	, f17."72 email add alphanumeric" as user_email
	, -10 as default_user_id
	, 'comment' as category
	, to_timestamp(concat_ws(' ', "post date", "post time"), 'DD/MM/YY HH24:MI') as insert_timestamp
	, c94.code
	, c94.description 
	, concat_ws(chr(10)
			, coalesce('Action: [' || c94.code || '] ' || c94.description, NULL)
			, coalesce('Created by: ' || f17."1 name alphanumeric" || ' - ' || f17."72 email add alphanumeric", NULL)
			, concat_ws(chr(10)
					, coalesce('[Notes 1]' || ' ' || nullif("notes 1", ''), NULL)
					, coalesce('[Notes 2]' || ' ' || nullif("notes 2", ''), NULL)
					, coalesce('[Notes 3]' || ' ' || nullif("notes 3", ''), NULL)
					, coalesce('[Notes 4]' || ' ' || nullif("notes 4", ''), NULL)
					, coalesce('[Notes 5]' || ' ' || nullif("notes 5", ''), NULL)
					, coalesce('[Notes 6]' || ' ' || nullif("notes 6", ''), NULL)
					, coalesce('[Notes 7]' || ' ' || nullif("notes 7", ''), NULL)
					)
			, case 
			when a."field 5" = 'AIE' then concat_ws(chr(10) --INTERVIEW NOTES | AIE
					, coalesce('Interview date time: ' || concat_ws(' ', nullif(a2."7 int date date", ''), nullif(a2."8 int time1 xref", '')), NULL)
					, coalesce('Job Title: ' || a2."28 job title note", NULL)
					, coalesce('Interview status: ' || c30.description, NULL)
					, coalesce('Candidate: ' || a2."52 cand title note" || ' ' || a2."53 cand sal note", NULL)
					, coalesce('Contact: ' || a2."31 title note" || ' ' || a2."30 salutation note", NULL)
					) end
		) as activity_comment
from act as a
	join f03 as job on job.uniqueid = a."field 3" --job
left join (select * from f01 where "101 candidate codegroup  23" = 'Y') as b on b.UniqueID = a."field 1" --candidate
left join (select * from codes where codegroup = '94') as c94 on c94.code = a."field 5"
left join F17 on f17.UniqueID = a."field 4"
left join (SELECT uniqueid, "1 name alphanumeric" from f02) as com on com.uniqueid = a."field 2" --company
left join act_aie a2 on a2."aie uniqueid" = a.uniqueid --Interview date
left join (select * from codes where codegroup = '30') as c30 on c30.code = a2."27 int type codegroup  30" --Interview status
where 1=1
and c94.description in ('Interview')</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>816</xloc>
      <yloc>912</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Job document</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>select job_ext_id
, job_document as uploaded_filename
, uid || right(job_document, position('.' in reverse(job_document))) as saved_filename
, mime_type
, created
, now() insert_timestamp
, now() trigger_index_update_timestamp
, 'legacy_job_document' document_type
, 20 document_types_id
, 'JOB' entity_type
, -10 user_account_id
, cast(0.0 as Float) successful_parsing_percent
, note
, 0 primary_document
, 0 legal_doc_id
, -1 google_viewer
, 1 "temporary"
, 0 user_id
, 0 s3_html_support
, 0 customer_portal
, 1 as visible
, 1 version_no
from job_document</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>816</xloc>
      <yloc>1936</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Job lookup</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>position_description</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>job_ext_id</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCJobID</rename>
        <default/>
        <type>Number</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1776</xloc>
      <yloc>112</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Job lookup 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>position_description</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>N</eat_row_on_failure>
      <key>
        <name>job_ext_id</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCJobID</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1344</xloc>
      <yloc>992</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Job lookup 3</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>position_description</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>job_ext_id</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCJobID</rename>
        <default/>
        <type>Number</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>992</xloc>
      <yloc>1936</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Job open-close date (review)</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>with job_status as (select j.uniqueid job_ext_id
	, c.description job_status
	, coalesce(to_date("21 order date date", 'DD/MM/YY'), to_date("23 start date", 'DD/MM/YY'), to_date("22 updated date", 'DD/MM/YY')) as startDate
	, to_date("24 end date", 'DD/MM/YY') as endDate
	from f03 j
	left join (select * from codes where codegroup = '6') c on c.code = j."5 status codegroup   6" --status
	)

select job_ext_id
, job_status
, startDate
, case when job_status = 'Closed' then coalesce(endDate, now() - interval '1 day')
	else coalesce(endDate, startDate + interval '1 year') end as endDate
from job_status
where startDate is not NULL</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1600</xloc>
      <yloc>192</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Language json</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>with language_list as (select uniqueid, "128 languages codegroup  12", "129 lang lev codegroup  28"
	, a.language_code
	, a.languagern
	--, b.language_lv
	--, b.lvrn
	from f01
		, unnest(string_to_array("128 languages codegroup  12", '~')) with ordinality as a (language_code, languagern)
		--, unnest(string_to_array("129 lang lev codegroup  28", '~')) with ordinality as b (language_lv, lvrn)
	)
	
, cand_lang as (select --distinct c12.description
	uniqueid
	, languagern
	, case c12.description
		when 'Arabic' then 'ar'
		when 'Armenian' then 'hy'
		when 'Bosnian' then 'bs'
		when 'Bulgarian' then 'bg'
		when 'Cantonese' then 'zh_TW'
		when 'Catalan' then 'ca'
		when 'Chinese' then 'zh_CN'
		when 'Czech' then 'cs'
		when 'Danish' then 'da'
		when 'Dutch' then 'nl'
		when 'English' then 'en'
		when 'Estonian' then 'et'
		when 'Finnish' then 'fi'
		when 'French' then 'fr'
		when 'German' then 'de'
		when 'Greek' then 'el'
		when 'Hebrew' then 'iw'
		when 'Hindu' then 'hi'
		when 'Hungarian' then 'hu'
		when 'Indonesian' then 'in'
		when 'Irish' then 'ga'
		when 'Italian' then 'it'
		when 'Japanese' then 'ja'
		when 'Kannada' then 'kn'
		when 'Korean' then 'ko'
		when 'Latin' then 'la'
		when 'Latvian' then 'lv'
		when 'Lithuanian' then 'lt'
		when 'Macedonian' then 'mk'
		when 'Maltese' then 'mt'
		when 'Maranthi' then 'mr'
		when 'Norwegian' then 'no'
		when 'Polish' then 'pl'
		when 'Portuguese' then 'pt'
		when 'Punjabi' then 'pa'
		when 'Romanian' then 'ro'
		when 'Russian' then 'ru'
		when 'Serbian' then 'sr'
		when 'Slovakian' then 'sk'
		when 'Slovenian' then 'sl'
		when 'Somali' then 'so'
		when 'Spanish' then 'es'
		when 'Swedish' then 'sv'
		when 'Tagaleg' then 'tl'
		when 'Tamil' then 'ta'
		when 'Telugu' then 'te'
		when 'Turkish' then 'tr'
		when 'Ukranian' then 'uk'
		when 'Urdu' then 'ur'
		else NULL end as cand_lang
	--, c28.description lv_description
	--, lvrn
	from language_list l
	left join (select * from codes where codegroup = '12') c12 on c12.code = l.language_code
	--left join (select * from codes where codegroup = '28') c28 on c28.code = l.language_lv
	)


SELECT uniqueid cand_ext_id
, json_agg(row_to_json((
       SELECT ColumnName FROM ( SELECT cand_lang) AS ColumnName ("languageCode")
			 )) order by languagern asc) AS language_json
FROM cand_lang
where cand_lang is not NULL
--where uniqueid = '' --checking
GROUP BY uniqueid</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>48</xloc>
      <yloc>1712</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Parsed doc (Postgres)</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <schema/>
    <table>parsed_document</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>id</column_name>
        <stream_name>id</stream_name>
      </field>
      <field>
        <column_name>doc_name</column_name>
        <stream_name>doc_name</stream_name>
      </field>
      <field>
        <column_name>doc_content</column_name>
        <stream_name>doc_content</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1840</xloc>
      <yloc>1520</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Parsed documents</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB (parsed)</connection>
    <sql>with doc as (select id
, doc_name
, doc_content
, convert(varchar(max), doc_content) as parsed_doc_content
from document_prod
)

select *
from doc
where nullif(parsed_doc_content, '') is not NULL</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1504</xloc>
      <yloc>1520</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Passport</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>select c.uniqueid as cand_ext_id
, c."221 idnum alphanumeric" as passport
from f01 c
where 1=1
and "101 candidate codegroup  23" = 'Y'
and c."221 idnum alphanumeric" is not NULL
and length(c."221 idnum alphanumeric") &lt; 50 --80810101EC868180 longer than 50 chars</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>816</xloc>
      <yloc>1264</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Personal location n/a</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>select uniqueid as cand_ext_id
	, "100 contact codegroup  23"
	, "101 candidate codegroup  23"
	, "34 cand addr alphanumeric" as location_name
	, "34 cand addr alphanumeric" as location_address
	, split_part("34 cand addr alphanumeric", '~', 3) as town
	, split_part("34 cand addr alphanumeric", '~', 5) as org_country
	, case split_part("34 cand addr alphanumeric", '~', 5) --multiple cases can be changed
		when 'New York, United States' then 'US'
		when 'Malta' then 'MT'
		when 'Cyprus' then 'CY'
		when 'US' then 'US'
		when 'Pakistan' then 'PK'
		when 'United States' then 'US'
		when 'Italy' then 'IT'
		when 'Isle Of Man' then 'IM'
		when 'India' then 'IN'
		when 'Switzerland' then 'CH'
		when 'Sweden' then 'SE'
		when 'Malta ' then 'MT'
		when 'Saudi Arabia' then 'SA'
		when 'United Kingdom' then 'GB'
		when 'Germany' then 'DE'
		when 'Hong Kong' then 'HK'
		when 'UK' then 'GB'
		when 'Great Britain' then 'GB'
		when 'UNITED KINGDOM' then 'GB'
		when 'NIGERIA ' then 'NG'
		when 'Gibraltar' then 'GI'
		when 'Ireland' then 'IE'
		when 'London' then 'GB'
		when 'MALTA' then 'MT'
		when 'Ukraine' then 'UA'
		when 'Usa' then 'US'
		when 'Italia' then 'IT'
		when 'Spain' then 'ES'
		when 'malta' then 'MT'
		when 'Qatar ' then 'QA'
	else NULL end as country
	from f01
	where nullif("34 cand addr alphanumeric", '') is not NULL
	and "101 candidate codegroup  23" = 'Y'</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>48</xloc>
      <yloc>1360</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Reg date</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>select uniqueid as cand_ext_id
, to_date("28 created date", 'DD/MM/YY') as reg_date
from f01
where 1=1
and "101 candidate codegroup  23" = 'Y'
and nullif("28 created date", '') is not NULL</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>48</xloc>
      <yloc>912</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Sub FE</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <sql>select trim(concat('【PP】', replace(fe, char(10), ' / '))) as fe
, sfe
from vc_new_fe_sfe_list
--where fe = 'Executive'
order by fe, sfe</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>48</xloc>
      <yloc>800</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Update #2 vertical</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema/>
      <table>position_description</table>
      <key>
        <name>VCJobID</name>
        <field>id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>vertical_id</name>
        <rename>VCIndustryID</rename>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2112</xloc>
      <yloc>32</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Update Language</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema/>
      <table>candidate</table>
      <key>
        <name>VCCandidateID</name>
        <field>id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>skill_details_json</name>
        <rename>language_json</rename>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>416</xloc>
      <yloc>1712</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Update available start</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema/>
      <table>candidate</table>
      <key>
        <name>VCCandidateID</name>
        <field>id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>availability_start</name>
        <rename>availability_start</rename>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>416</xloc>
      <yloc>1008</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Update cand nickname</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema/>
      <table>candidate</table>
      <key>
        <name>VCCandidateID</name>
        <field>id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>nickname</name>
        <rename>nickname</rename>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>416</xloc>
      <yloc>1168</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Update candidate source</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema/>
      <table>candidate</table>
      <key>
        <name>VCCandidateID</name>
        <field>id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>candidate_source_id</name>
        <rename>VCCandSourceID</rename>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1328</xloc>
      <yloc>1616</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Update education</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema/>
      <table>candidate</table>
      <key>
        <name>VCCandidateID</name>
        <field>id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>education_summary</name>
        <rename>education</rename>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1168</xloc>
      <yloc>1360</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Update fname lname</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema/>
      <table>candidate</table>
      <key>
        <name>VCCandidateID</name>
        <field>id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>first_name</name>
        <rename>candidate-firstName</rename>
      </value>
      <value>
        <name>last_name</name>
        <rename>candidate-lastName</rename>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>416</xloc>
      <yloc>1264</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Update from/to</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema/>
      <table>compensation</table>
      <key>
        <name>VCJobID</name>
        <field>position_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>annual_salary_from</name>
        <rename>salaryfrom</rename>
      </value>
      <value>
        <name>annual_salary_to</name>
        <rename>salaryto</rename>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1936</xloc>
      <yloc>112</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Update gender title</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema/>
      <table>contact</table>
      <key>
        <name>VCContactID</name>
        <field>id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>gender_title</name>
        <rename>title</rename>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1184</xloc>
      <yloc>192</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Update nickname</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema/>
      <table>contact</table>
      <key>
        <name>VCContactID</name>
        <field>id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>nick_name</name>
        <rename>nick_name</rename>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1184</xloc>
      <yloc>112</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Update open-close</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema/>
      <table>position_description</table>
      <key>
        <name>VCJobID</name>
        <field>id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>head_count_open_date</name>
        <rename>startdate</rename>
      </value>
      <value>
        <name>head_count_close_date</name>
        <rename>enddate</rename>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1936</xloc>
      <yloc>192</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Update passport</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema/>
      <table>candidate</table>
      <key>
        <name>VCCandidateID</name>
        <field>id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>passport_no</name>
        <rename>passport</rename>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1168</xloc>
      <yloc>1264</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Update reg date</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema/>
      <table>candidate</table>
      <key>
        <name>VCCandidateID</name>
        <field>id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>insert_timestamp</name>
        <rename>reg_date</rename>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>416</xloc>
      <yloc>912</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Update reg_date</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema/>
      <table>company</table>
      <key>
        <name>VCCompanyID</name>
        <field>id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>insert_timestamp</name>
        <rename>reg_date</rename>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>496</xloc>
      <yloc>112</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Update reg_date 2</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema/>
      <table>contact</table>
      <key>
        <name>VCContactID</name>
        <field>id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>insert_timestamp</name>
        <rename>reg_date</rename>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1184</xloc>
      <yloc>32</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Update website</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema/>
      <table>candidate</table>
      <key>
        <name>VCCandidateID</name>
        <field>id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>website</name>
        <rename>website</rename>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>416</xloc>
      <yloc>1088</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Update work history</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema/>
      <table>candidate</table>
      <key>
        <name>VCCandidateID</name>
        <field>id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>experience</name>
        <rename>work_history</rename>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1168</xloc>
      <yloc>1168</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>User join</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <rowlimit>0</rowlimit>
    <sql>select case when id is NULL then -10
		else id end as vc_user_id
, name as vc_user_name
, email as vc_user_email
from user_account
where 1=1
and deleted_timestamp is NULL
--and locked_user = 0
and lower(email) = ?</sql>
    <outer_join>Y</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>user_email</name>
        <type>String</type>
      </field>
    </parameter>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>352</xloc>
      <yloc>304</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>User join 2</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <rowlimit>0</rowlimit>
    <sql>select case when id is NULL then -10
		else id end as vc_user_account_id
, name as vc_user_name
, email as vc_user_email
from user_account
where 1=1
and deleted_timestamp is NULL
--and locked_user = 0
and lower(email) = ?</sql>
    <outer_join>Y</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>user_email</name>
        <type>String</type>
      </field>
    </parameter>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1728</xloc>
      <yloc>992</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>VC company_industry</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <commit>1000</commit>
    <update_bypassed>Y</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>company_industry</table>
      <key>
        <name>VCParentID</name>
        <field>industry_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>VCCompanyID</name>
        <field>company_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>industry_id</name>
        <rename>VCParentID</rename>
        <update>Y</update>
      </value>
      <value>
        <name>company_id</name>
        <rename>VCCompanyID</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>496</xloc>
      <yloc>464</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Website</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>select uniqueid as cand_ext_id
, "118 web add alphanumeric" as website
from f01
where 1=1
and "101 candidate codegroup  23" = 'Y'
and nullif("118 web add alphanumeric", 'www.') is not NULL</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>48</xloc>
      <yloc>1088</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Work history (format)</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>with 

--EMPLOYMENT WORK HISTORY
work_history as (select f04.uniqueid
	, "1 candidate xref" as person_id
	, "4 from date"
	, to_date(nullif(regexp_replace(regexp_replace("4 from date", '[^0-9]+/', ''), '[[:alpha:]]+\W', '', 'g'), ' '), 'DD/MM/YY') as from_date --due to invalid date
	, "5 to date"
	, to_date(nullif(regexp_replace(regexp_replace("5 to date", '[^0-9]+/', ''), '[[:alpha:]]+\W', '', 'g'), ' '), 'DD/MM/YY') as to_date --due to invalid date
	, "2 company xref"
	, case when "2 company xref" = f02.uniqueid then f02."1 name alphanumeric"
			else "2 company xref" end as employer
	, "6 position alphanumeric" as job_title
	, row_number() over(partition by "1 candidate xref"
				order by to_date("5 to date", 'DD/MM/YY') desc, to_date("4 from date", 'DD/MM/YY') desc
				, case "20 status codegroup   7"
						when 'C' then 1
						when 'F' then 2
						when 'P' then 3
						when 'U' then 4 end asc) as rn
	, "13 type codegroup  46"
	, c46.description as emp_type
	, "20 status codegroup   7"
	, c7.description as emp_status
	, "10 salary numeric" as salary
	from f04
	left join f02 on f02.uniqueid = f04."2 company xref" --get company name if using uniqueid
	left join (select * from codes where codegroup = '46') c46 on c46.code = f04."13 type codegroup  46"
	left join (select * from codes where codegroup = '7') c7 on c7.code = f04."20 status codegroup   7"
	where 1=1
	--and ("4 from date" ilike '%An%' or "5 to date" ilike '%An%')
	--and "1 candidate xref" = '80810101A1848080'
	)
	
, person_wh as (select *
	, row_number() over(partition by person_id
											order by to_date desc, from_date desc
										, case "20 status codegroup   7"
											when 'C' then 1
											when 'F' then 2
											when 'P' then 3
											when 'U' then 4 end asc) as person_wh_rn
	from work_history
	where employer is not NULL and job_title is not NULL
	) --select * from person_wh where person_id = '8081010180968080'
	
, wh_summary as (select person_id
	, string_agg(concat_ws('&lt;br/>'
			, ('From date: ' || from_date), ('To date: ' || to_date), ('Employer: ' || employer), ('Job title: ' || job_title), ('Salary: ' || salary)
			, ('Type: ' || emp_type), ('Status: ' || emp_status))
			, '&lt;br/>&lt;br/>' order by rn) as person_wh
	from work_history
	group by person_id)

	
--MAIN SCRIPT
select c.uniqueid as cand_ext_id
, wh.person_wh as work_history
from f01 c
left join wh_summary wh on wh.person_id = c.uniqueid
where 1=1
and c."101 candidate codegroup  23" = 'Y'
--and "1 name alphanumeric" ilike '%Eduardo%Cano%' --test candidate
--and c."4 ref no numeric" = '2891'
and wh.person_wh is not NULL</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>816</xloc>
      <yloc>1168</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>company industry</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>with industry as (select sub.uniqueid
, sub."1 attribute alphanumeric" as sub_type
, case sub."11 rootkey codegroup  58"
		when 'A' then 'Skills'
		when 'B' then 'Industry'
		when 'C' then 'Categories'
		end as code_type
, sub."2 parent xref"
, main."1 attribute alphanumeric" as main_type
from f12 sub
left join f12 main on main.uniqueid = sub."2 parent xref"
where 1=1
--and main."2 parent xref" is NULL --combination with codegroup
and main."11 rootkey codegroup  58" = 'B' --Industry
--and main."11 rootkey codegroup  58" = 'A' --Skills
--and main."11 rootkey codegroup  58" = 'C' --Categories
--and main."11 rootkey codegroup  58" in ('A', 'B', 'C')
--and main."11 rootkey codegroup  58" not in ('A', 'B', 'C') --Other types
--and sub."2 parent xref" is not NULL --checking hierachy mapping
order by main."1 attribute alphanumeric", sub."1 attribute alphanumeric"
)

, company_industry as (select uniqueid
	, "99 industry xref"
	, a.industry
	, a.splitrn
	from f02, unnest(string_to_array("99 industry xref", '~')) with ordinality as a(industry, splitrn)
	where 1=1
	and "99 industry xref" is not NULL
	)

select pi.uniqueid as com_ext_id
, pi.industry
, i.sub_type as final_industry
from company_industry pi
left join industry i on i.uniqueid = pi.industry
where i.sub_type is not NULL</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>48</xloc>
      <yloc>464</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>contact lookup</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>contact</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>con_ext_id</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCContactID</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1008</xloc>
      <yloc>464</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>contact lookup 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>contact</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>con_ext_id</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCContactID</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1008</xloc>
      <yloc>112</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>contact lookup 3</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>contact</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>con_ext_id</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCContactID</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1008</xloc>
      <yloc>368</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>contact lookup 4</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>contact</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>con_ext_id</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCContactID</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>992</xloc>
      <yloc>1840</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>email_subscription</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <commit>100</commit>
    <update_bypassed>Y</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>email_subscription</table>
      <key>
        <name>candidate-email</name>
        <field>email</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>email</name>
        <rename>candidate-email</rename>
        <update>Y</update>
      </value>
      <value>
        <name>subscribed</name>
        <rename>email_subscription</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>416</xloc>
      <yloc>1616</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>lookup company</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>company</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>com_ext_id</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCCompanyID</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>192</xloc>
      <yloc>464</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>lookup industry</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>vertical</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>final_industry</name>
        <field>name</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCParentID</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>352</xloc>
      <yloc>464</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>mobile</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema/>
      <table>contact</table>
      <key>
        <name>VCContactID</name>
        <field>id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>mobile_phone</name>
        <rename>mobile</rename>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1184</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>update met_not_met</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <key>
        <name>VCCandidateID</name>
        <field>id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>status</name>
        <rename>met_notmet</rename>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>416</xloc>
      <yloc>1808</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Contact physical doc</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>select *
from contact_physical_doc</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1328</xloc>
      <yloc>1840</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Tmp contact doc</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <schema/>
    <table>mike_temp_contact_doc</table>
    <commit>100</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>file_id</column_name>
        <stream_name>file_id</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1520</xloc>
      <yloc>1840</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Candidate category</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>--PERSON CATEGORY
with person_category as (select uniqueid
	, "127 job cat codegroup  24"
	, a.category
	, a.splitrn
	from f01, unnest(string_to_array("127 job cat codegroup  24", '~')) with ordinality as a(category, splitrn)
	where 1=1
	and "127 job cat codegroup  24" is not NULL
	and "101 candidate codegroup  23" = 'Y' --candidate filter
	)

select distinct pc.uniqueid as cand_ext_id
, pc.category
, c.description as final_category
from person_category pc
left join (select * from codes where codegroup = '24') c on c.code = pc.category
--order by pc.uniqueid
</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>48</xloc>
      <yloc>2144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>FE lookup 3</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema/>
      <table>functional_expertise</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>final_category</name>
        <field>name</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCFEID</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>416</xloc>
      <yloc>2144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert candidate FESFE</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <schema/>
    <table>candidate_functional_expertise</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>candidate_id</column_name>
        <stream_name>VCCandidateID</stream_name>
      </field>
      <field>
        <column_name>functional_expertise_id</column_name>
        <stream_name>VCFEID</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>592</xloc>
      <yloc>2144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Candidate lookup 7</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema/>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>cand_ext_id</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCCandidateID</rename>
        <default/>
        <type>BigNumber</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>224</xloc>
      <yloc>2144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Job category</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>with job_category as (select uniqueid
	, "100 job cat codegroup  24"
	, a.category
	, a.splitrn
	from f03, unnest(string_to_array("100 job cat codegroup  24", '~')) with ordinality as a(category, splitrn)
	where "100 job cat codegroup  24" is not NULL
	)
	
select distinct jc.uniqueid as job_ext_id
, jc.category
, c.description as final_category
from job_category jc
left join (select * from codes where codegroup = '24') c on c.code = jc.category
where c.description is not NULL
order by jc.uniqueid</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1600</xloc>
      <yloc>368</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>FE lookup 4</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema/>
      <table>functional_expertise</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>final_category</name>
        <field>name</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCFEID</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1936</xloc>
      <yloc>368</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert job FESFE</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <schema/>
    <table>position_description_functional_expertise</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>position_id</column_name>
        <stream_name>VCJobID</stream_name>
      </field>
      <field>
        <column_name>functional_expertise_id</column_name>
        <stream_name>VCFEID</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2112</xloc>
      <yloc>368</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Job lookup 4</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>position_description</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>job_ext_id</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCJobID</rename>
        <default/>
        <type>Number</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1776</xloc>
      <yloc>368</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>VC candidate industry</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <commit>1000</commit>
    <update_bypassed>Y</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>candidate_industry</table>
      <key>
        <name>VCParentID</name>
        <field>vertical_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>VCCandidateID</name>
        <field>candidate_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>vertical_id</name>
        <rename>VCParentID</rename>
        <update>Y</update>
      </value>
      <value>
        <name>candidate_id</name>
        <rename>VCCandidateID</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>592</xloc>
      <yloc>2240</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Candidate industry</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>with industry as (select sub.uniqueid
, sub."1 attribute alphanumeric" as sub_type
, case sub."11 rootkey codegroup  58"
		when 'A' then 'Skills'
		when 'B' then 'Industry'
		when 'C' then 'Categories'
		end as code_type
, sub."2 parent xref"
, main."1 attribute alphanumeric" as main_type
from f12 sub
left join f12 main on main.uniqueid = sub."2 parent xref"
where 1=1
--and main."2 parent xref" is NULL --combination with codegroup
and main."11 rootkey codegroup  58" = 'B' --Industry
--and main."11 rootkey codegroup  58" = 'A' --Skills
--and main."11 rootkey codegroup  58" = 'C' --Categories
--and main."11 rootkey codegroup  58" in ('A', 'B', 'C')
--and main."11 rootkey codegroup  58" not in ('A', 'B', 'C') --Other types
--and sub."2 parent xref" is not NULL --checking hierachy mapping
order by main."1 attribute alphanumeric", sub."1 attribute alphanumeric"
)

, person_industry as (select uniqueid
	, "187 industry xref"
	, a.industry
	, a.splitrn
	from f01, unnest(string_to_array("187 industry xref", '~')) with ordinality as a(industry, splitrn)
	where 1=1
	and "187 industry xref" is not NULL
	and "101 candidate codegroup  23" = 'Y' --candidate filter
	)


select pi.uniqueid as cand_ext_id
, pi.industry
, i.sub_type as final_industry
from person_industry pi
left join industry i on i.uniqueid = pi.industry</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>48</xloc>
      <yloc>2240</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>lookup industry 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>vertical</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>final_industry</name>
        <field>name</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCParentID</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>416</xloc>
      <yloc>2240</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Candidate lookup 10</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema/>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>cand_ext_id</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>VCCandidateID</rename>
        <default/>
        <type>BigNumber</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>224</xloc>
      <yloc>2240</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Cand note</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from DB</connection>
    <sql>--MAIN SCRIPT
select c.uniqueid as cand_ext_id
, concat_ws('&lt;br/>'
	, ('Reference number: ' || c."4 ref no numeric")
	, coalesce('Status: ' || nullif(c4.description, ''), NULL)
	, coalesce('Internal Interview date: ' || nullif(c."31 intvw date date", ''), NULL) --added 2021-02-24
	, coalesce('Created: ' || c."28 created date", NULL)
	, coalesce('Created by: ' || f17."1 name alphanumeric" || ' - ' || f17."72 email add alphanumeric", NULL)
	, coalesce('Updated: ' || c."29 updated date", NULL)
	, coalesce('Updated by: ' || u2."1 name alphanumeric" || ' - ' || u2."72 email add alphanumeric", NULL)
	, coalesce('Last contact date: ' || c."41 last cont date", NULL)
	) as note
from f01 c
left join (select * from codes where codegroup = '4') c4 on c4.code = c."3 status codegroup   4"
left join f17 on f17.uniqueid = c."62 created by xref"
left join f17 u2 on u2.uniqueid = c."37 updated by xref"
where 1=1
and c."101 candidate codegroup  23" = 'Y'</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>48</xloc>
      <yloc>2064</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Update candidate note</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to EU</connection>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema/>
      <table>candidate</table>
      <key>
        <name>VCCandidateID</name>
        <field>id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>note</name>
        <rename>note</rename>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>416</xloc>
      <yloc>2064</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step_error_handling>
  </step_error_handling>
  <slave-step-copy-partition-distribution>
  </slave-step-copy-partition-distribution>
  <slave_transformation>N</slave_transformation>
</transformation>
