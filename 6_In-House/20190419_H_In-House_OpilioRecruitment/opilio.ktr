<?xml version="1.0" encoding="UTF-8"?>
<transformation>
  <info>
    <name>opilio</name>
    <description/>
    <extended_description/>
    <trans_version/>
    <trans_type>Normal</trans_type>
    <trans_status>0</trans_status>
    <directory>&#x2f;</directory>
    <parameters>
    </parameters>
    <log>
      <trans-log-table>
        <connection/>
        <schema/>
        <table/>
        <size_limit_lines/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
          <subject/>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
          <subject/>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
          <subject/>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
          <subject/>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </trans-log-table>
      <perf-log-table>
        <connection/>
        <schema/>
        <table/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>SEQ_NR</id>
          <enabled>Y</enabled>
          <name>SEQ_NR</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>INPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>INPUT_BUFFER_ROWS</name>
        </field>
        <field>
          <id>OUTPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>OUTPUT_BUFFER_ROWS</name>
        </field>
      </perf-log-table>
      <channel-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
      <step-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
      </step-log-table>
      <metrics-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>METRICS_DATE</id>
          <enabled>Y</enabled>
          <name>METRICS_DATE</name>
        </field>
        <field>
          <id>METRICS_CODE</id>
          <enabled>Y</enabled>
          <name>METRICS_CODE</name>
        </field>
        <field>
          <id>METRICS_DESCRIPTION</id>
          <enabled>Y</enabled>
          <name>METRICS_DESCRIPTION</name>
        </field>
        <field>
          <id>METRICS_SUBJECT</id>
          <enabled>Y</enabled>
          <name>METRICS_SUBJECT</name>
        </field>
        <field>
          <id>METRICS_TYPE</id>
          <enabled>Y</enabled>
          <name>METRICS_TYPE</name>
        </field>
        <field>
          <id>METRICS_VALUE</id>
          <enabled>Y</enabled>
          <name>METRICS_VALUE</name>
        </field>
      </metrics-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file/>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
    <created_user>-</created_user>
    <created_date>2019&#x2f;04&#x2f;11 18&#x3a;15&#x3a;38.161</created_date>
    <modified_user>-</modified_user>
    <modified_date>2019&#x2f;04&#x2f;11 18&#x3a;15&#x3a;38.161</modified_date>
    <key_for_session_key>H4sIAAAAAAAAAAMAAAAAAAAAAAA&#x3d;</key_for_session_key>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
    <notepad>
      <note>Company</note>
      <xloc>192</xloc>
      <yloc>16</yloc>
      <width>62</width>
      <heigth>26</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>Contact</note>
      <xloc>752</xloc>
      <yloc>16</yloc>
      <width>53</width>
      <heigth>26</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>Candidate</note>
      <xloc>1556</xloc>
      <yloc>21</yloc>
      <width>65</width>
      <heigth>26</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
  </notepads>
  <connection>
    <name>prod_db</name>
    <server>rdbm</server>
    <type>POSTGRESQL</type>
    <access>Native</access>
    <database>opilio.vincere.io</database>
    <port>5432</port>
    <username>hoa</username>
    <password>Encrypted 2be98afc86aa7f2e4801cab22db81a6d0</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>5432</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>Y</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>source</name>
    <server>localhost</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>opilio</database>
    <port>3306</port>
    <username>root</username>
    <password>Encrypted 2be98afc86aa7f2e4cb79ff228d83b8df</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>EXTRA_OPTION_MYSQL.defaultFetchSize</code><attribute>500</attribute></attribute>
      <attribute><code>EXTRA_OPTION_MYSQL.useCursorFetch</code><attribute>true</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>3306</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>Y</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>STREAM_RESULTS</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <order>
    <hop>
      <from>company_address</from>
      <to>Database lookup</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Database lookup</from>
      <to>insert_company_address</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Database lookup 2</from>
      <to>insert_company_activity</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>company_activity</from>
      <to>Database lookup 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>FE</from>
      <to>Insert FE</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>fe_lookup</from>
      <to>insert_sub_FE</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>sub_FE</from>
      <to>fe_lookup</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Database lookup 5</from>
      <to>fe_lookup 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>contact_FE_no_sub_FE</from>
      <to>Database lookup 5</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>contact_FE_sub_FE</from>
      <to>Database lookup 5</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>fe_lookup 2 2</from>
      <to>insert_contact_FE_no_sub_fe</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>fe_lookup 2 2</from>
      <to>sub_fe_lookup 2 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>sub_fe_lookup 2 2 2</from>
      <to>insert_contact_FE 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Database lookup 2 2</from>
      <to>insert_candidate_activity</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>candidate_activity</from>
      <to>Database lookup 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Database lookup 3</from>
      <to>update_contact_mobile</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>contact_mobile</from>
      <to>Database lookup 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>candidate_edu</from>
      <to>Database lookup 2 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Database lookup 2 2 2</from>
      <to>update_candidate_edu</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Database lookup 2 2 2 2</from>
      <to>update_candidate_skills</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>candidate_skills</from>
      <to>Database lookup 2 2 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Database lookup 5 2</from>
      <to>fe_lookup 2 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>contact_FE_no_sub_FE 2</from>
      <to>Database lookup 5 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>candidate_FE_sub_FE</from>
      <to>Database lookup 5 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>fe_lookup 2 2 2</from>
      <to>insert_contact_FE_no_sub_fe 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>fe_lookup 2 2 2</from>
      <to>sub_fe_lookup 2 2 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>sub_fe_lookup 2 2 2 2</from>
      <to>insert_candidate_FE_sub_FE</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Database lookup 2 2 2 2 2</from>
      <to>update_candidate_keywords</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>candidate_keywords</from>
      <to>Database lookup 2 2 2 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Database lookup 2 2 2 2 2 2</from>
      <to>update_candidate_work_history</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>candidate_work_history</from>
      <to>Database lookup 2 2 2 2 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>company_registration</from>
      <to>Database lookup 4</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Database lookup 4</from>
      <to>insert_update_company_registration_date</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Database lookup 2 2 2 3</from>
      <to>update_candidate_note</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>candidate_note</from>
      <to>Database lookup 2 2 2 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Database lookup 4 2 2</from>
      <to>insert_candidate_document</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>candidate_document</from>
      <to>Database lookup 4 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Database lookup 2 2 2 3 2</from>
      <to>update_candidate_nationality</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>candidate_nationality</from>
      <to>Database lookup 2 2 2 3 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Database lookup 2 2 2 2 2 2 2</from>
      <to>update_candidate_current_position</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>candidate_current_position</from>
      <to>Database lookup 2 2 2 2 2 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Database lookup 2 2 2 4</from>
      <to>update_candidate_edu 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>candidate_edu 2</from>
      <to>Database lookup 2 2 2 4</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Database lookup 2 2 2 3 3</from>
      <to>update_candidate_salary</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>candidate_salary</from>
      <to>Database lookup 2 2 2 3 3</to>
      <enabled>N</enabled>
    </hop>
  </order>
  <step>
    <name>Database lookup</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>company</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>company_id</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>actual_company_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>240</xloc>
      <yloc>160</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Database lookup 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>company</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>company_id</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>actual_company_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>240</xloc>
      <yloc>304</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Database lookup 2 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>candidate_id</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>actual_candidate_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1552</xloc>
      <yloc>80</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Database lookup 2 2 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>candidate_id</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>actual_candidate_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1552</xloc>
      <yloc>160</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Database lookup 2 2 2 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>candidate_id</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>actual_candidate_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1568</xloc>
      <yloc>352</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Database lookup 2 2 2 2 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>candidate_id</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>actual_candidate_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1568</xloc>
      <yloc>448</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Database lookup 2 2 2 2 2 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>candidate_id</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>actual_candidate_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1568</xloc>
      <yloc>544</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Database lookup 2 2 2 2 2 2 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>candidate_id</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>actual_candidate_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1584</xloc>
      <yloc>1072</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Database lookup 2 2 2 3</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>candidate_id</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>actual_candidate_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1568</xloc>
      <yloc>256</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Database lookup 2 2 2 3 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>candidate_id</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>actual_candidate_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1584</xloc>
      <yloc>976</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Database lookup 3</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>contact</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>contact_id</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>actual_contact_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>864</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Database lookup 4</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>company</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>company_id</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>actual_company_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>240</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Database lookup 4 2 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>candidate_id</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>actual_candidate_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1600</xloc>
      <yloc>896</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Database lookup 5</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>contact</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>contact_id</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>actual_contact_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>832</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Database lookup 5 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>candidate_id</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>actual_candidate_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1504</xloc>
      <yloc>640</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>FE</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>source</connection>
    <sql>SELECT&#xd;&#xa;	id,&#xd;&#xa;	jobFunction sub_functional_expertise,&#xd;&#xa;	type functional_expertise,&#xd;&#xa;	CURRENT_TIMESTAMP insert_timestamp&#xd;&#xa;	FROM &#x60;alpha_sel_job_function&#x60;&#xd;&#xa;	WHERE type IN &#x28;&#x27;Marketing&#x27;, &#x27;Project Management&#x27;, &#x27;Sales&#x27;&#x29;&#xd;&#xa;	AND jobFunction IN &#x28;&#x27;Ad Operations&#x27;, &#x27;Brand Marketing&#x27;, &#x27;Category Manager&#x27;, &#x27;Chief Marketing Officer&#x27;, &#x27;Communications &#x26; PR&#x27;, &#xd;&#xa;												&#x27;CRM&#x27;, &#x27;Digital Marketing&#x27;, &#x27;eCommerce&#x27;, &#x27;Insight &#x26; Analytics&#x27;, &#x27;Marketing Events&#x27;,&#xd;&#xa;												&#x27;Media Planning &#x2f; Buying&#x27;, &#x27;PPC&#x27;, &#x27;SEO&#x27;, &#x27;Social Media&#x27;, &#x27;Business Analysts&#x27;,&#xd;&#xa;												&#x27;Chief Digital Officer&#x27;, &#x27;Digital Project Manager&#x27;, &#x27;Events Manager&#x27;, &#x27;IT Programme Manager&#x27;, &#x27;IT Project Manager&#x27;, &#xd;&#xa;												&#x27;PMO Analyst&#x27;, &#x27;PMO Assurance&#x27;, &#x27;Product Developer&#x27;, &#x27;Product Manager&#x27;, &#x27;Project Administrator&#x27;,&#xd;&#xa;												&#x27;Project Director&#x27;, &#x27;Project Manager&#x27;, &#x27;Project Resource Planner&#x27;, &#x27;Project Support&#x2f;Co-ordinator&#x27;, &#x27;Risk Manager&#x27;,&#xd;&#xa;												&#x27;Transformation and Change Manager&#x27;, &#x27;COO&#x27;, &#x27;MD &#x2f; CEO &#x2f; VP&#x27;&#x29;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>672</xloc>
      <yloc>128</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Insert FE</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>functional_expertise</table>
      <key>
        <name>functional_expertise</name>
        <field>name</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>id</name>
        <field>id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>name</name>
        <rename>functional_expertise</rename>
        <update>Y</update>
      </value>
      <value>
        <name>id</name>
        <rename>id</rename>
        <update>Y</update>
      </value>
      <value>
        <name>insert_timestamp</name>
        <rename>insert_timestamp</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>848</xloc>
      <yloc>128</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>candidate_FE_sub_FE</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>source</connection>
    <sql>WITH functional_expertise AS &#x28;&#xd;&#xa;	SELECT&#xd;&#xa;	id,&#xd;&#xa;	jobFunction sub_functional_expertise,&#xd;&#xa;	type functional_expertise&#xd;&#xa;	FROM &#x60;alpha_sel_job_function&#x60;&#xd;&#xa;	WHERE type IN &#x28;&#x27;Marketing&#x27;, &#x27;Project Management&#x27;, &#x27;Sales&#x27;&#x29;&#xd;&#xa;	AND jobFunction IN &#x28;&#x27;Ad Operations&#x27;, &#x27;Brand Marketing&#x27;, &#x27;Category Manager&#x27;, &#x27;Chief Marketing Officer&#x27;, &#x27;Communications &#x26; PR&#x27;, &#xd;&#xa;												&#x27;CRM&#x27;, &#x27;Digital Marketing&#x27;, &#x27;eCommerce&#x27;, &#x27;Insight &#x26; Analytics&#x27;, &#x27;Marketing Events&#x27;,&#xd;&#xa;												&#x27;Media Planning &#x2f; Buying&#x27;, &#x27;PPC&#x27;, &#x27;SEO&#x27;, &#x27;Social Media&#x27;, &#x27;Business Analysts&#x27;,&#xd;&#xa;												&#x27;Chief Digital Officer&#x27;, &#x27;Digital Project Manager&#x27;, &#x27;Events Manager&#x27;, &#x27;IT Programme Manager&#x27;, &#x27;IT Project Manager&#x27;, &#xd;&#xa;												&#x27;PMO Analyst&#x27;, &#x27;PMO Assurance&#x27;, &#x27;Product Developer&#x27;, &#x27;Product Manager&#x27;, &#x27;Project Administrator&#x27;,&#xd;&#xa;												&#x27;Project Director&#x27;, &#x27;Project Manager&#x27;, &#x27;Project Resource Planner&#x27;, &#x27;Project Support&#x2f;Co-ordinator&#x27;, &#x27;Risk Manager&#x27;,&#xd;&#xa;												&#x27;Transformation and Change Manager&#x27;, &#x27;COO&#x27;, &#x27;MD &#x2f; CEO &#x2f; VP&#x27;&#x29;&#xd;&#xa;&#x29;,&#xd;&#xa;candidate_position AS &#x28;&#xd;&#xa;	SELECT&#xd;&#xa;	c.person_id candidate_id,&#xd;&#xa;	p.jobFunction_id fe_id,&#xd;&#xa;	ROW_NUMBER&#x28;&#x29; OVER&#x28;PARTITION BY c.person_id, p.jobFunction_id ORDER BY c.person_id&#x29; rn&#xd;&#xa;	FROM alpha_candidate c&#xd;&#xa;	LEFT JOIN alpha_position p ON c.person_id &#x3d; p.person_id&#xd;&#xa;	WHERE p.jobFunction_id IS NOT NULL&#xd;&#xa;&#x29;&#xd;&#xa;&#xd;&#xa;SELECT&#xd;&#xa;candidate_id,&#xd;&#xa;sub_functional_expertise,&#xd;&#xa;functional_expertise&#xd;&#xa;FROM candidate_position cp&#xd;&#xa;JOIN functional_expertise fe ON cp.fe_id &#x3d; fe.id&#xd;&#xa;WHERE rn &#x3d; 1</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1280</xloc>
      <yloc>640</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>candidate_activity</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>source</connection>
    <sql>SELECT&#xd;&#xa;a.candidate_id,&#xd;&#xa;CONCAT_WS&#x28;&#xd;&#xa;	CHAR&#x28;10&#x29;,&#xd;&#xa;	CASE WHEN NULLIF&#x28;category, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Category&#x3a; &#x27;, category&#x29; END,&#xd;&#xa;	CASE WHEN NULLIF&#x28;type, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Type&#x3a; &#x27;, type&#x29; END,&#xd;&#xa;	CASE WHEN NULLIF&#x28;stage, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Stage&#x3a; &#x27;, stage&#x29; END,&#xd;&#xa;	CASE WHEN NULLIF&#x28;start, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Start date&#x3a; &#x27;, start&#x29; END,&#xd;&#xa;	CASE WHEN NULLIF&#x28;end, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;End date&#x3a; &#x27;, end&#x29; END,&#xd;&#xa;	CASE WHEN NULLIF&#x28;status, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Status&#x3a; &#x27;, status&#x29; END,&#xd;&#xa;	CASE WHEN NULLIF&#x28;jo.roleTitle, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Job opening&#x3a; &#x27;, roleTitle&#x29; END,&#xd;&#xa;	CASE WHEN NULLIF&#x28;comments, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Comment&#x3a; &#x27;, comments&#x29; END&#xd;&#xa;&#x29; content,&#xd;&#xa;COALESCE&#x28;a.created, CURRENT_TIMESTAMP&#x29; inserted_timestamp,&#xd;&#xa;-10 as user_account_id,&#xd;&#xa;&#x27;comment&#x27; as &#x27;category&#x27;,&#xd;&#xa;&#x27;candidate&#x27; as &#x27;type&#x27;&#xd;&#xa;&#xd;&#xa;FROM alpha_activity a&#xd;&#xa;LEFT JOIN alpha_job_opening jo ON a.jobOpening_id &#x3d; jo.id</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1408</xloc>
      <yloc>80</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>candidate_current_position</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>source</connection>
    <sql>WITH work_history AS &#x28;&#xd;&#xa;	SELECT&#xd;&#xa;		profile_id,&#xd;&#xa;		title job_title,&#xd;&#xa;		orgName company_name,&#xd;&#xa;		partialStartDate,&#xd;&#xa;		startDate,&#xd;&#xa;		ROW_NUMBER&#x28;&#x29; OVER&#x28;PARTITION BY profile_id ORDER BY profile_id&#x29; rn&#xd;&#xa;	FROM alpha_cv_employment&#xd;&#xa;&#x29;,&#xd;&#xa;current_position AS &#x28;&#xd;&#xa;	SELECT&#xd;&#xa;		profile_id,&#xd;&#xa;		CONCAT&#x28;&#xd;&#xa;			CASE&#xd;&#xa;				WHEN job_title IS NOT NULL OR company_name IS NOT NULL&#xd;&#xa;				THEN CONCAT&#x28;&#x27;&#x5b;&#x27;, json_object&#x28;&#x27;jobTitle&#x27;, COALESCE&#x28;job_title, &#x27;&#x27;&#x29;, &#x27;currentEmployer&#x27;, COALESCE&#x28;company_name, &#x27;&#x27;&#x29;, &#x27;dateRangeFrom&#x27;, &#x27;&#x27;, &#x27;dateRangeTo&#x27;, &#x27;&#x27;&#x29;, &#x27;&#x5d;&#x27;&#x29;&#xd;&#xa;			END&#xd;&#xa;		&#x29; AS data&#xd;&#xa;	FROM work_history&#xd;&#xa;	WHERE rn &#x3d; 1&#xd;&#xa;&#x29;&#xd;&#xa;SELECT&#xd;&#xa;c.person_id AS candidate_id,&#xd;&#xa;data&#xd;&#xa;FROM alpha_candidate c&#xd;&#xa;JOIN current_position cp ON c.cvProfile_id &#x3d; cp.profile_id</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1424</xloc>
      <yloc>1072</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>candidate_document</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>source</connection>
    <sql>WITH functional_expertise AS &#x28;&#xd;&#xa;	SELECT&#xd;&#xa;	id,&#xd;&#xa;	jobFunction sub_functional_expertise,&#xd;&#xa;	type functional_expertise&#xd;&#xa;	FROM &#x60;alpha_sel_job_function&#x60;&#xd;&#xa;	WHERE type IN &#x28;&#x27;Marketing&#x27;, &#x27;Project Management&#x27;, &#x27;Sales&#x27;&#x29;&#xd;&#xa;	AND jobFunction IN &#x28;&#x27;Ad Operations&#x27;, &#x27;Brand Marketing&#x27;, &#x27;Category Manager&#x27;, &#x27;Chief Marketing Officer&#x27;, &#x27;Communications &#x26; PR&#x27;, &#xd;&#xa;												&#x27;CRM&#x27;, &#x27;Digital Marketing&#x27;, &#x27;eCommerce&#x27;, &#x27;Insight &#x26; Analytics&#x27;, &#x27;Marketing Events&#x27;,&#xd;&#xa;												&#x27;Media Planning &#x2f; Buying&#x27;, &#x27;PPC&#x27;, &#x27;SEO&#x27;, &#x27;Social Media&#x27;, &#x27;Business Analysts&#x27;,&#xd;&#xa;												&#x27;Chief Digital Officer&#x27;, &#x27;Digital Project Manager&#x27;, &#x27;Events Manager&#x27;, &#x27;IT Programme Manager&#x27;, &#x27;IT Project Manager&#x27;, &#xd;&#xa;												&#x27;PMO Analyst&#x27;, &#x27;PMO Assurance&#x27;, &#x27;Product Developer&#x27;, &#x27;Product Manager&#x27;, &#x27;Project Administrator&#x27;,&#xd;&#xa;												&#x27;Project Director&#x27;, &#x27;Project Manager&#x27;, &#x27;Project Resource Planner&#x27;, &#x27;Project Support&#x2f;Co-ordinator&#x27;, &#x27;Risk Manager&#x27;,&#xd;&#xa;												&#x27;Transformation and Change Manager&#x27;, &#x27;COO&#x27;, &#x27;MD &#x2f; CEO &#x2f; VP&#x27;&#x29;&#xd;&#xa;&#x29;,&#xd;&#xa;candidate_position AS &#x28;&#xd;&#xa;	SELECT&#xd;&#xa;	c.person_id candidate_id,&#xd;&#xa;	p.jobFunction_id fe_id,&#xd;&#xa;	ROW_NUMBER&#x28;&#x29; OVER&#x28;PARTITION BY c.person_id, p.jobFunction_id ORDER BY c.person_id&#x29; rn&#xd;&#xa;	FROM alpha_candidate c&#xd;&#xa;	LEFT JOIN alpha_position p ON c.person_id &#x3d; p.person_id&#xd;&#xa;	WHERE p.jobFunction_id IS NOT NULL&#xd;&#xa;&#x29;,&#xd;&#xa;candidate_fe AS &#x28;&#xd;&#xa;	SELECT DISTINCT candidate_id&#xd;&#xa;	FROM candidate_position cp&#xd;&#xa;	JOIN functional_expertise fe ON cp.fe_id &#x3d; fe.id&#xd;&#xa;	WHERE rn &#x3d; 1&#xd;&#xa;&#x29;&#xd;&#xa;&#xd;&#xa;SELECT&#xd;&#xa;	c.person_id candidate_id,&#xd;&#xa;	CONCAT&#x28;SUBSTRING_INDEX&#x28;SUBSTRING_INDEX&#x28;doc.path, &#x27;&#x2f;&#x27;, -1&#x29;, &#x27;_&#x27;, 2&#x29;, &#x27;_&#x27;, LPAD&#x28;doc.id, 10, &#x27;0&#x27;&#x29;, &#x27;_&#x27;, SUBSTRING_INDEX&#x28;doc.path,&#x27;_&#x27;,-1&#x29;&#x29; document,&#xd;&#xa;	&#x27;CANDIDATE&#x27; entity_type,&#xd;&#xa;	&#x27;resume&#x27; document_type&#xd;&#xa;FROM alpha_candidate c&#xd;&#xa;JOIN alpha_person p ON c.person_id &#x3d; p.id&#xd;&#xa;JOIN candidate_fe cf ON c.person_id &#x3d; cf.candidate_id&#xd;&#xa;LEFT JOIN &#x28;SELECT id, path FROM alpha_document WHERE type &#x3d; &#x27;origCv&#x27; AND path IS NOT NULL&#x29; doc ON origCv_id &#x3d; doc.id&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;UNION ALL&#xd;&#xa;&#xd;&#xa;SELECT&#xd;&#xa;	c.person_id candidate_id,&#xd;&#xa;	CONCAT&#x28;SUBSTRING_INDEX&#x28;SUBSTRING_INDEX&#x28;doc.path, &#x27;&#x2f;&#x27;, -1&#x29;, &#x27;_&#x27;, 2&#x29;, &#x27;_&#x27;, LPAD&#x28;doc.id, 10, &#x27;0&#x27;&#x29;, &#x27;_&#x27;, SUBSTRING_INDEX&#x28;doc.path,&#x27;_&#x27;,-1&#x29;&#x29; document,&#xd;&#xa;	&#x27;CANDIDATE&#x27; entity_type,&#xd;&#xa;	&#x27;resume&#x27; document_type&#xd;&#xa;FROM alpha_candidate c&#xd;&#xa;JOIN alpha_person p ON c.person_id &#x3d; p.id&#xd;&#xa;JOIN candidate_fe cf ON c.person_id &#x3d; cf.candidate_id&#xd;&#xa;LEFT JOIN &#x28;SELECT id, path FROM alpha_document WHERE type &#x3d; &#x27;formCv&#x27; AND path IS NOT NULL&#x29; doc ON formCv_id &#x3d; doc.id&#xd;&#xa;&#xd;&#xa;UNION ALL&#xd;&#xa;&#xd;&#xa;SELECT&#xd;&#xa;	c.person_id candidate_id,&#xd;&#xa;	CONCAT&#x28;SUBSTRING_INDEX&#x28;SUBSTRING_INDEX&#x28;doc.path, &#x27;&#x2f;&#x27;, -1&#x29;, &#x27;_&#x27;, 2&#x29;, &#x27;_&#x27;, LPAD&#x28;doc.id, 10, &#x27;0&#x27;&#x29;, &#x27;_&#x27;, SUBSTRING_INDEX&#x28;doc.path,&#x27;_&#x27;,-1&#x29;&#x29; document,&#xd;&#xa;	&#x27;CANDIDATE&#x27; entity_type,&#xd;&#xa;	&#x27;resume&#x27; document_type&#xd;&#xa;FROM alpha_candidate c&#xd;&#xa;JOIN alpha_person p ON c.person_id &#x3d; p.id&#xd;&#xa;JOIN candidate_fe cf ON c.person_id &#x3d; cf.candidate_id&#xd;&#xa;LEFT JOIN &#x28;SELECT id, path FROM alpha_document WHERE type &#x3d; &#x27;canReg&#x27; AND path IS NOT NULL&#x29; doc ON canReg_id &#x3d; doc.id&#xd;&#xa;&#xd;&#xa;UNION ALL&#xd;&#xa;&#xd;&#xa;SELECT&#xd;&#xa;	c.person_id candidate_id,&#xd;&#xa;	CONCAT&#x28;SUBSTRING_INDEX&#x28;SUBSTRING_INDEX&#x28;doc.path, &#x27;&#x2f;&#x27;, -1&#x29;, &#x27;_&#x27;, 2&#x29;, &#x27;_&#x27;, LPAD&#x28;doc.id, 10, &#x27;0&#x27;&#x29;, &#x27;_&#x27;, SUBSTRING_INDEX&#x28;doc.path,&#x27;_&#x27;,-1&#x29;&#x29; document,&#xd;&#xa;	&#x27;CANDIDATE&#x27; entity_type,&#xd;&#xa;	&#x27;resume&#x27; document_type&#xd;&#xa;FROM alpha_candidate c&#xd;&#xa;JOIN alpha_person p ON c.person_id &#x3d; p.id&#xd;&#xa;JOIN candidate_fe cf ON c.person_id &#x3d; cf.candidate_id&#xd;&#xa;LEFT JOIN &#x28;SELECT id, path FROM alpha_document WHERE type &#x3d; &#x27;docId1&#x27; AND path IS NOT NULL&#x29; doc ON docId1_id &#x3d; doc.id&#xd;&#xa;&#xd;&#xa;UNION ALL&#xd;&#xa;&#xd;&#xa;SELECT&#xd;&#xa;	c.person_id candidate_id,&#xd;&#xa;	CONCAT&#x28;SUBSTRING_INDEX&#x28;SUBSTRING_INDEX&#x28;doc.path, &#x27;&#x2f;&#x27;, -1&#x29;, &#x27;_&#x27;, 2&#x29;, &#x27;_&#x27;, LPAD&#x28;doc.id, 10, &#x27;0&#x27;&#x29;, &#x27;_&#x27;, SUBSTRING_INDEX&#x28;doc.path,&#x27;_&#x27;,-1&#x29;&#x29; document,&#xd;&#xa;	&#x27;CANDIDATE&#x27; entity_type,&#xd;&#xa;	&#x27;resume&#x27; document_type&#xd;&#xa;FROM alpha_candidate c&#xd;&#xa;JOIN alpha_person p ON c.person_id &#x3d; p.id&#xd;&#xa;JOIN candidate_fe cf ON c.person_id &#x3d; cf.candidate_id&#xd;&#xa;LEFT JOIN &#x28;SELECT id, path FROM alpha_document WHERE type &#x3d; &#x27;docId2&#x27; AND path IS NOT NULL&#x29; doc ON docId2_id &#x3d; doc.id&#xd;&#xa;&#xd;&#xa;UNION ALL&#xd;&#xa;&#xd;&#xa;SELECT&#xd;&#xa;	c.person_id candidate_id,&#xd;&#xa;	CONCAT&#x28;SUBSTRING_INDEX&#x28;SUBSTRING_INDEX&#x28;doc.path, &#x27;&#x2f;&#x27;, -1&#x29;, &#x27;_&#x27;, 2&#x29;, &#x27;_&#x27;, LPAD&#x28;doc.id, 10, &#x27;0&#x27;&#x29;, &#x27;_&#x27;, SUBSTRING_INDEX&#x28;doc.path,&#x27;_&#x27;,-1&#x29;&#x29; document,&#xd;&#xa;	&#x27;CANDIDATE&#x27; entity_type,&#xd;&#xa;	&#x27;resume&#x27; document_type&#xd;&#xa;FROM alpha_candidate c&#xd;&#xa;JOIN alpha_person p ON c.person_id &#x3d; p.id&#xd;&#xa;JOIN candidate_fe cf ON c.person_id &#x3d; cf.candidate_id&#xd;&#xa;LEFT JOIN &#x28;SELECT id, path FROM alpha_document WHERE type &#x3d; &#x27;docId3&#x27; AND path IS NOT NULL&#x29; doc ON docId3_id &#x3d; doc.id&#xd;&#xa;&#xd;&#xa;UNION ALL&#xd;&#xa;&#xd;&#xa;SELECT&#xd;&#xa;	c.person_id candidate_id,&#xd;&#xa;	CONCAT&#x28;SUBSTRING_INDEX&#x28;SUBSTRING_INDEX&#x28;doc.path, &#x27;&#x2f;&#x27;, -1&#x29;, &#x27;_&#x27;, 2&#x29;, &#x27;_&#x27;, LPAD&#x28;doc.id, 10, &#x27;0&#x27;&#x29;, &#x27;_&#x27;, SUBSTRING_INDEX&#x28;doc.path,&#x27;_&#x27;,-1&#x29;&#x29; document,&#xd;&#xa;	&#x27;CANDIDATE&#x27; entity_type,&#xd;&#xa;	&#x27;resume&#x27; document_type&#xd;&#xa;FROM alpha_candidate c&#xd;&#xa;JOIN alpha_person p ON c.person_id &#x3d; p.id&#xd;&#xa;JOIN candidate_fe cf ON c.person_id &#x3d; cf.candidate_id&#xd;&#xa;LEFT JOIN &#x28;SELECT id, path FROM alpha_document WHERE type &#x3d; &#x27;ukVisa&#x27; AND path IS NOT NULL&#x29; doc ON ukVisa_id &#x3d; doc.id&#xd;&#xa;&#xd;&#xa;UNION ALL&#xd;&#xa;&#xd;&#xa;SELECT&#xd;&#xa;	c.person_id candidate_id,&#xd;&#xa;	CONCAT&#x28;SUBSTRING_INDEX&#x28;SUBSTRING_INDEX&#x28;doc.path, &#x27;&#x2f;&#x27;, -1&#x29;, &#x27;_&#x27;, 2&#x29;, &#x27;_&#x27;, LPAD&#x28;doc.id, 10, &#x27;0&#x27;&#x29;, &#x27;_&#x27;, SUBSTRING_INDEX&#x28;doc.path,&#x27;_&#x27;,-1&#x29;&#x29; document,&#xd;&#xa;	&#x27;CANDIDATE&#x27; entity_type,&#xd;&#xa;	&#x27;resume&#x27; document_type&#xd;&#xa;FROM alpha_candidate c&#xd;&#xa;JOIN alpha_person p ON c.person_id &#x3d; p.id&#xd;&#xa;JOIN candidate_fe cf ON c.person_id &#x3d; cf.candidate_id&#xd;&#xa;LEFT JOIN &#x28;SELECT id, path FROM alpha_document WHERE type &#x3d; &#x27;specCv&#x27; AND path IS NOT NULL&#x29; doc ON specCv_id &#x3d; doc.id&#xd;&#xa;&#xd;&#xa;UNION ALL&#xd;&#xa;&#xd;&#xa;SELECT&#xd;&#xa;	c.person_id candidate_id,&#xd;&#xa;	CONCAT&#x28;SUBSTRING_INDEX&#x28;SUBSTRING_INDEX&#x28;doc.path, &#x27;&#x2f;&#x27;, -1&#x29;, &#x27;_&#x27;, 2&#x29;, &#x27;_&#x27;, LPAD&#x28;doc.id, 10, &#x27;0&#x27;&#x29;, &#x27;_&#x27;, SUBSTRING_INDEX&#x28;doc.path,&#x27;_&#x27;,-1&#x29;&#x29; document,&#xd;&#xa;	&#x27;CANDIDATE&#x27; entity_type,&#xd;&#xa;	&#x27;resume&#x27; document_type&#xd;&#xa;FROM alpha_candidate c&#xd;&#xa;JOIN alpha_person p ON c.person_id &#x3d; p.id&#xd;&#xa;JOIN candidate_fe cf ON c.person_id &#x3d; cf.candidate_id&#xd;&#xa;LEFT JOIN &#x28;SELECT id, path FROM alpha_document WHERE type &#x3d; &#x27;curCon&#x27; AND path IS NOT NULL&#x29; doc ON curCon &#x3d; doc.id&#xd;&#xa;&#xd;&#xa;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1424</xloc>
      <yloc>896</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>candidate_edu</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>source</connection>
    <sql>WITH candidate_education AS &#x28;&#xd;&#xa;	SELECT&#xd;&#xa;		candidate_id,&#xd;&#xa;		GROUP_CONCAT&#x28;&#xd;&#xa;			CONCAT_WS&#x28;&#xd;&#xa;				CHAR&#x28;10&#x29;,&#xd;&#xa;				CASE WHEN NULLIF&#x28;schoolName, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;School name&#x3a; &#x27;, schoolName&#x29; END,&#xd;&#xa;				CASE WHEN NULLIF&#x28;organizationUnit, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Department&#x3a; &#x27;, organizationUnit&#x29; END,&#xd;&#xa;				CASE WHEN NULLIF&#x28;startDate, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Start date&#x3a; &#x27;, startDate&#x29; END,&#xd;&#xa;				CASE WHEN NULLIF&#x28;endDate, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;End date&#x3a; &#x27;, endDate&#x29; END,&#xd;&#xa;				CASE WHEN NULLIF&#x28;degreeName, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Degree name&#x3a; &#x27;, degreeName&#x29; END,&#xd;&#xa;				CASE WHEN NULLIF&#x28;major, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Major&#x3a; &#x27;, major&#x29; END,&#xd;&#xa;				CASE WHEN NULLIF&#x28;measure, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Grade&#x3a; &#x27;, measure&#x29; END,&#xd;&#xa;				CASE WHEN NULLIF&#x28;degreeDate, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Degree date&#x3a; &#x27;, degreeDate&#x29; END,&#xd;&#xa;				CASE WHEN NULLIF&#x28;comments, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Comment&#x3a; &#x27;, CHAR&#x28;10&#x29;, comments&#x29; END&#xd;&#xa;			&#x29; SEPARATOR &#x27;&#x5c;n--------------------------------------------------------------------------------------------------&#x5c;n&#x27;&#xd;&#xa;		&#x29; education_summary&#xd;&#xa;	FROM alpha_education&#xd;&#xa;	GROUP BY candidate_id&#xd;&#xa;&#x29;&#xd;&#xa;SELECT&#xd;&#xa;	CAST&#x28;c.person_id AS CHAR&#x29; candidate_id,&#xd;&#xa;	ce.education_summary&#xd;&#xa;	&#xd;&#xa;FROM alpha_candidate c&#xd;&#xa;JOIN alpha_person p ON c.person_id &#x3d; p.id&#xd;&#xa;LEFT JOIN candidate_education ce ON c.id &#x3d; ce.candidate_id&#xd;&#xa;-- WHERE c.person_id BETWEEN 0 AND 100000&#xd;&#xa;-- &#xd;&#xa;-- &#x29; temp WHERE rn &#x3c;&#x3e; 1</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1392</xloc>
      <yloc>160</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>candidate_keywords</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>source</connection>
    <sql>SELECT&#xd;&#xa;	c.person_id candidate_id,&#xd;&#xa;	GROUP_CONCAT&#x28;&#xd;&#xa;		CONCAT_WS&#x28;&#xd;&#xa;			&#x27;, &#x27;,&#xd;&#xa;			RTRIM&#x28;REPLACE&#x28;t.name, &#x27;,&#x27;, &#x27;&#x27;&#x29;&#x29;&#xd;&#xa;		&#x29; SEPARATOR &#x27;, &#x27;&#x29; keywords&#xd;&#xa;	&#xd;&#xa;FROM alpha_candidate c&#xd;&#xa;LEFT JOIN candidates_tags ct ON c.id &#x3d; ct.candidate_id&#xd;&#xa;LEFT JOIN alpha_tag t ON ct.tag_id &#x3d; t.id&#xd;&#xa;WHERE t.name IS NOT NULL&#xd;&#xa;GROUP BY candidate_id</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1408</xloc>
      <yloc>448</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>candidate_nationality</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>source</connection>
    <sql>WITH functional_expertise AS &#x28;&#xd;&#xa;	SELECT&#xd;&#xa;	id,&#xd;&#xa;	jobFunction sub_functional_expertise,&#xd;&#xa;	type functional_expertise&#xd;&#xa;	FROM &#x60;alpha_sel_job_function&#x60;&#xd;&#xa;	WHERE type IN &#x28;&#x27;Marketing&#x27;, &#x27;Project Management&#x27;, &#x27;Sales&#x27;&#x29;&#xd;&#xa;	AND jobFunction IN &#x28;&#x27;Ad Operations&#x27;, &#x27;Brand Marketing&#x27;, &#x27;Category Manager&#x27;, &#x27;Chief Marketing Officer&#x27;, &#x27;Communications &#x26; PR&#x27;, &#xd;&#xa;												&#x27;CRM&#x27;, &#x27;Digital Marketing&#x27;, &#x27;eCommerce&#x27;, &#x27;Insight &#x26; Analytics&#x27;, &#x27;Marketing Events&#x27;,&#xd;&#xa;												&#x27;Media Planning &#x2f; Buying&#x27;, &#x27;PPC&#x27;, &#x27;SEO&#x27;, &#x27;Social Media&#x27;, &#x27;Business Analysts&#x27;,&#xd;&#xa;												&#x27;Chief Digital Officer&#x27;, &#x27;Digital Project Manager&#x27;, &#x27;Events Manager&#x27;, &#x27;IT Programme Manager&#x27;, &#x27;IT Project Manager&#x27;, &#xd;&#xa;												&#x27;PMO Analyst&#x27;, &#x27;PMO Assurance&#x27;, &#x27;Product Developer&#x27;, &#x27;Product Manager&#x27;, &#x27;Project Administrator&#x27;,&#xd;&#xa;												&#x27;Project Director&#x27;, &#x27;Project Manager&#x27;, &#x27;Project Resource Planner&#x27;, &#x27;Project Support&#x2f;Co-ordinator&#x27;, &#x27;Risk Manager&#x27;,&#xd;&#xa;												&#x27;Transformation and Change Manager&#x27;, &#x27;COO&#x27;, &#x27;MD &#x2f; CEO &#x2f; VP&#x27;&#x29;&#xd;&#xa;&#x29;,&#xd;&#xa;candidate_position AS &#x28;&#xd;&#xa;	SELECT&#xd;&#xa;	c.person_id candidate_id,&#xd;&#xa;	p.jobFunction_id fe_id,&#xd;&#xa;	ROW_NUMBER&#x28;&#x29; OVER&#x28;PARTITION BY c.person_id, p.jobFunction_id ORDER BY c.person_id&#x29; rn&#xd;&#xa;	FROM alpha_candidate c&#xd;&#xa;	LEFT JOIN alpha_position p ON c.person_id &#x3d; p.person_id&#xd;&#xa;	WHERE p.jobFunction_id IS NOT NULL&#xd;&#xa;&#x29;,&#xd;&#xa;candidate_fe AS &#x28;&#xd;&#xa;	SELECT DISTINCT candidate_id&#xd;&#xa;	FROM candidate_position cp&#xd;&#xa;	JOIN functional_expertise fe ON cp.fe_id &#x3d; fe.id&#xd;&#xa;	WHERE rn &#x3d; 1&#xd;&#xa;&#x29;&#xd;&#xa;&#xd;&#xa;SELECT&#xd;&#xa;	c.person_id candidate_id,&#xd;&#xa;	CASE&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;United Kingdom&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Austrilian&#x27; THEN &#x27;AU&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;United States&#x27; THEN &#x27;US&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;british&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;France&#x27; THEN &#x27;FR&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;German&#x27; THEN &#x27;DE&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Romania&#x27; THEN &#x27;RO&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Sweden&#x27; THEN &#x27;SE&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Italy&#x27; THEN &#x27;IT&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Greece&#x27; THEN &#x27;GR&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Germany&#x27; THEN &#x27;DE&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;USA&#x27; THEN &#x27;US&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Belgium&#x27; THEN &#x27;BE&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;American&#x27; THEN &#x27;AS&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Czech Republic&#x27; THEN &#x27;CZ&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Irish&#x27; THEN &#x27;IE&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Netherlands&#x27; THEN &#x27;NL&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;South Africa&#x27; THEN &#x27;ZA&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;New Zealand&#x27; THEN &#x27;NZ&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Finland&#x27; THEN &#x27;FI&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Polish&#x27; THEN &#x27;PL&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Italian&#x27; THEN &#x27;IT&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Portugal&#x27; THEN &#x27;PT&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Poland&#x27; THEN &#x27;PL&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Spain&#x27; THEN &#x27;ES&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Australia&#x27; THEN &#x27;AU&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Nigerian&#x27; THEN &#x27;NG&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;India&#x27; THEN &#x27;IN&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Japan&#x27; THEN &#x27;JP&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Sri Lanka&#x27; THEN &#x27;LK&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Zimbabwe&#x27; THEN &#x27;ZW&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;China&#x27; THEN &#x27;CN&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Lithuania&#x27; THEN &#x27;LT&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Israel&#x27; THEN &#x27;IL&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Bulgaria&#x27; THEN &#x27;BG&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Russian Federation&#x27; THEN &#x27;RU&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Denmark&#x27; THEN &#x27;DK&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Malta&#x27; THEN &#x27;MT&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Indian&#x27; THEN &#x27;IN&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Egypt&#x27; THEN &#x27;EG&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Ireland&#x27; THEN &#x27;IE&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Swedish&#x27; THEN &#x27;SE&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Hungary&#x27; THEN &#x27;HU&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Turkey&#x27; THEN &#x27;TR&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Norway&#x27; THEN &#x27;NO&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Canada&#x27; THEN &#x27;CA&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;French&#x27; THEN &#x27;FR&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Greek&#x27; THEN &#x27;GR&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Austria&#x27; THEN &#x27;AT&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Somalian&#x27; THEN &#x27;SO&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;American&#x2f;British&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Iran, Islamic Republic of&#x27; THEN &#x27;IR&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Taiwan, Province of China&#x27; THEN &#x27;TW&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Brazil&#x27; THEN &#x27;BR&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Iraq&#x27; THEN &#x27;IQ&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Malaysia&#x27; THEN &#x27;MY&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;British Passport&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Hungarian&#x27; THEN &#x27;HU&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Pakistan&#x27; THEN &#x27;PK&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Venezuela, Bolivarian Republic of&#x27; THEN &#x27;VE&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Latvia&#x27; THEN &#x27;LV&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Uganda&#x27; THEN &#x27;UG&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Columbian&#x27; THEN &#x27;CO&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;australia and Irish nationality&#x27; THEN &#x27;IE&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Portuguese&#x27; THEN &#x27;PT&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Estonia&#x27; THEN &#x27;EE&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Kenya&#x27; THEN &#x27;KE&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Lithuanian&#x27; THEN &#x27;LT&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Lebanon&#x27; THEN &#x27;LB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Argentina&#x27; THEN &#x27;AR&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Syrian Arab Republic&#x27; THEN &#x27;SY&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Spainish&#x27; THEN &#x27;ES&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Ukraine&#x27; THEN &#x27;UA&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Peru&#x27; THEN &#x27;PE&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Switzerland&#x27; THEN &#x27;CH&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Slovakia&#x27; THEN &#x27;SK&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Mauritius&#x27; THEN &#x27;MU&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Slovenia&#x27; THEN &#x27;SI&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Idian&#x27; THEN &#x27;IN&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Korea, Republic of&#x27; THEN &#x27;KP&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Morocco&#x27; THEN &#x27;MA&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Armenian&#x27; THEN &#x27;AM&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Russian&#x27; THEN &#x27;RU&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Jordan&#x27; THEN &#x27;JO&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Croatia&#x27; THEN &#x27;HR&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Serbia&#x27; THEN &#x27;RS&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Spanish&#x27; THEN &#x27;ES&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;South African&#x27; THEN &#x27;ZA&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Indian - Indefinite Leave to Remain&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Nigeria&#x27; THEN &#x27;NG&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Israeli&#x2f;Polish&#x27; THEN &#x27;PL&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Frencg&#x27; THEN &#x27;FR&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Hong Kong&#x27; THEN &#x27;HK&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Mexico&#x27; THEN &#x27;MX&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Uruguay&#x27; THEN &#x27;UY&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Cyprus&#x27; THEN &#x27;CY&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;britosh&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Niger&#x27; THEN &#x27;NE&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Pakistani&#x27; THEN &#x27;PK&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Iceland&#x27; THEN &#x27;IS&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Macedonia, the former Yugoslav Republic of&#x27; THEN &#x27;MK&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Panama&#x27; THEN &#x27;PA&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Kazakhstan&#x27; THEN &#x27;KZ&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Scottish&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Nepal&#x27; THEN &#x27;NP&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Brtiish&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;romanian&#x27; THEN &#x27;RO&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Dutch&#x27; THEN &#x27;NL&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;British and NZ&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;United Arab Emirates&#x27; THEN &#x27;AE&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Chilean&#x27; THEN &#x27;CL&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;bulgarian&#x27; THEN &#x27;BG&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Georgia&#x27; THEN &#x27;GE&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;British-Colombian&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Morrocan&#x27; THEN &#x27;MA&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Norwegian&#x27; THEN &#x27;NO&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Cypriot&#x27; THEN &#x27;CY&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Irish passport&#x27; THEN &#x27;IE&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Viet Nam&#x27; THEN &#x27;VN&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Portugal - EU Passport&#x27; THEN &#x27;PT&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Maurician&#x27; THEN &#x27;MU&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;British&#x2f;American&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Czech&#x27; THEN &#x27;CZ&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Italian and Brazilian&#x27; THEN &#x27;IT&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Senegal&#x27; THEN &#x27;SN&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;American &#x2f; British&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;turkish&#x27; THEN &#x27;TR&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Bangladesh&#x27; THEN &#x27;BD&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;nepalese&#x27; THEN &#x27;NP&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Kuwait&#x27; THEN &#x27;KW&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Peruvian&#x27; THEN &#x27;PE&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Singapore&#x27; THEN &#x27;SG&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;British - Ivory Coast&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Chinese&#x27; THEN &#x27;CN&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Norweigan&#x27; THEN &#x27;NO&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Australian and British&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Ghana&#x27; THEN &#x27;GH&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;mexican&#x27; THEN &#x27;MX&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Portugese&#x27; THEN &#x27;PT&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Russian&#x2f;British&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Nigerian&#x2f;British&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;US and Spanish&#x27; THEN &#x27;US&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;UK Citizen&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Tunisia&#x27; THEN &#x27;TN&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Brazilian&#x27; THEN &#x27;BR&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Chile&#x27; THEN &#x27;CL&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Australian&#x27; THEN &#x27;AU&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;moroccan&#x27; THEN &#x27;MO&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Canadian Hungarian&#x27; THEN &#x27;HU&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Canadian National &#x28;Indefinite leave to remain&#x29;&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Canadian&#x27; THEN &#x27;CA&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Italian &#x26; French&#x27; THEN &#x27;IT&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;German Passport&#x27; THEN &#x27;DE&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Cameroon&#x27; THEN &#x27;CM&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Germa&#x27; THEN &#x27;DE&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;British Citizen&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Belgian&#x27; THEN &#x27;BE&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Argentinean&#x27; THEN &#x27;AR&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;British and Irish&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Australian - TIER 5 MOBILITY VISA&#x27; THEN &#x27;AU&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;French&#x2f;British&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;south african - portuguese dual nationality&#x27; THEN &#x27;PT&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Dual Austrian and American&#x27; THEN &#x27;AU&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Nigerian  On a Spouse Visa&#x27; THEN &#x27;NG&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;British - UK resident&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Jordanian&#x27; THEN &#x27;JO&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Australian &#x2f; British&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Malaysian&#x27; THEN &#x27;MY&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;British and South African&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Serbian&#x27; THEN &#x27;RS&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;British &#x28;UK&#x29;&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Polish &#x28;EU&#x29;&#x27; THEN &#x27;PL&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Italian, Spanish&#x27; THEN &#x27;IT&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;American &#x2f; French &#x2f; British&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Britsih&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Republic of Korea&#x27; THEN &#x27;KP&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Colombia&#x27; THEN &#x27;CO&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;african&#x27; THEN &#x27;CF&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;austrlian&#x27; THEN &#x27;AU&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Jamaica&#x27; THEN &#x27;JM&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;English&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Itallian&#x27; THEN &#x27;IT&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;New Zealend&#x27; THEN &#x27;NZ&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Latvian&#x27; THEN &#x27;LV&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Nnigerian&#x27; THEN &#x27;NG&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;British&#x2f;Kiwi&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;New Zealand &#x2f; Australian&#x27; THEN &#x27;AU&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;British and Russian&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Mauritian&#x27; THEN &#x27;MU&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Sri Lankan&#x27; THEN &#x27;SL&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Ivorian&#x27; THEN &#x27;CI&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Cyrpriot&#x27; THEN &#x27;CY&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Chilean&#x2f;italian&#x27; THEN &#x27;IT&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;French&#x2f;German&#x27; THEN &#x27;FR&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Finnish&#x27; THEN &#x27;FI&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Amercian&#x27; THEN &#x27;US&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Cameroonian&#x27; THEN &#x27;CM&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Israeli&#x27; THEN &#x27;IL&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;British Canadian&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Romainian&#x27; THEN &#x27;RO&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;brit&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Philippines&#x27; THEN &#x27;PH&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;British - Irish&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Inidan&#x27; THEN &#x27;IN&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Dual Nationality Burundi &#x2b; British&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Dual Nationality &#x3a; British&#x2f;Danish&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;British&#x2f;Indian&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Italian &#x2f; German&#x27; THEN &#x27;IT&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;saudi and egyptian&#x27; THEN &#x27;SA&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Zambian&#x27; THEN &#x27;ZM&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Taiwanese&#x27; THEN &#x27;TW&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Idian - Indefinite leave to remain&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Danish&#x27; THEN &#x27;DK&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Greek&#x2f; New Zealander&#x27; THEN &#x27;GR&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;British Bangldeshi&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Dannish&#x27; THEN &#x27;DK&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;slovenian&#x27; THEN &#x27;SI&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Zimbabwean&#x27; THEN &#x27;ZW&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Austrailian&#x27; THEN &#x27;AU&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;British &#x28;via Marriage&#x29;&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Kenyan&#x27; THEN &#x27;KE&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Bangleshi&#x27; THEN &#x27;BD&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;portguese&#x27; THEN &#x27;PT&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;British &#x2f; Swiss&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Italian and Australian&#x27; THEN &#x27;IT&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Indian - tier 2&#x27; THEN &#x27;IN&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Thailand&#x27; THEN &#x27;TH&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Itlaian&#x27; THEN &#x27;IT&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Turkish Passport&#x27; THEN &#x27;TR&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Britsh&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Moroccan &#x2f; Canadian&#x27; THEN &#x27;MO&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;New Zealanders&#x27; THEN &#x27;NZ&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Ghanaian&#x27; THEN &#x27;GH&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;British passport - Mauritian orginally&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;indian - work permit no sponsership&#x27; THEN &#x27;IN&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Filipino&#x27; THEN &#x27;PH&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;EU Passport French&#x2f;German&#x27; THEN &#x27;FR&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Italian &#x2f; Brazilian&#x27; THEN &#x27;IT&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;New Zealand and Irish&#x27; THEN &#x27;IE&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Slovakian&#x27; THEN &#x27;SK&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;dual&#x3a; French and morrocan&#x27; THEN &#x27;FR&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;mayanmar&#x27; THEN &#x27;MM&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Israeli and British&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;bangladeshi&#x27; THEN &#x27;BD&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Iranian&#x27; THEN &#x27;IR&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;British &#x26; NZ European&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Braillian&#x27; THEN &#x27;BR&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Moldova, Republic of&#x27; THEN &#x27;MD&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Venezualan&#x27; THEN &#x27;VE&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Nepali&#x27; THEN &#x27;NP&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Morrocon&#x27; THEN &#x27;MO&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Brtish&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Indian&#x3b;&#x27; THEN &#x27;IN&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Eritrean&#x27; THEN &#x27;ER&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Swiss&#x27; THEN &#x27;CH&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;british&#x2f;australian&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Colombian&#x27; THEN &#x27;CO&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Canadian &#x2f; Polish&#x27; THEN &#x27;PL&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;British &#x2f; Jamaican&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;british&#x2f;australiasn&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Algeria&#x27; THEN &#x27;DZ&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;marititus&#x27; THEN &#x27;MU&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;New Zeland&#x27; THEN &#x27;NZ&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;sri lanken&#x27; THEN &#x27;SL&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;British - Nigerian&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Bulgarian&#x2f;English&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Sweedish&#x27; THEN &#x27;SE&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;british and italian&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;itlalian&#x27; THEN &#x27;IT&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Lebanese&#x27; THEN &#x27;LB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Spanish&#x2f;German&#x27; THEN &#x27;ES&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;UK&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Bolivian&#x27; THEN &#x27;BO&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Dutch&#x2f;British&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;British&#x2f;Spanish&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Duel US and UK&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;jamaican&#x27; THEN &#x27;JM&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Chinnese&#x27; THEN &#x27;CN&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Bermuda&#x27; THEN &#x27;BM&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Indian&#x3b; German&#x27; THEN &#x27;DE&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;grenadian&#x27; THEN &#x27;GD&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;TRINIDADIAN&#x27; THEN &#x27;TT&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Indonesia&#x27; THEN &#x27;ID&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Slovak&#x27; THEN &#x27;SK&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Sudanese&#x27; THEN &#x27;SD&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Estonian&#x27; THEN &#x27;EE&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Vietnamese&#x27; THEN &#x27;VM&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Spanish &#x28;EU citizen&#x29;&#x27; THEN &#x27;ES&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;singaporean&#x27; THEN &#x27;SG&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Libya&#x27; THEN &#x27;LY&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;French&#x2f;Canadian&#x27; THEN &#x27;FR&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Tunisian&#x27; THEN &#x27;TN&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Lebonese&#x27; THEN &#x27;LB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;South Afican&#x27; THEN &#x27;ZA&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Samoan&#x27; THEN &#x27;WS&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Belgain&#x27; THEN &#x27;BE&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;British Indian&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Trinidad&#x27; THEN &#x27;TT&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Austalian&#x27; THEN &#x27;AU&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Welsh&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Austrian&#x27; THEN &#x27;AT&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;British, Egyptian&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Afgan&#x27; THEN &#x27;AF&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Syrian&#x27; THEN &#x27;SY&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Irish&#x2f;Russian&#x27; THEN &#x27;IE&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Nicaragua&#x27; THEN &#x27;NI&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Brazilian &#x28;Italian dual nationality&#x29;&#x27; THEN &#x27;IT&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;South Africa&#x2f; British&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;SriLankan&#x27; THEN &#x27;SL&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Palestinian&#x27; THEN &#x27;PS&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Spannish&#x27; THEN &#x27;ES&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Australian, Italian Passport&#x27; THEN &#x27;IT&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;British &#x26; Australian &#x28;Dual Citizenship&#x29;&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Persian&#x27; THEN &#x27;IR&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Albania&#x27; THEN &#x27;AL&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Belarus&#x27; THEN &#x27;BY&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Icelandic&#x27; THEN &#x27;IS&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;British&#x2f;Canadian&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Ugandan&#x27; THEN &#x27;UG&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Romanian - British passport&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;British and Chillian&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;british,&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Australian&#x2f;British&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Indian Passport&#x27; THEN &#x27;IN&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;New Zealand and Russian Passport&#x27; THEN &#x27;NZ&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Lithuanian nationality&#x27; THEN &#x27;LT&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Dutch Passport&#x27; THEN &#x27;NL&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Egyptian&#x27; THEN &#x27;EG&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Indian - Tier 2 - General Dependant&#x27; THEN &#x27;IN&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;USA and French&#x27; THEN &#x27;FR&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Brazilian &#x2f; Polish&#x27; THEN &#x27;PL&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Belgian Passport&#x27; THEN &#x27;BE&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Black British&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;British&#x2f;Russian&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Ieland&#x27; THEN &#x27;IS&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Belerusian&#x27; THEN &#x27;BY&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Polish and British&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;US &#x26; British&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;French&#x2f;Egyptian&#x27; THEN &#x27;FR&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Israeli &#x26; Romanian&#x27; THEN &#x27;RO&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;German&#x2f;Italian&#x27; THEN &#x27;DE&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Irish Canadian&#x27; THEN &#x27;IE&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Tibetan&#x27; THEN &#x27;CN&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Malasian&#x27; THEN &#x27;MY&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Pakistani Passport&#x27; THEN &#x27;PK&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Korean&#x27; THEN &#x27;KP&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Ukranian&#x27; THEN &#x27;UA&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Sudan&#x27; THEN &#x27;SD&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Brazilian Passport&#x27; THEN &#x27;BR&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Georgian&#x27; THEN &#x27;GE&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Qatar&#x27; THEN &#x27;QA&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Pakistan Passport&#x27; THEN &#x27;PK&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Pakistan- Spouse Visa&#x27; THEN &#x27;PK&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Crostian&#x27; THEN &#x27;HR&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Greek&#x2f;British&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Rwanda&#x27; THEN &#x27;RW&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;USA&#x2f;Canada&#x27; THEN &#x27;US&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Canadian&#x2f;Lithuanian&#x27; THEN &#x27;LT&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Barbados&#x27; THEN &#x27;BB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;US Citizen&#x27; THEN &#x27;US&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Belarussian&#x27; THEN &#x27;BY&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;US Passport&#x27; THEN &#x27;US&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;US&#x27; THEN &#x27;US&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Kyrgyzstan&#x27; THEN &#x27;KG&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Candian&#x27; THEN &#x27;CA&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Croatian&#x27; THEN &#x27;HR&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;British&#x2f;Nigerian&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Belarusian&#x27; THEN &#x27;BY&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Austaliam&#x27; THEN &#x27;AU&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Mexican passport&#x27; THEN &#x27;MX&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Angolian&#x27; THEN &#x27;AO&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;United States - British Passport&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Philippine&#x27; THEN &#x27;PH&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Isreal&#x27; THEN &#x27;IL&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Briitsh&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;American Irish&#x27; THEN &#x27;IE&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Botswana&#x27; THEN &#x27;BW&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Russian &#x2f; American&#x27; THEN &#x27;US&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Dominican Republic&#x27; THEN &#x27;DO&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Uzbekistan&#x27; THEN &#x27;UZ&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Venezuelan&#x27; THEN &#x27;VE&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Barbadian National&#x27; THEN &#x27;BB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Finnish National&#x27; THEN &#x27;FI&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;kazakhstani&#x27; THEN &#x27;KZ&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Dual Citizenship of Romanian and Moldavian.&#x27; THEN &#x27;RO&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Ecuadorian&#x27; THEN &#x27;EC&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;South Korean&#x27; THEN &#x27;KP&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Maltese&#x27; THEN &#x27;MT&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Nowegian&#x27; THEN &#x27;NO&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;b&#x3d;British&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Ukrainian&#x27; THEN &#x27;UA&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Swiss French National&#x27; THEN &#x27;CH&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Greek&#x2f;Albanian&#x27; THEN &#x27;GR&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Afghan&#x27; THEN &#x27;AF&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Somalia&#x27; THEN &#x27;SO&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Welsh - EU&#x27; THEN &#x27;GB&#x27;&#xd;&#xa;		WHEN c.nationality &#x3d; &#x27;Portuguese&#x2f;Brazilian&#x27; THEN &#x27;PT&#x27;&#xd;&#xa;	END nationality&#xd;&#xa;FROM alpha_candidate c&#xd;&#xa;JOIN alpha_person p ON c.person_id &#x3d; p.id&#xd;&#xa;JOIN candidate_fe cf ON c.person_id &#x3d; cf.candidate_id&#xd;&#xa;WHERE NULLIF&#x28;c.nationality, &#x27;&#x27;&#x29; IS NOT NULL</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1424</xloc>
      <yloc>976</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>candidate_note</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>source</connection>
    <sql>WITH candidate_education AS &#x28;&#xd;&#xa;	SELECT&#xd;&#xa;		candidate_id,&#xd;&#xa;		GROUP_CONCAT&#x28;&#xd;&#xa;			CONCAT_WS&#x28;&#xd;&#xa;				CHAR&#x28;10&#x29;,&#xd;&#xa;				CASE WHEN NULLIF&#x28;schoolName, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;School name&#x3a; &#x27;, schoolName&#x29; END,&#xd;&#xa;				CASE WHEN NULLIF&#x28;organizationUnit, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Department&#x3a; &#x27;, organizationUnit&#x29; END,&#xd;&#xa;				CASE WHEN NULLIF&#x28;startDate, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Start date&#x3a; &#x27;, startDate&#x29; END,&#xd;&#xa;				CASE WHEN NULLIF&#x28;endDate, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;End date&#x3a; &#x27;, endDate&#x29; END,&#xd;&#xa;				CASE WHEN NULLIF&#x28;degreeName, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Degree name&#x3a; &#x27;, degreeName&#x29; END,&#xd;&#xa;				CASE WHEN NULLIF&#x28;major, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Major&#x3a; &#x27;, major&#x29; END,&#xd;&#xa;				CASE WHEN NULLIF&#x28;measure, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Grade&#x3a; &#x27;, measure&#x29; END,&#xd;&#xa;				CASE WHEN NULLIF&#x28;degreeDate, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Degree date&#x3a; &#x27;, degreeDate&#x29; END,&#xd;&#xa;				CASE WHEN NULLIF&#x28;comments, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Comment&#x3a; &#x27;, CHAR&#x28;10&#x29;, comments&#x29; END&#xd;&#xa;			&#x29; SEPARATOR &#x27;&#x5c;n--------------------------------------------------------------------------------------------------&#x5c;n&#x27;&#xd;&#xa;		&#x29; education_summary&#xd;&#xa;	FROM alpha_education&#xd;&#xa;	GROUP BY candidate_id&#xd;&#xa;&#x29;,&#xd;&#xa;candidate_skill AS &#x28;&#xd;&#xa;	SELECT&#xd;&#xa;		c.person_id candidate_id,&#xd;&#xa;		GROUP_CONCAT&#x28;&#xd;&#xa;			CONCAT_WS&#x28;&#xd;&#xa;				&#x27;, &#x27;,&#xd;&#xa;				RTRIM&#x28;fq.qualification&#x29;,&#xd;&#xa;				RTRIM&#x28;co.skill&#x29;&#xd;&#xa;			&#x29; SEPARATOR &#x27;, &#x27;&#x29; skill&#xd;&#xa;-- 		c.languageString&#xd;&#xa;	FROM alpha_candidate c&#xd;&#xa;	LEFT JOIN alpha_sel_fin_qual fq ON c.finQual_id &#x3d; fq.id&#xd;&#xa;	LEFT JOIN &#x28;SELECT&#xd;&#xa;							candidate_id,&#xd;&#xa;							GROUP_CONCAT&#x28;RTRIM&#x28;name&#x29; SEPARATOR &#x27;, &#x27;&#x29; skill&#xd;&#xa;						FROM alpha_competency &#xd;&#xa;						WHERE description LIKE &#x27;&#x25;Skill&#x25;&#x27;&#xd;&#xa;						GROUP BY candidate_id&#x29; co ON c.person_id &#x3d; co.candidate_id&#xd;&#xa;	WHERE fq.qualification IS NOT NULL OR co.skill IS NOT NULL&#xd;&#xa;	GROUP BY candidate_id&#xd;&#xa;&#x29;,&#xd;&#xa;candidate_lists AS &#x28;&#xd;&#xa;	SELECT&#xd;&#xa;		candidate_id,&#xd;&#xa;		GROUP_CONCAT&#x28;listTitle SEPARATOR &#x27;, &#x27;&#x29; list&#xd;&#xa;	FROM alpha_lists_candidates lc&#xd;&#xa;	JOIN alpha_lists l ON lc.lists_id &#x3d; l.id&#xd;&#xa;	GROUP BY candidate_id&#xd;&#xa;&#x29;,&#xd;&#xa;candidate_nationality AS &#x28;&#xd;&#xa;	SELECT&#xd;&#xa;		candidate_id,&#xd;&#xa;		c.a2 nationality_code,&#xd;&#xa;		ROW_NUMBER&#x28;&#x29; OVER&#x28;PARTITION BY candidate_id ORDER BY n.created DESC&#x29; rn&#xd;&#xa;	FROM alpha_nationality n&#xd;&#xa;	JOIN alpha_sel_country c ON n.country_id &#x3d; c.id&#xd;&#xa;&#x29;,&#xd;&#xa;candidate_second_nationality AS &#x28;&#xd;&#xa;	SELECT &#x2a;&#xd;&#xa;	FROM candidate_nationality&#xd;&#xa;	WHERE rn &#x3d; 2&#xd;&#xa;&#x29;,&#xd;&#xa;functional_expertise AS &#x28;&#xd;&#xa;	SELECT&#xd;&#xa;	id,&#xd;&#xa;	jobFunction sub_functional_expertise,&#xd;&#xa;	type functional_expertise&#xd;&#xa;	FROM &#x60;alpha_sel_job_function&#x60;&#xd;&#xa;	WHERE type IN &#x28;&#x27;Marketing&#x27;, &#x27;Project Management&#x27;, &#x27;Sales&#x27;&#x29;&#xd;&#xa;	AND jobFunction IN &#x28;&#x27;Ad Operations&#x27;, &#x27;Brand Marketing&#x27;, &#x27;Category Manager&#x27;, &#x27;Chief Marketing Officer&#x27;, &#x27;Communications &#x26; PR&#x27;, &#xd;&#xa;												&#x27;CRM&#x27;, &#x27;Digital Marketing&#x27;, &#x27;eCommerce&#x27;, &#x27;Insight &#x26; Analytics&#x27;, &#x27;Marketing Events&#x27;,&#xd;&#xa;												&#x27;Media Planning &#x2f; Buying&#x27;, &#x27;PPC&#x27;, &#x27;SEO&#x27;, &#x27;Social Media&#x27;, &#x27;Business Analysts&#x27;,&#xd;&#xa;												&#x27;Chief Digital Officer&#x27;, &#x27;Digital Project Manager&#x27;, &#x27;Events Manager&#x27;, &#x27;IT Programme Manager&#x27;, &#x27;IT Project Manager&#x27;, &#xd;&#xa;												&#x27;PMO Analyst&#x27;, &#x27;PMO Assurance&#x27;, &#x27;Product Developer&#x27;, &#x27;Product Manager&#x27;, &#x27;Project Administrator&#x27;,&#xd;&#xa;												&#x27;Project Director&#x27;, &#x27;Project Manager&#x27;, &#x27;Project Resource Planner&#x27;, &#x27;Project Support&#x2f;Co-ordinator&#x27;, &#x27;Risk Manager&#x27;,&#xd;&#xa;												&#x27;Transformation and Change Manager&#x27;, &#x27;COO&#x27;, &#x27;MD &#x2f; CEO &#x2f; VP&#x27;&#x29;&#xd;&#xa;&#x29;,&#xd;&#xa;candidate_position AS &#x28;&#xd;&#xa;	SELECT&#xd;&#xa;	c.person_id candidate_id,&#xd;&#xa;	p.jobFunction_id fe_id,&#xd;&#xa;	ROW_NUMBER&#x28;&#x29; OVER&#x28;PARTITION BY c.person_id, p.jobFunction_id ORDER BY c.person_id&#x29; rn&#xd;&#xa;	FROM alpha_candidate c&#xd;&#xa;	LEFT JOIN alpha_position p ON c.person_id &#x3d; p.person_id&#xd;&#xa;	WHERE p.jobFunction_id IS NOT NULL&#xd;&#xa;&#x29;,&#xd;&#xa;candidate_fe AS &#x28;&#xd;&#xa;	SELECT DISTINCT candidate_id&#xd;&#xa;	FROM candidate_position cp&#xd;&#xa;	JOIN functional_expertise fe ON cp.fe_id &#x3d; fe.id&#xd;&#xa;	WHERE rn &#x3d; 1&#xd;&#xa;&#x29;&#xd;&#xa;&#xd;&#xa;SELECT&#xd;&#xa;	c.person_id candidate_id,&#xd;&#xa;	CONCAT_WS&#x28;&#xd;&#xa;		CHAR&#x28;10&#x29;,&#xd;&#xa;		CASE WHEN c.is_active &#x3d; 1 THEN &#x27;Active&#x3a; Yes&#x27; ELSE &#x27;Active&#x3a; No&#x27; END,&#xd;&#xa;		CASE WHEN cas.id IS NOT NULL THEN CONCAT&#x28;&#x27;Candidate status&#x3a; &#x27;, CONCAT_WS&#x28;&#x27; - &#x27;, cas.candStatus, cas.description&#x29;&#x29; END,&#xd;&#xa;		CASE WHEN c.lastPlaced IS NOT NULL THEN CONCAT&#x28;&#x27;Last placed date&#x3a; &#x27;, c.lastPlaced&#x29; END,&#xd;&#xa;		CASE WHEN c.last_placed_by IS NOT NULL THEN CONCAT&#x28;&#x27;Last placed by&#x3a; &#x27;, CONCAT_WS&#x28;&#x27; - &#x27;, u.username, u.email&#x29;&#x29; END,&#xd;&#xa;		CASE WHEN cls.clientStatus IS NOT NULL THEN CONCAT&#x28;&#x27;Client status&#x3a; &#x27;, cls.clientStatus&#x29; END,&#xd;&#xa;		CASE WHEN lic.list IS NOT NULL THEN CONCAT&#x28;&#x27;Lists&#x3a; &#x27;, lic.list&#x29; END,&#xd;&#xa;		CASE WHEN p.nationalInsuranceNumber IS NOT NULL THEN CONCAT&#x28;&#x27;NI number&#x3a; &#x27;, nationalInsuranceNumber&#x29; END,&#xd;&#xa;		CASE WHEN c.emailUnsubscribe &#x3d; 1 THEN &#x27;Email unsubscribe&#x3a; Yes&#x27; ELSE &#x27;Email unsubscribe&#x3a; No&#x27; END,&#xd;&#xa;		CASE WHEN c.smsUnsubscribe &#x3d; 1 THEN &#x27;SMS unsubscribe&#x3a; Yes&#x27; ELSE &#x27;SMS unsubscribe&#x3a; No&#x27; END,&#xd;&#xa;		CASE WHEN c.skype IS NOT NULL THEN CONCAT&#x28;&#x27;Skype&#x3a; &#x27;, c.skype&#x29; END,&#xd;&#xa;		CASE WHEN sn.nationality_code IS NOT NULL THEN CONCAT&#x28;&#x27;Second nationality&#x3a; &#x27;, sn.nationality_code&#x29; END,&#xd;&#xa;		CASE WHEN c.visaRequirements IS NOT NULL THEN CONCAT&#x28;&#x27;Visa requirements&#x3a; &#x27;, c.visaRequirements&#x29; END,&#xd;&#xa;		CASE WHEN c.hobbies IS NOT NULL THEN CONCAT&#x28;&#x27;Hobbies&#x3a; &#x27;, c.hobbies&#x29; END,&#xd;&#xa;		CASE WHEN c.created IS NOT NULL THEN CONCAT&#x28;&#x27;Created&#x3a; &#x27;, c.created&#x29; END,&#xd;&#xa;		CASE WHEN c.updated IS NOT NULL THEN CONCAT&#x28;&#x27;Updated&#x3a; &#x27;, c.updated&#x29; END,&#xd;&#xa;		CASE WHEN c.consultantNotes IS NOT NULL THEN CONCAT&#x28;&#x27;Consultant notes&#x3a; &#x27;, c.consultantNotes&#x29; END,&#xd;&#xa;		CASE WHEN c.meetingNotes IS NOT NULL THEN CONCAT&#x28;&#x27;Meeting notes&#x3a; &#x27;, c.meetingNotes&#x29; END&#xd;&#xa;		&#xd;&#xa;-- 		Last Contacted&#x3a;&#xd;&#xa;-- 		Interviews&#x3a;&#xd;&#xa;	&#x29; &#x22;candidate-note&#x22;&#xd;&#xa;	&#xd;&#xa;FROM alpha_candidate c&#xd;&#xa;JOIN alpha_person p ON c.person_id &#x3d; p.id&#xd;&#xa;JOIN candidate_fe cf ON c.person_id &#x3d; cf.candidate_id&#xd;&#xa;LEFT JOIN alpha_address a ON c.address_id &#x3d; a.id&#xd;&#xa;LEFT JOIN alpha_sel_cand_status cas ON c.candStatus_id &#x3d; cas.id&#xd;&#xa;LEFT JOIN alpha_user u ON c.last_placed_by &#x3d; u.id&#xd;&#xa;LEFT JOIN alpha_sel_client_status cls ON c.clientStatus_id &#x3d; cls.id&#xd;&#xa;LEFT JOIN candidate_nationality n ON c.id &#x3d; n.candidate_id AND n.rn &#x3d; 1&#xd;&#xa;LEFT JOIN candidate_education ce ON c.id &#x3d; ce.candidate_id&#xd;&#xa;LEFT JOIN candidate_skill cs ON c.id &#x3d; cs.candidate_id&#xd;&#xa;LEFT JOIN candidate_lists lic ON c.id &#x3d; lic.candidate_id&#xd;&#xa;LEFT JOIN candidate_second_nationality sn ON c.id &#x3d; sn.candidate_id</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1408</xloc>
      <yloc>256</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>candidate_skills</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>source</connection>
    <sql>WITH candidate_skill AS &#x28;&#xd;&#xa;	SELECT&#xd;&#xa;		c.person_id candidate_id,&#xd;&#xa;		GROUP_CONCAT&#x28;&#xd;&#xa;			CONCAT_WS&#x28;&#xd;&#xa;				&#x27;, &#x27;,&#xd;&#xa;				RTRIM&#x28;fq.qualification&#x29;,&#xd;&#xa;				RTRIM&#x28;co.skill&#x29;,&#xd;&#xa;				RTRIM&#x28;c.languageString&#x29;&#xd;&#xa;			&#x29; SEPARATOR &#x27;, &#x27;&#x29; skill&#xd;&#xa;		&#xd;&#xa;	FROM alpha_candidate c&#xd;&#xa;	LEFT JOIN alpha_sel_fin_qual fq ON c.finQual_id &#x3d; fq.id&#xd;&#xa;	LEFT JOIN &#x28;SELECT&#xd;&#xa;							candidate_id,&#xd;&#xa;							GROUP_CONCAT&#x28;RTRIM&#x28;name&#x29; SEPARATOR &#x27;, &#x27;&#x29; skill&#xd;&#xa;						FROM alpha_competency &#xd;&#xa;						WHERE description LIKE &#x27;&#x25;Skill&#x25;&#x27;&#xd;&#xa;						GROUP BY candidate_id&#x29; co ON c.person_id &#x3d; co.candidate_id&#xd;&#xa;	WHERE fq.qualification IS NOT NULL OR co.skill IS NOT NULL&#xd;&#xa;	GROUP BY candidate_id&#xd;&#xa;&#x29;&#xd;&#xa;&#xd;&#xa;SELECT&#xd;&#xa;	c.person_id candidate_id,&#xd;&#xa;	cs.skill skills&#xd;&#xa;&#xd;&#xa;FROM alpha_candidate c&#xd;&#xa;JOIN alpha_person p ON c.person_id &#x3d; p.id&#xd;&#xa;LEFT JOIN candidate_skill cs ON c.id &#x3d; cs.candidate_id&#xd;&#xa;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1408</xloc>
      <yloc>352</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>candidate_work_history</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>source</connection>
    <sql>WITH work_history AS &#x28;&#xd;&#xa;	SELECT&#xd;&#xa;	profile_id,&#xd;&#xa;	GROUP_CONCAT&#x28;&#xd;&#xa;		CONCAT_WS&#x28;&#xd;&#xa;			CHAR&#x28;10&#x29;,&#xd;&#xa;			CASE WHEN NULLIF&#x28;orgName, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Employer&#x3a; &#x27;, orgName&#x29; END,&#xd;&#xa;			CASE WHEN NULLIF&#x28;title, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Job title&#x3a; &#x27;, title&#x29; END,&#xd;&#xa;			CASE WHEN NULLIF&#x28;type, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Job Type&#x3a; &#x27;, type&#x29; END,&#xd;&#xa;			CASE WHEN NULLIF&#x28;partialStartDate, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Start date&#x3a; &#x27;, partialStartDate&#x29; END,&#xd;&#xa;			CASE WHEN NULLIF&#x28;partialEndDate, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;End date&#x3a; &#x27;, partialEndDate&#x29; END,&#xd;&#xa;			CASE WHEN NULLIF&#x28;description, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Description&#x3a; &#x27;, CHAR&#x28;10&#x29;, description&#x29; END&#xd;&#xa;		&#x29;&#xd;&#xa;		SEPARATOR &#x27;&#x5c;n--------------------------------------------------------------------------------------------------&#x5c;n&#x27;&#xd;&#xa;	&#x29; work_history&#xd;&#xa;	&#xd;&#xa;	FROM alpha_cv_employment&#xd;&#xa;	GROUP BY profile_id&#xd;&#xa;&#x29;&#xd;&#xa;SELECT&#xd;&#xa;c.person_id AS candidate_id,&#xd;&#xa;wh.work_history,&#xd;&#xa;wh.profile_id&#xd;&#xa;FROM alpha_candidate c&#xd;&#xa;JOIN work_history wh ON c.cvProfile_id &#x3d; wh.profile_id</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1408</xloc>
      <yloc>544</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>company_activity</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>source</connection>
    <sql>WITH selected_company AS &#x28;&#xd;&#xa;	SELECT&#xd;&#xa;		ct.company_id&#xd;&#xa;	FROM companies_tags ct&#xd;&#xa;	JOIN alpha_tag alt ON ct.tag_id &#x3d; alt.id&#xd;&#xa;	WHERE alt.id &#x3d; 477&#xd;&#xa;&#x29;&#xd;&#xa;SELECT&#xd;&#xa;a.company_id,&#xd;&#xa;CONCAT_WS&#x28;&#xd;&#xa;	CHAR&#x28;10&#x29;,&#xd;&#xa;	CASE WHEN NULLIF&#x28;category, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Category&#x3a; &#x27;, category&#x29; END,&#xd;&#xa;	CASE WHEN NULLIF&#x28;type, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Type&#x3a; &#x27;, type&#x29; END,&#xd;&#xa;	CASE WHEN NULLIF&#x28;stage, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Stage&#x3a; &#x27;, stage&#x29; END,&#xd;&#xa;	CASE WHEN NULLIF&#x28;start, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Start date&#x3a; &#x27;, start&#x29; END,&#xd;&#xa;	CASE WHEN NULLIF&#x28;end, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;End date&#x3a; &#x27;, end&#x29; END,&#xd;&#xa;	CASE WHEN NULLIF&#x28;status, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Status&#x3a; &#x27;, status&#x29; END,&#xd;&#xa;	CASE WHEN NULLIF&#x28;jo.roleTitle, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Job opening&#x3a; &#x27;, roleTitle&#x29; END,&#xd;&#xa;	CASE WHEN NULLIF&#x28;comments, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Comment&#x3a; &#x27;, comments&#x29; END&#xd;&#xa;&#x29; content,&#xd;&#xa;COALESCE&#x28;a.created, CURRENT_TIMESTAMP&#x29; inserted_timestamp,&#xd;&#xa;-10 as user_account_id,&#xd;&#xa;&#x27;comment&#x27; as &#x27;category&#x27;,&#xd;&#xa;&#x27;company&#x27; as &#x27;type&#x27;&#xd;&#xa;&#xd;&#xa;FROM alpha_activity a&#xd;&#xa;LEFT JOIN alpha_job_opening jo ON a.jobOpening_id &#x3d; jo.id&#xd;&#xa;JOIN selected_company sc ON a.company_id &#x3d; sc.company_id</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>96</xloc>
      <yloc>304</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>company_address</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>source</connection>
    <sql>WITH selected_company AS &#x28;&#xd;&#xa;	SELECT&#xd;&#xa;		ct.company_id&#xd;&#xa;	FROM companies_tags ct&#xd;&#xa;	JOIN alpha_tag alt ON ct.tag_id &#x3d; alt.id&#xd;&#xa;	WHERE alt.id &#x3d; 477&#xd;&#xa;&#x29;,&#xd;&#xa;company_address AS &#x28;&#xd;&#xa;	SELECT&#xd;&#xa;	ROW_NUMBER&#x28;&#x29; OVER&#x28;PARTITION BY a.company_id, a.latitude, a.longitude ORDER BY a.company_id&#x29; rn,&#xd;&#xa;	a.company_id,&#xd;&#xa;	CONCAT_WS&#x28;&#x27;,&#x27;, a.addressLine1, a.addressLine2,a.addressLine3&#x29; location_name,&#xd;&#xa;	COALESCE&#x28;a.city, a.region, townCity&#x29; city,&#xd;&#xa;	a.county,&#xd;&#xa;	COALESCE&#x28;REPLACE&#x28;a.countryCode, &#x27;UK&#x27;, &#x27;GB&#x27;&#x29;, REPLACE&#x28;a.countryUkCode, &#x27;ENG&#x27;, &#x27;GB&#x27;&#x29;&#x29; country_code,&#xd;&#xa;	CONCAT_WS&#x28;&#xd;&#xa;		&#x27;, &#x27;,&#xd;&#xa;		CASE WHEN NULLIF&#x28;a.addressLine1, &#x27;&#x27;&#x29; IS NOT NULL THEN a.addressLine1 END,&#xd;&#xa;		CASE WHEN NULLIF&#x28;a.addressLine2, &#x27;&#x27;&#x29; IS NOT NULL THEN a.addressLine2 END,&#xd;&#xa;		CASE WHEN NULLIF&#x28;a.addressLine3, &#x27;&#x27;&#x29; IS NOT NULL THEN a.addressLine3 END,&#xd;&#xa;		CASE WHEN NULLIF&#x28;a.city, &#x27;&#x27;&#x29; OR NULLIF&#x28;a.region, &#x27;&#x27;&#x29; IS NOT NULL THEN COALESCE&#x28;a.city, a.region, townCity&#x29; END,&#xd;&#xa;		CASE WHEN NULLIF&#x28;a.county, &#x27;&#x27;&#x29; IS NOT NULL THEN a.county END,&#xd;&#xa;		CASE WHEN NULLIF&#x28;a.country, &#x27;&#x27;&#x29; IS NOT NULL THEN a.country END&#xd;&#xa;	&#x29; AS address,&#xd;&#xa;	latitude,&#xd;&#xa;	longitude,&#xd;&#xa;	phoneNumber phone_number&#xd;&#xa;	FROM alpha_company_address a&#xd;&#xa;	JOIN selected_company sc ON a.company_id &#x3d; sc.company_id&#xd;&#xa;	WHERE a.company_id IS NOT NULL&#xd;&#xa;&#x29;&#xd;&#xa;&#xd;&#xa;SELECT &#x2a;&#xd;&#xa;FROM company_address&#xd;&#xa;WHERE rn &#x3d; 1&#xd;&#xa;AND COALESCE&#x28;NULLIF&#x28;location_name, &#x27;&#x27;&#x29;, city, county, country_code, NULLIF&#x28;address, &#x27;&#x27;&#x29;, latitude, longitude, phone_number&#x29; IS NOT NULL&#xd;&#xa;ORDER BY company_id&#xd;&#xa;-- LIMIT 500</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>96</xloc>
      <yloc>160</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>company_registration</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>source</connection>
    <sql>WITH selected_company AS &#x28;&#xd;&#xa;	SELECT&#xd;&#xa;		ct.company_id&#xd;&#xa;	FROM companies_tags ct&#xd;&#xa;	JOIN alpha_tag alt ON ct.tag_id &#x3d; alt.id&#xd;&#xa;	WHERE alt.id &#x3d; 477&#xd;&#xa;&#x29;&#xd;&#xa;SELECT&#xd;&#xa;CONVERT&#x28;id, CHAR&#x29; company_id,&#xd;&#xa;created registration_date&#xd;&#xa;FROM alpha_company c&#xd;&#xa;JOIN selected_company sc ON c.id &#x3d; sc.company_id&#xd;&#xa;WHERE companyName IS NOT NULL</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>96</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>contact_FE_no_sub_FE</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>source</connection>
    <sql>WITH functional_expertise AS &#x28;&#xd;&#xa;	SELECT&#xd;&#xa;	id,&#xd;&#xa;	jobFunction sub_functional_expertise,&#xd;&#xa;	type functional_expertise&#xd;&#xa;	FROM &#x60;alpha_sel_job_function&#x60;&#xd;&#xa;	WHERE type IN &#x28;&#x27;Marketing&#x27;, &#x27;Project Management&#x27;, &#x27;Sales&#x27;&#x29;&#xd;&#xa;	AND jobFunction IN &#x28;&#x27;Ad Operations&#x27;, &#x27;Brand Marketing&#x27;, &#x27;Category Manager&#x27;, &#x27;Chief Marketing Officer&#x27;, &#x27;Communications &#x26; PR&#x27;, &#xd;&#xa;												&#x27;CRM&#x27;, &#x27;Digital Marketing&#x27;, &#x27;eCommerce&#x27;, &#x27;Insight &#x26; Analytics&#x27;, &#x27;Marketing Events&#x27;,&#xd;&#xa;												&#x27;Media Planning &#x2f; Buying&#x27;, &#x27;PPC&#x27;, &#x27;SEO&#x27;, &#x27;Social Media&#x27;, &#x27;Business Analysts&#x27;,&#xd;&#xa;												&#x27;Chief Digital Officer&#x27;, &#x27;Digital Project Manager&#x27;, &#x27;Events Manager&#x27;, &#x27;IT Programme Manager&#x27;, &#x27;IT Project Manager&#x27;, &#xd;&#xa;												&#x27;PMO Analyst&#x27;, &#x27;PMO Assurance&#x27;, &#x27;Product Developer&#x27;, &#x27;Product Manager&#x27;, &#x27;Project Administrator&#x27;,&#xd;&#xa;												&#x27;Project Director&#x27;, &#x27;Project Manager&#x27;, &#x27;Project Resource Planner&#x27;, &#x27;Project Support&#x2f;Co-ordinator&#x27;, &#x27;Risk Manager&#x27;,&#xd;&#xa;												&#x27;Transformation and Change Manager&#x27;, &#x27;COO&#x27;, &#x27;MD &#x2f; CEO &#x2f; VP&#x27;&#x29;&#xd;&#xa;&#x29;,&#xd;&#xa;selected_company AS &#x28;&#xd;&#xa;	SELECT&#xd;&#xa;		ct.company_id&#xd;&#xa;	FROM companies_tags ct&#xd;&#xa;	JOIN alpha_tag alt ON ct.tag_id &#x3d; alt.id&#xd;&#xa;	WHERE alt.id &#x3d; 477&#xd;&#xa;&#x29;,&#xd;&#xa;current_contact AS &#x28;&#xd;&#xa;	SELECT&#xd;&#xa;	cc.person_id contact_id,&#xd;&#xa;	cc.jobFunction_id,&#xd;&#xa;	ROW_NUMBER&#x28;&#x29; OVER&#x28;PARTITION BY cc.person_id ORDER BY STR_TO_DATE&#x28;REPLACE&#x28;cc.startDate, &#x27;&#x2f;&#x27;, &#x27;-&#x27;&#x29;, &#x27;&#x25;d-&#x25;m-&#x25;Y&#x27;&#x29; DESC&#x29; rn&#xd;&#xa;	FROM alpha_position cc&#xd;&#xa;	JOIN alpha_person ap ON cc.person_id &#x3d; ap.id&#xd;&#xa;	JOIN alpha_company ac ON cc.company_id &#x3d; ac.id&#xd;&#xa;	JOIN selected_company sc ON cc.id &#x3d; sc.company_id&#xd;&#xa;&#x29;&#xd;&#xa;SELECT&#xd;&#xa;contact_id,&#xd;&#xa;sub_functional_expertise,&#xd;&#xa;functional_expertise&#xd;&#xa;FROM current_contact cc&#xd;&#xa;JOIN functional_expertise fe ON cc.jobFunction_id &#x3d; fe.id&#xd;&#xa;WHERE rn &#x3d; 1&#xd;&#xa;AND sub_functional_expertise IS NULL</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>624</xloc>
      <yloc>416</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>contact_FE_no_sub_FE 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>source</connection>
    <sql>WITH functional_expertise AS &#x28;&#xd;&#xa;	SELECT&#xd;&#xa;	id,&#xd;&#xa;	jobFunction sub_functional_expertise,&#xd;&#xa;	type functional_expertise&#xd;&#xa;	FROM &#x60;alpha_sel_job_function&#x60;&#xd;&#xa;	WHERE type IN &#x28;&#x27;Marketing&#x27;, &#x27;Project Management&#x27;, &#x27;Sales&#x27;&#x29;&#xd;&#xa;	AND jobFunction IN &#x28;&#x27;Ad Operations&#x27;, &#x27;Brand Marketing&#x27;, &#x27;Category Manager&#x27;, &#x27;Chief Marketing Officer&#x27;, &#x27;Communications &#x26; PR&#x27;, &#xd;&#xa;												&#x27;CRM&#x27;, &#x27;Digital Marketing&#x27;, &#x27;eCommerce&#x27;, &#x27;Insight &#x26; Analytics&#x27;, &#x27;Marketing Events&#x27;,&#xd;&#xa;												&#x27;Media Planning &#x2f; Buying&#x27;, &#x27;PPC&#x27;, &#x27;SEO&#x27;, &#x27;Social Media&#x27;, &#x27;Business Analysts&#x27;,&#xd;&#xa;												&#x27;Chief Digital Officer&#x27;, &#x27;Digital Project Manager&#x27;, &#x27;Events Manager&#x27;, &#x27;IT Programme Manager&#x27;, &#x27;IT Project Manager&#x27;, &#xd;&#xa;												&#x27;PMO Analyst&#x27;, &#x27;PMO Assurance&#x27;, &#x27;Product Developer&#x27;, &#x27;Product Manager&#x27;, &#x27;Project Administrator&#x27;,&#xd;&#xa;												&#x27;Project Director&#x27;, &#x27;Project Manager&#x27;, &#x27;Project Resource Planner&#x27;, &#x27;Project Support&#x2f;Co-ordinator&#x27;, &#x27;Risk Manager&#x27;,&#xd;&#xa;												&#x27;Transformation and Change Manager&#x27;, &#x27;COO&#x27;, &#x27;MD &#x2f; CEO &#x2f; VP&#x27;&#x29;&#xd;&#xa;&#x29;,&#xd;&#xa;all_contact AS &#x28;&#xd;&#xa;	SELECT &#x2a;,&#xd;&#xa;	ROW_NUMBER&#x28;&#x29; OVER&#x28;PARTITION BY person_id ORDER BY STR_TO_DATE&#x28;REPLACE&#x28;startDate, &#x27;&#x2f;&#x27;, &#x27;-&#x27;&#x29;, &#x27;&#x25;d-&#x25;m-&#x25;Y&#x27;&#x29; DESC&#x29; rn&#xd;&#xa;	FROM alpha_position&#xd;&#xa;&#x29;,&#xd;&#xa;current_contact AS &#x28;&#xd;&#xa;	SELECT&#xd;&#xa;	cc.person_id contact_id,&#xd;&#xa;	cc.jobFunction_id,&#xd;&#xa;	ROW_NUMBER&#x28;&#x29; OVER&#x28;PARTITION BY cc.person_id, cc.company_id ORDER BY cc.person_id&#x29; rn&#xd;&#xa;	FROM all_contact cc&#xd;&#xa;	JOIN alpha_person ap ON cc.person_id &#x3d; ap.id&#xd;&#xa;	JOIN alpha_company ac ON cc.company_id &#x3d; ac.id&#xd;&#xa;	WHERE cc.rn &#x3d; 1&#xd;&#xa;&#x29;&#xd;&#xa;SELECT&#xd;&#xa;contact_id,&#xd;&#xa;sub_functional_expertise,&#xd;&#xa;functional_expertise&#xd;&#xa;FROM current_contact cc&#xd;&#xa;JOIN functional_expertise fe ON cc.jobFunction_id &#x3d; fe.id&#xd;&#xa;WHERE rn &#x3d; 1&#xd;&#xa;AND sub_functional_expertise IS NULL&#xd;&#xa;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1296</xloc>
      <yloc>784</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>contact_FE_sub_FE</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>source</connection>
    <sql>WITH functional_expertise AS &#x28;&#xd;&#xa;	SELECT&#xd;&#xa;	id,&#xd;&#xa;	jobFunction sub_functional_expertise,&#xd;&#xa;	type functional_expertise&#xd;&#xa;	FROM &#x60;alpha_sel_job_function&#x60;&#xd;&#xa;	WHERE type IN &#x28;&#x27;Marketing&#x27;, &#x27;Project Management&#x27;, &#x27;Sales&#x27;&#x29;&#xd;&#xa;	AND jobFunction IN &#x28;&#x27;Ad Operations&#x27;, &#x27;Brand Marketing&#x27;, &#x27;Category Manager&#x27;, &#x27;Chief Marketing Officer&#x27;, &#x27;Communications &#x26; PR&#x27;, &#xd;&#xa;												&#x27;CRM&#x27;, &#x27;Digital Marketing&#x27;, &#x27;eCommerce&#x27;, &#x27;Insight &#x26; Analytics&#x27;, &#x27;Marketing Events&#x27;,&#xd;&#xa;												&#x27;Media Planning &#x2f; Buying&#x27;, &#x27;PPC&#x27;, &#x27;SEO&#x27;, &#x27;Social Media&#x27;, &#x27;Business Analysts&#x27;,&#xd;&#xa;												&#x27;Chief Digital Officer&#x27;, &#x27;Digital Project Manager&#x27;, &#x27;Events Manager&#x27;, &#x27;IT Programme Manager&#x27;, &#x27;IT Project Manager&#x27;, &#xd;&#xa;												&#x27;PMO Analyst&#x27;, &#x27;PMO Assurance&#x27;, &#x27;Product Developer&#x27;, &#x27;Product Manager&#x27;, &#x27;Project Administrator&#x27;,&#xd;&#xa;												&#x27;Project Director&#x27;, &#x27;Project Manager&#x27;, &#x27;Project Resource Planner&#x27;, &#x27;Project Support&#x2f;Co-ordinator&#x27;, &#x27;Risk Manager&#x27;,&#xd;&#xa;												&#x27;Transformation and Change Manager&#x27;, &#x27;COO&#x27;, &#x27;MD &#x2f; CEO &#x2f; VP&#x27;&#x29;&#xd;&#xa;&#x29;,&#xd;&#xa;selected_company AS &#x28;&#xd;&#xa;	SELECT&#xd;&#xa;		ct.company_id&#xd;&#xa;	FROM companies_tags ct&#xd;&#xa;	JOIN alpha_tag alt ON ct.tag_id &#x3d; alt.id&#xd;&#xa;	WHERE alt.id &#x3d; 477&#xd;&#xa;&#x29;,&#xd;&#xa;current_contact AS &#x28;&#xd;&#xa;	SELECT&#xd;&#xa;	cc.person_id contact_id,&#xd;&#xa;	cc.jobFunction_id,&#xd;&#xa;	ROW_NUMBER&#x28;&#x29; OVER&#x28;PARTITION BY cc.person_id ORDER BY STR_TO_DATE&#x28;REPLACE&#x28;cc.startDate, &#x27;&#x2f;&#x27;, &#x27;-&#x27;&#x29;, &#x27;&#x25;d-&#x25;m-&#x25;Y&#x27;&#x29; DESC&#x29; rn&#xd;&#xa;	FROM alpha_position cc&#xd;&#xa;	JOIN alpha_person ap ON cc.person_id &#x3d; ap.id&#xd;&#xa;	JOIN alpha_company ac ON cc.company_id &#x3d; ac.id&#xd;&#xa;	JOIN selected_company sc ON cc.id &#x3d; sc.company_id&#xd;&#xa;&#x29;&#xd;&#xa;SELECT&#xd;&#xa;contact_id,&#xd;&#xa;sub_functional_expertise,&#xd;&#xa;functional_expertise&#xd;&#xa;FROM current_contact cc&#xd;&#xa;JOIN functional_expertise fe ON cc.jobFunction_id &#x3d; fe.id&#xd;&#xa;WHERE rn &#x3d; 1&#xd;&#xa;-- AND sub_functional_expertise IS NULL</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>608</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>contact_mobile</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>source</connection>
    <sql>WITH selected_company AS &#x28;&#xd;&#xa;	SELECT&#xd;&#xa;		ct.company_id&#xd;&#xa;	FROM companies_tags ct&#xd;&#xa;	JOIN alpha_tag alt ON ct.tag_id &#x3d; alt.id&#xd;&#xa;	WHERE alt.id &#x3d; 477&#xd;&#xa;&#x29;,&#xd;&#xa;current_contact AS &#x28;&#xd;&#xa;	SELECT&#xd;&#xa;	cc.person_id contact_id,&#xd;&#xa;	ROW_NUMBER&#x28;&#x29; OVER&#x28;PARTITION BY cc.person_id ORDER BY STR_TO_DATE&#x28;REPLACE&#x28;cc.startDate, &#x27;&#x2f;&#x27;, &#x27;-&#x27;&#x29;, &#x27;&#x25;d-&#x25;m-&#x25;Y&#x27;&#x29; DESC&#x29; rn,&#xd;&#xa;	STR_TO_DATE&#x28;REPLACE&#x28;cc.startDate, &#x27;&#x2f;&#x27;, &#x27;-&#x27;&#x29;, &#x27;&#x25;d-&#x25;m-&#x25;Y&#x27;&#x29; start_date,&#xd;&#xa;	cc.company_id,&#xd;&#xa;	ap.firstName first_name,&#xd;&#xa;	ap.lastName last_name,&#xd;&#xa;	cc.directNumber phone,&#xd;&#xa;	cc.mobileNumber mobile,&#xd;&#xa;	cc.email,&#xd;&#xa;	cc.roleTitle job_title,&#xd;&#xa;	CONCAT_WS&#x28;&#xd;&#xa;		CHAR&#x28;10&#x29;,&#xd;&#xa;		CASE WHEN ap.gender IS NOT NULL THEN CONCAT&#x28;&#x27;Gender&#x3a; &#x27;, ap.gender&#x29; END,&#xd;&#xa;		CASE WHEN srl.recruiterLevel IS NOT NULL THEN CONCAT&#x28;&#x27;Recruiter level&#x3a; &#x27;, srl.recruiterLevel&#x29; END,&#xd;&#xa;		CASE WHEN sjf.jobFunction IS NOT NULL THEN CONCAT&#x28;&#x27;Job function&#x3a; &#x27;, sjf.jobFunction&#x29; END,&#xd;&#xa;		CASE WHEN cc.startDate IS NOT NULL THEN CONCAT&#x28;&#x27;&#x5b;Current Role&#x5d; Start date&#x3a; &#x27;, cc.startDate&#x29; END,&#xd;&#xa;		CASE WHEN ac.companyName IS NOT NULL THEN CONCAT&#x28;&#x27;&#x5b;Current Role&#x5d; Office&#x3a; &#x27;, ac.companyName&#x29; END,&#xd;&#xa;		CASE WHEN cc.is_active &#x3d; 0 THEN &#x27;Active user&#x3a; No&#x27; ELSE &#x27;Active user&#x3a; Yes&#x27; END,&#xd;&#xa;		CASE WHEN tan.linkedInUrl IS NOT NULL THEN CONCAT&#x28;&#x27;LinkedIn&#x3a; &#x27;, tan.linkedInUrl&#x29; END,&#xd;&#xa;		CASE WHEN cc.emailUnsubscribe &#x3d; 0 THEN &#x27;Email unsubscribe&#x3a; No&#x27; ELSE &#x27;Email unsubscribe&#x3a; Yes&#x27; END,&#xd;&#xa;		CASE WHEN ap.meetingNotes IS NOT NULL THEN CONCAT&#x28;&#x27;Meeting notes&#x3a; &#x27;, ap.meetingNotes&#x29; END&#xd;&#xa;	&#x29; note&#xd;&#xa;	FROM alpha_position cc&#xd;&#xa;	JOIN alpha_person ap ON cc.person_id &#x3d; ap.id&#xd;&#xa;	JOIN alpha_company ac ON cc.company_id &#x3d; ac.id&#xd;&#xa;	JOIN selected_company sc ON cc.company_id &#x3d; sc.company_id&#xd;&#xa;	LEFT JOIN alpha_sel_recruiter_level srl ON cc.recruiterLevel_id &#x3d; srl.id&#xd;&#xa;	LEFT JOIN alpha_sel_job_function sjf ON cc.recruitsJobFunction_id &#x3d; sjf.id&#xd;&#xa;	LEFT JOIN table_appy_nitty tan ON cc.person_id &#x3d; tan.person_id&#xd;&#xa;	WHERE COALESCE&#x28;cc.directNumber, cc.email&#x29; IS NOT NULL&#xd;&#xa;&#x29;,&#xd;&#xa;check_dup_email AS &#x28;&#xd;&#xa;	SELECT &#x2a;,&#xd;&#xa;		CASE&#xd;&#xa;			WHEN email IS NOT NULL THEN ROW_NUMBER&#x28;&#x29; OVER&#x28;PARTITION BY email ORDER BY start_date DESC&#x29;&#xd;&#xa;			ELSE 1&#xd;&#xa;		END AS rn_email&#xd;&#xa;	FROM current_contact&#xd;&#xa;	WHERE rn &#x3d; 1&#xd;&#xa;&#x29;&#xd;&#xa;SELECT&#xd;&#xa;CAST&#x28;contact_id AS CHAR&#x29; contact_id,&#xd;&#xa;mobile&#xd;&#xa;FROM check_dup_email</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>672</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>fe_lookup</name>
    <type>DBLookup</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>functional_expertise</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>functional_expertise</name>
        <field>name</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>fe_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>784</xloc>
      <yloc>192</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>fe_lookup 2 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>functional_expertise</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>functional_expertise</name>
        <field>name</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>fe_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>992</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>fe_lookup 2 2 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>functional_expertise</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>functional_expertise</name>
        <field>name</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>fe_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1664</xloc>
      <yloc>640</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>insert_candidate_FE_sub_FE</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <schema>public</schema>
    <table>candidate_functional_expertise</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>N</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field>contactid</partitioning_field>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>candidate_id</column_name>
          <stream_name>actual_candidate_id</stream_name>
        </field>
        <field>
          <column_name>functional_expertise_id</column_name>
          <stream_name>fe_id</stream_name>
        </field>
        <field>
          <column_name>sub_functional_expertise_id</column_name>
          <stream_name>sub_fe_id</stream_name>
        </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1936</xloc>
      <yloc>640</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>insert_candidate_activity</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <schema>public</schema>
    <table>activity</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>candidate_id</column_name>
          <stream_name>actual_candidate_id</stream_name>
        </field>
        <field>
          <column_name>content</column_name>
          <stream_name>content</stream_name>
        </field>
        <field>
          <column_name>insert_timestamp</column_name>
          <stream_name>inserted_timestamp</stream_name>
        </field>
        <field>
          <column_name>user_account_id</column_name>
          <stream_name>user_account_id</stream_name>
        </field>
        <field>
          <column_name>category</column_name>
          <stream_name>category</stream_name>
        </field>
        <field>
          <column_name>type</column_name>
          <stream_name>type</stream_name>
        </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1760</xloc>
      <yloc>80</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>insert_candidate_document</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <schema>public</schema>
    <table>bulk_upload_document_mapping</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>entity_id</column_name>
          <stream_name>actual_candidate_id</stream_name>
        </field>
        <field>
          <column_name>file_name</column_name>
          <stream_name>document</stream_name>
        </field>
        <field>
          <column_name>entity_type</column_name>
          <stream_name>entity_type</stream_name>
        </field>
        <field>
          <column_name>document_type</column_name>
          <stream_name>document_type</stream_name>
        </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1824</xloc>
      <yloc>896</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>insert_company_activity</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <schema>public</schema>
    <table>activity</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>company_id</column_name>
          <stream_name>actual_company_id</stream_name>
        </field>
        <field>
          <column_name>content</column_name>
          <stream_name>content</stream_name>
        </field>
        <field>
          <column_name>insert_timestamp</column_name>
          <stream_name>inserted_timestamp</stream_name>
        </field>
        <field>
          <column_name>user_account_id</column_name>
          <stream_name>user_account_id</stream_name>
        </field>
        <field>
          <column_name>category</column_name>
          <stream_name>category</stream_name>
        </field>
        <field>
          <column_name>type</column_name>
          <stream_name>type</stream_name>
        </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>448</xloc>
      <yloc>304</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>insert_company_address</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <schema>public</schema>
    <table>company_location</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>company_id</column_name>
          <stream_name>actual_company_id</stream_name>
        </field>
        <field>
          <column_name>location_name</column_name>
          <stream_name>location_name</stream_name>
        </field>
        <field>
          <column_name>city</column_name>
          <stream_name>city</stream_name>
        </field>
        <field>
          <column_name>state</column_name>
          <stream_name>county</stream_name>
        </field>
        <field>
          <column_name>country_code</column_name>
          <stream_name>country_code</stream_name>
        </field>
        <field>
          <column_name>address</column_name>
          <stream_name>address</stream_name>
        </field>
        <field>
          <column_name>latitude</column_name>
          <stream_name>latitude</stream_name>
        </field>
        <field>
          <column_name>longitude</column_name>
          <stream_name>longitude</stream_name>
        </field>
        <field>
          <column_name>phone_number</column_name>
          <stream_name>phone_number</stream_name>
        </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>448</xloc>
      <yloc>160</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>insert_contact_FE 2 2</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <schema>public</schema>
    <table>contact_functional_expertise</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>N</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field>contactid</partitioning_field>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>contact_id</column_name>
          <stream_name>actual_contact_id</stream_name>
        </field>
        <field>
          <column_name>functional_expertise_id</column_name>
          <stream_name>fe_id</stream_name>
        </field>
        <field>
          <column_name>sub_functional_expertise_id</column_name>
          <stream_name>sub_fe_id</stream_name>
        </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1264</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>insert_contact_FE_no_sub_fe</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <schema>public</schema>
    <table>contact_functional_expertise</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>N</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field>contactid</partitioning_field>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>contact_id</column_name>
          <stream_name>actual_contact_id</stream_name>
        </field>
        <field>
          <column_name>functional_expertise_id</column_name>
          <stream_name>fe_id</stream_name>
        </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1264</xloc>
      <yloc>416</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>insert_contact_FE_no_sub_fe 2</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <schema>public</schema>
    <table>contact_functional_expertise</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>N</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field>contactid</partitioning_field>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>contact_id</column_name>
          <stream_name>actual_contact_id</stream_name>
        </field>
        <field>
          <column_name>functional_expertise_id</column_name>
          <stream_name>fe_id</stream_name>
        </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1936</xloc>
      <yloc>784</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>insert_sub_FE</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>sub_functional_expertise</table>
      <key>
        <name>fe_id</name>
        <field>functional_expertise_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>sub_functional_expertise</name>
        <field>name</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>name</name>
        <rename>sub_functional_expertise</rename>
        <update>Y</update>
      </value>
      <value>
        <name>insert_timestamp</name>
        <rename>insert_timestamp</rename>
        <update>Y</update>
      </value>
      <value>
        <name>functional_expertise_id</name>
        <rename>fe_id</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>960</xloc>
      <yloc>192</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>insert_update_company_registration_date</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <commit>100</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>company</table>
      <key>
        <name>actual_company_id</name>
        <field>id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>insert_timestamp</name>
        <rename>registration_date</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>448</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>sub_FE</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>source</connection>
    <sql>WITH sub_functional_expertise AS &#x28;&#xd;&#xa;SELECT &#x27;Marketing&#x27; AS functional_expertise, &#x27;Ad Operations&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Marketing&#x27; AS functional_expertise, &#x27;B2B marketing&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Marketing&#x27; AS functional_expertise, &#x27;Brand Marketing&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Marketing&#x27; AS functional_expertise, &#x27;Campaign Marketing&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Marketing&#x27; AS functional_expertise, &#x27;Category Manager&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Marketing&#x27; AS functional_expertise, &#x27;Chief Marketing Officer&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Marketing&#x27; AS functional_expertise, &#x27;Communications &#x26; PR&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Marketing&#x27; AS functional_expertise, &#x27;CRM&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Marketing&#x27; AS functional_expertise, &#x27;CRO Marketing&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Marketing&#x27; AS functional_expertise, &#x27;Data Analyst Marketing&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Marketing&#x27; AS functional_expertise, &#x27;Digital Marketing&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Marketing&#x27; AS functional_expertise, &#x27;eCommerce&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Marketing&#x27; AS functional_expertise, &#x27;Events Marketing&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Marketing&#x27; AS functional_expertise, &#x27;Insight &#x26; Analytics&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Marketing&#x27; AS functional_expertise, &#x27;Marketing Events&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Marketing&#x27; AS functional_expertise, &#x27;Marketing Strategy&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Marketing&#x27; AS functional_expertise, &#x27;Media Planning &#x2f; Buying&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Marketing&#x27; AS functional_expertise, &#x27;PPC&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Marketing&#x27; AS functional_expertise, &#x27;Product Marketing&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Marketing&#x27; AS functional_expertise, &#x27;Research Marketing&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Marketing&#x27; AS functional_expertise, &#x27;SEO&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Marketing&#x27; AS functional_expertise, &#x27;Social Media&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Project Management&#x27; AS functional_expertise, &#x27;&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Project Management&#x27; AS functional_expertise, &#x27;Business Analysts&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Project Management&#x27; AS functional_expertise, &#x27;Chief Digital Officer&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Project Management&#x27; AS functional_expertise, &#x27;Digital Project Manager&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Project Management&#x27; AS functional_expertise, &#x27;Events Manager&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Project Management&#x27; AS functional_expertise, &#x27;IT Programme Manager&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Project Management&#x27; AS functional_expertise, &#x27;IT Project Manager&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Project Management&#x27; AS functional_expertise, &#x27;PMO Analyst&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Project Management&#x27; AS functional_expertise, &#x27;PMO Assurance&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Project Management&#x27; AS functional_expertise, &#x27;Product Developer&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Project Management&#x27; AS functional_expertise, &#x27;Product Manager&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Project Management&#x27; AS functional_expertise, &#x27;Project Administrator&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Project Management&#x27; AS functional_expertise, &#x27;Project Director&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Project Management&#x27; AS functional_expertise, &#x27;Project Manager&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Project Management&#x27; AS functional_expertise, &#x27;Project Resource Planner&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Project Management&#x27; AS functional_expertise, &#x27;Project Support&#x2f;Co-ordinator&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Project Management&#x27; AS functional_expertise, &#x27;Risk Manager&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Project Management&#x27; AS functional_expertise, &#x27;Transformation and Change Manager&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Sales&#x27; AS functional_expertise, &#x27;COO&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x27;Sales&#x27; AS functional_expertise, &#x27;MD &#x2f; CEO &#x2f; VP&#x27; AS sub_functional_expertise, CURRENT_TIMESTAMP AS insert_timestamp&#xd;&#xa;&#x29;&#xd;&#xa;SELECT &#x2a;, ROW_NUMBER&#x28;&#x29; OVER&#x28;&#x29; AS id&#xd;&#xa;FROM sub_functional_expertise&#xd;&#xa;WHERE sub_functional_expertise &#x3c;&#x3e; &#x27;&#x27;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>624</xloc>
      <yloc>192</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>sub_fe_lookup 2 2 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>sub_functional_expertise</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>fe_id</name>
        <field>functional_expertise_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>sub_functional_expertise</name>
        <field>name</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>sub_fe_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1136</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>sub_fe_lookup 2 2 2 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>sub_functional_expertise</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>fe_id</name>
        <field>functional_expertise_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>sub_functional_expertise</name>
        <field>name</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>sub_fe_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1808</xloc>
      <yloc>640</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>update_candidate_current_position</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <key>
        <name>actual_candidate_id</name>
        <field>id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>experience_details_json</name>
        <rename>data</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1792</xloc>
      <yloc>1072</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>update_candidate_edu</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <key>
        <name>actual_candidate_id</name>
        <field>id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>education_summary</name>
        <rename>education_summary</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1760</xloc>
      <yloc>160</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>update_candidate_keywords</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <key>
        <name>actual_candidate_id</name>
        <field>id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>keyword</name>
        <rename>keywords</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1776</xloc>
      <yloc>448</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>update_candidate_nationality</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <key>
        <name>actual_candidate_id</name>
        <field>id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>nationality</name>
        <rename>nationality</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1792</xloc>
      <yloc>976</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>update_candidate_note</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <key>
        <name>actual_candidate_id</name>
        <field>id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>note</name>
        <rename>candidate-note</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1776</xloc>
      <yloc>256</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>update_candidate_skills</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <key>
        <name>actual_candidate_id</name>
        <field>id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>skills</name>
        <rename>skills</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1776</xloc>
      <yloc>352</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>update_candidate_work_history</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <key>
        <name>actual_candidate_id</name>
        <field>id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>experience</name>
        <rename>work_history</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1776</xloc>
      <yloc>544</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>update_contact_mobile</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>contact</table>
      <key>
        <name>actual_contact_id</name>
        <field>id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>mobile_phone</name>
        <rename>mobile</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1040</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Database lookup 2 2 2 4</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>candidate_id</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>actual_candidate_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1584</xloc>
      <yloc>1184</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>candidate_edu 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>source</connection>
    <sql>WITH candidate_education AS &#x28;&#xd;&#xa;	SELECT&#xd;&#xa;		candidate_id,&#xd;&#xa;		GROUP_CONCAT&#x28;&#xd;&#xa;			CONCAT_WS&#x28;&#xd;&#xa;				CHAR&#x28;10&#x29;,&#xd;&#xa;				CASE WHEN NULLIF&#x28;schoolName, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;School name&#x3a; &#x27;, schoolName&#x29; END,&#xd;&#xa;				CASE WHEN NULLIF&#x28;organizationUnit, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Department&#x3a; &#x27;, organizationUnit&#x29; END,&#xd;&#xa;				CASE WHEN NULLIF&#x28;startDate, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Start date&#x3a; &#x27;, startDate&#x29; END,&#xd;&#xa;				CASE WHEN NULLIF&#x28;endDate, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;End date&#x3a; &#x27;, endDate&#x29; END,&#xd;&#xa;				CASE WHEN NULLIF&#x28;degreeName, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Degree name&#x3a; &#x27;, degreeName&#x29; END,&#xd;&#xa;				CASE WHEN NULLIF&#x28;major, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Major&#x3a; &#x27;, major&#x29; END,&#xd;&#xa;				CASE WHEN NULLIF&#x28;measure, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Grade&#x3a; &#x27;, measure&#x29; END,&#xd;&#xa;				CASE WHEN NULLIF&#x28;degreeDate, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Degree date&#x3a; &#x27;, degreeDate&#x29; END,&#xd;&#xa;				CASE WHEN NULLIF&#x28;comments, &#x27;&#x27;&#x29; IS NOT NULL THEN CONCAT&#x28;&#x27;Comment&#x3a; &#x27;, CHAR&#x28;10&#x29;, comments&#x29; END&#xd;&#xa;			&#x29; SEPARATOR &#x27;&#x5c;n--------------------------------------------------------------------------------------------------&#x5c;n&#x27;&#xd;&#xa;		&#x29; education_summary&#xd;&#xa;	FROM alpha_education&#xd;&#xa;	GROUP BY candidate_id&#xd;&#xa;&#x29;&#xd;&#xa;SELECT&#xd;&#xa;	CAST&#x28;c.person_id AS CHAR&#x29; candidate_id,&#xd;&#xa;	ce.education_summary&#xd;&#xa;	&#xd;&#xa;FROM alpha_candidate c&#xd;&#xa;JOIN alpha_person p ON c.person_id &#x3d; p.id&#xd;&#xa;LEFT JOIN candidate_education ce ON c.id &#x3d; ce.candidate_id&#xd;&#xa;-- WHERE c.person_id BETWEEN 0 AND 100000&#xd;&#xa;-- &#xd;&#xa;-- &#x29; temp WHERE rn &#x3c;&#x3e; 1</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1424</xloc>
      <yloc>1184</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>update_candidate_edu 2</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <key>
        <name>actual_candidate_id</name>
        <field>id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>education_summary</name>
        <rename>education_summary</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1792</xloc>
      <yloc>1184</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>Database lookup 2 2 2 3 3</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>candidate_id</name>
        <field>external_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>actual_candidate_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1584</xloc>
      <yloc>1280</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>candidate_salary</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>source</connection>
    <sql>WITH current_salary AS &#x28;&#xd;&#xa;	SELECT&#xd;&#xa;		person_id,&#xd;&#xa;		salaryAmount current_salary,&#xd;&#xa;		ROW_NUMBER&#x28;&#x29; OVER&#x28;PARTITION BY person_id ORDER BY startDate DESC&#x29; rn&#xd;&#xa;	FROM alpha_position p&#xd;&#xa;	WHERE salaryAmount IS NOT NULL&#xd;&#xa;&#x29;&#xd;&#xa;SELECT&#xd;&#xa;c.person_id AS candidate_id,&#xd;&#xa;current_salary,&#xd;&#xa;c.salaryAmount AS desire_salary&#xd;&#xa;FROM alpha_candidate c&#xd;&#xa;LEFT JOIN current_salary cs ON c.person_id &#x3d; cs.person_id&#xd;&#xa;WHERE cs.rn &#x3d; 1&#xd;&#xa;AND COALESCE&#x28;current_salary, c.salaryAmount&#x29; IS NOT NULL</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1424</xloc>
      <yloc>1280</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>update_candidate_salary</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>prod_db</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <key>
        <name>actual_candidate_id</name>
        <field>id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>current_salary</name>
        <rename>current_salary</rename>
        <update>Y</update>
      </value>
      <value>
        <name>desire_salary</name>
        <rename>desire_salary</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1792</xloc>
      <yloc>1280</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step_error_handling>
  </step_error_handling>
  <slave-step-copy-partition-distribution>
  </slave-step-copy-partition-distribution>
  <slave_transformation>N</slave_transformation>
</transformation>
