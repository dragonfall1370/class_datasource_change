<?xml version="1.0" encoding="UTF-8"?>
<transformation>
  <info>
    <name>industries__function_expertise__skills__source</name>
    <description/>
    <extended_description/>
    <trans_version/>
    <trans_type>Normal</trans_type>
    <trans_status>0</trans_status>
    <directory>/</directory>
    <parameters>
    </parameters>
    <log>
      <trans-log-table>
        <connection/>
        <schema/>
        <table/>
        <size_limit_lines/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
          <subject/>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
          <subject/>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
          <subject/>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
          <subject/>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </trans-log-table>
      <perf-log-table>
        <connection/>
        <schema/>
        <table/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>SEQ_NR</id>
          <enabled>Y</enabled>
          <name>SEQ_NR</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>INPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>INPUT_BUFFER_ROWS</name>
        </field>
        <field>
          <id>OUTPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>OUTPUT_BUFFER_ROWS</name>
        </field>
      </perf-log-table>
      <channel-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
      <step-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
      </step-log-table>
      <metrics-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>METRICS_DATE</id>
          <enabled>Y</enabled>
          <name>METRICS_DATE</name>
        </field>
        <field>
          <id>METRICS_CODE</id>
          <enabled>Y</enabled>
          <name>METRICS_CODE</name>
        </field>
        <field>
          <id>METRICS_DESCRIPTION</id>
          <enabled>Y</enabled>
          <name>METRICS_DESCRIPTION</name>
        </field>
        <field>
          <id>METRICS_SUBJECT</id>
          <enabled>Y</enabled>
          <name>METRICS_SUBJECT</name>
        </field>
        <field>
          <id>METRICS_TYPE</id>
          <enabled>Y</enabled>
          <name>METRICS_TYPE</name>
        </field>
        <field>
          <id>METRICS_VALUE</id>
          <enabled>Y</enabled>
          <name>METRICS_VALUE</name>
        </field>
      </metrics-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file/>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
    <created_user>-</created_user>
    <created_date>2018/12/07 17:14:30.529</created_date>
    <modified_user>-</modified_user>
    <modified_date>2018/12/07 17:14:30.529</modified_date>
    <key_for_session_key>H4sIAAAAAAAAAAMAAAAAAAAAAAA=</key_for_session_key>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
  </notepads>
  <connection>
    <name>cusDB</name>
    <server>localhost</server>
    <type>MSSQLNATIVE</type>
    <access>Native</access>
    <database>BiGGGroupProd</database>
    <port>1433</port>
    <username>sa</username>
    <password>Encrypted 2be98afc86aa7f2d5f94aea35e083b8df</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>MSSQLUseIntegratedSecurity</code>
        <attribute>false</attribute>
      </attribute>
      <attribute>
        <code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>1433</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>vcDB</name>
    <server>rdb</server>
    <type>POSTGRESQL</type>
    <access>Native</access>
    <database>bigggroup.vincere.io</database>
    <port>5432</port>
    <username>dbapplication_user</username>
    <password>Encrypted 2be98afc819e8b9aebe11bd63cb8b9ae3</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>5432</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <order>
    <hop>
      <from>Industries Collection</from>
      <to>Insert Industries</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>funtional_expertise</from>
      <to>Insert functional_expertise</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>sub_funtional_expertise</from>
      <to>Insert sub_functional_expertise</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Can funtional_expertise</from>
      <to>VC Can Lookup 4</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Con funtional_expertise</from>
      <to>VC Con Lookup 4</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>VC Can Lookup 4</from>
      <to>Insert candidate_functional_expertise</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>VC Con Lookup 4</from>
      <to>Insert contact_functional_expertise</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Com Industries</from>
      <to>LookupCom1</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>LookupCom1</from>
      <to>LookupIndustry1</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>LookupIndustry1</from>
      <to>Inject Com Industries</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Con Industries</from>
      <to>LookupCon1</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>LookupCon1</from>
      <to>LookupIndustry2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>LookupIndustry2</from>
      <to>Inject Con Industries</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Can Lookup 2</from>
      <to>candidate_source Lookup</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>candidate_source Lookup</from>
      <to>Can Updare candidate_source_id</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Can Source</from>
      <to>Can Lookup 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Sources Collection</from>
      <to>Inset to candidate_source</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Can Industries</from>
      <to>LookupCan1</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>LookupCan1</from>
      <to>LookupIndustry3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>LookupIndustry3</from>
      <to>Inject Can Industries</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Job Industries</from>
      <to>LookupJob 1</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>LookupJob 1</from>
      <to>LookupIndustry3 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Com Latitude Longitude</from>
      <to>Com Lookup</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Com Lookup</from>
      <to>company_location lookup</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>company_location lookup</from>
      <to>Update company_location</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Can Latitude Longitude</from>
      <to>Can Lookup</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Can Lookup</from>
      <to>common_location Lookup</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>common_location Lookup</from>
      <to>Update common_location</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>user_account and candidate_source</from>
      <to>insert user_account_candidate_source</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>user_account_candidate_source</from>
      <to>Delete</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>candidate_source</from>
      <to>Delete candidate_source</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Can GDPR</from>
      <to>Can Lookup 4 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Can Lookup 4 2</from>
      <to>Insert / Update GDPR</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>LookupIndustry3 2</from>
      <to>Update</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Con Info</from>
      <to>Con Lookup</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Con Lookup</from>
      <to>Update Con Info</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Job Info</from>
      <to>Job Lookup</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Job Lookup</from>
      <to>Update Job Info</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Con CF</from>
      <to>configurable_form_field</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>configurable_form_field</from>
      <to>configurable_form</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>configurable_form</from>
      <to>configurable_form_language</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>configurable_form_language</from>
      <to>configurable_form_field_value</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>configurable_form_field_value</from>
      <to>Con Lookup 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Con Lookup 2</from>
      <to>Insert/Update CF value</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Job CF Status</from>
      <to>configurable_form_field</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>configurable_form_field_value</from>
      <to>Job Lookup 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Job Lookup 2</from>
      <to>Insert/Update CF value</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>configurable_form_field_value</from>
      <to>Can Lookup 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Can Lookup 3</from>
      <to>Insert/Update CF value</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Table input</from>
      <to>I/U configurable_form</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>configurable_form 2</from>
      <to>I/U configurable_form_field</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>I/U configurable_form</from>
      <to>configurable_form 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>I/U configurable_form_field</from>
      <to>configurable_form_field 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>configurable_form_field 2</from>
      <to>Formula</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Formula</from>
      <to>Update 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Update 2</from>
      <to>I/U configurable_form_language</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Job CF Source</from>
      <to>configurable_form_field</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Can Subscribe</from>
      <to>Can Lookup 4 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Can Lookup 4 2 2</from>
      <to>Insert / Update Subscribed</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>user_account and vertical</from>
      <to>insert user_account_vertical</to>
      <enabled>N</enabled>
    </hop>
  </order>
  <step>
    <name>Can GDPR</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>cusDB</connection>
    <sql>;with TmpTab1 as (
select
cast(CAND_ID as int) as entityExtId
--, case(OPTOUT)
--	when NULL then NULL
--	when 1 then 1
--	when 0 then 2
--end as consent_level
, iif(lower(trim(isnull(GDPR_ACCEPT, ''))) = lower('Yes'), 1, null) as consent_level
, case(lower(trim(isnull(GDPR_ACCEPT, ''))))
	when '' then NULL
	when lower('Yes') then 1
	when lower('No') then 0
end as explicit_consent
, iif(lower(trim(isnull(GDPR_ACCEPT, ''))) = lower('Yes'), 1, null) as portal_status
--, GDPR_TYPE
, case(lower(trim(isnull(GDPR_TYPE, ''))))
	when '' then NULL
	when lower('Email') then 1
	when lower('') then 5
	else 6
end as request_through
--, GDPR_DATE
, dateadd(day, -2, cast(cast(GDPR_DATE as float) as datetime)) as request_through_date
--, EXPIRY_DATE
from CANDINFO_DATA_TABLE
--where GDPR_ACCEPT is not null or GDPR_TYPE is not null or GDPR_DATE is not null
)

select
*
, request_through as obtained_through
, request_through_date as obtained_through_date
, 3 as exercise_right
, isnull(request_through_date, getdate()) as insert_timestamp
, iif(explicit_consent = 1, request_through_date, null) as activated_date
from TmpTab1
--where explicit_consent is not null</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>368</xloc>
      <yloc>640</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Can Industries</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>cusDB</connection>
    <sql>	select
	cast(CAND_ID as int) as entityExtId
	, case upper(trim(isnull(sector, '')))
		when 'LEGAL' then 'Nelson Chambers'
		when 'INSURANCE' then 'A&amp;F Chambers'
		when 'A&amp;F' then 'A&amp;F Chambers'
		when 'PROPERTY' then 'A&amp;F Chambers'
		when 'PUBLIC PRACTICE' then 'AJ Chambers'
		when 'INTERNAL' then 'AJ Chambers'
		when 'LOCAL AUTHORITY' then 'A&amp;F Chambers'
		else NULL
	end as indName
	from CANDINFO_DATA_TABLE
	where sector is not null</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>48</xloc>
      <yloc>992</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Can Latitude Longitude</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>cusDB</connection>
    <sql>select
cast(CAND_ID as int) as entityExtId
, LATITUDE
, LONGITUDE
from CANDINFO_DATA_TABLE
where LATITUDE is not null or LONGITUDE is not null</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>704</xloc>
      <yloc>448</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Can Lookup</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>N</eat_row_on_failure>
      <key>
        <name>entityExtId</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>CanId</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>864</xloc>
      <yloc>448</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Can Lookup 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>entityExtId</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>CanId</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>784</xloc>
      <yloc>256</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Can Lookup 3</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name/>
        <field>external_id</field>
        <condition>IS NOT NULL</condition>
        <name2/>
      </key>
      <key>
        <name>entityExtId</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>additional_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1296</xloc>
      <yloc>1008</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Can Lookup 4 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name/>
        <field>external_id</field>
        <condition>IS NOT NULL</condition>
        <name2/>
      </key>
      <key>
        <name>entityExtId</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>CanID</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>496</xloc>
      <yloc>640</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Can Source</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>cusDB</connection>
    <sql>select
	  C.candidateID as entityExtId
--       , Coalesce(NULLIF(replace(C.FirstName,'?',''), ''), 'No Firstname') as 'contact-firstName'
--       , Coalesce(NULLIF(replace(C.LastName,'?',''), ''), concat('Lastname-',C.userID)) as 'contact-lastName'
       , trim(iif(
			charindex(',', trim(isnull(c.source, 'Other'))) > 0
			, left(trim(isnull(c.source, 'Other')), charindex(',', trim(isnull(c.source, 'Other'))) - 1)
			, trim(isnull(c.source, 'Other'))
		)) as SourceName
-- select count (*) -- select distinct ltrim(rtrim(source))
from bullhorn1.Candidate C
where source &lt;&gt; '' and C.isPrimaryOwner = 1</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>608</xloc>
      <yloc>256</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Can Updare candidate_source_id</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <key>
        <name>CanId</name>
        <field>id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>candidate_source_id</name>
        <rename>CanSourceId</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>608</xloc>
      <yloc>336</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Can funtional_expertise</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <sql>;with
fes1 as (
	select iif(len(trim(isnull(x.occupation, ''))) = 0, trim(isnull(x.name, '')), trim(isnull(x.occupation, ''))) as feName
	, x.categoryID
	from bullhorn1.BH_CategoryList x
	where x.parentCategoryID = 0
	--and enabled = 1
	--and x.groupName &lt;&gt; 'BHExchange'
	--and len(iif(x.occupation is null, trim(isnull(x.name, '')), trim(isnull(x.occupation, '')))) > 0
)

, fes2 as (
	select
	categoryID
	, feName
	, row_number() over(partition by feName order by categoryID) as rn
	from fes1
)

, fes as (
	select categoryID as Id
	, iif(rn > 1, concat(feName, '(', rn, ')'), feName) as feName
	from fes2
)

, sfes1 as (
	select iif(x.occupation is null, trim(isnull(x.name, '')), trim(isnull(x.occupation, ''))) as sfeName
	, x.categoryID
	, x.parentCategoryID
	from bullhorn1.BH_CategoryList x
	where x.parentCategoryID > 0
)

, sfes2 as (
	select parentCategoryID as feId
	, categoryID as sfeExtId
	--, replace(sfeName, '-&amp;gt;', '->') as sfeName
	, sfeName
	, row_number() over(partition by sfeName, parentCategoryID order by categoryID) as rn
	from sfes1
)

, sfes as (
	select feId
	, iif(rn > 1, concat(sfeName, '(', rn, ')'), sfeName) as sfeName
	, sfeExtId
	from sfes2
)

, canfes1 as (
	select
	x.candidateID
	, iif(len(trim(' ,' from isnull(cast(x.categoryIDList as varchar(255)), ''))) > 0, trim(' ,' from isnull(cast(x.categoryIDList as varchar(255)), '')), cast(x.categoryID as varchar(10))) as categoryIDList
	, x.categoryIDList as ocategoryIDList
	, x.categoryID
	from bullhorn1.Candidate x
	where x.isPrimaryOwner = 1 and x.isDeleted = 0
)

--select
----max(len(categoryIDList))
--*
--from confes1

, canfes2 as (
	select
	candidateID
	, trim(isnull(value, '')) as catId
	from canfes1
	cross apply string_split(categoryIDList, ',')
)

--select * from (
select
x.candidateID as EntityExtId
, y.Id as ExpertiseId
from canfes2 x
join fes y on x.catId = y.Id
--) abc
--where abc.ExpertiseId in (
--	--select sfeExtId from sfes
--	select Id from fes
--)</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>992</xloc>
      <yloc>240</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Com Industries</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>cusDB</connection>
    <sql>;with
inds as (
select distinct trim(isnull(name, '')) as indName
, x.businessSectorID
from bullhorn1.BH_BusinessSectorList x
--order by indName
)

, inds1 as (
	select
	trim(' ;' from isnull(cast(businessSectorList as nvarchar(255)), '')) as indNames
	, clientCorporationID as entityExtId
	from bullhorn1.BH_ClientCorporation
	where len(trim(' ;' from isnull(cast(businessSectorList as nvarchar(255)), ''))) > 0 
)

, inds2 as (
	select
	distinct trim(' ;' from isnull(value, '')) as indName
	, entityExtId
	from inds1
	cross apply string_split(indNames, ';')
)

select
x.entityExtId
, x.indName
from inds2 x
join inds y on lower(x.indName) = lower(trim(isnull(y.indName, '')))
order by x.entityExtId</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>48</xloc>
      <yloc>352</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Com Latitude Longitude</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>cusDB</connection>
    <sql>select
cast(CLNT_ID as int) as entityExtId
, LATITUDE
, LONGITUDE
from CLNTINFO_DATA_TABLE
where LATITUDE is not null or LONGITUDE is not null</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>368</xloc>
      <yloc>448</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Com Lookup</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>company</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>N</eat_row_on_failure>
      <key>
        <name>entityExtId</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>ComId</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>528</xloc>
      <yloc>448</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Con CF</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>cusDB</connection>
    <sql>select
cast(cast(CONT_ID as int) as varchar(20)) as entityExtId
, 'optout' as cfName
, 'en' as language
, case(OPTOUT)
	when 1 then 'Yes'
	when 0 then 'No'
	else 'No'
end as cfValueTitle
from CONT_DATA_TABLE
order by CONT_ID</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>928</xloc>
      <yloc>720</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Con Industries</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>cusDB</connection>
    <sql>select
cast(x.CONT_ID as int) as entityExtId
, case upper(trim(isnull(y.INDUSTRY, '')))
	when 'LEGAL' then 'Nelson Chambers'
	when 'INSURANCE' then 'A&amp;F Chambers'
	when 'A&amp;F' then 'A&amp;F Chambers'
	when 'PROPERTY' then 'A&amp;F Chambers'
	when 'PUBLIC PRACTICE' then 'AJ Chambers'
	when 'INTERNAL' then 'AJ Chambers'
	when 'LOCAL AUTHORITY' then 'A&amp;F Chambers'
	else NULL
end as indName
from
CONT_DATA_TABLE x
left join CLNTINFO_DATA_TABLE y on x.CLNT_ID = y.CLNT_ID
where INDUSTRY is not null
order by x.CONT_ID</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>48</xloc>
      <yloc>560</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Con Info</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>cusDB</connection>
    <sql>select
  cast(cast(CONT_ID as int) as varchar(20)) as entityExtId
  , [dbo].[ufn_RefinePhoneNumber_V2](trim(isnull(MOBILE, ''))) as MobilePhone
  from CONT_DATA_TABLE
  where  [dbo].[ufn_RefinePhoneNumber_V2](trim(isnull(MOBILE, ''))) &lt;&gt; ''</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>496</xloc>
      <yloc>800</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Con Lookup</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>contact</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name/>
        <field>external_id</field>
        <condition>IS NOT NULL</condition>
        <name2/>
      </key>
      <key>
        <name>entityExtId</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>ConId</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>608</xloc>
      <yloc>800</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Con Lookup 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>contact</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name/>
        <field>external_id</field>
        <condition>IS NOT NULL</condition>
        <name2/>
      </key>
      <key>
        <name>entityExtId</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>additional_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>928</xloc>
      <yloc>1008</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Con funtional_expertise</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <sql>;with
fes1 as (
	select iif(len(trim(isnull(x.occupation, ''))) = 0, trim(isnull(x.name, '')), trim(isnull(x.occupation, ''))) as feName
	, x.categoryID
	from bullhorn1.BH_CategoryList x
	where x.parentCategoryID = 0
	--and enabled = 1
	--and x.groupName &lt;&gt; 'BHExchange'
	--and len(iif(x.occupation is null, trim(isnull(x.name, '')), trim(isnull(x.occupation, '')))) > 0
)

, fes2 as (
	select
	categoryID
	, feName
	, row_number() over(partition by feName order by categoryID) as rn
	from fes1
)

, fes as (
	select categoryID as Id
	, iif(rn > 1, concat(feName, '(', rn, ')'), feName) as feName
	from fes2
)

, confes1 as (
	select
	x.clientID
	, iif(len(trim(' ,' from isnull(cast(y.categoryIDList as varchar(255)), ''))) > 0, trim(' ,' from isnull(cast(y.categoryIDList as varchar(255)), '')), cast(y.categoryID as varchar(10))) as categoryIDList
	, y.categoryIDList as ocategoryIDList
	, y.categoryID
	from bullhorn1.BH_Client x
	left join bullhorn1.BH_UserContact y on x.userID = y.userID
	where x.isPrimaryOwner = 1
)

--select
----max(len(categoryIDList))
--*
--from confes1

, confes2 as (
	select
	clientID
	, trim(isnull(value, '')) as catId
	from confes1
	cross apply string_split(categoryIDList, ',')
)

select
x.clientID as EntityExtId
, y.Id as ExpertiseId
from confes2 x
join fes y on x.catId = y.Id</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>992</xloc>
      <yloc>320</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Delete</name>
    <type>Delete</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <commit>100</commit>
    <lookup>
      <schema>public</schema>
      <table>user_account_candidate_source</table>
      <key>
        <name>id</name>
        <field>id</field>
        <condition>=</condition>
        <name2/>
      </key>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>400</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Delete candidate_source</name>
    <type>Delete</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <commit>100</commit>
    <lookup>
      <schema>public</schema>
      <table>candidate_source</table>
      <key>
        <name>id</name>
        <field>id</field>
        <condition>=</condition>
        <name2/>
      </key>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>560</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Formula</name>
    <type>Formula</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <formula>
      <field_name>label_language_code</field_name>
      <formula_string>""label_language_code"&amp;[field_id]</formula_string>
      <value_type>String</value_type>
      <value_length>255</value_length>
      <value_precision>-1</value_precision>
      <replace_field/>
    </formula>
    <formula>
      <field_name>constraint_id</field_name>
      <formula_string>""&amp;[field_id]</formula_string>
      <value_type>String</value_type>
      <value_length>50</value_length>
      <value_precision>-1</value_precision>
      <replace_field/>
    </formula>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1152</xloc>
      <yloc>1152</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>I/U configurable_form</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <commit>100</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>configurable_form</table>
      <key>
        <name>type</name>
        <field>type</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>default_language</name>
        <field>default_language</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>insert_timestamp</name>
        <rename>insert_timestamp</rename>
        <update>N</update>
      </value>
      <value>
        <name>type</name>
        <rename>type</rename>
        <update>N</update>
      </value>
      <value>
        <name>default_language</name>
        <rename>default_language</rename>
        <update>N</update>
      </value>
      <value>
        <name>update_timestamp</name>
        <rename>insert_timestamp</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>848</xloc>
      <yloc>1152</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>I/U configurable_form_field</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <commit>100</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>configurable_form_field</table>
      <key>
        <name>form_id</name>
        <field>form_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>name</name>
        <field>name</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>form_id</name>
        <rename>form_id</rename>
        <update>N</update>
      </value>
      <value>
        <name>field_type</name>
        <rename>field_type</rename>
        <update>Y</update>
      </value>
      <value>
        <name>block</name>
        <rename>block</rename>
        <update>Y</update>
      </value>
      <value>
        <name>name</name>
        <rename>name</rename>
        <update>N</update>
      </value>
      <value>
        <name>field_key</name>
        <rename>field_key</rename>
        <update>N</update>
      </value>
      <value>
        <name>required</name>
        <rename>required</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1008</xloc>
      <yloc>1264</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>I/U configurable_form_language</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <commit>100</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>configurable_form_language</table>
      <key>
        <name>default_language</name>
        <field>language</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>label_language_code</name>
        <field>language_code</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>name</name>
        <field>translate</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>language_code</name>
        <rename>label_language_code</rename>
        <update>N</update>
      </value>
      <value>
        <name>language</name>
        <rename>default_language</rename>
        <update>N</update>
      </value>
      <value>
        <name>translate</name>
        <rename>name</rename>
        <update>N</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1296</xloc>
      <yloc>1264</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Industries Collection</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>cusDB</connection>
    <sql>;with
inds1 as (
select
--clientCorporationID
trim(' ;' from isnull(cast(businessSectorList as nvarchar(255)), '')) as indNames
from bullhorn1.BH_ClientCorporation
where len(trim(' ;' from isnull(cast(businessSectorList as nvarchar(255)), ''))) > 0 
)

, inds2 as (
select distinct trim(' ;' from isnull(value, '')) as indName
from inds1
cross apply string_split(indNames, ';')
)

select
indName
, current_timestamp as insert_timestamp
from inds2
order by indName</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>208</xloc>
      <yloc>32</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Inject Can Industries</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <schema>public</schema>
    <table>candidate_industry</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>Y</ignore_errors>
    <use_batch>N</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field>contactid</partitioning_field>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>vertical_id</column_name>
        <stream_name>IndId</stream_name>
      </field>
      <field>
        <column_name>candidate_id</column_name>
        <stream_name>CanId</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>48</xloc>
      <yloc>1104</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Inject Com Industries</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <schema>public</schema>
    <table>company_industry</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>Y</ignore_errors>
    <use_batch>N</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field>contactid</partitioning_field>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>industry_id</column_name>
        <stream_name>IndId</stream_name>
      </field>
      <field>
        <column_name>company_id</column_name>
        <stream_name>ComId</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>48</xloc>
      <yloc>464</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Inject Con Industries</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <schema>public</schema>
    <table>contact_industry</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>Y</ignore_errors>
    <use_batch>N</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field>contactid</partitioning_field>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>industry_id</column_name>
        <stream_name>IndId</stream_name>
      </field>
      <field>
        <column_name>contact_id</column_name>
        <stream_name>ConId</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>48</xloc>
      <yloc>672</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert / Update GDPR</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <commit>100</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>candidate_gdpr_compliance</table>
      <key>
        <name>CanID</name>
        <field>candidate_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>consent_level</name>
        <rename>consent_level</rename>
        <update>Y</update>
      </value>
      <value>
        <name>explicit_consent</name>
        <rename>explicit_consent</rename>
        <update>Y</update>
      </value>
      <value>
        <name>exercise_right</name>
        <rename>exercise_right</rename>
        <update>Y</update>
      </value>
      <value>
        <name>request_through</name>
        <rename>request_through</rename>
        <update>Y</update>
      </value>
      <value>
        <name>request_through_date</name>
        <rename>request_through_date</rename>
        <update>Y</update>
      </value>
      <value>
        <name>obtained_through</name>
        <rename>obtained_through</rename>
        <update>Y</update>
      </value>
      <value>
        <name>obtained_through_date</name>
        <rename>obtained_through_date</rename>
        <update>Y</update>
      </value>
      <value>
        <name>insert_timestamp</name>
        <rename>insert_timestamp</rename>
        <update>Y</update>
      </value>
      <value>
        <name>activated_date</name>
        <rename>activated_date</rename>
        <update>Y</update>
      </value>
      <value>
        <name>portal_status</name>
        <rename>portal_status</rename>
        <update>Y</update>
      </value>
      <value>
        <name>candidate_id</name>
        <rename>CanID</rename>
        <update>N</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>624</xloc>
      <yloc>640</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert Industries</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>vertical</table>
      <key>
        <name>indName</name>
        <field>name</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>name</name>
        <rename>indName</rename>
        <update>Y</update>
      </value>
      <value>
        <name>insert_timestamp</name>
        <rename>insert_timestamp</rename>
        <update>N</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>208</xloc>
      <yloc>112</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert candidate_functional_expertise</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <schema>public</schema>
    <table>candidate_functional_expertise</table>
    <commit>100</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>functional_expertise_id</column_name>
        <stream_name>ExpertiseId</stream_name>
      </field>
      <field>
        <column_name>candidate_id</column_name>
        <stream_name>CanID</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1296</xloc>
      <yloc>240</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert contact_functional_expertise</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <schema>public</schema>
    <table>contact_functional_expertise</table>
    <commit>100</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>functional_expertise_id</column_name>
        <stream_name>ExpertiseId</stream_name>
      </field>
      <field>
        <column_name>contact_id</column_name>
        <stream_name>ConID</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1296</xloc>
      <yloc>320</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert functional_expertise</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <schema>public</schema>
    <table>functional_expertise</table>
    <commit>100</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>id</column_name>
        <stream_name>Id</stream_name>
      </field>
      <field>
        <column_name>name</column_name>
        <stream_name>feName</stream_name>
      </field>
      <field>
        <column_name>expertise</column_name>
        <stream_name>feName</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1008</xloc>
      <yloc>128</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert sub_functional_expertise</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <schema>public</schema>
    <table>sub_functional_expertise</table>
    <commit>100</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>functional_expertise_id</column_name>
        <stream_name>feId</stream_name>
      </field>
      <field>
        <column_name>name</column_name>
        <stream_name>sfeName</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1232</xloc>
      <yloc>128</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert/Update CF value</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>additional_form_values</table>
      <key>
        <name>additional_type</name>
        <field>additional_type</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>additional_id</name>
        <field>additional_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>constraint_id</name>
        <field>constraint_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>form_id</name>
        <field>form_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>field_id</name>
        <field>field_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>additional_type</name>
        <rename>additional_type</rename>
        <update>N</update>
      </value>
      <value>
        <name>additional_id</name>
        <rename>additional_id</rename>
        <update>N</update>
      </value>
      <value>
        <name>constraint_id</name>
        <rename>constraint_id</rename>
        <update>N</update>
      </value>
      <value>
        <name>form_id</name>
        <rename>form_id</rename>
        <update>N</update>
      </value>
      <value>
        <name>field_id</name>
        <rename>field_id</rename>
        <update>N</update>
      </value>
      <value>
        <name>field_value</name>
        <rename>field_value</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1104</xloc>
      <yloc>1008</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Inset to candidate_source</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>candidate_source</table>
      <key>
        <name>sourceName</name>
        <field>name</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>payment_style</name>
        <field>payment_style</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>name</name>
        <rename>sourceName</rename>
        <update>Y</update>
      </value>
      <value>
        <name>source_type</name>
        <rename>source_type</rename>
        <update>Y</update>
      </value>
      <value>
        <name>insert_timestamp</name>
        <rename>insert_timestamp</rename>
        <update>Y</update>
      </value>
      <value>
        <name>payment_style</name>
        <rename>payment_style</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>720</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Job CF Source</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>cusDB</connection>
    <sql>select
cast(cast(JOBS_ID as int) as varchar(20)) as entityExtId
, 'source' as cfName
, 'en' as language
, dbo.ufn_TrimSpecialCharacters_V2(SOURCE, '') as cfValueTitle
from JOBS_DATA_TABLE
where dbo.ufn_TrimSpecialCharacters_V2(SOURCE, '') &lt;&gt; ''
order by JOBS_ID</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1216</xloc>
      <yloc>608</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Job CF Status</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>cusDB</connection>
    <sql>select
cast(cast(JOBS_ID as int) as varchar(20)) as entityExtId
, 'status' as cfName
, 'en' as language
, dbo.ufn_TrimSpecialCharacters_V2(STATUS, '') as cfValueTitle
from JOBS_DATA_TABLE
where dbo.ufn_TrimSpecialCharacters_V2(STATUS, '') &lt;&gt; ''
order by JOBS_ID</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1088</xloc>
      <yloc>608</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Job Industries</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>cusDB</connection>
    <sql>;with
inds as (
select distinct trim(isnull(name, '')) as indName
, x.businessSectorID
from bullhorn1.BH_BusinessSectorList x
--order by indName
)

, inds1 as (
	select
	trim(' ;' from isnull(cast(businessSectorList as nvarchar(255)), '')) as indNames
	, clientCorporationID as entityExtId
	from bullhorn1.BH_ClientCorporation
	where len(trim(' ;' from isnull(cast(businessSectorList as nvarchar(255)), ''))) > 0 
)

, inds2 as (
	select
	distinct trim(' ;' from isnull(value, '')) as indName
	, entityExtId
	from inds1
	cross apply string_split(indNames, ';')
)

, inds3 as(
select
x.entityExtId as ComExtId
, x.indName
from inds2 x
join inds y on lower(x.indName) = lower(trim(isnull(y.indName, '')))
--order by x.entityExtId
)

select
x.jobPostingID as entityExtId
, y.indName
from bullhorn1.BH_JobPosting x
join inds3 y on x.clientCorporationID = y.ComExtId</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>48</xloc>
      <yloc>768</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Job Info</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>cusDB</connection>
    <sql>;with
TmpTab1 as (
	select distinct
		trim(isnull(JOBS_ID, '')) as entityExtId
		, replace(dbo.ufn_TrimSpecialCharacters_V2(isnull(SKILL, ','), ''), ',', '-') as Skill
	from [SKILLINFO_DATA_TABLE]
	where trim(isnull(JOBS_ID, '')) &lt;&gt; ''
)

select
entityExtId
, string_agg(Skill, ',') Skills
from TmpTab1
group by entityExtId
order by cast(entityExtId as int)</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>496</xloc>
      <yloc>896</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Job Lookup</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>position_description</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name/>
        <field>external_id</field>
        <condition>IS NOT NULL</condition>
        <name2/>
      </key>
      <key>
        <name>entityExtId</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>JobId</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>608</xloc>
      <yloc>896</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Job Lookup 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>position_description</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name/>
        <field>external_id</field>
        <condition>IS NOT NULL</condition>
        <name2/>
      </key>
      <key>
        <name>entityExtId</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>additional_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1104</xloc>
      <yloc>896</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>LookupCan1</name>
    <type>DBLookup</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name/>
        <field>external_id</field>
        <condition>IS NOT NULL</condition>
        <name2/>
      </key>
      <key>
        <name>entityExtId</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>CanId</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>176</xloc>
      <yloc>992</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>LookupCom1</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>company</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name/>
        <field>external_id</field>
        <condition>IS NOT NULL</condition>
        <name2/>
      </key>
      <key>
        <name>entityExtId</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>ComId</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>176</xloc>
      <yloc>352</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>LookupCon1</name>
    <type>DBLookup</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>contact</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name/>
        <field>external_id</field>
        <condition>IS NOT NULL</condition>
        <name2/>
      </key>
      <key>
        <name>entityExtId</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>ConId</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>176</xloc>
      <yloc>560</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>LookupIndustry1</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>vertical</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>indName</name>
        <field>name</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>IndId</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>176</xloc>
      <yloc>464</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>LookupIndustry2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>vertical</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>indName</name>
        <field>name</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>IndId</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>176</xloc>
      <yloc>672</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>LookupIndustry3</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>vertical</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>indName</name>
        <field>name</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>IndId</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>176</xloc>
      <yloc>1104</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>LookupIndustry3 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>vertical</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>indName</name>
        <field>name</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>IndId</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>176</xloc>
      <yloc>880</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>LookupJob 1</name>
    <type>DBLookup</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>position_description</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name/>
        <field>external_id</field>
        <condition>IS NOT NULL</condition>
        <name2/>
      </key>
      <key>
        <name>entityExtId</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>JobId</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>176</xloc>
      <yloc>768</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Sources Collection</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>cusDB</connection>
    <sql>;with CanSources as (
	SELECT trim(isnull(source.value, '')) as sourceName
	from bullhorn1.Candidate m
	CROSS APPLY STRING_SPLIT(trim(isnull(m.source, '')),',') AS source
)

select
1 as source_type
, 11 as payment_style
, current_timestamp as insert_timestamp
, x.sourceName
from (
	select distinct(trim(isnull(sourceName, ''))) sourceName
	from CanSources
	where len(trim(isnull(sourceName, ''))) > 0
) x
order by x.sourceName</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>720</xloc>
      <yloc>32</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Table input</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>cusDB</connection>
    <sql>;with
TmpTab1 as (
select
---- form setup --
--'add_con_info' as type
'add_job_info' as type
--'add_can_info' as type
, getdate() as insert_timestamp
, 'en' as default_language
---- field setup --
, replace(lower(cast(newid() as varchar(36))), '-' , '') as field_key
, 0 as required
, 1 as block
, 'source' as name
, 4 as field_type -- dropdownlist
--, 5 as field_type -- checkboxlist
--, '' as constraint_id
---- field value setup
)

, TmpTab2 as (
select distinct
dbo.ufn_TrimSpecialCharacters_V2(SOURCE, '') as cfValue
from JOBS_DATA_TABLE
where dbo.ufn_TrimSpecialCharacters_V2(SOURCE, '') &lt;&gt; ''
--order by dbo.ufn_TrimSpecialCharacters_V2(SOURCE, '')
)

select
t1.*, t2.*
from TmpTab1 t1, TmpTab2 t2
order by t2.cfValue</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>688</xloc>
      <yloc>1152</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Update</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>N</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema>public</schema>
      <table>position_description</table>
      <key>
        <name>JobId</name>
        <field>id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>vertical_id</name>
        <rename>IndId</rename>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>48</xloc>
      <yloc>880</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Update 2</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>N</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema>public</schema>
      <table>configurable_form_field</table>
      <key>
        <name>field_id</name>
        <field>id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>label_language_code</name>
        <rename>label_language_code</rename>
      </value>
      <value>
        <name>constraint_id</name>
        <rename>constraint_id</rename>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1152</xloc>
      <yloc>1264</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Update Con Info</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>N</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema>public</schema>
      <table>contact</table>
      <key>
        <name>ConId</name>
        <field>id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>mobile_phone</name>
        <rename>MobilePhone</rename>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>720</xloc>
      <yloc>800</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Update Job Info</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>N</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema>public</schema>
      <table>position_description</table>
      <key>
        <name>JobId</name>
        <field>id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>key_words</name>
        <rename>Skills</rename>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>720</xloc>
      <yloc>896</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Update common_location</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>N</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema>public</schema>
      <table>common_location</table>
      <key>
        <name>ComLocId</name>
        <field>id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>latitude</name>
        <rename>LATITUDE</rename>
      </value>
      <value>
        <name>longitude</name>
        <rename>LONGITUDE</rename>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>704</xloc>
      <yloc>544</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Update company_location</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>N</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema>public</schema>
      <table>company_location</table>
      <key>
        <name>ComLocId</name>
        <field>id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>latitude</name>
        <rename>LATITUDE</rename>
      </value>
      <value>
        <name>longitude</name>
        <rename>LONGITUDE</rename>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>368</xloc>
      <yloc>544</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>VC Can Lookup 4</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name/>
        <field>external_id</field>
        <condition>IS NOT NULL</condition>
        <name2/>
      </key>
      <key>
        <name>EntityExtId</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>CanID</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1120</xloc>
      <yloc>240</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>VC Con Lookup 4</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>contact</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name/>
        <field>external_id</field>
        <condition>IS NOT NULL</condition>
        <name2/>
      </key>
      <key>
        <name>EntityExtId</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>ConID</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1120</xloc>
      <yloc>320</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>candidate_source</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <sql>select * from candidate_source
where id &lt;&gt; 29093</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>560</xloc>
      <yloc>32</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>candidate_source Lookup</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate_source</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>SourceName</name>
        <field>name</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>CanSourceId</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>784</xloc>
      <yloc>336</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>common_location Lookup</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>common_location</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>N</eat_row_on_failure>
      <key>
        <name>CanId</name>
        <field>current_location_candidate_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>ComLocId</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>864</xloc>
      <yloc>544</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>company_location lookup</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>company_location</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>N</eat_row_on_failure>
      <key>
        <name>ComId</name>
        <field>company_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>ComLocId</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>528</xloc>
      <yloc>544</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>configurable_form</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>configurable_form</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>form_id</name>
        <field>id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>type</name>
        <rename>additional_type</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1296</xloc>
      <yloc>720</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>configurable_form 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>configurable_form</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>type</name>
        <field>type</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>default_language</name>
        <field>default_language</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>form_id</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>848</xloc>
      <yloc>1264</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>configurable_form_field</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>configurable_form_field</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>cfName</name>
        <field>name</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>form_id</name>
        <rename>form_id</rename>
        <default/>
        <type>None</type>
      </value>
      <value>
        <name>id</name>
        <rename>field_id</rename>
        <default/>
        <type>None</type>
      </value>
      <value>
        <name>constraint_id</name>
        <rename>constraint_id</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1088</xloc>
      <yloc>720</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>configurable_form_field 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>configurable_form_field</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>field_key</name>
        <field>field_key</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>field_id</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1008</xloc>
      <yloc>1152</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>configurable_form_field_value</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>configurable_form_field_value</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>title_language_code</name>
        <field>title_language_code</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>field_value</name>
        <rename>field_value</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1104</xloc>
      <yloc>800</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>configurable_form_language</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>configurable_form_language</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>cfValueTitle</name>
        <field>translate</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>language</name>
        <field>language</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>language_code</name>
        <rename>title_language_code</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1296</xloc>
      <yloc>800</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>funtional_expertise</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <sql>;with
fes1 as (
	select iif(len(trim(isnull(x.occupation, ''))) = 0, trim(isnull(x.name, '')), trim(isnull(x.occupation, ''))) as feName
	, x.categoryID
	, x.parentCategoryID
	from bullhorn1.BH_CategoryList x
	--order by indName
	where x.parentCategoryID = 0
	--and enabled = 1
	--and x.groupName &lt;&gt; 'BHExchange'
	--and len(iif(x.occupation is null, trim(isnull(x.name, '')), trim(isnull(x.occupation, '')))) > 0
)

, fes2 as (
	select
	categoryID
	, parentCategoryID
	, feName
	, row_number() over(partition by feName order by categoryID) as rn
	from fes1
)

select categoryID as Id
, parentCategoryID
, iif(rn > 1, concat(feName, '(', rn, ')'), feName) as feName
from fes2
order by feName</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1008</xloc>
      <yloc>32</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>insert user_account_candidate_source</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <commit>100</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>user_account_candidate_source</table>
      <key>
        <name>user_account_id</name>
        <field>user_account_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>candidate_source_id</name>
        <field>candidate_source_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>user_account_id</name>
        <rename>user_account_id</rename>
        <update>N</update>
      </value>
      <value>
        <name>candidate_source_id</name>
        <rename>candidate_source_id</rename>
        <update>N</update>
      </value>
      <value>
        <name>insert_timestamp</name>
        <rename>inserted_timestamp</rename>
        <update>N</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>400</xloc>
      <yloc>336</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>sub_funtional_expertise</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <sql>;with
fes1 as (
	select iif(len(trim(isnull(x.occupation, ''))) = 0, trim(isnull(x.name, '')), trim(isnull(x.occupation, ''))) as feName
	, x.categoryID
	from bullhorn1.BH_CategoryList x
	where x.parentCategoryID = 0
	--and enabled = 1
	--and x.groupName &lt;&gt; 'BHExchange'
	--and len(iif(x.occupation is null, trim(isnull(x.name, '')), trim(isnull(x.occupation, '')))) > 0
)

, fes2 as (
	select
	categoryID
	, feName
	, row_number() over(partition by feName order by categoryID) as rn
	from fes1
)

, fes as (
	select categoryID as Id
	, iif(rn > 1, concat(feName, '(', rn, ')'), feName) as feName
	from fes2
)

--select * from fes

, sfes1 as (
	select iif(x.occupation is null, trim(isnull(x.name, '')), trim(isnull(x.occupation, ''))) as sfeName
	, x.categoryID
	, x.parentCategoryID
	from bullhorn1.BH_CategoryList x
	where x.parentCategoryID > 0
)

, sfes2 as (
	select parentCategoryID as feId
	, categoryID as sfeExtId
	--, replace(sfeName, '-&amp;gt;', '->') as sfeName
	, sfeName
	, row_number() over(partition by sfeName, parentCategoryID order by categoryID) as rn
	from sfes1
)

, sfes as (
	select feId
	, iif(rn > 1, concat(sfeName, '(', rn, ')'), sfeName) as sfeName
	, sfeExtId
	from sfes2
)

select x.*, y.feName from sfes x
left join fes y on x.feId = y.Id
order by feId, sfeName</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1232</xloc>
      <yloc>32</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>user_account and candidate_source</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <sql>select
x.id as user_account_id
, y.id as candidate_source_id
, now() as inserted_timestamp
from
user_account x
, candidate_source y
where x.deleted_timestamp is null</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>400</xloc>
      <yloc>256</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>user_account_candidate_source</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <sql>select * from user_account_candidate_source</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>400</xloc>
      <yloc>32</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Can Subscribe</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>cusDB</connection>
    <sql>select
cast(cast(CAND_ID as int) as varchar(20)) as entityExtId
, iif(cast(OPTOUT as int) = 1, 0, 1) as Subscribed
, cast('2018/12/01' as datetime) as SubscribedDate
from CANDINFO_DATA_TABLE
where OPTOUT is not null
order by CAND_ID</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>368</xloc>
      <yloc>704</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Can Lookup 4 2 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name/>
        <field>external_id</field>
        <condition>IS NOT NULL</condition>
        <name2/>
      </key>
      <key>
        <name>entityExtId</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>email</name>
        <rename>CanEmail</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>496</xloc>
      <yloc>704</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert / Update Subscribed</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <commit>100</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>email_subscription</table>
      <key>
        <name>CanEmail</name>
        <field>email</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>email</name>
        <rename>CanEmail</rename>
        <update>N</update>
      </value>
      <value>
        <name>subscribed</name>
        <rename>Subscribed</rename>
        <update>Y</update>
      </value>
      <value>
        <name>insert_timestamp</name>
        <rename>SubscribedDate</rename>
        <update>N</update>
      </value>
      <value>
        <name>last_modified_date</name>
        <rename>SubscribedDate</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>624</xloc>
      <yloc>704</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>insert user_account_vertical</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <commit>100</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>user_account_vertical</table>
      <key>
        <name>user_account_id</name>
        <field>user_account_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>vertical_id</name>
        <field>vertical_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>user_account_id</name>
        <rename>user_account_id</rename>
        <update>N</update>
      </value>
      <value>
        <name>vertical_id</name>
        <rename>vertical_id</rename>
        <update>N</update>
      </value>
      <value>
        <name>insert_timestamp</name>
        <rename>inserted_timestamp</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>64</xloc>
      <yloc>112</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>user_account and vertical</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>vcDB</connection>
    <sql>select
x.id as user_account_id
, y.id as vertical_id
, now() as inserted_timestamp
from
user_account x
, vertical y
where x.deleted_timestamp is null</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>64</xloc>
      <yloc>32</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step_error_handling>
  </step_error_handling>
  <slave-step-copy-partition-distribution>
  </slave-step-copy-partition-distribution>
  <slave_transformation>N</slave_transformation>
</transformation>
