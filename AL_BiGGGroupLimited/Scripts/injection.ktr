<?xml version="1.0" encoding="UTF-8"?>
<transformation>
  <info>
    <name>pentaho_export</name>
    <description/>
    <extended_description/>
    <trans_version/>
    <trans_type>Normal</trans_type>
    <trans_status>0</trans_status>
    <directory>/</directory>
    <parameters>
    </parameters>
    <log>
      <trans-log-table>
        <connection/>
        <schema/>
        <table/>
        <size_limit_lines/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
          <subject/>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
          <subject/>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
          <subject/>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
          <subject/>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </trans-log-table>
      <perf-log-table>
        <connection/>
        <schema/>
        <table/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>SEQ_NR</id>
          <enabled>Y</enabled>
          <name>SEQ_NR</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>INPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>INPUT_BUFFER_ROWS</name>
        </field>
        <field>
          <id>OUTPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>OUTPUT_BUFFER_ROWS</name>
        </field>
      </perf-log-table>
      <channel-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
      <step-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
      </step-log-table>
      <metrics-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>METRICS_DATE</id>
          <enabled>Y</enabled>
          <name>METRICS_DATE</name>
        </field>
        <field>
          <id>METRICS_CODE</id>
          <enabled>Y</enabled>
          <name>METRICS_CODE</name>
        </field>
        <field>
          <id>METRICS_DESCRIPTION</id>
          <enabled>Y</enabled>
          <name>METRICS_DESCRIPTION</name>
        </field>
        <field>
          <id>METRICS_SUBJECT</id>
          <enabled>Y</enabled>
          <name>METRICS_SUBJECT</name>
        </field>
        <field>
          <id>METRICS_TYPE</id>
          <enabled>Y</enabled>
          <name>METRICS_TYPE</name>
        </field>
        <field>
          <id>METRICS_VALUE</id>
          <enabled>Y</enabled>
          <name>METRICS_VALUE</name>
        </field>
      </metrics-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file/>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit/>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
    <created_user/>
    <created_date>2017/01/20 16:14:34.085</created_date>
    <modified_user/>
    <modified_date>2017/01/20 16:14:34.085</modified_date>
    <key_for_session_key>H4sIAAAAAAAAAAMAAAAAAAAAAAA=</key_for_session_key>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
    <notepad>
      <note>COMPANY</note>
      <xloc>236</xloc>
      <yloc>17</yloc>
      <width>68</width>
      <heigth>26</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>CONTACT</note>
      <xloc>736</xloc>
      <yloc>16</yloc>
      <width>65</width>
      <heigth>26</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>JOB</note>
      <xloc>1216</xloc>
      <yloc>16</yloc>
      <width>31</width>
      <heigth>26</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>CANDIDATE</note>
      <xloc>1728</xloc>
      <yloc>32</yloc>
      <width>79</width>
      <heigth>26</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
  </notepads>
  <connection>
    <name>from</name>
    <server>EC2AMAZ-QKOFCH8</server>
    <type>MSSQLNATIVE</type>
    <access>Native</access>
    <database>BiGGGroupProd</database>
    <port>1433</port>
    <username>sa</username>
    <password>Encrypted 2be98afc86aa7f2d5f94aea35e083b8df</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>MSSQLUseIntegratedSecurity</code>
        <attribute>false</attribute>
      </attribute>
      <attribute>
        <code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>1433</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>to</name>
    <server>rdb</server>
    <type>POSTGRESQL</type>
    <access>Native</access>
    <database>bigggroup.vincere.io</database>
    <port>5432</port>
    <username>dbapplication_user</username>
    <password>Encrypted 2be98afc819e8b9aebe11bd63cb8b9ae3</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>5432</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <order>
    <hop>
      <from>BULLHORN Contact Comment</from>
      <to>Database lookup 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Database lookup 2 2</from>
      <to>Insert / Update 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>BULLHORN Contact Email Body</from>
      <to>Database lookup 2 2 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Database lookup 2 2 3</from>
      <to>Insert / Update 2 2 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>BULLHORN Job Comment</from>
      <to>Database lookup 2 2 2 2 2 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Database lookup 2 2 2 2 2 2 2</from>
      <to>Insert / Update 2 3 2 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>BULLHORN Company Comment</from>
      <to>Database lookup 2 2 2 2 2 2 2 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Database lookup 2 2 2 2 2 2 2 2 2</from>
      <to>Insert / Update 2 3 2 2 2 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>BULLHORN Candidate Comment</from>
      <to>Database lookup 2 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>BULLHORN Candidate Email Body</from>
      <to>Database lookup 2 2 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Database lookup 2 2 2 2</from>
      <to>Insert / Update 2 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Database lookup 2 3</from>
      <to>Insert / Update 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>BULLHORN Job Application - Rejected</from>
      <to>position_description</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>candidate 3 2 2</from>
      <to>Update 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>position_description</from>
      <to>candidate 3 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>BULLHORN Candidate Note</from>
      <to>Update 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>BULLHORN Contact Info + Location 2</from>
      <to>Database lookup 2 2 2 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>BULLHORN Contact Info + Location 2</from>
      <to>Insert / Update 2 2 2 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Database lookup 2 2 2 3</from>
      <to>Update 2 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>source</from>
      <to>Database lookup 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>source 2</from>
      <to>candidate_source</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Database lookup 2</from>
      <to>Database lookup 2 4</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Database lookup 2 4</from>
      <to>candidate_source_id</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>candidate id</from>
      <to>industry</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>candidate industry 2</from>
      <to>candidate id</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>industry</from>
      <to>candidate_industry</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>candidate industry</from>
      <to>industry 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>industry 2</from>
      <to>candidate industry 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>company id 2</from>
      <to>industry 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>company industry 2 2</from>
      <to>company id 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>industry 3</from>
      <to>com_industry 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>company industry 3</from>
      <to>industry 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>contact id 2</from>
      <to>industry 4</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>contact industry 2 2</from>
      <to>contact id 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>industry 4</from>
      <to>contact_industry 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>contact industry 3</from>
      <to>industry 2 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>industry 2 3</from>
      <to>contact industry 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>job id 2 2</from>
      <to>industry 4 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>job industry 2 2 2</from>
      <to>job id 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>industry 4 2</from>
      <to>contact_industry 3 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>DONT USE job industry 3 2</from>
      <to>industry 2 3 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>industry 2 3 2</from>
      <to>job industry 2 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>company</from>
      <to>additional_form_values InsertUpdate</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>cf</from>
      <to>company</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>contact</from>
      <to>additional_form_values InsertUpdate 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>cf 2</from>
      <to>contact</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>contact FE-SFE</from>
      <to>contact id</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>contact id</from>
      <to>fe</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>fe</from>
      <to>contact_functional_expertise 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>candidate 3 3</from>
      <to>Insert / Update</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>candidate 3 3</from>
      <to>candidate_functional_expertise 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>candidate FE-SFE 2</from>
      <to>candidate 3 3</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Candidate - desired_contract_rate - contract_rate</from>
      <to>Update 3 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>candidate 3 3 2</from>
      <to>Insert / Update 2 4</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>sfe</from>
      <to>candidate 3 3 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>BULLHORN Company Comment</from>
      <to>UserAccountLookup</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>UserAccountLookup</from>
      <to>Database lookup 2 2 2 2 2 2 2 2 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>collect candidate's activities</from>
      <to>Clear activity_candidate</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>collect candidate's activities</from>
      <to>Insert Into activity_candidate</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>collect company's activities</from>
      <to>Clear activity_company</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>collect company's activities</from>
      <to>Insert Into activity_company</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>collect contact's activities</from>
      <to>Clear activity_contact</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>collect contact's activities</from>
      <to>Insert Into activity_contact</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>collect job's activities</from>
      <to>Clear activity_job</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>collect job's activities</from>
      <to>Insert Into activity_job</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Can Note, Skills</from>
      <to>VC Candiate Lookup</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>VC Candiate Lookup</from>
      <to>Update Can Note, Skills</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>VC Candiate Lookup 2</from>
      <to>Insert Into candidate_deleted</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Can Note, Skills</from>
      <to>VC Candiate Lookup 2</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>VC Job Lookup</from>
      <to>Update Job</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Job close date info</from>
      <to>VC Job Lookup</to>
      <enabled>N</enabled>
    </hop>
  </order>
  <step>
    <name>BULLHORN Candidate Comment</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>
--select C.candidateID, C.FirstName,C.LastName from bullhorn1.Candidate C where FirstName = 'Mohammad' and lastname = 'Abusalah' --C.isPrimaryOwner = 1 and C.candidateID = 33


with comments as (
        SELECT --top 1000
                  C.candidateID, C.fullname --,UC.Userid
                , UC.dateAdded
                        , Stuff('COMMENT: ' + char(10)
                                + Coalesce('Created Date: ' + NULLIF(convert(varchar,UC.dateAdded,120), '') + char(10), '')
                                + Coalesce('Author: ' + NULLIF(U.name, '') + char(10), '')
                                + Coalesce('Action: ' + NULLIF(UC.action, '') + char(10), '')
                                + Coalesce('Comments: ' + NULLIF( 
                                          replace(replace(replace(replace(replace(replace( [dbo].[fn_ConvertHTMLToText](UC.comments)
                                          ,'Â','')
                                          ,'Â·','')
                                          ,'v\:* {behavior:url(#default#VML);}','')
                                          ,'o\:* {behavior:url(#default#VML);}','')
                                          ,'w\:* {behavior:url(#default#VML);}','')
                                          ,'.shape {behavior:url(#default#VML);}','') , '') + char(10), '')
                        , 1, 0, '') as 'content'
        -- select count(*) --12292
        -- select top 100 *
        from bullhorn1.BH_UserComment UC
        left join ( select candidateID, concat(FirstName,' ',LastName) as fullname, userid, isPrimaryOwner from bullhorn1.Candidate) C on C.userID = UC.Userid 
        left join bullhorn1.BH_User U on U.userID = UC.commentingUserID
        where C.isPrimaryOwner = 1 and C.candidateID is not null --and cast(UC.comments as varchar(max)) &lt;&gt; ''
UNION ALL
        SELECT --top 1000
                  ch.candidateID ,C.fullname --,UC.Userid
                , ch.dateAdded
                , coalesce('HISTORY: ' + char(10)
		                  + 'Date Added: ' + convert(varchar(10), ch.dateAdded, 120) + char(10) 
		                  + 'Candidate History: ' + NULLIF(convert(varchar(max),ch.comments), ''), '') 
		                  as 'content'
        -- select count(*) --138
        -- select top 100 *
        from bullhorn1.BH_CandidateHistory CH
        left join ( select candidateID, concat(FirstName,' ',LastName) as fullname, userid, isPrimaryOwner from bullhorn1.Candidate) C on C.candidateID = CH.candidateID 
        where C.isPrimaryOwner = 1 and C.candidateID is not null and ch.comments is not null --and cast(ch.comments as varchar(max)) &lt;&gt; '' 
UNION ALL
	SELECT --top 20 
	C.candidateID ,C.fullname  --, a.candidateuserID, C.userID
	, a.dateAdded
		 , Stuff(       'APPOINTMENT: ' + char(10)
                         	    + Coalesce('Contact: ' + NULLIF(cast(concat(UC1.FirstName,' ',UC1.LastName,'     ',UC1.email) as varchar(max)), '') + char(10), '') --a.clientUserID 
                         	    + Coalesce('Candidate: ' + NULLIF(cast( concat(UC2.FirstName,' ',UC2.LastName,'     ',UC2.email) as varchar(max)), '') + char(10), '') --a.candidateUserID 
                         	    + Coalesce('Job: ' + NULLIF(cast(j.title as varchar(max)), '') + char(10), '') --jobPostingID
                                + coalesce('Communication Method: ' + NULLIF(convert(varchar(max),a.communicationMethod), '') + char(10), '')
		                  + Coalesce('Date Begin: ' + NULLIF(cast(a.dateBegin as varchar(max)), '') + char(10), '')
                                + coalesce('Date End: ' + NULLIF(convert(varchar(max),a.dateEnd), '') + char(10), '')
                                + coalesce('Type: ' + NULLIF(convert(varchar(max),a.type), '') + char(10), '') --CA.activePlacements
                                + coalesce('Subject: ' + NULLIF(convert(varchar(max),a.subject), '') + char(10), '')
                                + coalesce('Reminder: ' + NULLIF(convert(varchar(max),a.notificationMinutes), '') + char(10), '')
                                + coalesce('Opportunity: ' + NULLIF(convert(varchar(max),j2.title), '') + char(10), '')
                                + coalesce('Location: ' + NULLIF(convert(varchar(max),a.location), '') + char(10), '')
                                + coalesce('Description: ' + NULLIF( [dbo].[fn_ConvertHTMLToText](a.description), '') + char(10), '')
                                + coalesce('File Name: ' + NULLIF(convert(varchar(max),af.name), '') + char(10), '')
                                + coalesce('Owner: ' + NULLIF(cast( concat(UC3.FirstName,' ',UC3.LastName,'     ',UC3.email) as varchar(max)), '') + char(10), '')
                                + coalesce('Lead: ' + NULLIF(cast( concat(UC4.FirstName,' ',UC4.LastName,'     ',UC4.email) as varchar(max)), '') + char(10), '')
                        , 1, 0, '') as 'content' 
        -- select count(*) --2062
        -- select top 20 *
        from bullhorn1.View_Appointment a
        left join bullhorn1.View_AppointmentFile af on af.appointmentID = a.appointmentID
        left join ( select candidateID, concat(FirstName,' ',LastName) as fullname, userid, isPrimaryOwner from bullhorn1.Candidate) C on C.userID = a.candidateuserID
        left join bullhorn1.BH_UserContact UC1 ON UC1.userID = a.ClientuserID
        left join bullhorn1.BH_UserContact UC2 ON UC2.userID = a.candidateUserID
        left join bullhorn1.BH_UserContact UC3 ON UC3.userID = a.userID
        left join bullhorn1.BH_UserContact UC4 ON UC4.userID = a.LeaduserID
        left join bullhorn1.BH_JobPosting j on j.jobPostingID = a.jobPostingID
        left join bullhorn1.BH_JobPosting j2 on j.jobPostingID = a.opportunityJobPostingID        
        where C.isPrimaryOwner = 1 and C.candidateID is not null 
UNION ALL
	SELECT --top 20 
	C.candidateID,C.fullname  --, a.candidateuserID, C.userID
	, a.dateAdded
		 , Stuff(       'TASK: ' + char(10)
                            + Coalesce('Candidate: ' + NULLIF(cast( concat(UC2.FirstName,' ',UC2.LastName,'     ',UC2.email) as varchar(max)), '') + char(10), '') --a.candidateUserID 
                            --+ Coalesce('Assigned To: ' + NULLIF(cast(a.childTaskOwners as varchar(max)), '') + char(10), '')
                            + Coalesce('Contact: ' + NULLIF(cast(concat(UC1.FirstName,' ',UC1.LastName,'     ',UC1.email) as varchar(max)), '') + char(10), '') --a.clientUserID 
                            + Coalesce('Due Date And Time: ' + NULLIF(cast(a.dateBegin as varchar(max)), '') + char(10), '')
                            + Coalesce('Date End: ' + NULLIF(cast(a.dateEnd as varchar(max)), '') + char(10), '')
                            + Coalesce('Description: ' + NULLIF(cast( [dbo].[fn_ConvertHTMLToText](a.description) as varchar(max)), '') + char(10), '')
                            + Coalesce('Visibility: ' + NULLIF(cast(a.isPrivate as varchar(max)), '') + char(10), '')
                            + Coalesce('Job: ' + NULLIF(cast(j.title as varchar(max)), '') + char(10), '') --jobPostingID
                            + Coalesce('Lead: ' + NULLIF(cast( concat(UC3.FirstName,' ',UC3.LastName,'     ',UC3.email) as varchar(max)), '') + char(10), '') --a.leadUserID
                            + Coalesce('Reminder: ' + NULLIF(cast(a.notificationMinutes as varchar(max)), '') + char(10), '')
                            + Coalesce('Opportunity: ' + NULLIF(cast(j2.title as varchar(max)), '') + char(10), '') --a.opportunityJobPostingID 
                            + Coalesce('Placement: ' + NULLIF(cast(a.placementID as varchar(max)), '') + char(10), '')
                            + Coalesce('Priority: ' + NULLIF(cast(a.priority as varchar(max)), '') + char(10), '')
                            + Coalesce('Recurrence Day Bits: ' + NULLIF(cast(a.recurrenceDayBits as varchar(max)), '') + char(10), '')
                            + Coalesce('Recurrence Frequency: ' + NULLIF(cast(a.recurrenceFrequency as varchar(max)), '') + char(10), '')
                            + Coalesce('Recurrence Max: ' + NULLIF(cast(a.recurrenceMax as varchar(max)), '') + char(10), '')
                            + Coalesce('Recurrence Month Bits: ' + NULLIF(cast(a.recurrenceMonthBits as varchar(max)), '') + char(10), '')
                            + Coalesce('Recurrence Style: ' + NULLIF(cast(a.recurrenceStyle as varchar(max)), '') + char(10), '')
                            + Coalesce('Recurrence Type: ' + NULLIF(cast(a.recurrenceType as varchar(max)), '') + char(10), '')
                            + Coalesce('Subject: ' + NULLIF(cast(a.subject as varchar(max)), '') + char(10), '')
                            + Coalesce('Type: ' + NULLIF(cast(a.type as varchar(max)), '') + char(10), '')
                            + Coalesce('Owner: ' + NULLIF(cast( concat(UC4.FirstName,' ',UC4.LastName,'     ',UC4.email) as varchar(max)), '') + char(10), '') --a.userID
                        , 1, 0, '') as 'content' 
        -- select count(*) --24
        -- select top 100 *        
        from bullhorn1.View_Task a
        left join bullhorn1.BH_Client Cl on Cl.userID = a.ClientUserID
        left join bullhorn1.BH_UserContact UC1 ON Cl.userID = UC1.userID
        left join bullhorn1.BH_UserContact UC2 ON a.candidateUserID = UC2.userID
        left join bullhorn1.BH_JobPosting j on j.jobPostingID = a.jobPostingID
        left join bullhorn1.BH_UserContact UC3 ON a.leadUserID = UC3.userID
        left join bullhorn1.BH_UserContact UC4 ON a.userID = UC4.userID
        left join ( select candidateID, concat(FirstName,' ',LastName) as fullname, userid, isPrimaryOwner from bullhorn1.Candidate) C on C.userID = a.candidateuserID 
        left join bullhorn1.BH_JobPosting j2 on j2.jobPostingID = a.opportunityJobPostingID
        where C.isPrimaryOwner = 1 and C.candidateID is not null 
UNION ALL
       -- PLACEMENT
        select 
        C.candidateid, C.fullname
        , pl.dateadded 
	, Stuff( 'PLACEMENT: ' + char(10)
              + Coalesce('Billing Contact: ' + NULLIF(cast( concat(UC1.FirstName,' ',UC1.LastName,'     ',UC1.email)  as varchar(max)), '') + char(10), '')  --pl.billingUserID
                     --+ Coalesce('Bill Rate Information: ' + NULLIF(cast(pl.billRateInfoHeader as varchar(max)), '') + char(10), '')
              + Coalesce('Bill Rate: ' + NULLIF(cast(pl.clientBillRate as varchar(max)), '') + char(10), '')
              + Coalesce('Over-time Bill Rate: ' + NULLIF(cast(pl.clientOverTimeRate as varchar(max)), '') + char(10), '')
              + Coalesce('Comments: ' + NULLIF(cast(pl.comments as varchar(max)), '') + char(10), '')
                     --+ Coalesce('Contract Employment Info: ' + NULLIF(cast(pl.contractInfoHeader as varchar(max)), '') + char(10), '')
              + Coalesce('Primary Timesheet Approver: ' + NULLIF(cast(pl.correlatedCustomText1 as varchar(max)), '') + char(10), '')
              + Coalesce('Secondary Timecard Approver: ' + NULLIF(cast(pl.correlatedCustomText2 as varchar(max)), '') + char(10), '')
              + Coalesce('Purchase Order Number: ' + NULLIF(cast(pl.correlatedCustomText3 as varchar(max)), '') + char(10), '')
              + Coalesce('Cost Center: ' + NULLIF(cast(pl.costCenter as varchar(max)), '') + char(10), '')
              + Coalesce('Insurance Reference: ' + NULLIF(cast(pl.customText1 as varchar(max)), '') + char(10), '')
              + Coalesce('Start Date: ' + NULLIF(cast(pl.dateBegin as varchar(max)), '') + char(10), '')
              + Coalesce('Effective Date (Client): ' + NULLIF(cast(pl.dateClientEffective as varchar(max)), '') + char(10), '')
              + Coalesce('Effective Date: ' + NULLIF(cast(pl.dateEffective as varchar(max)), '') + char(10), '')
              + Coalesce('Scheduled End: ' + NULLIF(cast(pl.dateEnd as varchar(max)), '') + char(10), '')
              + Coalesce('Days Guaranteed: ' + NULLIF(cast(pl.daysGuaranteed as varchar(max)), '') + char(10), '')
              + Coalesce('Days Pro-Rated: ' + NULLIF(cast(pl.daysProRated as varchar(max)), '') + char(10), '')
              + Coalesce('Employment Type: ' + NULLIF(cast(pl.employmentType as varchar(max)), '') + char(10), '')
              + Coalesce('Placement Fee (%): ' + NULLIF(cast(pl.fee as varchar(max)), '') + char(10), '')
              --+ Coalesce('Placement Fee (Flat): ' + NULLIF(cast(pl.flatFee as varchar(max)), '') + char(10), '')
              + Coalesce('Hours of Operation: ' + NULLIF(cast(pl.hoursOfOperation as varchar(max)), '') + char(10), '')
              + Coalesce('Hours Per Day: ' + NULLIF(cast(pl.hoursPerDay as varchar(max)), '') + char(10), '')
              + Coalesce('Rate Entry Type: ' + NULLIF(cast(pl.isMultirate as varchar(max)), '') + char(10), '')
              --+ Coalesce('Mark-up %: ' + NULLIF(cast(pl.markUpPercentage as varchar(max)), '') + char(10), '')
              + Coalesce('Over-time Pay Rate: ' + NULLIF(cast(pl.overtimeRate as varchar(max)), '') + char(10), '')
              + Coalesce('Pay Rate: ' + NULLIF(cast(pl.payRate as varchar(max)), '') + char(10), '')
                     --+ Coalesce('Pay Rate Information: ' + NULLIF(cast(pl.payRateInfoHeader as varchar(max)), '') + char(10), '')
                     --+ Coalesce('Permanent Employment Info: ' + NULLIF(cast(pl.permanentInfoHeader as varchar(max)), '') + char(10), '')
              + Coalesce('Referral Fee Type: ' + NULLIF(cast(pl.referralFeeType as varchar(max)), '') + char(10), '')
              + Coalesce('Reporting to: ' + NULLIF(cast(pl.reportTo as varchar(max)), '') + char(10), '')
              + Coalesce('Salary: ' + NULLIF(cast(pl.salary as varchar(max)), '') + char(10), '')
              + Coalesce('Pay Unit: ' + NULLIF(cast(pl.salaryUnit as varchar(max)), '') + char(10), '')
              + Coalesce('Status: ' + NULLIF(cast(pl.status as varchar(max)), '') + char(10), '')
        , 1, 0, '') as 'content'
        from bullhorn1.BH_Placement PL --where PL.reportTo &lt;&gt; ''
        left join bullhorn1.BH_UserContact UC1 ON UC1.userID = pl.billingUserID
        left join ( select candidateID, concat(FirstName,' ',LastName) as fullname, userid from bullhorn1.Candidate) C on C.userID = pl.userid
UNION ALL
       -- Job Submission
        select 
        C.candidateid, C.fullname
        , jr.dateadded
	, Stuff(    'JOB SUBMISSION: ' + char(10)
                 --Coalesce('Appointments: ' + NULLIF(cast(jr.appointments as varchar(max)), '') + char(10), '')
              + Coalesce('Bill Rate: ' + NULLIF(cast(jr.billRate as varchar(max)), '') + char(10), '')
              + Coalesce('Comments: ' + NULLIF(cast(jr.comments as varchar(max)), '') + char(10), '')
              + Coalesce('Date Added: ' + NULLIF(cast(jr.dateAdded as varchar(max)), '') + char(10), '')
              --+ Coalesce('Date Last Modified: ' + NULLIF(cast(jr.dateLastModified as varchar(max)), '') + char(10), '')
              + Coalesce('Date Web Response: ' + NULLIF(cast(jr.dateWebResponse as varchar(max)), '') + char(10), '')
              + Coalesce('Job Order: ' + NULLIF(cast(j.title as varchar(max)), '') + char(10), '') --jr.jobPostingID
              + Coalesce('Latest Appointment: ' + NULLIF(cast(jr.latestAppointmentID as varchar(max)), '') + char(10), '')
              + Coalesce('Migrate GUID: ' + NULLIF(cast(jr.migrateGUID as varchar(max)), '') + char(10), '')
              --+ Coalesce('Owners: ' + NULLIF(cast(jr.owners as varchar(max)), '') + char(10), '')
              + Coalesce('Pay Rate: ' + NULLIF(cast(jr.payRate as varchar(max)), '') + char(10), '')
              + Coalesce('Salary: ' + NULLIF(cast(jr.salary as varchar(max)), '') + char(10), '')
              + Coalesce('Added By: ' + NULLIF(cast( concat(UC2.FirstName,' ',UC2.LastName,'     ',UC2.email) as varchar(max)), '') + char(10), '') --jr.sendingUserID
              + Coalesce('Source: ' + NULLIF(cast(jr.source as varchar(max)), '') + char(10), '')
              + Coalesce('Status: ' + NULLIF(cast(jr.status as varchar(max)), '') + char(10), '')
              --+ Coalesce('Task: ' + NULLIF(cast(jr.tasks as varchar(max)), '') + char(10), '')
              + Coalesce('Candidate: ' + NULLIF(cast( concat(UC1.FirstName,' ',UC1.LastName,'     ',UC1.email) as varchar(max)), '') + char(10), '') --jr.userID 
        , 1, 0, '') as note
        from bullhorn1.View_JobResponse jr
        left join bullhorn1.BH_UserContact UC1 ON UC1.userID = jr.userID
        left join bullhorn1.BH_UserContact UC2 ON UC2.userID = jr.sendingUserID
        left join bullhorn1.BH_JobPosting j on j.jobPostingID = jr.jobPostingID        
        left join ( select candidateID, concat(FirstName,' ',LastName) as fullname, userid from bullhorn1.Candidate) C on C.userID = jr.userid
        --where jr.userid &lt;&gt; jr.sendingUserID
)


--select count(*) from comments where note &lt;&gt; '' --12428
select --top 100
                   candidateID
                  , cast('-10' as int) as 'user_account_id'
                  , 'comment' as 'category'
                  , 'candidate' as 'type'
                  , dateAdded as 'insert_timestamp'
                  , [dbo].[fn_ConvertHTMLToText](content) as content
from comments where content &lt;&gt; '' 
--and candidateID = 2988 or fullname like '%Philip%'







/*
-- Add placement information under job posting
with placementnote as (
        --select jobPostingID
        select 
        C.candidateid
        , pl.dateadded 
	, Stuff(
	--, Stuff((select 
 Coalesce('Billing Contact: ' + NULLIF(cast( concat(UC1.FirstName,' ',UC1.LastName,'     ',UC1.email)  as varchar(max)), '') + char(10), '')  --pl.billingUserID
       --+ Coalesce('Bill Rate Information: ' + NULLIF(cast(pl.billRateInfoHeader as varchar(max)), '') + char(10), '')
+ Coalesce('Bill Rate: ' + NULLIF(cast(pl.clientBillRate as varchar(max)), '') + char(10), '')
+ Coalesce('Over-time Bill Rate: ' + NULLIF(cast(pl.clientOverTimeRate as varchar(max)), '') + char(10), '')
+ Coalesce('Comments: ' + NULLIF(cast(pl.comments as varchar(max)), '') + char(10), '')
       --+ Coalesce('Contract Employment Info: ' + NULLIF(cast(pl.contractInfoHeader as varchar(max)), '') + char(10), '')
+ Coalesce('Primary Timesheet Approver: ' + NULLIF(cast(pl.correlatedCustomText1 as varchar(max)), '') + char(10), '')
+ Coalesce('Secondary Timecard Approver: ' + NULLIF(cast(pl.correlatedCustomText2 as varchar(max)), '') + char(10), '')
+ Coalesce('Purchase Order Number: ' + NULLIF(cast(pl.correlatedCustomText3 as varchar(max)), '') + char(10), '')
+ Coalesce('Cost Center: ' + NULLIF(cast(pl.costCenter as varchar(max)), '') + char(10), '')
+ Coalesce('Insurance Reference: ' + NULLIF(cast(pl.customText1 as varchar(max)), '') + char(10), '')
+ Coalesce('Start Date: ' + NULLIF(cast(pl.dateBegin as varchar(max)), '') + char(10), '')
+ Coalesce('Effective Date (Client): ' + NULLIF(cast(pl.dateClientEffective as varchar(max)), '') + char(10), '')
+ Coalesce('Effective Date: ' + NULLIF(cast(pl.dateEffective as varchar(max)), '') + char(10), '')
+ Coalesce('Scheduled End: ' + NULLIF(cast(pl.dateEnd as varchar(max)), '') + char(10), '')
+ Coalesce('Days Guaranteed: ' + NULLIF(cast(pl.daysGuaranteed as varchar(max)), '') + char(10), '')
+ Coalesce('Days Pro-Rated: ' + NULLIF(cast(pl.daysProRated as varchar(max)), '') + char(10), '')
+ Coalesce('Employment Type: ' + NULLIF(cast(pl.employmentType as varchar(max)), '') + char(10), '')
+ Coalesce('Placement Fee (%): ' + NULLIF(cast(pl.fee as varchar(max)), '') + char(10), '')
--+ Coalesce('Placement Fee (Flat): ' + NULLIF(cast(pl.flatFee as varchar(max)), '') + char(10), '')
+ Coalesce('Hours of Operation: ' + NULLIF(cast(pl.hoursOfOperation as varchar(max)), '') + char(10), '')
+ Coalesce('Hours Per Day: ' + NULLIF(cast(pl.hoursPerDay as varchar(max)), '') + char(10), '')
+ Coalesce('Rate Entry Type: ' + NULLIF(cast(pl.isMultirate as varchar(max)), '') + char(10), '')
--+ Coalesce('Mark-up %: ' + NULLIF(cast(pl.markUpPercentage as varchar(max)), '') + char(10), '')
+ Coalesce('Over-time Pay Rate: ' + NULLIF(cast(pl.overtimeRate as varchar(max)), '') + char(10), '')
+ Coalesce('Pay Rate: ' + NULLIF(cast(pl.payRate as varchar(max)), '') + char(10), '')
       --+ Coalesce('Pay Rate Information: ' + NULLIF(cast(pl.payRateInfoHeader as varchar(max)), '') + char(10), '')
       --+ Coalesce('Permanent Employment Info: ' + NULLIF(cast(pl.permanentInfoHeader as varchar(max)), '') + char(10), '')
+ Coalesce('Referral Fee Type: ' + NULLIF(cast(pl.referralFeeType as varchar(max)), '') + char(10), '')
+ Coalesce('Reporting to: ' + NULLIF(cast(pl.reportTo as varchar(max)), '') + char(10), '')
+ Coalesce('Salary: ' + NULLIF(cast(pl.salary as varchar(max)), '') + char(10), '')
+ Coalesce('Pay Unit: ' + NULLIF(cast(pl.salaryUnit as varchar(max)), '') + char(10), '')
+ Coalesce('Status: ' + NULLIF(cast(pl.status as varchar(max)), '') + char(10), '')
 , 1, 0, '') as note
	        -- select top 50 *
	        from bullhorn1.BH_Placement PL --where PL.reportTo &lt;&gt; ''
        left join bullhorn1.BH_UserContact UC1 ON UC1.userID = pl.billingUserID
        left join ( select candidateID, concat(FirstName,' ',LastName) as fullname, userid from bullhorn1.Candidate) C on C.userID = pl.userid 	        
--               left join bullhorn1.BH_UserContact UC on PL.billingUserID = UC.userID
--               WHERE PL.jobPostingID = a.jobPostingID FOR XML PATH (''), TYPE).value('.', 'nvarchar(MAX)'), 1, 0, '') as note
--        from bullhorn1.BH_Placement a group by a.jobPostingID 
        )
select count(*) from placementnote
--select * from placementnote where jobPostingID in (17,28,30,50,92,115)
--select jobPostingID from placementnote group by jobPostingID having count(*) > 1

*/

-- select * from bullhorn1.View_JobResponse where latestAppointmentID is not null;
</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1584</xloc>
      <yloc>80</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>BULLHORN Candidate Email Body</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>select * from VCCanACEmails</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1584</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>BULLHORN Candidate Note</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>
with
-- EMAIL
  mail1 (ID,email) as (select UC.userID, replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(concat(UC.email,',',UC.email2,',',UC.email3),'/',' '),'&lt;',' '),'>',' '),'(',' '),')',' '),':',' '),'.@','@'),'@.','@'),'+',' '),'&amp;',' '),'[',' '),']',' '),'?',' '),'''',' '),';',' '),'•',' '),CHAR(9),' ') as mail from bullhorn1.BH_UserContact UC left join bullhorn1.Candidate C on C.userID = UC.UserID where UC.email like '%_@_%.__%' or UC.email2 like '%_@_%.__%' or UC.email3 like '%_@_%.__%' and C.isPrimaryOwner = 1 )
, mail2 (ID,email) as (SELECT ID, email.value as email FROM mail1 m CROSS APPLY STRING_SPLIT(m.email,',') AS email)
, mail3 (ID,email) as (SELECT ID, case when RIGHT(email, 1) = '.' then LEFT(email, LEN(email) - 1) when LEFT(email, 1) = '.' then RIGHT(email, LEN(email) - 1) else email end as email from mail2 WHERE email like '%_@_%.__%')
, mail4 (ID,email,rn) as ( SELECT ID, email = ltrim(rtrim(CONVERT(NVARCHAR(MAX), email))), r1 = ROW_NUMBER() OVER (PARTITION BY ID ORDER BY ID desc) FROM mail3 )
, e1 (ID,email) as (select ID, email from mail4 where rn = 1)
, ed  (ID,email,rn) as (SELECT ID,email,ROW_NUMBER() OVER(PARTITION BY email ORDER BY ID DESC) AS rn FROM e1 )
, e2 (ID,email) as (select ID, email from mail4 where rn = 2)
, e3 (ID,email) as (select ID, email from mail4 where rn = 3)
, e4 as (select ID, email from mail4 where rn = 4)
--select * from ed

-- OWNER
, owner as (select distinct CA.recruiterUserID, UC.email from bullhorn1.Candidate CA left join bullhorn1.BH_UserContact UC on CA.recruiterUserID = UC.userID where CA.isPrimaryOwner = 1)

-- SkillName: split by separate rows by comma, then combine them into SkillName
, SkillName0(userid, skillID) as (SELECT userid, Split.a.value('.', 'VARCHAR(2000)') AS skillID FROM (SELECT userid, CAST('&lt;M>' + REPLACE(cast(skillIDList as varchar(max)),',','&lt;/M>&lt;M>') + '&lt;/M>' AS XML) AS x FROM  bullhorn1.Candidate where isPrimaryOwner = 1) t CROSS APPLY x.nodes('/M') AS Split(a) )
, SkillName(userId, SkillName) as (SELECT userId, STUFF((SELECT DISTINCT ', ' + SL.name from SkillName0 left join bullhorn1.BH_SkillList SL ON SkillName0.skillID = SL.skillID WHERE SkillName0.skillID &lt;&gt; '' and userId = a.userId FOR XML PATH (''), TYPE).value('.', 'nvarchar(MAX)'), 1, 2, '') AS URLList FROM SkillName0 as a where a.skillID &lt;&gt; '' GROUP BY a.userId)

-- BusinessSector: split by separate rows by comma, then combine them into Business Sector(Industry)
, BusinessSector0(userid, businessSectorID) as (SELECT userid, Split.a.value('.', 'VARCHAR(2000)') AS businessSectorID FROM (SELECT userid, CAST('&lt;M>' + REPLACE(cast(businessSectorIDList as varchar(max)),',','&lt;/M>&lt;M>') + '&lt;/M>' AS XML) AS x FROM  bullhorn1.Candidate where isPrimaryOwner = 1) t CROSS APPLY x.nodes('/M') AS Split(a) )
, BusinessSector(userId, BusinessSector) as (SELECT userId, STUFF((SELECT DISTINCT ', ' + BSL.name from BusinessSector0 left join bullhorn1.BH_BusinessSectorList BSL ON BusinessSector0.businessSectorID = BSL.businessSectorID WHERE BusinessSector0.businessSectorID &lt;&gt; '' and userId = a.userId FOR XML PATH (''), TYPE).value('.', 'nvarchar(MAX)'), 1, 2, '')  AS URLList FROM BusinessSector0 as a where a.businessSectorID &lt;&gt; '' GROUP BY a.userId)
--, BusinessSector(userId, BusinessSector) as (SELECT userId, BSL.name from BusinessSector0 left join bullhorn1.BH_BusinessSectorList BSL ON BusinessSector0.businessSectorID = BSL.businessSectorID )
-- select distinct BusinessSector from BusinessSector0

-- CATEGORY - VC FE info
, CateSplit(userid, categoryid) as (SELECT userid, Split.a.value('.','varchar(2000)') AS categoryID FROM (SELECT userid, CAST('&lt;M>' + REPLACE(cast(categoryIDList as varchar(max)),',','&lt;/M>&lt;M>') + '&lt;/M>' AS XML) AS x FROM  bullhorn1.Candidate where isPrimaryOwner = 1) t CROSS APPLY x.nodes('/M') as Split(a) )
, CName(Userid, Name) as (SELECT Userid, STUFF((SELECT DISTINCT ', ' + CL.occupation from CateSplit left join bullhorn1.BH_CategoryList CL ON CateSplit.categoryid = CL.categoryID WHERE CateSplit.categoryid &lt;&gt; '' and Userid = a.Userid FOR XML PATH (''), TYPE).value('.', 'nvarchar(MAX)'), 1, 2, '') AS URLList FROM CateSplit as a where a.categoryid &lt;&gt; '' GROUP BY a.Userid)
--, CName(Userid, Name) as (SELECT Userid, CL.occupation from CateSplit left join bullhorn1.BH_CategoryList CL ON CateSplit.categoryid = CL.categoryID )
-- select distinct Name from CName

-- SPECIALTY - VC SFE info
, SpecSplit(userid, specialtyid) as (SELECT userid,Split.a.value('.','varchar(2000)') AS SpecialtyID FROM (SELECT userid,CAST('&lt;M>' + REPLACE(cast(specialtyIDList as varchar(max)),',','&lt;/M>&lt;M>') + '&lt;/M>' AS XML) AS x FROM  bullhorn1.Candidate) t CROSS APPLY x.nodes('/M') as Split(a) )
, SpeName(Userid, Name) as (SELECT Userid, STUFF((SELECT DISTINCT ', ' + VS.name from SpecSplit left join bullhorn1.View_Specialty VS ON SpecSplit.SpecialtyID = VS.specialtyID WHERE SpecSplit.specialtyid &lt;&gt; '' and Userid = b.Userid FOR XML PATH (''), TYPE).value('.', 'nvarchar(MAX)'), 1, 2, '') AS URLList FROM SpecSplit as b where b.specialtyid &lt;&gt; '' GROUP BY b.Userid)

-- ADMISSION
, AdmissionRows(userId, CombinedText) as (select UCOI.userID, concat(text1,' ',text2) as CombinedText from bullhorn1.BH_UserCustomObjectInstance UCOI inner join bullhorn1.BH_CustomObjectInstance COI On UCOI.instanceID = COI.instanceID)
, admission(Userid, Admission) as (SELECT Userid, STUFF((SELECT ' || ' + CombinedText from  AdmissionRows WHERE Userid = c.Userid and CombinedText is not NULL and CombinedText &lt;&gt; '' FOR XML PATH (''), TYPE).value('.', 'nvarchar(MAX)'), 1, 4, '')  AS URLList FROM  AdmissionRows as c GROUP BY c.Userid)


-- Secondary OWNER
, owner2a as (SELECT userID, Split.a.value('.', 'VARCHAR(100)') AS String FROM (SELECT userID, CAST ('&lt;M>' + REPLACE(convert(varchar(20),ownerUserIDList),',','&lt;/M>&lt;M>') + '&lt;/M>' AS XML) AS Data FROM bullhorn1.BH_UserContact where ownerUserIDList like '%,%') AS A CROSS APPLY Data.nodes ('/M') AS Split(a))
, owner2b as (select  owner2a.userid, UC.name from owner2a left join (select userid, name from bullhorn1.BH_UserContact) UC on UC.userid = owner2a.String)
, owner2c as (SELECT userID, STUFF((SELECT ', ' + name  from owner2b WHERE userID = a.userID FOR XML PATH (''), TYPE).value('.', 'nvarchar(MAX)'), 1, 1, '')  AS name FROM owner2b AS a GROUP BY a.userID )
--select * from owner2c where userid in (8281,12389,6467,10883,4281)

-- Web Responses
, wr as (
        select jr.userid, jp.title,jr.status
        from bullhorn1.BH_JobResponse JR
        left join (select CA.userID as CandidateUserID, CA.candidateID, UC.userID, UC.name as CandidateName, UC.email as CandidateEmail from bullhorn1.BH_Candidate CA left join bullhorn1.BH_UserContact UC on CA.userID = UC.userID where CA.isPrimaryOwner = 1) CAI on JR.userID = CAI.CandidateUserID
        left join bullhorn1.BH_JobPosting  jp on jp.jobPostingID = jr.jobPostingID )
, wr1 as (SELECT userID, STUFF((SELECT ', ' + concat('Title: ',title,' - Status: ',status)  from wr WHERE userID = a.userID FOR XML PATH (''), TYPE).value('.', 'nvarchar(MAX)'), 1, 1, '')  AS name FROM wr AS a GROUP BY a.userID )
--select * from wr1

-- Latest Comment
, lc (userid,comments,dateAdded,rn) as ( SELECT userid, comments, dateAdded, r1 = ROW_NUMBER() OVER (PARTITION BY userid ORDER BY dateAdded desc) FROM bullhorn1.BH_UserComment )


-- NEWEST EDUCATION
-- select * from bullhorn1.BH_UserEducation 
, EducationGroup as (select userID, max(userEducationID) as userEducationID from bullhorn1.BH_UserEducation group by userID)
, Education as (
       select EG.userID
              , UE.certification
              , UE.city
              , UE.comments
              --, UE.customText1
              , UE.dateAdded
              , UE.degree
              , UE.endDate
              , UE.expirationDate
              , UE.gpa
              , convert(varchar(10),UE.graduationDate,110) as graduationDate
              , UE.major
              , UE.school
              , UE.startDate
              , UE.state
              , UE.userEducationID       
       from EducationGroup EG left join bullhorn1.BH_UserEducation UE on EG.userEducationID = UE.userEducationID)
-- Education Summary
, EducationSummary(userId, es) as (
       SELECT userId, STUFF(( 
                     select char(10) + 
                     stuff(
                               Coalesce('Date Added: ' + NULLIF(cast(dateAdded as varchar(max)), '') + char(10), '')                   
                            + Coalesce('Certification: ' + NULLIF(cast(certification as varchar(max)), '') + char(10), '')
                            + Coalesce('City: ' + NULLIF(cast(city as varchar(max)), '') + char(10), '')
                            + Coalesce('Comments: ' + NULLIF(cast(comments as varchar(max)), '') + char(10), '')
                            --+ Coalesce('Country: ' + NULLIF(cast(customText1 as varchar(max)), '') + char(10), '')
                            + Coalesce('Degree: ' + NULLIF(cast(degree as varchar(max)), '') + char(10), '')
                            + Coalesce('End Date: ' + NULLIF(cast(endDate as varchar(max)), '') + char(10), '')
                            + Coalesce('Expiration Date: ' + NULLIF(cast(expirationDate as varchar(max)), '') + char(10), '')
                            + Coalesce('GPA: ' + NULLIF(cast(gpa as varchar(max)), '') + char(10), '')
                            + Coalesce('Graduation Date: ' + NULLIF(cast(graduationDate as varchar(max)), '') + char(10), '')
                            + Coalesce('Major: ' + NULLIF(cast(major as varchar(max)), '') + char(10), '')
                            + Coalesce('School: ' + NULLIF(cast(school as varchar(max)), '') + char(10), '')
                            + Coalesce('Start Date: ' + NULLIF(cast(startDate as varchar(max)), '') + char(10), '')
                            + Coalesce('State: ' + NULLIF(cast(state as varchar(max)), '') + char(10), '')
                            --+ Coalesce('Education ID: ' + NULLIF(cast(userEducationID as varchar(max)), '') + char(10), '')
                     , 1, 0, '') as es
                     from bullhorn1.BH_UserEducation
       WHERE userId = a.userId 
       FOR XML PATH (''), TYPE).value('.', 'nvarchar(MAX)'), 1, 1, '') AS es 
       FROM bullhorn1.BH_UserEducation as a GROUP BY a.userId 
       )
--select * from EducationSummary where userid in (163454);

-- Employment History -- select *  from bullhorn1.BH_userWorkHistory
, EmploymentHistory(userId, eh) as (
       SELECT a.userId, STUFF(( 
                     select char(10) + 
                     stuff(
                         Coalesce('Bonus: ' + NULLIF(cast(bonus as varchar(max)), '') + char(10), '')
                     + Coalesce('Client Corporation: ' + NULLIF(cast(clientCorporationID as varchar(max)), '') + char(10), '')
                     + Coalesce('Comments: ' + NULLIF(cast(comments as varchar(max)), '') + char(10), '')
                     + Coalesce('Commission: ' + NULLIF(cast(commission as varchar(max)), '') + char(10), '')
                     + Coalesce('Company Name: ' + NULLIF(cast(companyName as varchar(max)), '') + char(10), '')
                     + Coalesce('Date Added: ' + NULLIF(cast(dateAdded as varchar(max)), '') + char(10), '')
                     + Coalesce('End Date: ' + NULLIF(cast(endDate as varchar(max)), '') + char(10), '')
                     + Coalesce('Job Posting: ' + NULLIF(cast(title as varchar(max)), '') + char(10), '') --jobPostingID
                     --+ Coalesce('Placement: ' + NULLIF(cast(placementID as varchar(max)), '') + char(10), '')
                     + Coalesce('Salary Low: ' + NULLIF(cast(salary1 as varchar(max)), '') + char(10), '')
                     + Coalesce('Salary High: ' + NULLIF(cast(salary2 as varchar(max)), '') + char(10), '')
                     + Coalesce('Salary Type: ' + NULLIF(cast(salaryType as varchar(max)), '') + char(10), '')
                     + Coalesce('Start Date: ' + NULLIF(cast(startDate as varchar(max)), '') + char(10), '')
                     + Coalesce('Termination Reason: ' + NULLIF(cast(terminationReason as varchar(max)), '') + char(10), '')
                     + Coalesce('Title: ' + NULLIF(cast(title as varchar(max)), '') + char(10), '')
                     --+ Coalesce('User Work History ID: ' + NULLIF(cast(userWorkHistoryID as varchar(max)), '') + char(10), '')
                            --+ Coalesce('Comments: ' + NULLIF(replace([dbo].[udf_StripHTML](comments),'Â ',''), '') + char(10), '')
                            --+ Coalesce('Comments: ' + NULLIF(replace([dbo].[fn_ConvertHTMLToText](comments),'Â ',''), '') + char(10), '')
                     , 1, 0, '') as eh
                     from bullhorn1.BH_userWorkHistory
       WHERE userId = a.userId order by startDate desc
       FOR XML PATH (''), TYPE).value('.', 'nvarchar(MAX)'), 1, 1, '') AS es 
       FROM bullhorn1.BH_userWorkHistory as a
       left join bullhorn1.BH_JobPosting j on j.jobPostingID = a.jobPostingID
       --where userid in (164043)
       GROUP BY a.userId 
       )
-- select * from EmploymentHistory where userid in (164043);


-- NOTE
, note as (
	SELECT CA.candidateID
		 , Stuff( Coalesce('User ID: ' + NULLIF(cast(CA.userID as varchar(max)), '') + char(10), '') 
+ Coalesce('Other email: ' + NULLIF(cast(e3.email as varchar(max)), '') + char(10), '')
+ Coalesce('Will Relocate To: ' + NULLIF(cast(ca.customText10 as varchar(max)), '') + char(10), '')
+ Coalesce('Notice Period: ' + NULLIF(cast(ca.customText4 as varchar(max)), '') + char(10), '')
+ Coalesce('Current Commission Structure: ' + NULLIF(cast(ca.customTextBlock1 as varchar(max)), '') + char(10), '')
+ Coalesce('Status: ' + NULLIF(cast(ca.status as varchar(max)), '') + char(10), '')
+ Coalesce('Willing to Relocate: ' + NULLIF(cast(ca.willRelocate as varchar(max)), '') + char(10), '')
+ Coalesce('General Comments: ' + NULLIF(convert(varchar(max),CA.comments), '') + char(10), '')
+ Coalesce('CV: ' + NULLIF(UW.description, '') , '')
-- Reference (EMPTY)
                        , 1, 0, '') as note
	-- select top 10 * -- select count(*) -- select customText10 --UW.description , [dbo].[udf_StripHTML](UW.description) as test --referredBy, referredByUserID
	from bullhorn1.Candidate CA --where CA.isPrimaryOwner = 1 --where convert(varchar(max),CA.comments) &lt;&gt; ''
       left join e3 on CA.userID = e3.ID
	left join ( select userid, firstname, lastname from bullhorn1.BH_UserContact )UC ON UC.userID = CA.referredByUserID
       left join (SELECT userid, STUFF((
                        SELECT char(10) + NULLIF(description_truong, '') + char(10) + '--------------------------------------------------' + char(10)
                        from bullhorn1.BH_UserWork where userid = a.userid FOR XML PATH (''), TYPE).value('.', 'nvarchar(MAX)'), 1, 1, '')  AS description 
                        FROM (   select userid, description_truong
                                        from bullhorn1.BH_UserWork) AS a GROUP BY a.userid 
                        ) uw on uw.userid = ca.userid                
	where CA.isPrimaryOwner = 1 )
--select count(*) from note --8545
--select * from note --where AddedNote like '%Business Sector%'
--select top 100 * from note


-- COMMENT
, comment(Userid, comment) as (SELECT Userid, STUFF((SELECT char(10) + 'Date Added: ' + convert(varchar(10), dateAdded, 120) + ' || ' + 'Action: ' + action + ' || ' + cast(comments as varchar(max)) from [bullhorn1].[BH_UserComment] WHERE Userid = a.Userid order by dateAdded desc FOR XML PATH (''), TYPE).value('.', 'nvarchar(MAX)'), 1, 1, '')  AS URLList FROM [bullhorn1].[BH_UserComment] AS a GROUP BY a.Userid )
, summary(candidateID,summary) as (SELECT candidateID, STUFF((SELECT coalesce(char(10) + 'Date Added: ' + convert(varchar,dateAdded,120) + ' || ' + 'Candidate History: ' + NULLIF(convert(varchar(max),comments), ''), '') from bullhorn1.BH_CandidateHistory WHERE candidateID = b.candidateID order by dateAdded desc FOR XML PATH (''), TYPE).value('.', 'nvarchar(MAX)'), 1, 1, '')  AS summary FROM bullhorn1.BH_CandidateHistory as b GROUP BY b.candidateID)

-- DOCUMENT
, t4(candidateUserID, finame) as (SELECT candidateUserID, STUFF((SELECT ',' + name from bullhorn1.View_CandidateFile WHERE candidateUserID = a.candidateUserID FOR XML PATH (''), TYPE).value('.', 'nvarchar(MAX)'), 1, 1, '')  AS string FROM bullhorn1.View_CandidateFile AS a GROUP BY a.candidateUserID)

-- Files
, files(candidateUserID, ResumeId) as (SELECT candidateUserID, STUFF((SELECT DISTINCT ',' + concat(candidateFileID, fileExtension) from bullhorn1.View_CandidateFile WHERE fileExtension in ('.doc','.docx','.pdf','.xls','.xlsx','.rtf','.html') and candidateUserID = a.candidateUserID FOR XML PATH (''), TYPE).value('.', 'nvarchar(MAX)'), 1, 1, '')  AS URLList FROM bullhorn1.View_CandidateFile AS a GROUP BY a.candidateUserID) --where a.type = 'Resume') ==> get all candidates files



	select --top 200
                  --C.userID as '#userID'
		  C.candidateID as 'candidate-externalId'
		, note.note as 'candidate-note'

	-- select count (*) -- select distinct employmentPreference -- select skillset, skillIDlist, customTextBlock1 --select top 10 * -- select distinct customText11
	from bullhorn1.Candidate C --where C.isPrimaryOwner = 1 --8545
	left join SkillName SN on C.userID = SN.userId
	left join BusinessSector BS on BS.userid = C.userid -- INDUSTRY
	left join EmploymentHistory EH on EH.userid = C.userid --WORK HISTORY
	left join tmp_country tc ON c.countryID = tc.code
	left join owner on C.recruiterUserID = owner.recruiterUserID
	--left join e1 on C.userID = e1.ID
	left join ed on C.userID = ed.ID -- candidate-email-DUPLICATION
	left join e2 on C.userID = e2.ID
	--left join Education on C.userID = Education.userID
	left join EducationSummary es on es.userID = C.userID
	--left join t4 on t4.candidateUserID = C.userID
	left join files on C.userID = files.candidateUserID
	--left join comment on C.userID = comment.Userid
	left join note on C.userID = note.candidateID
	where C.isPrimaryOwner = 1
	--and C.userid in (37380,5)
	--and (C.FirstName like '%Partha%' or C.LastName like '%Partha%')
	--and concat (C.FirstName,' ',C.LastName) like '%Partha%'
	--and e1.email = '' or e1.email is null --e1.email &lt;&gt; ''
	--inner join bullhorn1.BH_UserContact UC_2 on C.recruiterUserID = UC_2.userID
	--left join bullhorn1.BH_ClientCorporation CC ON CC.clientCorporationID = C.clientCorporationID

/* select * from tmp_country
select    C.candidateID as 'externalId'
	, C.Nickname as 'PreferredName'
        , Coalesce(NULLIF(replace(C.FirstName,'?',''), ''), 'No Firstname') as 'contact-firstName'
        , Coalesce(NULLIF(replace(C.LastName,'?',''), ''), concat('Lastname-',C.candidateID)) as 'contact-lastName'
from bullhorn1.Candidate C
where Nickname &lt;&gt; '' and Nickname is not null


with t as (
select    C.candidateID as 'externalId'
        , Coalesce(NULLIF(replace(C.FirstName,'?',''), ''), 'No Firstname') as 'contact-firstName'
        , Coalesce(NULLIF(replace(C.LastName,'?',''), ''), concat('Lastname-',C.candidateID)) as 'contact-lastName'
        , C.source as original
        , case 
                when c.source like '%Inde%' then 29085
                when c.source like '%Volc%' then 29084
                when c.source like '%Dova%' then 29086
                when c.source like '%Broa%' then 29089
                when c.source like '%Head%' then 29091
                when c.source like '%Refe%' then 29092
                when c.source like '%Data%' then 29093
                when c.source like '%Inst%' then 29087
                when c.source like '%Logi%' then 29094
                when c.source like '%Auto%' then 29095
                when c.source like '%Inde%' then 29098
                when c.source like '%Alph%' then 29096
                when c.source like '%Face%' then 29097
                when c.source like '%Jobstreet%' then 29099
                when c.source like '%Lee %' then 29101
                when c.source like '%Link%' then 29090
                when c.source like '%Link%Job%' then 29102
                when c.source like '%Regi%' then 29103
                when c.source like '%JobsDB%' then 29100
        else '' end as 'candidate_source_id'
from bullhorn1.Candidate C
where source &lt;&gt; '' and source is not null )
--select count(*) from t where source is not null
select * from t where candidate_source_id &lt;&gt; 0 and candidate_source_id &lt;&gt; '29093'
--where externalid = 13144

*/</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1584</xloc>
      <yloc>304</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>BULLHORN Company Comment</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>with 
t as (
       select 
                 UC1.clientCorporationID
               , UC.dateAdded , author.name as 'authorname', author.email as 'authoremail'--author.userID, 
               , about.name as 'aboutname', about.email as 'aboutemail'--, about.userID 
               , UC.action, UC.comments
       from bullhorn1.BH_UserComment UC
       left join (select * from bullhorn1.BH_UserContact) author ON author.userID = UC.commentingUserID
       left join (select * from bullhorn1.BH_UserContact) about ON about.userID = UC.userID
       --left join bullhorn1.BH_ClientCorporation on Cl.userID = UC.userID
       --left join bullhorn1.BH_Client Cl on Cl.userID = UC.userID
       left join bullhorn1.BH_UserContact UC1 ON UC1.userID = UC.userID
       where UC1.clientCorporationID is not null
       --and UC.dateAdded between '2017-09-01' AND '2017-11-01' --&lt;&lt;&lt;&lt;&lt;
       --and (UC.dateAdded &lt; '2017-09-01' or '2017-11-01' &lt; UC.dateAdded ) --&lt;&lt;&lt;&lt;&lt;
       /*order by UC.dateAdded desc 
       and UC1.clientCorporationID = 4666 
       and UC.comments like 'Can you put%'  
       or UC1.userid in (98297,180534) or U.userid in (98297,180534) */
       )

--select count(*) from t
select
             clientCorporationID as external_id
          	, cast('-10' as int) as 'user_account_id'
			, t.authoremail as UserEmail
          , 'comment' as category
          , 'company' as type	
          , dateAdded as insert_timestamp
         ,  [dbo].[fn_ConvertHTMLToText](
              Stuff(  Coalesce('Author Name: ' + nullif(convert(varchar(max),authorname), '') + char(10), '')
                        + Coalesce('Author Email: ' + nullif(convert(varchar(max),authoremail), '') + char(10), '')
                        + Coalesce('Author Name: ' + nullif(convert(varchar(max),aboutname), '') + char(10), '')
                        + Coalesce('About Email: ' + nullif(convert(varchar(max),aboutemail), '') + char(10), '')
                        + Coalesce('Action: ' + nullif(convert(varchar(max),[action]), '') + char(10), '')
                        + Coalesce('Comments: ' + nullif(convert(varchar(max),comments), '') + char(10), '')
              , 1, 0, '')) as content
        -- select  top 10 *
from t</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>64</xloc>
      <yloc>80</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>BULLHORN Contact Comment</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>
with 
Task_Assignments as (

	SELECT [taskID]
      ,string_agg(NULLIF(cast( concat(uc.FirstName, ' ', uc.LastName, '     ', uc.email) as varchar(max)), ''),  ',') as owners
	  FROM [bullhorn1].[View_TaskOwner] tow
	  join [bullhorn1].[BH_UserContact] uc on uc.userID = tow.ownerID
	  group by taskID
	 -- order by taskID
)

,comments as (
	 select Cl.clientID as 'contact_id' --, UC.userID, concat(UC1.firstName,' ',UC1.lastName) as fullname
			 , UC.dateAdded
			 , Stuff('COMMENT: ' + char(10)
					 + Coalesce('Created Date: ' + NULLIF(convert(varchar,UC.dateAdded,120), '') + char(10), '')
					 + Coalesce('Author: ' + NULLIF(U.name, '') + char(10), '')
					 + Coalesce('Action: ' + NULLIF(UC.action, '') + char(10), '')
					 + Coalesce('Comments: ' + NULLIF(cast(UC.comments as nvarchar(max)), '') + char(10), '')
			 , 1, 0, '') as 'content'
	 -- select top 100 *
	 from bullhorn1.BH_UserComment UC
	 left join bullhorn1.BH_Client Cl on Cl.userID = UC.userID
	 left join bullhorn1.BH_UserContact UC1 ON Cl.userID = UC1.userID
	 left join bullhorn1.BH_User U on U.userID = UC.commentingUserID
	 where Cl.isPrimaryOwner = 1
 UNION ALL
	 SELECT --top 20 
	 Cl.clientID as 'contact_id' --,concat(UC1.firstName,' ',UC1.lastName) as fullname
	 , a.dateAdded
		  , Stuff(       'APPOINTMENT: ' + char(10)
                         	     + Coalesce('Contact: ' + NULLIF(cast(concat(UC1.FirstName,' ',UC1.LastName,'     ',UC1.email) as varchar(max)), '') + char(10), '') --a.clientUserID 
                         	     + Coalesce('Candidate: ' + NULLIF(cast( concat(UC2.FirstName,' ',UC2.LastName,'     ',UC2.email) as varchar(max)), '') + char(10), '') --a.candidateUserID 
                         	     + Coalesce('Job: ' + NULLIF(cast(j.title as varchar(max)), '') + char(10), '') --jobPostingID
                                 + coalesce('Communication Method: ' + NULLIF(convert(varchar(max),a.communicationMethod), '') + char(10), '')
		                   + Coalesce('Date Begin: ' + NULLIF(cast(a.dateBegin as varchar(max)), '') + char(10), '')
                                 + coalesce('Date End: ' + NULLIF(convert(varchar(max),a.dateEnd), '') + char(10), '')
                                 + coalesce('Type: ' + NULLIF(convert(varchar(max),a.type), '') + char(10), '') --CA.activePlacements
                                 + coalesce('Subject: ' + NULLIF(convert(varchar(max),a.subject), '') + char(10), '')
                                 + coalesce('Reminder: ' + NULLIF(convert(varchar(max),a.notificationMinutes), '') + char(10), '')
                                 + coalesce('Opportunity: ' + NULLIF(convert(varchar(max),j2.title), '') + char(10), '')
                                 + coalesce('Location: ' + NULLIF(convert(varchar(max),a.location), '') + char(10), '')
                                 + coalesce('Description: ' + NULLIF( [dbo].[fn_ConvertHTMLToText](a.description), '') + char(10), '')
                                 + coalesce('File Name: ' + NULLIF(convert(varchar(max),af.name), '') + char(10), '')
                                 + coalesce('Owner: ' + NULLIF(cast( concat(UC3.FirstName,' ',UC3.LastName,'     ',UC3.email) as varchar(max)), '') + char(10), '')
                                 + coalesce('Lead: ' + NULLIF(cast( concat(UC4.FirstName,' ',UC4.LastName,'     ',UC4.email) as varchar(max)), '') + char(10), '')
                         , 1, 0, '') as 'content' 
	 -- select count(*) --2062
	 -- select top 100 *
	 from bullhorn1.View_Appointment a
	 left join bullhorn1.View_AppointmentFile af on af.appointmentID = a.appointmentID
	 left join bullhorn1.BH_Client Cl on Cl.userID = a.ClientUserID
	 left join bullhorn1.BH_UserContact UC1 ON UC1.userID = Cl.userID
	 left join bullhorn1.BH_UserContact UC2 ON UC2.userID = a.candidateUserID
	 left join bullhorn1.BH_UserContact UC3 ON UC3.userID = a.userID
	 left join bullhorn1.BH_UserContact UC4 ON UC4.userID = a.LeaduserID
	 left join bullhorn1.BH_JobPosting j on j.jobPostingID = a.jobPostingID
	 left join bullhorn1.BH_JobPosting j2 on j.jobPostingID = a.opportunityJobPostingID
	 where Cl.userID is not null
 UNION ALL
	SELECT ---top 20 
                     Cl.clientID as 'contact_id' --,concat(UC1.firstName,' ',UC1.lastName) as fullname
                     , a.dateAdded
                             , Stuff(       'TASK: ' + char(10)
              -- + Coalesce('Candidate: ' + NULLIF(cast( concat(UC2.FirstName,' ',UC2.LastName,'     ',UC2.email) as varchar(max)), '') + char(10), '') --a.candidateUserID 
              + Coalesce('Assignments: ' + NULLIF(cast(ta.owners as varchar(max)), '') + char(10), '')
			  + Coalesce('Date Added: ' + NULLIF(convert(varchar, a.dateAdded,120), '') + char(10), '')
              --+ Coalesce('Contact: ' + NULLIF(cast(concat(UC1.FirstName,' ',UC1.LastName,'     ',UC1.email) as varchar(max)), '') + char(10), '') --a.clientUserID 
              + Coalesce('Due Date And Time: ' + NULLIF(cast(a.dateBegin as varchar(max)), '') + char(10), '')
              --+ Coalesce('Date End: ' + NULLIF(cast(a.dateEnd as varchar(max)), '') + char(10), '')
              
              --+ Coalesce('Job: ' + NULLIF(cast(j.title as varchar(max)), '') + char(10), '') --jobPostingID
              --+ Coalesce('Lead: ' + NULLIF(cast( concat(UC3.FirstName,' ',UC3.LastName,'     ',UC3.email) as varchar(max)), '') + char(10), '') --a.leadUserID
              --+ Coalesce('Reminder: ' + NULLIF(cast(a.notificationMinutes as varchar(max)), '') + char(10), '')
              --+ Coalesce('Opportunity: ' + NULLIF(cast(a.opportunityJobPostingID as varchar(max)), '') + char(10), '')
              --+ Coalesce('Placement: ' + NULLIF(cast(a.placementID as varchar(max)), '') + char(10), '')
              --+ Coalesce('Priority: ' + NULLIF(cast(a.priority as varchar(max)), '') + char(10), '')
              + Coalesce('Subject: ' + NULLIF(cast(a.subject as varchar(max)), '') + char(10), '')
			  + Coalesce('Parent Task: ' + NULLIF(cast(a.parentTaskID as varchar(max)), '') + char(10), '')
			  + Coalesce('Time Zone ID: ' + NULLIF(cast(a.timeZoneID as varchar(max)), '') + char(10), '')
              + Coalesce('Type: ' + NULLIF(cast(a.type as varchar(max)), '') + char(10), '')
              + Coalesce('Owner: ' + NULLIF(cast( concat(UC4.FirstName,' ',UC4.LastName,'     ',UC4.email) as varchar(max)), '') + char(10), '') --a.userID
			  + Coalesce('Description: ' + NULLIF(cast( [dbo].[fn_ConvertHTMLToText](a.description) as varchar(max)), '') + char(10), '')
                        , 1, 0, '') as 'content' 
        -- select count(*) --24
        -- select top 100 *        
        from bullhorn1.View_Task a
        left join bullhorn1.BH_Client Cl on Cl.userID = a.ClientUserID
        left join bullhorn1.BH_UserContact UC1 ON Cl.userID = UC1.userID
        left join bullhorn1.BH_UserContact UC2 ON a.candidateUserID = UC2.userID
        left join bullhorn1.BH_JobPosting j on j.jobPostingID = a.jobPostingID
        --left join bullhorn1.BH_UserContact UC3 ON a.leadUserID = UC3.userID
        left join bullhorn1.BH_UserContact UC4 ON a.userID = UC4.userID
		left join Task_Assignments ta on ta.taskID = a.taskID
        where Cl.userID is not null 
       )

--select count(*) from comments where content &lt;&gt; '' --12428
--select top 10 * from bullhorn1.BH_Client 
--select count(*) from comments where contact_id is not null
--select * from comments where contact_id is not null and contact_id in (4054,7102) --538216 > 563579

select --top 100
                   contact_id
                  , cast('-10' as int) as 'user_account_id'
                  , 'comment' as 'category'
                  , 'contact' as 'type'
                  , dateAdded as 'insert_timestamp'
                  , [dbo].[fn_ConvertHTMLToText](content) as 'content'
from comments where 'content' &lt;&gt; '' 
--and contact_id = 326 
--or fullname like '%Philip%'</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>576</xloc>
      <yloc>80</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>BULLHORN Contact Email Body</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>select * from VCConACEmails</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>576</xloc>
      <yloc>160</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>BULLHORN Contact Info + Location 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>-- ALTER DATABASE [temptingventures] SET COMPATIBILITY_LEVEL = 130
with
  mail1 (ID,email) as (select UC.userID, replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(concat(ltrim(rtrim(UC.email)),',',ltrim(rtrim(UC.email2)),',',ltrim(rtrim(UC.email3))),'/',' '),'&lt;',' '),'>',' '),'(',' '),')',' '),':',' '),'.@','@'),'@.','@'),'+',' '),'&amp;',' '),'[',' '),']',' '),'?',' '),'''',' '),';',' ') as email from bullhorn1.BH_UserContact UC left join bullhorn1.BH_Client Cl on Cl.userID = UC.userID where Cl.isPrimaryOwner = 1)
, mail2 (ID,email) as (SELECT ID, email.value as email FROM mail1 m CROSS APPLY STRING_SPLIT(m.email,',') AS email)
, mail3 (ID,email) as (SELECT ID, case when RIGHT(email, 1) = '.' then LEFT(email, LEN(email) - 1) when LEFT(email, 1) = '.' then RIGHT(email, LEN(email) - 1) else email end as email from mail2 WHERE email like '%_@_%.__%')
, mail4 (ID,email,rn) as ( SELECT ID, email = ltrim(rtrim(CONVERT(NVARCHAR(MAX), email))), r1 = ROW_NUMBER() OVER (PARTITION BY ID ORDER BY ID desc) FROM mail3 )
, e1 (ID,email) as (select ID, email from mail4 where rn = 1)
, ed  (ID,email,rn) as (SELECT ID,email,ROW_NUMBER() OVER(PARTITION BY email ORDER BY ID DESC) AS rn FROM e1 )
, e2 (ID,email) as (select ID, email from mail4 where rn = 2)
, e3 (ID,email) as (select ID, email from mail4 where rn = 3)
--select * from ed

select 
	 Cl.clientID as 'contact-externalId'
	, UC.Phone2 as 'home_phone'
	, UC.Mobile as 'mobile_phone'
       , Stuff(
                                   Coalesce(' ' + NULLIF(UC.address1, ''), '')
                               + Coalesce(', ' + NULLIF(UC.address2, ''), '')
                               + Coalesce(', ' + NULLIF(UC.city, ''), '')
                               + Coalesce(', ' + NULLIF(UC.state, ''), '')
                               + Coalesce(', ' + NULLIF(tc.country, ''), '')
                       , 1, 1, '') as 'address'
       , UC.city
       , UC.state
       , UC.zip as 'post_code'
       , tc.ABBREVIATION as 'country_code' --UC.countryID
       , ltrim(Stuff(
                         Coalesce(', ' + NULLIF(UC.city, ''), '')
                        + Coalesce(', ' + NULLIF(UC.state, ''), '')
                        + Coalesce(', ' + NULLIF(tc.country, ''), '')
                , 1, 1, '') ) as 'locationName'
	, Cl.division as 'department'
	, e2.email as 'personal_email'
	, UC.namePrefix as 'gender_tile'
	, UC.NickName as 'nickname'
       , UC.customText1 as 'LinkedIn'
-- select count(*) --7487 -- select top 10 *
from bullhorn1.BH_Client Cl --where isPrimaryOwner = 1
left join bullhorn1.BH_UserContact UC ON Cl.userID = UC.userID
left join e2 ON Cl.userID = e2.ID -- candidate-email
left join tmp_country tc ON UC.countryID = tc.code
where isPrimaryOwner = 1 </sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>576</xloc>
      <yloc>240</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>BULLHORN Job Application - Rejected</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>select
[application-positionExternalId]
, [application-candidateExternalId]
--, cast(dateAdded as datetime) as associatedDate
, getdate() as rejectedDate
from VCApplications
where Rejected = 1</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1056</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>BULLHORN Job Comment</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>

with comments as (
                select a.jobPostingID as 'externalid' --, UC.userID, concat(UC1.firstName,' ',UC1.lastName) as fullname
                        , UC.dateAdded
                        , Stuff('COMMENT: ' + char(10)
                                + Coalesce('Created Date: ' + NULLIF(convert(varchar,UC.dateAdded,120), '') + char(10), '')
                                + Coalesce('Author: ' + NULLIF(U.name, '') + char(10), '')
                                + Coalesce('Action: ' + NULLIF(UC.action, '') + char(10), '')
                                + Coalesce('Comments: ' + NULLIF(cast(UC.comments as nvarchar(max)), '') + char(10), '')
                        , 1, 0, '') as 'content'
                -- select top 100 *
                from bullhorn1.BH_UserComment UC --where jobPostingID is not null
                left join bullhorn1.BH_JobPosting a on a.jobPostingID = UC.jobPostingID
                left join bullhorn1.BH_User U on U.userID = UC.commentingUserID
                where a.jobPostingID is not null
UNION ALL
	SELECT --top 20 
	a.jobPostingID as 'externalid'
	, a.dateAdded
		 , Stuff(       'APPOINTMENT: ' + char(10)
                         	    + Coalesce('Contact: ' + NULLIF(cast(concat(UC1.FirstName,' ',UC1.LastName,'     ',UC1.email) as varchar(max)), '') + char(10), '') --a.clientUserID 
                         	    + Coalesce('Candidate: ' + NULLIF(cast( concat(UC2.FirstName,' ',UC2.LastName,'     ',UC2.email) as varchar(max)), '') + char(10), '') --a.candidateUserID 
                         	    + Coalesce('Job: ' + NULLIF(cast(j.title as varchar(max)), '') + char(10), '') --jobPostingID
                                + coalesce('Communication Method: ' + NULLIF(convert(varchar(max),a.communicationMethod), '') + char(10), '')
		                  + Coalesce('Date Begin: ' + NULLIF(cast(a.dateBegin as varchar(max)), '') + char(10), '')
                                + coalesce('Date End: ' + NULLIF(convert(varchar(max),a.dateEnd), '') + char(10), '')
                                + coalesce('Type: ' + NULLIF(convert(varchar(max),a.type), '') + char(10), '') --CA.activePlacements
                                + coalesce('Subject: ' + NULLIF(convert(varchar(max),a.subject), '') + char(10), '')
                                + coalesce('Reminder: ' + NULLIF(convert(varchar(max),a.notificationMinutes), '') + char(10), '')
                                + coalesce('Opportunity: ' + NULLIF(convert(varchar(max),j2.title), '') + char(10), '')
                                + coalesce('Location: ' + NULLIF(convert(varchar(max),a.location), '') + char(10), '')
                                + coalesce('Description: ' + NULLIF( [dbo].[fn_ConvertHTMLToText](a.description), '') + char(10), '')
                                + coalesce('File Name: ' + NULLIF(convert(varchar(max),af.name), '') + char(10), '')
                                + coalesce('Owner: ' + NULLIF(cast( concat(UC3.FirstName,' ',UC3.LastName,'     ',UC3.email) as varchar(max)), '') + char(10), '')
                                + coalesce('Lead: ' + NULLIF(cast( concat(UC4.FirstName,' ',UC4.LastName,'     ',UC4.email) as varchar(max)), '') + char(10), '')
                        , 1, 0, '') as 'content' 
        -- select count(*) --2062
        -- select top 100 *
        from bullhorn1.View_Appointment a
        left join bullhorn1.View_AppointmentFile af on af.appointmentID = a.appointmentID
        left join bullhorn1.BH_Client Cl on Cl.userID = a.ClientUserID
        left join bullhorn1.BH_UserContact UC1 ON UC1.userID = Cl.userID
        left join bullhorn1.BH_UserContact UC2 ON UC2.userID = a.candidateUserID
        left join bullhorn1.BH_UserContact UC3 ON UC3.userID = a.userID
        left join bullhorn1.BH_UserContact UC4 ON UC4.userID = a.LeaduserID
        left join bullhorn1.BH_JobPosting j on j.jobPostingID = a.jobPostingID
        left join bullhorn1.BH_JobPosting j2 on j.jobPostingID = a.opportunityJobPostingID
        where j.jobPostingID is not null        
UNION ALL
	SELECT ---top 20 
       j.jobPostingID as 'externalid' --,concat(UC1.firstName,' ',UC1.lastName) as fullname
	, a.dateAdded
		 , Stuff(       'TASK: ' + char(10)
                            + Coalesce('Candidate: ' + NULLIF(cast( concat(UC2.FirstName,' ',UC2.LastName,'     ',UC2.email) as varchar(max)), '') + char(10), '') --a.candidateUserID 
                            --+ Coalesce('Assigned To: ' + NULLIF(cast(a.childTaskOwners as varchar(max)), '') + char(10), '')
                            + Coalesce('Contact: ' + NULLIF(cast(concat(UC1.FirstName,' ',UC1.LastName,'     ',UC1.email) as varchar(max)), '') + char(10), '') --a.clientUserID 
                            + Coalesce('Due Date And Time: ' + NULLIF(cast(a.dateBegin as varchar(max)), '') + char(10), '')
                            + Coalesce('Date End: ' + NULLIF(cast(a.dateEnd as varchar(max)), '') + char(10), '')
                            + Coalesce('Description: ' + NULLIF(cast( [dbo].[fn_ConvertHTMLToText](a.description) as varchar(max)), '') + char(10), '')
                            + Coalesce('Visibility: ' + NULLIF(cast(a.isPrivate as varchar(max)), '') + char(10), '')
                            + Coalesce('Job: ' + NULLIF(cast(j.title as varchar(max)), '') + char(10), '') --jobPostingID
                            + Coalesce('Lead: ' + NULLIF(cast( concat(UC3.FirstName,' ',UC3.LastName,'     ',UC3.email) as varchar(max)), '') + char(10), '') --a.leadUserID
                            + Coalesce('Reminder: ' + NULLIF(cast(a.notificationMinutes as varchar(max)), '') + char(10), '')
                            + Coalesce('Opportunity: ' + NULLIF(cast(a.opportunityJobPostingID as varchar(max)), '') + char(10), '')
                            + Coalesce('Placement: ' + NULLIF(cast(a.placementID as varchar(max)), '') + char(10), '')
                            + Coalesce('Priority: ' + NULLIF(cast(a.priority as varchar(max)), '') + char(10), '')
                            + Coalesce('Recurrence Day Bits: ' + NULLIF(cast(a.recurrenceDayBits as varchar(max)), '') + char(10), '')
                            + Coalesce('Recurrence Frequency: ' + NULLIF(cast(a.recurrenceFrequency as varchar(max)), '') + char(10), '')
                            + Coalesce('Recurrence Max: ' + NULLIF(cast(a.recurrenceMax as varchar(max)), '') + char(10), '')
                            + Coalesce('Recurrence Month Bits: ' + NULLIF(cast(a.recurrenceMonthBits as varchar(max)), '') + char(10), '')
                            + Coalesce('Recurrence Style: ' + NULLIF(cast(a.recurrenceStyle as varchar(max)), '') + char(10), '')
                            + Coalesce('Recurrence Type: ' + NULLIF(cast(a.recurrenceType as varchar(max)), '') + char(10), '')
                            + Coalesce('Subject: ' + NULLIF(cast(a.subject as varchar(max)), '') + char(10), '')
                            + Coalesce('Type: ' + NULLIF(cast(a.type as varchar(max)), '') + char(10), '')
                            + Coalesce('Owner: ' + NULLIF(cast( concat(UC4.FirstName,' ',UC4.LastName,'     ',UC4.email) as varchar(max)), '') + char(10), '') --a.userID
                        , 1, 0, '') as 'content' 
        -- select count(*) --24
        -- select top 100 *        
        from bullhorn1.View_Task a
        left join bullhorn1.BH_Client Cl on Cl.userID = a.ClientUserID
        left join bullhorn1.BH_UserContact UC1 ON Cl.userID = UC1.userID
        left join bullhorn1.BH_UserContact UC2 ON a.candidateUserID = UC2.userID
        left join bullhorn1.BH_JobPosting j on j.jobPostingID = a.jobPostingID
        left join bullhorn1.BH_UserContact UC3 ON a.leadUserID = UC3.userID
        left join bullhorn1.BH_UserContact UC4 ON a.userID = UC4.userID
        where j.jobPostingID is not null 

UNION ALL
        -- PLACEMENT
        select 
        PL.jobPostingID as 'externalid' 
        , pl.dateadded 
	, Stuff( 'PLACEMENT: ' + char(10)
              + Coalesce('Billing Contact: ' + NULLIF(cast( concat(UC1.FirstName,' ',UC1.LastName,'     ',UC1.email)  as varchar(max)), '') + char(10), '')  --pl.billingUserID
                     --+ Coalesce('Bill Rate Information: ' + NULLIF(cast(pl.billRateInfoHeader as varchar(max)), '') + char(10), '')
              + Coalesce('Bill Rate: ' + NULLIF(cast(pl.clientBillRate as varchar(max)), '') + char(10), '')
              + Coalesce('Over-time Bill Rate: ' + NULLIF(cast(pl.clientOverTimeRate as varchar(max)), '') + char(10), '')
              + Coalesce('Comments: ' + NULLIF(cast(pl.comments as varchar(max)), '') + char(10), '')
                     --+ Coalesce('Contract Employment Info: ' + NULLIF(cast(pl.contractInfoHeader as varchar(max)), '') + char(10), '')
              + Coalesce('Primary Timesheet Approver: ' + NULLIF(cast(pl.correlatedCustomText1 as varchar(max)), '') + char(10), '')
              + Coalesce('Secondary Timecard Approver: ' + NULLIF(cast(pl.correlatedCustomText2 as varchar(max)), '') + char(10), '')
              + Coalesce('Purchase Order Number: ' + NULLIF(cast(pl.correlatedCustomText3 as varchar(max)), '') + char(10), '')
              + Coalesce('Cost Center: ' + NULLIF(cast(pl.costCenter as varchar(max)), '') + char(10), '')
              + Coalesce('Insurance Reference: ' + NULLIF(cast(pl.customText1 as varchar(max)), '') + char(10), '')
              + Coalesce('Start Date: ' + NULLIF(cast(pl.dateBegin as varchar(max)), '') + char(10), '')
              + Coalesce('Effective Date (Client): ' + NULLIF(cast(pl.dateClientEffective as varchar(max)), '') + char(10), '')
              + Coalesce('Effective Date: ' + NULLIF(cast(pl.dateEffective as varchar(max)), '') + char(10), '')
              + Coalesce('Scheduled End: ' + NULLIF(cast(pl.dateEnd as varchar(max)), '') + char(10), '')
              + Coalesce('Days Guaranteed: ' + NULLIF(cast(pl.daysGuaranteed as varchar(max)), '') + char(10), '')
              + Coalesce('Days Pro-Rated: ' + NULLIF(cast(pl.daysProRated as varchar(max)), '') + char(10), '')
              + Coalesce('Employment Type: ' + NULLIF(cast(pl.employmentType as varchar(max)), '') + char(10), '')
              + Coalesce('Placement Fee (%): ' + NULLIF(cast(pl.fee as varchar(max)), '') + char(10), '')
              --+ Coalesce('Placement Fee (Flat): ' + NULLIF(cast(pl.flatFee as varchar(max)), '') + char(10), '')
              + Coalesce('Hours of Operation: ' + NULLIF(cast(pl.hoursOfOperation as varchar(max)), '') + char(10), '')
              + Coalesce('Hours Per Day: ' + NULLIF(cast(pl.hoursPerDay as varchar(max)), '') + char(10), '')
              + Coalesce('Rate Entry Type: ' + NULLIF(cast(pl.isMultirate as varchar(max)), '') + char(10), '')
              --+ Coalesce('Mark-up %: ' + NULLIF(cast(pl.markUpPercentage as varchar(max)), '') + char(10), '')
              + Coalesce('Over-time Pay Rate: ' + NULLIF(cast(pl.overtimeRate as varchar(max)), '') + char(10), '')
              + Coalesce('Pay Rate: ' + NULLIF(cast(pl.payRate as varchar(max)), '') + char(10), '')
                     --+ Coalesce('Pay Rate Information: ' + NULLIF(cast(pl.payRateInfoHeader as varchar(max)), '') + char(10), '')
                     --+ Coalesce('Permanent Employment Info: ' + NULLIF(cast(pl.permanentInfoHeader as varchar(max)), '') + char(10), '')
              + Coalesce('Referral Fee Type: ' + NULLIF(cast(pl.referralFeeType as varchar(max)), '') + char(10), '')
              + Coalesce('Reporting to: ' + NULLIF(cast(pl.reportTo as varchar(max)), '') + char(10), '')
              + Coalesce('Salary: ' + NULLIF(cast(pl.salary as varchar(max)), '') + char(10), '')
              + Coalesce('Pay Unit: ' + NULLIF(cast(pl.salaryUnit as varchar(max)), '') + char(10), '')
              + Coalesce('Status: ' + NULLIF(cast(pl.status as varchar(max)), '') + char(10), '')
        , 1, 0, '') as 'content'
        from bullhorn1.BH_Placement PL --where PL.reportTo &lt;&gt; ''
        left join bullhorn1.BH_UserContact UC1 ON UC1.userID = pl.billingUserID
        left join ( select candidateID, concat(FirstName,' ',LastName) as fullname, userid from bullhorn1.Candidate) C on C.userID = pl.userid
)

--select count(*) from comments where content &lt;&gt; '' --12428
--select top 10 * from bullhorn1.BH_Client 
--select count(*) from comments where contact_id is not null
--select * from comments where contact_id is not null and contact_id in (4054,7102) --538216 > 563579

select --top 100
                   externalid
                  , cast('-10' as int) as 'user_account_id'
                  , 'comment' as 'category'
                  , 'job' as 'type'
                  , dateAdded as 'insert_timestamp'
                  , [dbo].[fn_ConvertHTMLToText](content) as 'content'
from comments where 'content' &lt;&gt; '' 
--and candidateID = 2988 or fullname like '%Philip%'                
                

</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1072</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Can Note, Skills</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>select
--top 10
x.candidateID as CanExtId
, trim(isnull(firstName, '')) as firstName
, trim(isnull(middleName, '')) as middleName
, trim(isnull(lastName, '')) as lastName
, email
, email2
, email3
, email_old
, externalEmail
, [status]
, isDeleted
, getdate() - 1 as deleted_timestamp
, 'BIGG Group' as deleted_by
, '14.161.50.101' as deleted_ip_address
from bullhorn1.Candidate x
where x.isDeleted = 1
--and x.CandidateID = 15245</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>176</xloc>
      <yloc>496</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Candidate - desired_contract_rate - contract_rate</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>select 
       convert(varchar(500),C.candidateID) as 'candidate-externalId'
       , Coalesce(NULLIF(replace(C.FirstName,'?',''), ''), 'No Firstname') as 'contact-firstName'
       , Coalesce(NULLIF(replace(C.LastName,'?',''), ''), concat('Lastname-',C.userID)) as 'contact-lastName'
       , c.dayRate as 'desired_contract_rate'
       , c.dayRateLow as 'contract_rate'
-- select count (*) -- select distinct gender --employmentPreference -- select skillset, skillIDlist, customTextBlock1, companyURL --select top 10 * -- select dayRate, dayRateLow
from bullhorn1.Candidate C
--where C.isPrimaryOwner = 1	</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1584</xloc>
      <yloc>224</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Clear activity_candidate</name>
    <type>Delete</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <commit>100</commit>
    <lookup>
      <schema>public</schema>
      <table>activity_candidate</table>
      <key>
        <name>activity_id</name>
        <field>activity_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>candidate_id</name>
        <field>candidate_id</field>
        <condition>=</condition>
        <name2/>
      </key>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>897</xloc>
      <yloc>942</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Clear activity_company</name>
    <type>Delete</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <commit>100</commit>
    <lookup>
      <schema>public</schema>
      <table>activity_company</table>
      <key>
        <name>activity_id</name>
        <field>activity_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>company_id</name>
        <field>company_id</field>
        <condition>=</condition>
        <name2/>
      </key>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>145</xloc>
      <yloc>942</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Clear activity_contact</name>
    <type>Delete</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <commit>100</commit>
    <lookup>
      <schema>public</schema>
      <table>activity_contact</table>
      <key>
        <name>activity_id</name>
        <field>activity_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>contact_id</name>
        <field>contact_id</field>
        <condition>=</condition>
        <name2/>
      </key>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>433</xloc>
      <yloc>942</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Clear activity_job</name>
    <type>Delete</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <commit>100</commit>
    <lookup>
      <schema>public</schema>
      <table>activity_job</table>
      <key>
        <name>activity_id</name>
        <field>activity_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>position_id</name>
        <field>job_id</field>
        <condition>=</condition>
        <name2/>
      </key>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>657</xloc>
      <yloc>942</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>DONT USE job industry 3 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>
-- BusinessSector: split by separate rows by comma, then combine them into Business Sector(Industry)
with
  BusinessSector0(userid, businessSectorID) as (SELECT userid, a.value as ind FROM  ( select Cl.userID, UC.businessSectorIDList from bullhorn1.BH_Client Cl left join bullhorn1.BH_UserContact UC ON Cl.userID = UC.userID where Cl.isPrimaryOwner = 1 and convert(varchar(100),UC.businessSectorIDList) &lt;&gt; '' and UC.businessSectorIDList is not null ) m CROSS APPLY STRING_SPLIT( ltrim(rtrim( convert(varchar(100),m.businessSectorIDList) )), ',') AS a )
, BusinessSector(userId, BusinessSector) as (SELECT userId, ltrim(rtrim(BSL.name)) as BusinessSector from BusinessSector0 left join bullhorn1.BH_BusinessSectorList BSL ON BusinessSector0.businessSectorID = BSL.businessSectorID WHERE BusinessSector0.businessSectorID &lt;&gt; '' )
-- select * from BusinessSector
select
       distinct BusinessSector
       , current_timestamp as insert_timestamp
from BusinessSector</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1008</xloc>
      <yloc>240</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Database lookup 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>candidate-externalId</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>vc_candidate_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1776</xloc>
      <yloc>480</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Database lookup 2 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>contact</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>contact_id</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>actual_contactid</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>736</xloc>
      <yloc>80</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Database lookup 2 2 2 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>candidate_id</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>actual_candidateid</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1744</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Database lookup 2 2 2 2 2 2 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>position_description</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>externalid</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>actual_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1216</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Database lookup 2 2 2 2 2 2 2 2 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>company</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>external_id</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>actual_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>240</xloc>
      <yloc>80</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Database lookup 2 2 2 3</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>contact</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>contact-externalId</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>actual_contactid</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>736</xloc>
      <yloc>240</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Database lookup 2 2 3</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>contact</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>contact_id</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>actual_contactid</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>736</xloc>
      <yloc>160</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Database lookup 2 3</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>candidateID</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>actual_candidate_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1744</xloc>
      <yloc>80</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Database lookup 2 4</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate_source</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>candidate-source</name>
        <field>name</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>vc_source_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1776</xloc>
      <yloc>400</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert / Update</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <commit>1000</commit>
    <update_bypassed>Y</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>candidate_functional_expertise</table>
      <key>
        <name>final_candidate_id</name>
        <field>candidate_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>fe</name>
        <field>functional_expertise_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>candidate_id</name>
        <rename>final_candidate_id</rename>
        <update>Y</update>
      </value>
      <value>
        <name>functional_expertise_id</name>
        <rename>fe</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1808</xloc>
      <yloc>784</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert / Update 2</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>activity</table>
      <key>
        <name>actual_candidate_id</name>
        <field>candidate_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>content</name>
        <field>content</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>insert_timestamp</name>
        <field>insert_timestamp</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>candidate_id</name>
        <rename>actual_candidate_id</rename>
        <update>Y</update>
      </value>
      <value>
        <name>user_account_id</name>
        <rename>user_account_id</rename>
        <update>Y</update>
      </value>
      <value>
        <name>insert_timestamp</name>
        <rename>insert_timestamp</rename>
        <update>Y</update>
      </value>
      <value>
        <name>content</name>
        <rename>content</rename>
        <update>Y</update>
      </value>
      <value>
        <name>type</name>
        <rename>type</rename>
        <update>Y</update>
      </value>
      <value>
        <name>category</name>
        <rename>category</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1888</xloc>
      <yloc>80</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert / Update 2 2</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>activity</table>
      <key>
        <name>actual_contactid</name>
        <field>contact_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>content</name>
        <field>content</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>insert_timestamp</name>
        <field>insert_timestamp</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>contact_id</name>
        <rename>actual_contactid</rename>
        <update>Y</update>
      </value>
      <value>
        <name>user_account_id</name>
        <rename>user_account_id</rename>
        <update>Y</update>
      </value>
      <value>
        <name>insert_timestamp</name>
        <rename>insert_timestamp</rename>
        <update>Y</update>
      </value>
      <value>
        <name>content</name>
        <rename>content</rename>
        <update>Y</update>
      </value>
      <value>
        <name>type</name>
        <rename>type</rename>
        <update>Y</update>
      </value>
      <value>
        <name>category</name>
        <rename>category</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>880</xloc>
      <yloc>80</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert / Update 2 2 2 2 2</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>common_location</table>
      <key>
        <name>contact-externalId</name>
        <field>tmp_externalid</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>state</name>
        <rename>state</rename>
        <update>Y</update>
      </value>
      <value>
        <name>city</name>
        <rename>city</rename>
        <update>Y</update>
      </value>
      <value>
        <name>post_code</name>
        <rename>post_code</rename>
        <update>Y</update>
      </value>
      <value>
        <name>country_code</name>
        <rename>country_code</rename>
        <update>Y</update>
      </value>
      <value>
        <name>address</name>
        <rename>address</rename>
        <update>Y</update>
      </value>
      <value>
        <name>location_name</name>
        <rename>locationName</rename>
        <update>Y</update>
      </value>
      <value>
        <name>tmp_externalid</name>
        <rename>contact-externalId</rename>
        <update>N</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>880</xloc>
      <yloc>320</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert / Update 2 2 3</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>activity</table>
      <key>
        <name>actual_contactid</name>
        <field>contact_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>content</name>
        <field>content</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>insert_timestamp</name>
        <field>insert_timestamp</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>contact_id</name>
        <rename>actual_contactid</rename>
        <update>Y</update>
      </value>
      <value>
        <name>user_account_id</name>
        <rename>user_account_id</rename>
        <update>Y</update>
      </value>
      <value>
        <name>insert_timestamp</name>
        <rename>insert_timestamp</rename>
        <update>Y</update>
      </value>
      <value>
        <name>content</name>
        <rename>content</rename>
        <update>Y</update>
      </value>
      <value>
        <name>type</name>
        <rename>type</rename>
        <update>Y</update>
      </value>
      <value>
        <name>category</name>
        <rename>category</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>880</xloc>
      <yloc>160</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert / Update 2 3</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>activity</table>
      <key>
        <name>actual_candidateid</name>
        <field>candidate_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>content</name>
        <field>content</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>insert_timestamp</name>
        <field>insert_timestamp</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>candidate_id</name>
        <rename>actual_candidateid</rename>
        <update>Y</update>
      </value>
      <value>
        <name>user_account_id</name>
        <rename>user_account_id</rename>
        <update>Y</update>
      </value>
      <value>
        <name>insert_timestamp</name>
        <rename>insert_timestamp</rename>
        <update>Y</update>
      </value>
      <value>
        <name>content</name>
        <rename>content</rename>
        <update>Y</update>
      </value>
      <value>
        <name>type</name>
        <rename>type</rename>
        <update>Y</update>
      </value>
      <value>
        <name>category</name>
        <rename>category</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1888</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert / Update 2 3 2 2 2</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>activity</table>
      <key>
        <name>actual_id</name>
        <field>position_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>content</name>
        <field>content</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>insert_timestamp</name>
        <field>insert_timestamp</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>position_id</name>
        <rename>actual_id</rename>
        <update>Y</update>
      </value>
      <value>
        <name>user_account_id</name>
        <rename>user_account_id</rename>
        <update>Y</update>
      </value>
      <value>
        <name>insert_timestamp</name>
        <rename>insert_timestamp</rename>
        <update>Y</update>
      </value>
      <value>
        <name>content</name>
        <rename>content</rename>
        <update>Y</update>
      </value>
      <value>
        <name>type</name>
        <rename>type</rename>
        <update>Y</update>
      </value>
      <value>
        <name>category</name>
        <rename>category</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1344</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert / Update 2 3 2 2 2 2 2</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>activity</table>
      <key>
        <name>actual_id</name>
        <field>company_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>content</name>
        <field>content</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>insert_timestamp</name>
        <field>insert_timestamp</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>company_id</name>
        <rename>actual_id</rename>
        <update>Y</update>
      </value>
      <value>
        <name>user_account_id</name>
        <rename>user_account_id</rename>
        <update>Y</update>
      </value>
      <value>
        <name>insert_timestamp</name>
        <rename>insert_timestamp</rename>
        <update>Y</update>
      </value>
      <value>
        <name>content</name>
        <rename>content</rename>
        <update>Y</update>
      </value>
      <value>
        <name>type</name>
        <rename>type</rename>
        <update>Y</update>
      </value>
      <value>
        <name>category</name>
        <rename>category</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>400</xloc>
      <yloc>80</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert / Update 2 4</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>candidate_functional_expertise</table>
      <key>
        <name>fe</name>
        <field>functional_expertise_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>final_candidate_id</name>
        <field>candidate_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>sfe</name>
        <field>sub_functional_expertise_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>functional_expertise_id</name>
        <rename>fe</rename>
        <update>Y</update>
      </value>
      <value>
        <name>candidate_id</name>
        <rename>final_candidate_id</rename>
        <update>Y</update>
      </value>
      <value>
        <name>sub_functional_expertise_id</name>
        <rename>sfe</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1824</xloc>
      <yloc>864</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert Into activity_candidate</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <schema>public</schema>
    <table>activity_candidate</table>
    <commit>100</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>activity_id</column_name>
        <stream_name>activity_id</stream_name>
      </field>
      <field>
        <column_name>candidate_id</column_name>
        <stream_name>candidate_id</stream_name>
      </field>
      <field>
        <column_name>insert_timestamp</column_name>
        <stream_name>insert_timestamp</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>897</xloc>
      <yloc>1150</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert Into activity_company</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <schema>public</schema>
    <table>activity_company</table>
    <commit>100</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>activity_id</column_name>
        <stream_name>activity_id</stream_name>
      </field>
      <field>
        <column_name>company_id</column_name>
        <stream_name>company_id</stream_name>
      </field>
      <field>
        <column_name>insert_timestamp</column_name>
        <stream_name>insert_timestamp</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>145</xloc>
      <yloc>1150</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert Into activity_contact</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <schema>public</schema>
    <table>activity_contact</table>
    <commit>100</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>activity_id</column_name>
        <stream_name>activity_id</stream_name>
      </field>
      <field>
        <column_name>contact_id</column_name>
        <stream_name>contact_id</stream_name>
      </field>
      <field>
        <column_name>insert_timestamp</column_name>
        <stream_name>insert_timestamp</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>433</xloc>
      <yloc>1150</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert Into activity_job</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <schema>public</schema>
    <table>activity_job</table>
    <commit>100</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>activity_id</column_name>
        <stream_name>activity_id</stream_name>
      </field>
      <field>
        <column_name>job_id</column_name>
        <stream_name>position_id</stream_name>
      </field>
      <field>
        <column_name>insert_timestamp</column_name>
        <stream_name>insert_timestamp</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>657</xloc>
      <yloc>1150</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert Into candidate_deleted</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <schema>public</schema>
    <table>candidate_deleted</table>
    <commit>100</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>candidate_id</column_name>
        <stream_name>CanID</stream_name>
      </field>
      <field>
        <column_name>first_name</column_name>
        <stream_name>firstName</stream_name>
      </field>
      <field>
        <column_name>middle_name</column_name>
        <stream_name>middleName</stream_name>
      </field>
      <field>
        <column_name>last_name</column_name>
        <stream_name>lastName</stream_name>
      </field>
      <field>
        <column_name>insert_timestamp</column_name>
        <stream_name>deleted_timestamp</stream_name>
      </field>
      <field>
        <column_name>deleted_by</column_name>
        <stream_name>deleted_by</stream_name>
      </field>
      <field>
        <column_name>deleted_ip_address</column_name>
        <stream_name>deleted_ip_address</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>80</xloc>
      <yloc>672</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Job close date info</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>select
x.jobPostingID as JobExtId
, x.isOpen
, dateClosed
, case x.isOpen
	when 1 then dateadd(month, 6, getdate())
	when 0 then iif(x.dateClosed is null, getdate() - 3, x.dateClosed)
end as head_count_close_date
from bullhorn1.BH_JobPosting x</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>48</xloc>
      <yloc>784</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Update 2 2</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <skip_lookup>N</skip_lookup>
    <commit>1000</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema>public</schema>
      <table>position_candidate</table>
      <key>
        <name>final_candidate_id</name>
        <field>candidate_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>final_position_id</name>
        <field>position_description_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>rejected_date</name>
        <rename>rejectedDate</rename>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1408</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Update 2 3</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>Y</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema>public</schema>
      <table>contact</table>
      <key>
        <name>actual_contactid</name>
        <field>id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>department</name>
        <rename>department</rename>
      </value>
      <value>
        <name>gender_title</name>
        <rename>gender_tile</rename>
      </value>
      <value>
        <name>personal_email</name>
        <rename>personal_email</rename>
      </value>
      <value>
        <name>nick_name</name>
        <rename>nickname</rename>
      </value>
      <value>
        <name>mobile_phone</name>
        <rename>mobile_phone</rename>
      </value>
      <value>
        <name>home_phone</name>
        <rename>home_phone</rename>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>880</xloc>
      <yloc>240</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Update 3</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <skip_lookup>Y</skip_lookup>
    <commit>300</commit>
    <use_batch>N</use_batch>
    <error_ignored>N</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <key>
        <name>candidate-externalId</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>note</name>
        <rename>candidate-note</rename>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1776</xloc>
      <yloc>304</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Update 3 2</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <skip_lookup>Y</skip_lookup>
    <commit>300</commit>
    <use_batch>N</use_batch>
    <error_ignored>N</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <key>
        <name>candidate-externalId</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>desired_contract_rate</name>
        <rename>desired_contract_rate</rename>
      </value>
      <value>
        <name>contract_rate</name>
        <rename>contract_rate</rename>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1776</xloc>
      <yloc>224</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Update Can Note, Skills</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>N</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <key>
        <name>CanID</name>
        <field>id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>deleted_timestamp</name>
        <rename>deleted_timestamp</rename>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>256</xloc>
      <yloc>672</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Update Job</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <skip_lookup>N</skip_lookup>
    <commit>100</commit>
    <use_batch>N</use_batch>
    <error_ignored>N</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema>public</schema>
      <table>position_description</table>
      <key>
        <name>JobID</name>
        <field>id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>head_count_close_date</name>
        <rename>head_count_close_date</rename>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>320</xloc>
      <yloc>784</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>UserAccountLookup</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>user_account</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>N</eat_row_on_failure>
      <key>
        <name>UserEmail</name>
        <field>email</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>user_account_id</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>144</xloc>
      <yloc>16</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>VC Candiate Lookup</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name/>
        <field>external_id</field>
        <condition>IS NOT NULL</condition>
        <name2/>
      </key>
      <key>
        <name>CanExtId</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>CanID</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>256</xloc>
      <yloc>576</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>VC Candiate Lookup 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name/>
        <field>external_id</field>
        <condition>IS NOT NULL</condition>
        <name2/>
      </key>
      <key>
        <name>CanExtId</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NOT NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>CanID</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>80</xloc>
      <yloc>576</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>VC Job Lookup</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>position_description</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name/>
        <field>external_id</field>
        <condition>IS NOT NULL</condition>
        <name2/>
      </key>
      <key>
        <name>JobExtId</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>JobID</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>176</xloc>
      <yloc>784</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>additional_form_values InsertUpdate</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>additional_form_values</table>
      <key>
        <name>additional_type</name>
        <field>additional_type</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>final_additional_id</name>
        <field>additional_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>form_id</name>
        <field>form_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>field_id</name>
        <field>field_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>field_value</name>
        <field>field_value</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>additional_type</name>
        <rename>additional_type</rename>
        <update>N</update>
      </value>
      <value>
        <name>additional_id</name>
        <rename>final_additional_id</rename>
        <update>N</update>
      </value>
      <value>
        <name>form_id</name>
        <rename>form_id</rename>
        <update>N</update>
      </value>
      <value>
        <name>field_id</name>
        <rename>field_id</rename>
        <update>N</update>
      </value>
      <value>
        <name>field_value</name>
        <rename>field_value</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>272</xloc>
      <yloc>400</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>additional_form_values InsertUpdate 2</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>additional_form_values</table>
      <key>
        <name>additional_type</name>
        <field>additional_type</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>final_additional_id</name>
        <field>additional_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>form_id</name>
        <field>form_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>field_id</name>
        <field>field_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>field_value</name>
        <field>field_value</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>additional_type</name>
        <rename>additional_type</rename>
        <update>N</update>
      </value>
      <value>
        <name>additional_id</name>
        <rename>final_additional_id</rename>
        <update>N</update>
      </value>
      <value>
        <name>form_id</name>
        <rename>form_id</rename>
        <update>N</update>
      </value>
      <value>
        <name>field_id</name>
        <rename>field_id</rename>
        <update>N</update>
      </value>
      <value>
        <name>field_value</name>
        <rename>field_value</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>736</xloc>
      <yloc>672</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>candidate 3 2 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>application-candidateExternalId</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>final_candidate_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1328</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>candidate 3 3</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>candidate-externalId</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>final_candidate_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1648</xloc>
      <yloc>720</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>candidate 3 3 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>candidateID</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>final_candidate_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1680</xloc>
      <yloc>864</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>candidate FE-SFE 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>-- CATEGORY - VC FE info
 with CateSplit(userid, categoryid) as (SELECT userid, Split.a.value('.','varchar(2000)') AS categoryID FROM (SELECT userid, CAST('&lt;M>' + REPLACE(cast(categoryIDList as varchar(max)),',','&lt;/M>&lt;M>') + '&lt;/M>' AS XML) AS x FROM  bullhorn1.Candidate where isPrimaryOwner = 1) t CROSS APPLY x.nodes('/M') as Split(a) )
, CName(Userid, Name) as (SELECT Userid, STUFF((SELECT DISTINCT ', ' + CL.occupation from CateSplit left join bullhorn1.BH_CategoryList CL ON CateSplit.categoryid = CL.categoryID WHERE CateSplit.categoryid &lt;&gt; '' and Userid = a.Userid FOR XML PATH (''), TYPE).value('.', 'nvarchar(MAX)'), 1, 2, '') AS URLList FROM CateSplit as a where a.categoryid &lt;&gt; '' GROUP BY a.Userid)
--, CName(Userid, Name) as (SELECT Userid, CL.occupation from CateSplit left join bullhorn1.BH_CategoryList CL ON CateSplit.categoryid = CL.categoryID )
-- select distinct Name from CName
 
 select 
       CA.candidateID as 'candidate-externalId'
       , case Cname.Name
              when 'Other' then 2983
              when 'Other Area(s)' then 2984
              when 'Sales' then 2985 
              end as fe
from bullhorn1.Candidate CA --where CA.isPrimaryOwner = 1 --where convert(varchar(max),CA.comments) &lt;&gt; ''
left join CName on CA.userID = CName.Userid
where CA.isPrimaryOwner = 1 and CName.name is not null</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1552</xloc>
      <yloc>720</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>candidate id</name>
    <type>DBLookup</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>candidateID</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>final_candidate_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1776</xloc>
      <yloc>640</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>candidate industry</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>-- BusinessSector: split by separate rows by comma, then combine them into Business Sector(Industry)
with
  BusinessSector0(userid, businessSectorID) as (SELECT userid, a.value as ind FROM  bullhorn1.Candidate m CROSS APPLY STRING_SPLIT( ltrim(rtrim( convert(varchar(100),m.businessSectorIDList) )), ',') AS a where isPrimaryOwner = 1 )
, BusinessSector(userId, BusinessSector) as (SELECT userId, ltrim(rtrim(BSL.name)) as BusinessSector from BusinessSector0 left join bullhorn1.BH_BusinessSectorList BSL ON BusinessSector0.businessSectorID = BSL.businessSectorID WHERE BusinessSector0.businessSectorID &lt;&gt; '' )
select distinct BusinessSector, current_timestamp as insert_timestamp from BusinessSector
  </sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1552</xloc>
      <yloc>560</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>candidate industry 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>
-- BusinessSector: split by separate rows by comma, then combine them into Business Sector(Industry)
with
  BusinessSector0(userid, businessSectorID) as (SELECT userid, a.value as ind FROM  bullhorn1.Candidate m CROSS APPLY STRING_SPLIT( ltrim(rtrim( convert(varchar(100),m.businessSectorIDList) )), ',') AS a where isPrimaryOwner = 1 )
, BusinessSector(userId, BusinessSector) as (SELECT userId, ltrim(rtrim(BSL.name)) as BusinessSector from BusinessSector0 left join bullhorn1.BH_BusinessSectorList BSL ON BusinessSector0.businessSectorID = BSL.businessSectorID WHERE BusinessSector0.businessSectorID &lt;&gt; '' )
/*select 
       distinct BusinessSector
       , current_timestamp as insert_timestamp
from BusinessSector*/
  
 
SELECT
         CA.candidateID
       , BS.BusinessSector
       , current_timestamp as insert_timestamp
from bullhorn1.Candidate CA
left join BusinessSector BS on CA.userID = BS.userId
where CA.isPrimaryOwner = 1</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1648</xloc>
      <yloc>640</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>candidate_functional_expertise 2</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <schema>public</schema>
    <table>candidate_functional_expertise</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>Y</ignore_errors>
    <use_batch>N</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field>contactid</partitioning_field>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>candidate_id</column_name>
        <stream_name>final_candidate_id</stream_name>
      </field>
      <field>
        <column_name>functional_expertise_id</column_name>
        <stream_name>fe</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1808</xloc>
      <yloc>720</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>candidate_industry</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <schema>public</schema>
    <table>candidate_industry</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>Y</ignore_errors>
    <use_batch>N</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field>contactid</partitioning_field>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>vertical_id</column_name>
        <stream_name>final_industry_id</stream_name>
      </field>
      <field>
        <column_name>candidate_id</column_name>
        <stream_name>final_candidate_id</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1888</xloc>
      <yloc>560</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>candidate_source</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>candidate_source</table>
      <key>
        <name>name</name>
        <field>name</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>payment_style</name>
        <field>payment_style</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>name</name>
        <rename>name</rename>
        <update>Y</update>
      </value>
      <value>
        <name>source_type</name>
        <rename>source_type</rename>
        <update>Y</update>
      </value>
      <value>
        <name>insert_timestamp</name>
        <rename>insert_timestamp</rename>
        <update>Y</update>
      </value>
      <value>
        <name>payment_style</name>
        <rename>payment_style</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1664</xloc>
      <yloc>400</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>candidate_source_id</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>candidate</table>
      <key>
        <name>vc_candidate_id</name>
        <field>id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>candidate_source_id</name>
        <rename>vc_source_id</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1904</xloc>
      <yloc>400</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>cf</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>SELECT
         clientCorporationID as 'external_additional_id'
        --, name 
        , 'add_com_info' as additional_type
        , 1006 as form_id
        , 1018 as field_id
        , replace(replace(replace(replace( ltrim(rtrim(customText1)),'Advisory',1),'General',2),'Investment',3),'TT Client',4) as field_value
from bullhorn1.BH_ClientCorporation
where customText1 &lt;&gt; ''</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>16</xloc>
      <yloc>400</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>cf 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>
-- TV Business Area
select
        Cl.clientID as 'external_additional_id'
        , 'add_con_info' as additional_type
        , 1007 as form_id
        , 1019 as field_id
        , replace(replace(replace(replace( ltrim(rtrim(UC.customText1)),'Advisory',1),'General',2),'Investment',3),'TT Client',4) as field_value
-- select distinct ltrim(rtrim(UC.customText1))
from bullhorn1.BH_Client Cl
left join bullhorn1.BH_UserContact UC ON Cl.userID = UC.userID
where Cl.isPrimaryOwner = 1 and UC.customText1 &lt;&gt; ''
</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>480</xloc>
      <yloc>672</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>collect candidate's activities</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <sql>SELECT id as activity_id
, candidate_id
, insert_timestamp
from activity
where candidate_id is not NULL and candidate_id > 0</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>897</xloc>
      <yloc>1038</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>collect company's activities</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <sql>SELECT id as activity_id
, company_id
, insert_timestamp
from activity
where company_id is not NULL and company_id > 0</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>145</xloc>
      <yloc>1038</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>collect contact's activities</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <sql>SELECT id as activity_id
, contact_id
, insert_timestamp
from activity
where contact_id is not NULL and contact_id > 0</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>433</xloc>
      <yloc>1038</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>collect job's activities</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <sql>SELECT id as activity_id
, position_id
, insert_timestamp
from activity
where position_id is not NULL and position_id > 0</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>657</xloc>
      <yloc>1022</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>com_industry 2</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <schema>public</schema>
    <table>company_industry</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>Y</ignore_errors>
    <use_batch>N</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field>contactid</partitioning_field>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>industry_id</column_name>
        <stream_name>final_industry_id</stream_name>
      </field>
      <field>
        <column_name>company_id</column_name>
        <stream_name>final_company_id</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>400</xloc>
      <yloc>160</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>company</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>company</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>external_additional_id</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>final_additional_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>128</xloc>
      <yloc>400</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>company id 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>company</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>clientCorporationID</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>final_company_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>272</xloc>
      <yloc>256</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>company industry 2 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>
with
ind (clientCorporationID,ind) as (SELECT clientCorporationID, ind.value as ind FROM bullhorn1.BH_ClientCorporation m CROSS APPLY STRING_SPLIT( ltrim(rtrim( convert(varchar(100),m.businessSectorList) )), ';') AS ind)

select 
        clientCorporationID
       , ind as 'company_industry' 
from ind
where ind &lt;&gt; ''</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>144</xloc>
      <yloc>256</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>company industry 3</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>with
ind (clientCorporationID,ind) as (SELECT clientCorporationID, ind.value as ind FROM bullhorn1.BH_ClientCorporation m CROSS APPLY STRING_SPLIT( ltrim(rtrim( convert(varchar(100),m.businessSectorList) )), ';') AS ind)

select
       distinct ind as 'company-industry'
       , current_timestamp as insert_timestamp
from ind
where ind &lt;&gt; ''</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>48</xloc>
      <yloc>160</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>contact</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>contact</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>external_additional_id</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>final_additional_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>576</xloc>
      <yloc>672</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>contact FE-SFE</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>
-- FE
select 
       Cl.clientid
       --, UC.categoryID
       , cat.occupation
from bullhorn1.BH_Client Cl 
left join bullhorn1.BH_UserContact UC ON Cl.userID = UC.userID 
left join bullhorn1.BH_CategoryList cat ON cat.categoryID = UC.categoryID
where Cl.isPrimaryOwner = 1
</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>464</xloc>
      <yloc>752</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>contact id</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>contact</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>clientid</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>final_contact_id</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>576</xloc>
      <yloc>752</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>contact id 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>contact</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>contact-externalId</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>final_contact_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>736</xloc>
      <yloc>592</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>contact industry 2 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>
-- BusinessSector: split by separate rows by comma, then combine them into Business Sector(Industry)
with
  BusinessSector0(userid, businessSectorID) as (SELECT userid, a.value as ind FROM  ( select Cl.userID, UC.businessSectorIDList from bullhorn1.BH_Client Cl left join bullhorn1.BH_UserContact UC ON Cl.userID = UC.userID where Cl.isPrimaryOwner = 1 and convert(varchar(100),UC.businessSectorIDList) &lt;&gt; '' and UC.businessSectorIDList is not null ) m CROSS APPLY STRING_SPLIT( ltrim(rtrim( convert(varchar(100),m.businessSectorIDList) )), ',') AS a )
, BusinessSector(userId, BusinessSector) as (SELECT userId, ltrim(rtrim(BSL.name)) as BusinessSector from BusinessSector0 left join bullhorn1.BH_BusinessSectorList BSL ON BusinessSector0.businessSectorID = BSL.businessSectorID WHERE BusinessSector0.businessSectorID &lt;&gt; '' )
-- select * from BusinessSector
/*select
       distinct BusinessSector
       , current_timestamp as insert_timestamp
from BusinessSector*/
  
 
SELECT
         Cl.clientID as 'contact-externalId'
--       , case when (ltrim(replace(UC.firstName,'?','')) = '' or  UC.firstName is null) then 'Firstname' else ltrim(replace(UC.firstName,'?','')) end as 'contact-firstName'
--	, case when (ltrim(replace(UC.lastName,'?','')) = '' or  UC.lastName is null) then concat('Lastname-',Cl.clientID) else ltrim(replace(UC.lastName,'?','')) end as 'contact-Lastname'
       , BS.BusinessSector
from bullhorn1.BH_Client Cl
left join bullhorn1.BH_UserContact UC ON Cl.userID = UC.userID
left join BusinessSector BS on Cl.userID = BS.userId
where cl.isPrimaryOwner = 1 and BS.BusinessSector is not null</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>592</xloc>
      <yloc>592</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>contact industry 3</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>
-- BusinessSector: split by separate rows by comma, then combine them into Business Sector(Industry)
with
  BusinessSector0(userid, businessSectorID) as (SELECT userid, a.value as ind FROM  ( select Cl.userID, UC.businessSectorIDList from bullhorn1.BH_Client Cl left join bullhorn1.BH_UserContact UC ON Cl.userID = UC.userID where Cl.isPrimaryOwner = 1 and convert(varchar(100),UC.businessSectorIDList) &lt;&gt; '' and UC.businessSectorIDList is not null ) m CROSS APPLY STRING_SPLIT( ltrim(rtrim( convert(varchar(100),m.businessSectorIDList) )), ',') AS a )
, BusinessSector(userId, BusinessSector) as (SELECT userId, ltrim(rtrim(BSL.name)) as BusinessSector from BusinessSector0 left join bullhorn1.BH_BusinessSectorList BSL ON BusinessSector0.businessSectorID = BSL.businessSectorID WHERE BusinessSector0.businessSectorID &lt;&gt; '' )
-- select * from BusinessSector
select
       distinct BusinessSector
       , current_timestamp as insert_timestamp
from BusinessSector</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>480</xloc>
      <yloc>512</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>contact_functional_expertise 2</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>contact_functional_expertise</table>
      <key>
        <name>final_contact_id</name>
        <field>contact_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>functional_expertise_id</name>
        <rename>final_fe_id</rename>
        <update>Y</update>
      </value>
      <value>
        <name>contact_id</name>
        <rename>final_contact_id</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>864</xloc>
      <yloc>752</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>contact_industry 3</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <schema>public</schema>
    <table>contact_industry</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>Y</ignore_errors>
    <use_batch>N</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field>contactid</partitioning_field>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>industry_id</column_name>
        <stream_name>final_industry_id</stream_name>
      </field>
      <field>
        <column_name>contact_id</column_name>
        <stream_name>final_contact_id</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>832</xloc>
      <yloc>512</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>contact_industry 3 2</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <schema>public</schema>
    <table>contact_industry</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>Y</ignore_errors>
    <use_batch>N</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field>contactid</partitioning_field>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>industry_id</column_name>
        <stream_name>final_industry_id</stream_name>
      </field>
      <field>
        <column_name>contact_id</column_name>
        <stream_name>final_contact_id</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1376</xloc>
      <yloc>240</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>fe</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>functional_expertise</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>N</eat_row_on_failure>
      <key>
        <name>occupation</name>
        <field>name</field>
        <condition>LIKE</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>final_fe_id</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>736</xloc>
      <yloc>752</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>industry</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>vertical</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>BusinessSector</name>
        <field>name</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>final_industry_id</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1776</xloc>
      <yloc>560</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>industry 2</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>vertical</table>
      <key>
        <name>BusinessSector</name>
        <field>name</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>name</name>
        <rename>BusinessSector</rename>
        <update>Y</update>
      </value>
      <value>
        <name>insert_timestamp</name>
        <rename>insert_timestamp</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1648</xloc>
      <yloc>560</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>industry 2 2</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>vertical</table>
      <key>
        <name>company-industry</name>
        <field>name</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>name</name>
        <rename>company-industry</rename>
        <update>Y</update>
      </value>
      <value>
        <name>insert_timestamp</name>
        <rename>insert_timestamp</rename>
        <update>N</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>144</xloc>
      <yloc>160</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>industry 2 3</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>vertical</table>
      <key>
        <name>BusinessSector</name>
        <field>name</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>name</name>
        <rename>BusinessSector</rename>
        <update>Y</update>
      </value>
      <value>
        <name>insert_timestamp</name>
        <rename>insert_timestamp</rename>
        <update>N</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>592</xloc>
      <yloc>512</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>industry 2 3 2</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>public</schema>
      <table>vertical</table>
      <key>
        <name>BusinessSector</name>
        <field>name</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>name</name>
        <rename>BusinessSector</rename>
        <update>Y</update>
      </value>
      <value>
        <name>insert_timestamp</name>
        <rename>insert_timestamp</rename>
        <update>N</update>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1136</xloc>
      <yloc>240</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>industry 3</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>vertical</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>company_industry</name>
        <field>name</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>final_industry_id</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>272</xloc>
      <yloc>160</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>industry 4</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>vertical</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>BusinessSector</name>
        <field>name</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>final_industry_id</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>736</xloc>
      <yloc>512</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>industry 4 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>vertical</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>BusinessSector</name>
        <field>name</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>final_industry_id</rename>
        <default/>
        <type>None</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1264</xloc>
      <yloc>240</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>job id 2 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>contact</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>contact-externalId</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>final_contact_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1264</xloc>
      <yloc>368</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>job industry 2 2 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>
-- BusinessSector: split by separate rows by comma, then combine them into Business Sector(Industry)
with
  BusinessSector0(userid, businessSectorID) as (SELECT userid, a.value as ind FROM  ( select Cl.userID, UC.businessSectorIDList from bullhorn1.BH_Client Cl left join bullhorn1.BH_UserContact UC ON Cl.userID = UC.userID where Cl.isPrimaryOwner = 1 and convert(varchar(100),UC.businessSectorIDList) &lt;&gt; '' and UC.businessSectorIDList is not null ) m CROSS APPLY STRING_SPLIT( ltrim(rtrim( convert(varchar(100),m.businessSectorIDList) )), ',') AS a )
, BusinessSector(userId, BusinessSector) as (SELECT userId, ltrim(rtrim(BSL.name)) as BusinessSector from BusinessSector0 left join bullhorn1.BH_BusinessSectorList BSL ON BusinessSector0.businessSectorID = BSL.businessSectorID WHERE BusinessSector0.businessSectorID &lt;&gt; '' )
-- select * from BusinessSector
/*select
       distinct BusinessSector
       , current_timestamp as insert_timestamp
from BusinessSector*/
  
 
SELECT
         Cl.clientID as 'contact-externalId'
--       , case when (ltrim(replace(UC.firstName,'?','')) = '' or  UC.firstName is null) then 'Firstname' else ltrim(replace(UC.firstName,'?','')) end as 'contact-firstName'
--	, case when (ltrim(replace(UC.lastName,'?','')) = '' or  UC.lastName is null) then concat('Lastname-',Cl.clientID) else ltrim(replace(UC.lastName,'?','')) end as 'contact-Lastname'
       , BS.BusinessSector
from bullhorn1.BH_Client Cl
left join bullhorn1.BH_UserContact UC ON Cl.userID = UC.userID
left join BusinessSector BS on Cl.userID = BS.userId
where cl.isPrimaryOwner = 1 and BS.BusinessSector is not null</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1136</xloc>
      <yloc>368</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>position_description</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>to</connection>
    <cache>N</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema>public</schema>
      <table>position_description</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>Y</eat_row_on_failure>
      <key>
        <name>application-positionExternalId</name>
        <field>external_id</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name/>
        <field>deleted_timestamp</field>
        <condition>IS NULL</condition>
        <name2/>
      </key>
      <value>
        <name>id</name>
        <rename>final_position_id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1216</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>sfe</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection/>
    <sql>
with
-- SkillName: split by separate rows by comma, then combine them into SkillName
  SkillName0(userid, skillID) as (SELECT userid, Split.a.value('.', 'VARCHAR(2000)') AS skillID FROM (SELECT userid, CAST('&lt;M>' + REPLACE(cast(skillIDList as varchar(max)),',','&lt;/M>&lt;M>') + '&lt;/M>' AS XML) AS x FROM  bullhorn1.Candidate where isPrimaryOwner = 1) t CROSS APPLY x.nodes('/M') AS Split(a) )
, SkillName(userId, SkillName) as (SELECT userId, SL.name from SkillName0 left join bullhorn1.BH_SkillList SL ON SkillName0.skillID = SL.skillID WHERE SkillName0.skillID &lt;&gt; '')
, sfe as (
                select
                 C.candidateID, concat(C.FirstName,' ',C.LastName) as fullname
                 , 2983 as 'fe'
                --, SN.SkillName
                , case sn.SkillName
when '1C' then 184
when 'Absence' then 185
when 'ActiveX' then 186
when 'Actuate' then 187
when 'Administer Training' then 188
when 'Administer Workforce' then 189
when 'ADP' then 190
when 'ADSL' then 191
when 'Advanced Configurator' then 192
when 'Advanced Planning' then 193
when 'Afrikaans' then 194
when 'Agile' then 195
when 'AIX' then 196
when 'ALE' then 197
when 'AME' then 198
when 'AMX BPM' then 199
when 'Android' then 200
when 'angular js' then 201
when 'Apache' then 202
when 'APO' then 203
when 'Application developer' then 204
when 'Application engine' then 205
when 'Application server' then 206
when 'AQ' then 207
when 'AquaLogic Architect' then 208
when 'AquaLogic BPM' then 209
when 'AquaLogic ESB' then 210
when 'Arbor' then 211
when 'Architect' then 212
when 'AS/400' then 213
when 'ASCP' then 214
when 'AX4' then 215
when 'Axure' then 216
when 'B2B Sales/Recruitment Consultant' then 217
when 'Back-End Developer' then 218
when 'BAM' then 219
when 'BAPI' then 220
when 'BC' then 221
when 'Benefits' then 222
when 'BI' then 223
when 'BI Architect' then 224
when 'bi publisher' then 225
when 'Big Data' then 226
when 'Big Data Architect' then 227
when 'BIG DATA Scientist' then 228
when 'BI-IP' then 229
when 'Billing' then 230
when 'BizTalk 2009' then 231
when 'Biztalk 2010' then 232
when 'BizTalk Systems Administrator' then 233
when 'BO' then 234
when 'BODI' then 235
when 'BOM' then 236
when 'BPM' then 237
when 'Bscs' then 238
when 'BSS Consultant' then 239
when 'BSS Solution Architect' then 240
when 'Bulgarian' then 241
when 'Business Analyst' then 242
when 'Business Intelligence' then 243
when 'Business Intelligence Architect' then 244
when 'Business Intelligence Business Analyst' then 245
when 'Business Intelligence Project Manager' then 246
when 'Business Process Consultant' then 247
when 'Business Rules' then 248
when 'BusinessEvents' then 249
when 'BusinessWorks 2nd' then 250
when 'BW' then 251
when 'C' then 252
when 'C#' then 253
when 'Ca' then 254
when 'Candidate Gateway' then 255
when 'Cantonese' then 256
when 'Captiva' then 257
when 'Cassandra' then 258
when 'CDMA/WCDMA' then 259
when 'Cim' then 260
when 'Cisco' then 261
when 'Clojure' then 262
when 'cloud' then 263
when 'Cloud Architect' then 264
when 'Cloud Development' then 265
when 'Cloud Security' then 266
when 'cloudera' then 267
when 'CM' then 268
when 'CMS' then 269
when 'Coach Agile' then 270
when 'CODA' then 271
when 'Cognos TM1' then 272
when 'Collaborator' then 273
when 'Configuration Manager' then 274
when 'Configurator' then 275
when 'Consulting' then 276
when 'CONTROL M' then 277
when 'Core Networks' then 278
when 'Cornerstone' then 279
when 'CouchDB' then 280
when 'CRM' then 281
when 'Croatian' then 282
when 'CrossWorlds' then 283
when 'CTO' then 284
when 'Czech' then 285
when 'd3js' then 286
when 'DADS-U' then 287
when 'Danish' then 288
when 'Data Analysis' then 289
when 'Data Cleansing' then 290
when 'DATA INTEGRATION' then 291
when 'Data Migration' then 292
when 'Data Quality' then 293
when 'data science' then 294
when 'Data Warehousing' then 295
when 'Database Architect' then 296
when 'DATAMART' then 297
when 'DataStage' then 298
when 'Dell Quest' then 299
when 'DevOps' then 300
when 'Digital PM' then 301
when 'Director of Marketing and Communications' then 302
when 'django' then 303
when 'Documentum' then 304
when 'DOS' then 305
when 'Drupal' then 306
when 'DS' then 307
when 'Dynamics Functional' then 308
when 'EAM' then 309
when 'EBTAX' then 310
when 'ECONFIGURATOR' then 311
when 'eDevelopment' then 312
when 'EIM' then 313
when 'Electronic Money' then 314
when 'eMarketing' then 315
when 'EmberJs' then 316
when 'Ems' then 317
when 'Engineer' then 318
when 'English' then 319
when 'eRecruitment' then 320
when 'ESA' then 321
when 'eSales' then 322
when 'eSettlement' then 323
when 'ESSBase' then 324
when 'Est' then 325
when 'Ethernet' then 326
when 'ETL' then 327
when 'EX' then 328
when 'EZpublish' then 329
when 'FA' then 330
when 'FAH' then 331
when 'Fi-co' then 332
when 'Filenet' then 333
when 'Finance AX Module' then 334
when 'Finance NAV Module' then 335
when 'Firewall' then 336
when 'Flash' then 337
when 'Flume' then 338
when 'FM' then 339
when 'Foodtech' then 340
when 'Forms' then 341
when 'FS-CD' then 342
when 'FSCM' then 343
when 'FS-CM' then 344
when 'FS-PM' then 345
when 'Full Stack' then 346
when 'Functional AX' then 347
when 'Functional NAV' then 348
when 'Fusion HR Consultant' then 349
when 'GC' then 350
when 'Genesys' then 351
when 'GI' then 352
when 'GIT' then 353
when 'Global Payroll' then 354
when 'Golang' then 355
when 'Gprs' then 356
when 'GSM' then 357
when 'Hal' then 358
when 'Hbase' then 359
when 'Hibernate' then 360
when 'Hive' then 361
when 'hortonworks' then 362
when 'HP Cloud' then 363
when 'HPQC' then 364
when 'HTML' then 365
when 'HYBRID' then 366
when 'Hybride Cloud' then 367
when 'IAM' then 368
when 'IBM BPM' then 369
when 'IBM Identity Manager' then 370
when 'IBM MDM' then 371
when 'IDAM' then 372
when 'IHM' then 373
when 'iLearning' then 374
when 'Interfacing' then 375
when 'Interim Management' then 376
when 'INV' then 377
when 'IOT' then 378
when 'IRANIAN' then 379
when 'IS Pharma' then 380
when 'ISAM' then 381
when 'ISAMESSO' then 382
when 'ISDS' then 383
when 'IS-H' then 384
when 'IS-Media' then 385
when 'IS-RE' then 386
when 'IS-U' then 387
when 'Italian' then 388
when 'ITIL' then 389
when 'Java Architect' then 390
when 'Java Developer' then 391
when 'JAVA FX' then 392
when 'Java lead dev' then 393
when 'Javascript' then 394
when 'JD EDWARDS' then 395
when 'JDEDWARDS' then 396
when 'Jira' then 397
when 'Joomla!' then 398
when 'JSON' then 399
when 'JSP' then 400
when 'Kafka' then 401
when 'KAZAKH' then 402
when 'Kshell' then 403
when 'L4G' then 404
when 'Laravel' then 405
when 'LE' then 406
when 'Lean' then 407
when 'Lease Management' then 408
when 'Lithuanian' then 409
when 'Loyalty' then 410
when 'LSO' then 411
when 'LTE' then 412
when 'Machine Learning' then 413
when 'Manufacturing NAV Module' then 414
when 'Marketing CRM Module' then 415
when 'Matlab' then 416
when 'Maven' then 417
when 'MDX' then 418
when 'MEAN Stack' then 419
when 'Mercury' then 420
when 'Message Broker' then 421
when 'Meteor JS' then 422
when 'Microsoft CRM' then 423
when 'Microsoft CRM Developer' then 424
when 'Microsoft CRM Director' then 425
when 'Microsoft Dynamics AX' then 426
when 'Microsoft Dynamics AX Finance' then 427
when 'Microsoft Dynamics AX PM' then 428
when 'Microsoft Dynamics AX Technical Consultant' then 429
when 'Microsoft Dynamics CRM' then 430
when 'Microsoft Dynamics CRM PM' then 431
when 'microsoft dynamics nav' then 432
when 'Microsoft Dynamics NAV BA' then 433
when 'Microsoft Dynamics NAV Developer' then 434
when 'Microsoft Dynamics NAV Director' then 435
when 'Microsoft Dynamics NAV pre-sales' then 436
when 'MongoDB' then 437
when 'MRP' then 438
when 'MSCA' then 439
when 'MySQL' then 440
when 'NAS' then 441
when 'Netbackup' then 442
when 'Netweaver Gateway' then 443
when 'Network administrator' then 444
when 'Network engineer' then 445
when 'NORD' then 446
when 'norweigan' then 447
when 'NoSQL' then 448
when 'OAM' then 449
when 'ODI' then 450
when 'ODS' then 451
when 'OIL HPM' then 452
when 'OIL TSW' then 453
when 'OKS' then 454
when 'OLM' then 455
when 'OM' then 456
when 'ONDEMAND' then 457
when 'OPENTEXT' then 458
when 'OPM' then 459
when 'Oracle' then 460
when 'Oracle Administrator' then 461
when 'Oracle Database Developer' then 462
when 'Oracle EBS' then 463
when 'Oracle EBS CRM Functional Consultant' then 464
when 'Oracle EBS CRM Project Director' then 465
when 'Oracle EBS CRM Project Manager' then 466
when 'Oracle EBS Financials Functional Consultant' then 467
when 'Oracle EBS Financials Project Director' then 468
when 'Oracle EBS Financials Support Consultant' then 469
when 'Oracle EBS HRMS Business Analyst' then 470
when 'Oracle EBS HRMS Project Manager' then 471
when 'Oracle EBS HRMS Support Consultant' then 472
when 'Oracle EBS HRMS Technical Analyst' then 473
when 'Oracle EBS HRMS Techno Functional' then 474
when 'Oracle EBS Logistics Business Analyst' then 475
when 'Oracle EBS Logistics Functional Consultant' then 476
when 'Oracle EBS Logistics Project Director' then 477
when 'Oracle EBS Logistics Techno Functional' then 478
when 'Oracle Fusion Financials' then 479
when 'Oracle Fusion Middleware' then 480
when 'Oracle Fusion Procurement' then 481
when 'Oracle Identity Management' then 482
when 'Oracle SOA' then 483
when 'Oracle SOA Architect' then 484
when 'Oracle SOA Tester' then 485
when 'OST' then 486
when 'OTA' then 487
when 'OTC' then 488
when 'OTL' then 489
when 'OTM' then 490
when 'Ouest' then 491
when 'PA' then 492
when 'PAB' then 493
when 'PAC' then 494
when 'Pascal' then 495
when 'PC' then 496
when 'Pega CLSA' then 497
when 'Pega CSA' then 498
when 'PEGA Developer' then 499
when 'Pentaho' then 500
when 'Peoplesoft Architect' then 501
when 'PeopleSoft Campus Developer' then 502
when 'PeopleSoft Campus Functional' then 503
when 'PeopleSoft Campus Project Manager' then 504
when 'PeopleSoft CRM Functional' then 505
when 'PeopleSoft CRM Project Manager' then 506
when 'PeopleSoft CRM Techno Functional' then 507
when 'PeopleSoft EPM Project Manager' then 508
when 'PeopleSoft EPM Techno Functional' then 509
when 'PeopleSoft ESA Functional' then 510
when 'PeopleSoft ESA Techno Functional' then 511
when 'PeopleSoft Financials Developer' then 512
when 'PeopleSoft Financials Functional' then 513
when 'PeopleSoft Financials Techno Functional' then 514
when 'PeopleSoft FSCM Developer' then 515
when 'PeopleSoft FSCM Functional' then 516
when 'PeopleSoft FSCM Project Manager' then 517
when 'PeopleSoft HR Developer' then 518
when 'PeopleSoft HR Project Manager' then 519
when 'PeopleSoft HR Techno Functional' then 520
when 'PeopleSoft Payroll Functional' then 521
when 'PeopleSoft Payroll Project Manager' then 522
when 'PeopleSoft Payroll Techno Functional' then 523
when 'Peoplesoft Tester' then 524
when 'PeopleTools' then 525
when 'PHP' then 526
when 'PHP lead dev' then 527
when 'PI' then 528
when 'Play Framework' then 529
when 'PM/Program Manager NAV' then 530
when 'Policy Manager' then 531
when 'Polish' then 532
when 'Portal' then 533
when 'Portuguese' then 534
when 'Postgresql' then 535
when 'postsales' then 536
when 'PowerShell' then 537
when 'Pre-Production Engineer' then 538
when 'Presales' then 539
when 'Prestashop' then 540
when 'Pretashop' then 541
when 'Pricing' then 542
when 'ProcessServer' then 543
when 'Procurement AX Module' then 544
when 'PRODUCT CATALOGUE' then 545
when 'Product Director' then 546
when 'Product Manager' then 547
when 'Production Analyst' then 548
when 'Project Manager' then 549
when 'Purchasing AX Module' then 550
when 'Python' then 551
when 'QM' then 552
when 'QP' then 553
when 'Quality Management' then 554
when 'QualityCenter' then 555
when 'quant' then 556
when 'R&amp;D' then 557
when 'RAN' then 558
when 'Recruitment' then 559
when 'Recruitment Resourcer' then 560
when 'Redhat' then 561
when 'Requirement Engineering' then 562
when 'Responsive Design' then 563
when 'Retail AX Module' then 564
when 'Risk Backtesting' then 565
when 'Risk Credit' then 566
when 'Risk LGD' then 567
when 'Risk Management' then 568
when 'Risk market quant' then 569
when 'Risk market regulatory' then 570
when 'Risk MOA' then 571
when 'Risk PD' then 572
when 'Risk Score Carding' then 573
when 'Risk Stress Testing' then 574
when 'RMCA' then 575
when 'Romanian' then 576
when 'RPG' then 577
when 'Ruby' then 578
when 'SA' then 579
when 'SAGE' then 580
when 'Sage 1000' then 581
when 'Sage Paie' then 582
when 'Sage x3' then 583
when 'Sales and Marketing NAV Module' then 584
when 'Sales AX Module' then 585
when 'Salesforce.com Administrator' then 586
when 'Salesforce.com Functional' then 587
when 'Salesforce.com Project Manager' then 588
when 'SAP' then 589
when 'SAP ABAP Developer' then 590
when 'SAP Admin' then 591
when 'SAP AMOA Finance Consultant' then 592
when 'SAP AMOA Logistic Consultant' then 593
when 'SAP APO CONSULTANT' then 594
when 'SAP Bank Analyzer Consultant' then 595
when 'SAP Bank Analyzer Techno/Fun Consultant' then 596
when 'SAP BCA Consultant' then 597
when 'SAP BCS Consultant' then 598
when 'SAP BCS Techno/Fun Consultant' then 599
when 'SAP BFC Consultant' then 600
when 'SAP BI Consultant' then 601
when 'SAP BO Administrator' then 602
when 'SAP BPC Consultant' then 603
when 'SAP BRF' then 604
when 'SAP BRIM Consultant' then 605
when 'SAP BW Consultant' then 606
when 'SAP BW Techno/Fun Consultant' then 607
when 'SAP CFM Consultant' then 608
when 'SAP CFM Techno/Fun Consultant' then 609
when 'SAP CML Consultant' then 610
when 'SAP CML Techno/Fun Consultant' then 611
when 'SAP CO Consultant' then 612
when 'SAP CO Techno/Fun Consultant' then 613
when 'SAP Core Banking Consultant' then 614
when 'SAP Core Banking Techno/Fun Consultant' then 615
when 'SAP CRM Developer' then 616
when 'SAP CS Consultant' then 617
when 'SAP CS Techno/Fun Consultant' then 618
when 'SAP DATA MIGRATION CONSULTANT' then 619
when 'SAP EDI Techno/Fun Consultant' then 620
when 'SAP EM Consultant' then 621
when 'SAP EWM Consultant' then 622
when 'Sap Fi Consultant' then 623
when 'SAP FI Techno/Fun Consultant' then 624
when 'SAP FI-AA Techno/Functional Consultant' then 625
when 'SAP Financials Business Analyst' then 626
when 'SAP FM Techno/Fun Consultant' then 627
when 'SAP FS-CD Consultant' then 628
when 'SAP FS-CS Consultant' then 629
when 'SAP FS-PM Consultant' then 630
when 'SAP FS-RI Consultant' then 631
when 'SAP HCM Techno/Fun Consultant' then 632
when 'SAP HR' then 633
when 'SAP IS-A&amp;D Consultant' then 634
when 'SAP IS-AFS Consultant' then 635
when 'SAP IS-AFS Techno/Fun Consultant' then 636
when 'SAP IS-Auto Consultant' then 637
when 'SAP IS-Auto Techno/Fun Consultant' then 638
when 'SAP IS-EH&amp;S Techno/Fun Consultant' then 639
when 'SAP IS-Media Techno/Fun Consultant' then 640
when 'SAP IS-Mill Consultant' then 641
when 'SAP IS-RE Consultant' then 642
when 'SAP IS-Retail Consultant' then 643
when 'SAP IS-Retail Techno/Fun Consultant' then 644
when 'SAP IS-T Techno/Fun Consultant' then 645
when 'SAP IS-U CONSULTANT' then 646
when 'SAP JVA Consultant' then 647
when 'SAP LE Consultant' then 648
when 'SAP LE Techno/Fun Consultant' then 649
when 'SAP MM Techno/Fun Consultant' then 650
when 'SAP Netweaver Architect /Consultant' then 651
when 'SAP PM Techno/Fun Consultant' then 652
when 'SAP PMO' then 653
when 'SAP PP Techno/Fun Consultant' then 654
when 'SAP PP-PI' then 655
when 'SAP PS Consultant' then 656
when 'SAP PS-CD Consultant' then 657
when 'SAP PS-CD Techno/Functional Consultant' then 658
when 'SAP QM Consultant' then 659
when 'SAP QM Techno/Fun Consultant' then 660
when 'SAP RE Consultant' then 661
when 'SAP Recruitment Consultant' then 662
when 'SAP REFX' then 663
when 'SAP RM Consultant' then 664
when 'SAP SCM Business Analyst' then 665
when 'SAP SNP Consultant' then 666
when 'SAP SRM Consultant' then 667
when 'SAP TM Consultant' then 668
when 'Sap Trainer' then 669
when 'SAP VARIANT CONFIGURATOR' then 670
when 'SAP VIM Consultant' then 671
when 'SAP VIM Techno/Fun Consultant' then 672
when 'SAP Workflow Developer' then 673
when 'SAS' then 674
when 'SDH/PDH' then 675
when 'SDLC' then 676
when 'SEC Business Continuity' then 677
when 'Sec Cert CCNA' then 678
when 'SEC cert CISM' then 679
when 'SEC cert CISP' then 680
when 'SEC cert CISSP' then 681
when 'SEC cert ISO 27001' then 682
when 'SEC CISO' then 683
when 'SEC Cryptography' then 684
when 'SEC Cyber Architect' then 685
when 'SEC Cyber Manager' then 686
when 'SEC Data Protection' then 687
when 'SEC Disaster Recovery' then 688
when 'SEC Encryption' then 689
when 'SEC FIREWALL' then 690
when 'SEC GDPR' then 691
when 'SEC IAM Technical' then 692
when 'SEC Infrastructure' then 693
when 'SEC IOT-Security' then 694
when 'SEC IT AUDIT' then 695
when 'SEC IT Auditor' then 696
when 'SEC Juniper' then 697
when 'SEC Network Security' then 698
when 'SEC Pre-Sales Security' then 699
when 'SEC Sales Security' then 700
when 'SEC Security Risk and Governance' then 701
when 'SEC SIEM Vulnerability Asst' then 702
when 'SEC SOC Security Analyst' then 703
when 'SEC TCP/IP' then 704
when 'SEC Wireless Security' then 705
when 'Security' then 706
when 'Security Cleared - UK Current' then 707
when 'Security Cleared - UK Potential' then 708
when 'Security Engineer' then 709
when 'Seeburger' then 710
when 'Selenium' then 711
when 'Self-Service' then 712
when 'Selligent Functional' then 713
when 'SENTINEL' then 714
when 'SEO Consultant' then 715
when 'Servicenow' then 716
when 'Sharepoint' then 717
when 'Siebel AMOE' then 718
when 'Siebel Architect' then 719
when 'Siebel Project Manager' then 720
when 'Siebel Trainer' then 721
when 'SIEBELTOOLS' then 722
when 'Silex' then 723
when 'Sitecore' then 724
when 'SLA' then 725
when 'SLOVAKIAN' then 726
when 'SMTP' then 727
when 'SOA' then 728
when 'SOA / BPM' then 729
when 'SOA Architect' then 730
when 'Solaris' then 731
when 'Solution Architect' then 732
when 'SPIP' then 733
when 'Splunk' then 734
when 'SQL Server' then 735
when 'Sql Server Administrator' then 736
when 'Sqoop' then 737
when 'SQR' then 738
when 'SSIS' then 739
when 'SSO' then 740
when 'SSRS' then 741
when 'Startup' then 742
when 'STLC' then 743
when 'Stockage' then 744
when 'Successfactor Consultant' then 745
when 'Successfactors Functional Consultant' then 746
when 'Successfactors PM/GM' then 747
when 'SuccessFactors Recruitment' then 748
when 'Successfactors Recruting' then 749
when 'SuccessFactors Variable Pay' then 750
when 'SuccessFactors Workforce Analytics' then 751
when 'Sud Est' then 752
when 'Sud Ouest' then 753
when 'Sun' then 754
when 'Supply Chain' then 755
when 'Supply Chain AX Module' then 756
when 'Support' then 757
when 'Swedish' then 758
when 'SWING' then 759
when 'Sybase' then 760
when 'Symfony' then 761
when 'System Administrator Linux' then 762
when 'System Administrator Unix' then 763
when 'System Engineer IBM' then 764
when 'System Engineer Unix' then 765
when 'System Engineer Windows' then 766
when 'T&amp;L' then 767
when 'Tableau' then 768
when 'Talentsoft Consultant' then 769
when 'TAM' then 770
when 'Technical Project Manager' then 771
when 'TELCO' then 772
when 'Telco Design' then 773
when 'Telco Installation Integration' then 774
when 'Telco Project Manager' then 775
when 'Telco Testing' then 776
when 'Telecom Project Manager' then 777
when 'Test Analyst' then 778
when 'Test Engineer' then 779
when 'Thai' then 780
when 'TIBCO Developer' then 781
when 'Tibco Project Manager' then 782
when 'Tibco Systems Administrator' then 783
when 'Tivoli' then 784
when 'TOGAF' then 785
when 'Trainer' then 786
when 'Transition Manager' then 787
when 'Transmission' then 788
when 'Turkish' then 789
when 'TV' then 790
when 'Typo3' then 791
when 'UCM' then 792
when 'UI designer' then 793
when 'UI/User Interface' then 794
when 'Ukrainian' then 795
when 'Umts' then 796
when 'Update Software Technical' then 797
when 'VBS' then 798
when 'VirtualBox' then 799
when 'Virtualization' then 800
when 'VNC' then 801
when 'VoIP' then 802
when 'Vsphere' then 803
when 'WAN' then 804
when 'Web ADI' then 805
when 'Web architect' then 806
when 'Web Design' then 807
when 'Web Development' then 808
when 'webdynpro' then 809
when 'Webfocus' then 810
when 'WebMethods' then 811
when 'Webmethods architect' then 812
when 'Webmethods Project Manager' then 813
when 'WebMethods Systems Administrator' then 814
when 'Websphere' then 815
when 'Websphere business Integrator' then 816
when 'WebSphere Business Integrator Message Broker' then 817
when 'Websphere Developer' then 818
when 'WebSphere Systems Administrator' then 819
when 'WebSphere Tester' then 820
when 'Windows NT' then 821
when 'Windows Server' then 822
when 'WM' then 823
when 'WMQI' then 824
when 'Workday Advanced Compensation' then 825
when 'Workday Bonus' then 826
when 'Workday Consultant' then 827
when 'Workday Core Connector' then 828
when 'Workday Data Conversion' then 829
when 'Workday Engagement Manager' then 830
when 'Workday Finance Functional Consultant' then 831
when 'Workday HCM Functional Consultant' then 832
when 'Workday HCM Technical Consultant' then 833
when 'Workday Integration Core' then 834
when 'Workday Integrations Certified' then 835
when 'Workday Learning' then 836
when 'Workday Payroll' then 837
when 'Workday Planning' then 838
when 'Workday Pre-sales' then 839
when 'Workday Reporting' then 840
when 'Workday Security' then 841
when 'Workday Studio' then 842
when 'Workday Talent &amp; Performance' then 843
when 'Workday Time Tracking' then 844
when 'WORKFORCE ADMINISTRATION' then 845
when 'WPF' then 846
when 'WPM' then 847
when 'WSO2' then 848
when 'Xamarin' then 849
when 'Xcelsius' then 850
when 'XHTML' then 851
when 'XML' then 852
when 'XML Publisher' then 853
when 'XSLT' then 854
when 'Zookeeper' then 855
when '$Univers' then 856
when '.NET' then 857
when '4G' then 858
when 'AA' then 859
when 'ABAP' then 860
when 'Abroad' then 861
when 'Accountant' then 862
when 'Acd' then 863
when 'ActionScript' then 864
when 'Active Directory' then 865
when 'Active Enterprise' then 866
when 'Active Matrix' then 867
when 'Actuary' then 868
when 'Adapter SDK' then 869
when 'ADI' then 870
when 'Administrator' then 871
when 'Adobe' then 872
when 'Adonix' then 873
when 'Adoption' then 874
when 'Advanced Collections' then 875
when 'AFF' then 876
when 'AFS' then 877
when 'Ajax' then 878
when 'Alfresco' then 879
when 'AM' then 880
when 'Amazon Web Services' then 881
when 'AMF' then 882
when 'AMOA' then 883
when 'Analytics' then 884
when 'AP' then 885
when 'API' then 886
when 'Application designer' then 887
when 'Application Messaging' then 888
when 'Application Packages' then 889
when 'Approval Management' then 890
when 'APS' then 891
when 'Aptitude' then 892
when 'Aqualogic' then 893
when 'AR' then 894
when 'Arabic' then 895
when 'ARIBA' then 896
when 'Art Director' then 897
when 'AS3' then 898
when 'ASP.NET' then 899
when 'ATM' then 900
when 'AX' then 901
when 'AX2009' then 902
when 'AX2012' then 903
when 'Axapta' then 904
when 'Azure AAD' then 905
when 'BACKBONE' then 906
when 'Bale' then 907
when 'Bank Reconciliation' then 908
when 'Banking Consultant' then 909
when 'Bash' then 910
when 'Basis' then 911
when 'BCS' then 912
when 'BIA' then 913
when 'Big Data Analyst' then 914
when 'Big Data Chief Officer' then 915
when 'Big Data Developer' then 916
when 'BIG DATA Ecole Gr.1' then 917
when 'Big Data Engineer' then 918
when 'Big Data Integration Specialist' then 919
when 'Big Data Miner' then 920
when 'Big Data Visualizer' then 921
when 'BizTalk Architect' then 922
when 'BizTalk Business Analyst' then 923
when 'Biztalk Developer' then 924
when 'BizTalk Functional Consultant' then 925
when 'Bootstrap' then 926
when 'BPR' then 927
when 'BPS' then 928
when 'Brio' then 929
when 'BRM' then 930
when 'Business Intelligence Developer' then 931
when 'Business Intelligence Functional Analyst' then 932
when 'Business Intelligence Project Director' then 933
when 'Business Intelligence Techno Functional Consultant' then 934
when 'Business Intelligence Trainer' then 935
when 'Business Transformation' then 936
when 'BusinessConnect' then 937
when 'BusinessStudio' then 938
when 'BusinessWorks' then 939
when 'BusinessWorks 6' then 940
when 'C++' then 941
when 'Campus Solutions' then 942
when 'Capital Market Consultant' then 943
when 'CC' then 944
when 'CCNA/CCNP' then 945
when 'Centre' then 946
when 'Change management' then 947
when 'Charging Systems' then 948
when 'Checkpoint' then 949
when 'Chinese' then 950
when 'Chronos' then 951
when 'CI' then 952
when 'CITRIX' then 953
when 'Clementine' then 954
when 'CO' then 955
when 'COBOL' then 956
when 'Cognos' then 957
when 'Cold Fusion' then 958
when 'Compensation' then 959
when 'Compliance Consultant' then 960
when 'COMPONENT INTERFACE' then 961
when 'Consultancy CRM' then 962
when 'Copywriting' then 963
when 'CORBA' then 964
when 'Cordova' then 965
when 'CROSS-PLATFORM' then 966
when 'Crystal' then 967
when 'CS' then 968
when 'CSS' then 969
when 'Customer Service CRM Module' then 970
when 'Customer Success Manager' then 971
when 'Cyber Security' then 972
when 'Data Architecture' then 973
when 'Data Centre' then 974
when 'Data mining' then 975
when 'Data Modelling' then 976
when 'Database Administrator' then 977
when 'Database Design' then 978
when 'Database Development' then 979
when 'Datamining' then 980
when 'DB2' then 981
when 'Debian' then 982
when 'Dell Quest One' then 983
when 'Delphi' then 984
when 'Demandware' then 985
when 'Developer' then 986
when 'DHCP' then 987
when 'Digital Payment Consultant' then 988
when 'Discoverer' then 989
when 'DM' then 990
when 'DNS' then 991
when 'DP' then 992
when 'Dutch' then 993
when 'Dynamics' then 994
when 'Dynamics Technical' then 995
when 'Dynasight' then 996
when 'EAI' then 997
when 'ECM' then 998
when 'Ecommerce' then 999
when 'e-commerce' then 1000
when 'E-commerce Development' then 1001
when 'eCommunication' then 1002
when 'eCompensation' then 1003
when 'EDI' then 1004
when 'eEnergy' then 1005
when 'EH&amp;S' then 1006
when 'ElasticSearch' then 1007
when 'ELM' then 1008
when 'ePerformance' then 1009
when 'epharma' then 1010
when 'EPM' then 1011
when 'eProcurement' then 1012
when 'eProfile' then 1013
when 'Erlang' then 1014
when 'eSourcing' then 1015
when 'ESX' then 1016
when 'Etraining' then 1017
when 'Ets' then 1018
when 'Exchange' then 1019
when 'Ext JS' then 1020
when 'F&amp;R' then 1021
when 'FI' then 1022
when 'Finance Business Transformation' then 1023
when 'Financials' then 1024
when 'Finnish' then 1025
when 'Fintech' then 1026
when 'fiori' then 1027
when 'French' then 1028
when 'Front-End Developer' then 1029
when 'FS-CS' then 1030
when 'Functional' then 1031
when 'Functional Architect' then 1032
when 'Functional CRM' then 1033
when 'Fusion' then 1034
when 'Genio' then 1035
when 'German' then 1036
when 'Gl' then 1037
when 'Google Apps' then 1038
when 'Google Cloud Platform' then 1039
when 'Governance' then 1040
when 'GRC' then 1041
when 'Greek' then 1042
when 'Groovy' then 1043
when 'GTA' then 1044
when 'Hadoop' then 1045
when 'HANA' then 1046
when 'Hebrew' then 1047
when 'Helpdesk' then 1048
when 'Hitachi' then 1049
when 'Hotonworks' then 1050
when 'HP-UX' then 1051
when 'HR' then 1052
when 'HR ACCESS' then 1053
when 'HR Access Functional' then 1054
when 'HR Access Technical' then 1055
when 'HR AX Module' then 1056
when 'HR Business Transformation' then 1057
when 'HRIS Project Manager' then 1058
when 'HUM' then 1059
when 'Hungarian' then 1060
when 'Hybris' then 1061
when 'Hyperion' then 1062
when 'IBM cloud computing' then 1063
when 'Identity Access Management' then 1064
when 'IDOC' then 1065
when 'IDS' then 1066
when 'IEXPENSES' then 1067
when 'Ile de France' then 1068
when 'Indian' then 1069
when 'Infor M3' then 1070
when 'Informatica' then 1071
when 'Infrastructure' then 1072
when 'Integration Broker' then 1073
when 'INTERSHOP' then 1074
when 'ios developer' then 1075
when 'IP' then 1076
when 'iProcess' then 1077
when 'iProcurement' then 1078
when 'iRecruitment' then 1079
when 'IS' then 1080
when 'IS-Auto' then 1081
when 'IS-FS' then 1082
when 'IS-Mill' then 1083
when 'IS-OIL' then 1084
when 'IS-Retail' then 1085
when 'IT Security Recruitment Consultant' then 1086
when 'J2EE' then 1087
when 'Jahia' then 1088
when 'Japanese' then 1089
when 'Java' then 1090
when 'Java Project Manager' then 1091
when 'jQuery' then 1092
when 'Juniper' then 1093
when 'Junit' then 1094
when 'Kanban' then 1095
when 'LAN' then 1096
when 'Latvian' then 1097
when 'Linux' then 1098
when 'Logistics' then 1099
when 'Lotus Notes' then 1100
when 'LSMW' then 1101
when 'MAC' then 1102
when 'Magento' then 1103
when 'Managing Director' then 1104
when 'Manufacturing' then 1105
when 'Manufacturing AX Module' then 1106
when 'MapReduce' then 1107
when 'MDM' then 1108
when 'Mega Data' then 1109
when 'Meteor' then 1110
when 'Microgen' then 1111
when 'Microsoft Azure' then 1112
when 'Microsoft BI' then 1113
when 'Microsoft CRM BA' then 1114
when 'Microsoft CRM PM' then 1115
when 'Microsoft Dynamics AX Developer' then 1116
when 'Microsoft Dynamics AX Functional Consultant' then 1117
when 'Microsoft Dynamics AX Pre-Sales' then 1118
when 'Microsoft Dynamics AX Sales' then 1119
when 'Microsoft Dynamics AX Solutions Architect' then 1120
when 'Microsoft Dynamics AX Support' then 1121
when 'Microsoft Dynamics AX Test Analyst' then 1122
when 'Microsoft Dynamics NAV Functional' then 1123
when 'Microsoft Dynamics NAV PM' then 1124
when 'Microsoft Dynamics NAV Sales' then 1125
when 'Microsoft Dynamics NAV Support' then 1126
when 'Microsoft Dynamics NAV Trainer' then 1127
when 'MicroStrategy' then 1128
when 'Middle East' then 1129
when 'MM' then 1130
when 'Mobile Development' then 1131
when 'Movex' then 1132
when 'MQ Series' then 1133
when 'MRO' then 1134
when 'MUREX ARCHITECT' then 1135
when 'NETSUITE' then 1136
when 'Netweaver' then 1137
when 'Networker' then 1138
when 'Noc' then 1139
when 'Node JS' then 1140
when 'Nvision' then 1141
when 'OAF' then 1142
when 'OBIEE' then 1143
when 'Objective-C' then 1144
when 'Ocs' then 1145
when 'oData' then 1146
when 'OFA' then 1147
when 'OIC' then 1148
when 'OIL SSR' then 1149
when 'OIL TD' then 1150
when 'OIM' then 1151
when 'OKE' then 1152
when 'OLAP' then 1153
when 'OO Programming' then 1154
when 'OPEN' then 1155
when 'OpenStack' then 1156
when 'optimization' then 1157
when 'Oracle EBS Administrator' then 1158
when 'Oracle EBS CRM Business Analyst' then 1159
when 'Oracle EBS CRM Support Consultant' then 1160
when 'Oracle EBS CRM Technical Analyst' then 1161
when 'Oracle EBS Financials Business Analyst' then 1162
when 'Oracle EBS Financials Project Manager' then 1163
when 'Oracle EBS Financials Technical Analyst' then 1164
when 'Oracle EBS HRMS Functional Consultant' then 1165
when 'Oracle EBS HRMS Project Director' then 1166
when 'Oracle EBS Logistics Project Manager' then 1167
when 'Oracle EBS Logistics Support Consultant' then 1168
when 'Oracle EBS Trainer' then 1169
when 'Oracle Fusion' then 1170
when 'Oracle Fusion HCM Functional Consultant' then 1171
when 'Oracle Fusion HCM Technical Consultant' then 1172
when 'Oracle Fusion PPM' then 1173
when 'Oracle SOA Developer' then 1174
when 'Oracle SOA Project Manager' then 1175
when 'Oracle SOA Systems Administrator' then 1176
when 'Order Capture' then 1177
when 'Order Management' then 1178
when 'OSS Consultant' then 1179
when 'OSS Solution Architect' then 1180
when 'Other' then 1181
when 'Payment Consultant' then 1182
when 'Payment Processing' then 1183
when 'Payroll' then 1184
when 'Pega Architect' then 1185
when 'Pega CBA' then 1186
when 'Pega CCA' then 1187
when 'Pega CSSA' then 1188
when 'PEGA LSA' then 1189
when 'Pega PRPC' then 1190
when 'Penthao' then 1191
when 'Peoplecode' then 1192
when 'PeopleSoft' then 1193
when 'Peoplesoft Administrator' then 1194
when 'PeopleSoft Campus Techno Functional' then 1195
when 'PeopleSoft CRM Developer' then 1196
when 'PeopleSoft EPM Developer' then 1197
when 'PeopleSoft EPM Functional' then 1198
when 'PeopleSoft ESA Developer' then 1199
when 'PeopleSoft ESA Project Manager' then 1200
when 'PeopleSoft Financials Project Manager' then 1201
when 'PeopleSoft FSCM Techno Functional' then 1202
when 'PeopleSoft HR Functional' then 1203
when 'PeopleSoft Payroll Developer' then 1204
when 'PeopleSoft Project Director' then 1205
when 'PEOPLESOFT TRAINER' then 1206
when 'PERL' then 1207
when 'Persian' then 1208
when 'phonegap' then 1209
when 'PIG' then 1210
when 'PL/SQL' then 1211
when 'PLM' then 1212
when 'PM' then 1213
when 'PM/Program Manager AX' then 1214
when 'PM/Program Manager CRM' then 1215
when 'PMO' then 1216
when 'Po' then 1217
when 'POS DM' then 1218
when 'Post Merger Integration Consultant' then 1219
when 'Post Production Engineer' then 1220
when 'PP' then 1221
when 'Predictive Analytics' then 1222
when 'Private Cloud' then 1223
when 'Procurement' then 1224
when 'Product Owner' then 1225
when 'Programme Director' then 1226
when 'Prolog' then 1227
when 'PS' then 1228
when 'PS-Query' then 1229
when 'Public Cloud' then 1230
when 'QlikView' then 1231
when 'QTP' then 1232
when 'Quality Engineer' then 1233
when 'R' then 1234
when 'R.' then 1235
when 'RDJ' then 1236
when 'React JS' then 1237
when 'ReactJS' then 1238
when 'Remedy' then 1239
when 'Rendezvous' then 1240
when 'Reports' then 1241
when 'Responsive Development' then 1242
when 'RESTFUL' then 1243
when 'Retail' then 1244
when 'Risk Compliance Consultant' then 1245
when 'Risk EAD' then 1246
when 'Risk IFRS9' then 1247
when 'Risk market frtb' then 1248
when 'RM' then 1249
when 'Ruby on Rails' then 1250
when 'Russian' then 1251
when 'SAAS' then 1252
when 'Sage 100' then 1253
when 'Sage CRM' then 1254
when 'Sales' then 1255
when 'Sales CRM Module' then 1256
when 'Sales Director' then 1257
when 'Salesforce' then 1258
when 'Salesforce.com Architect' then 1259
when 'Salesforce.com Technical' then 1260
when 'SAP Adapter' then 1261
when 'SAP APO Techno/Fun Consultant' then 1262
when 'SAP BASIS Administrator/Consultant' then 1263
when 'SAP BCA Techno/Fun Consultant' then 1264
when 'SAP BI Techno-Functional Consultant' then 1265
when 'SAP BI-IP Consultant' then 1266
when 'SAP BI-IP Techno/Fun Consultant' then 1267
when 'SAP BO Consultant' then 1268
when 'SAP BO Techno/Fun Consultant' then 1269
when 'Sap Business Analyst' then 1270
when 'Sap Bw Developer' then 1271
when 'Sap Crm Consultant' then 1272
when 'SAP CTRM Consultant' then 1273
when 'SAP CTRM Techno/Functional Consultant' then 1274
when 'SAP DM Consultant' then 1275
when 'SAP DM Techno/Fun Consultant' then 1276
when 'SAP EHS Consultant' then 1277
when 'SAP EWM Techno/Fun Consultant' then 1278
when 'SAP FI-AA Consultant' then 1279
when 'SAP FI-CA Consultant' then 1280
when 'SAP Fiori' then 1281
when 'SAP FM Consultant' then 1282
when 'SAP FS-BP Consultant' then 1283
when 'SAP FS-CM Consultant' then 1284
when 'SAP FS-ICM Consultant' then 1285
when 'SAP GRC Consultant' then 1286
when 'SAP GRC Techno/Fun Consultant' then 1287
when 'SAP GTS Consultant' then 1288
when 'SAP GTS Techno/Fun Consultant' then 1289
when 'SAP HANA Consultant' then 1290
when 'SAP HCM Business Analyst' then 1291
when 'SAP HCM Consultant' then 1292
when 'SAP HCM Developer' then 1293
when 'SAP HUM Consultant' then 1294
when 'SAP IPM' then 1295
when 'SAP IS-Bev Consultant' then 1296
when 'SAP IS-EH&amp;S Consultant' then 1297
when 'SAP IS-H Consultant' then 1298
when 'SAP IS-H Techno/Fun Consultant' then 1299
when 'SAP IS-Media Consultant' then 1300
when 'SAP IS-OIL CONSULTANT' then 1301
when 'SAP IS-Oil Techno/Fun Consultant' then 1302
when 'SAP IS-Procurement Techno/Functional Consultant' then 1303
when 'SAP IS-PS Consultant' then 1304
when 'SAP IS-T Consultant' then 1305
when 'SAP IS-U Techno/Fun Consultant' then 1306
when 'SAP JAVA Developer' then 1307
when 'SAP MDM Consultant' then 1308
when 'SAP MDM Techno/Fun Consultant' then 1309
when 'SAP MM Consultant' then 1310
when 'SAP PI Developer' then 1311
when 'SAP PLM Consultant' then 1312
when 'SAP PLM Techno/Fun Consultant' then 1313
when 'SAP PM CONSULTANT' then 1314
when 'SAP Portal Developer' then 1315
when 'SAP PP Consultant' then 1316
when 'SAP Project Manager' then 1317
when 'SAP PS Techno/Fun Consultant' then 1318
when 'SAP RE Techno/Fun Consultant' then 1319
when 'SAP RM Techno/Fun Consultant' then 1320
when 'SAP RM-CA' then 1321
when 'Sap Sd Consultant' then 1322
when 'SAP SD Techno/Fun Consultant' then 1323
when 'SAP Security' then 1324
when 'SAP Security &amp; Authorisations Consultant' then 1325
when 'SAP SNP Techno/Functional Consultant' then 1326
when 'SAP Solution Architect' then 1327
when 'SAP Solution Manager Consultant' then 1328
when 'SAP SRM Techno/Fun Consultant' then 1329
when 'SAP Tester' then 1330
when 'SAP TM Techno/Fun Consultant' then 1331
when 'SAP Treasury Consultant' then 1332
when 'SAP TRM Consultant' then 1333
when 'SAP TRM Techno/Functional Consultant' then 1334
when 'SAP UI5' then 1335
when 'SAP VC Consultant' then 1336
when 'SAP VC Techno/Fun Consultant' then 1337
when 'SAP WM Consultant' then 1338
when 'SAP WM Techno/Fun Consultant' then 1339
when 'SASS' then 1340
when 'Sauvegarde' then 1341
when 'Scala' then 1342
when 'SCM' then 1343
when 'Scrum Master' then 1344
when 'SD' then 1345
when 'SEC Business Analayst Security' then 1346
when 'SEC cert CEH' then 1347
when 'SEC cert CISA' then 1348
when 'SEC cert COBIT' then 1349
when 'SEC cert GSEC' then 1350
when 'SEC cert ITIL' then 1351
when 'SEC cert PCI DSS' then 1352
when 'SEC Checkpoint' then 1353
when 'SEC Cisco' then 1354
when 'SEC Cloud Security' then 1355
when 'SEC Cyber Security Governance' then 1356
when 'SEC Cyber Senior Manager' then 1357
when 'SEC Digital Forensics' then 1358
when 'SEC Hacking Android' then 1359
when 'SEC IAM Business Analyst' then 1360
when 'SEC IT Service Management' then 1361
when 'SEC KPI' then 1362
when 'SEC Log Mgt' then 1363
when 'SEC MALWARE' then 1364
when 'SEC PEN TEST' then 1365
when 'SEC PKI' then 1366
when 'SEC Scada Security' then 1367
when 'SEC Security Strategy' then 1368
when 'SEC SIEM Threat Mgt' then 1369
when 'SEC SIEM Vulnerability Mgt' then 1370
when 'SEC Virtualization' then 1371
when 'SEC Web Application Security' then 1372
when 'SELLIGENT' then 1373
when 'Selligent Technical' then 1374
when 'sencha' then 1375
when 'Serbian' then 1376
when 'Service Grid' then 1377
when 'Service Manager' then 1378
when 'SHELL' then 1379
when 'Siebel' then 1380
when 'Siebel Adapter' then 1381
when 'Siebel Administrator' then 1382
when 'Siebel AMOA' then 1383
when 'Siebel Business Analyst' then 1384
when 'Siebel Developer' then 1385
when 'SIEBEL TESTER' then 1386
when 'SINATRA Framework' then 1387
when 'Slovenian' then 1388
when 'SNMP' then 1389
when 'SNP' then 1390
when 'SOAP' then 1391
when 'SOD' then 1392
when 'Solution Design' then 1393
when 'Spanish' then 1394
when 'Spark' then 1395
when 'Spotfire' then 1396
when 'Spring' then 1397
when 'SQL' then 1398
when 'SRM' then 1399
when 'SS' then 1400
when 'SSAS' then 1401
when 'Stakeholder Management' then 1402
when 'STORM' then 1403
when 'StreamServe' then 1404
when 'SuccessFactors Compensation' then 1405
when 'Successfactors Employee Central' then 1406
when 'Successfactors LMS' then 1407
when 'SuccessFactors Onboarding' then 1408
when 'Successfactors Technical Consultant' then 1409
when 'SUSE' then 1410
when 'Swift' then 1411
when 'System Administrator' then 1412
when 'System Administrator Windows' then 1413
when 'System Engineer' then 1414
when 'System Engineer Linux' then 1415
when 'T&amp;E' then 1416
when 'Talend' then 1417
when 'Taleo' then 1418
when 'TCP/IP' then 1419
when 'TDD' then 1420
when 'Technical analyst' then 1421
when 'Technical Architect' then 1422
when 'Technical AX' then 1423
when 'Technical Lead' then 1424
when 'Technical NAV' then 1425
when 'Telco Network' then 1426
when 'Telco Support' then 1427
when 'Telecom Operational Manager' then 1428
when 'Telecom Transitional Manager' then 1429
when 'Telecoms Engineer' then 1430
when 'Telesales' then 1431
when 'Teradata' then 1432
when 'Test Manager' then 1433
when 'Tester' then 1434
when 'Tibco' then 1435
when 'TIBCO ARCHITECT' then 1436
when 'Tibco Business Analyst' then 1437
when 'Tibco Tester' then 1438
when 'Titanium' then 1439
when 'Toad' then 1440
when 'TR' then 1441
when 'Trade and Logistics AX Module' then 1442
when 'Trainer AX' then 1443
when 'Tuxedo' then 1444
when 'UML' then 1445
when 'UNIX' then 1446
when 'Update Software Functional' then 1447
when 'UX design' then 1448
when 'UX/User Experience' then 1449
when 'VC' then 1450
when 'Vietnamese' then 1451
when 'VLAN' then 1452
when 'VMWARE' then 1453
when 'VueJs 2' then 1454
when 'Waterfall' then 1455
when 'WebLogic' then 1456
when 'WebLogic Architect' then 1457
when 'Weblogic Developer' then 1458
when 'Webmethods Developer' then 1459
when 'webservices' then 1460
when 'Websphere Architect' then 1461
when 'WebSphere Project Manager' then 1462
when 'Wi-Fi' then 1463
when 'WiMax' then 1464
when 'Windows' then 1465
when 'Windows Phone' then 1466
when 'Winshuttle' then 1467
when 'Wip' then 1468
when 'Wireless' then 1469
when 'Wordpress' then 1470
when 'Workday Benefits' then 1471
when 'Workday Compensation' then 1472
when 'Workday Expenses' then 1473
when 'Workday Finance Technical Consultant' then 1474
when 'Workday French Payroll' then 1475
when 'Workday HCM Core Certified' then 1476
when 'Workday Payroll Functional Consultant' then 1477
when 'Workday Payroll Technical Consultant' then 1478
when 'Workday Project Manager' then 1479
when 'Workday Recruiting Certified' then 1480
when 'Workday Reporting Composite' then 1481
when 'Workday Testing' then 1482
when 'Workday Time and Absence' then 1483
when 'Workday Trainer' then 1484
when 'WorkFlow' then 1485
when 'WSS' then 1486
when 'Yarn' then 1487
when 'Zend' then 1488
end as 'sfe'
                from bullhorn1.Candidate C
                left join SkillName SN on C.userID = SN.userId
                where C.isPrimaryOwner = 1 and  SN.userId is not null
)

select * from sfe where sfe is not null and candidateID &lt;&gt; 16
--select count(distinct ltrim(SkillName)) as Skill from SkillName --where SkillName
--select distinct ltrim(SkillName) as Skill from SkillName --where SkillName
-- select * from bullhorn1.BH_SkillList SL where name in ('Product Mgmt &amp; Marketing','Customer/Data Analytics','Cash Ops','Investment/Portfolio Mgmt','Investment research and analysis','Credit admin/ops','Card Ops','HR Analytics','Compensation','Benefits','L&amp;D','Robotic process automation (RPA)','AI &amp; machine learning','JD Edwards ERP','Avaloq','Cognos','Hyperion','Bloomberg','Reuters','Matlab','Labview','Pro E+','SAS','Qlikview','Tableau','R Programming','SPSS','Mobile app developer','Assistant Manager','Senior Manager','Local','Startup','Social Insights &amp; Analytics','Art Creative Director','Copy Art Director','Integrated Marketing','Digital media','Customer/Data Analytics','Risk &amp; Compliance','Advisory/Sales','Investment/Portfolio Mgmt','Project Mgmt/Transformation','Client Service/Call Centre','Capex or Opex category sourcing','Chemical sourcing','Consumables category','Electrical category','Electronic component category','EMS category','Flavour category','Frangrance category','IT category sourcing','Logistic category sourcing','Marketing category sourcing','Mechanical category','NPI category sourcing','Oil &amp; gas sourcing','Professional category sourcing','Project category sourcing','Supplier mgmt','Raw material sourcing','Reverse auction','Distribution','Media research')
</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1552</xloc>
      <yloc>864</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>source</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>select
	  C.candidateID as 'candidate-externalId'
--       , Coalesce(NULLIF(replace(C.FirstName,'?',''), ''), 'No Firstname') as 'contact-firstName'
--       , Coalesce(NULLIF(replace(C.LastName,'?',''), ''), concat('Lastname-',C.userID)) as 'contact-lastName'
       , ltrim(rtrim(c.source)) as 'candidate-source'
-- select count (*) -- select distinct ltrim(rtrim(source))
from bullhorn1.Candidate C
where source &lt;&gt; '' and C.isPrimaryOwner = 1</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1664</xloc>
      <yloc>480</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>source 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>from</connection>
    <sql>select distinct ltrim(rtrim(source)) as name
       , 1 as source_type
       , current_timestamp as insert_timestamp
       , 11 as payment_style 
from bullhorn1.Candidate C
where source &lt;&gt; '' and C.isPrimaryOwner = 1</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1552</xloc>
      <yloc>400</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step_error_handling>
  </step_error_handling>
  <slave-step-copy-partition-distribution>
  </slave-step-copy-partition-distribution>
  <slave_transformation>N</slave_transformation>
</transformation>
